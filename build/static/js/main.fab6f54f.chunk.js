(this["webpackJsonpmessenger-copy"]=this["webpackJsonpmessenger-copy"]||[]).push([[0],{101:function(e,t,n){},102:function(e,t,n){},103:function(e,t,n){},104:function(e,t,n){},105:function(e,t,n){},106:function(e,t,n){"use strict";n.r(t);var a=n(4),r=n.n(a),s=n(59),c=n.n(s),i=(n(69),n(29)),o=n(31),u=n(13),l=n(19),d=n(33);n(107),n(72),n(108);d.a.initializeApp({apiKey:"AIzaSyBMB6C-_B61S1wd1RYAr34jomKZpvq16eA",authDomain:"better-react-messenger.firebaseapp.com",projectId:"better-react-messenger",storageBucket:"better-react-messenger.appspot.com",messagingSenderId:"381225253186",appId:"1:381225253186:web:43a9fb8cce6b202f31f0db"});var j=d.a.firestore(),b=d.a.auth(),p=d.a.storage(),m=new d.a.auth.GoogleAuthProvider;m.setCustomParameters({prompt:"select_account"});var h=d.a.firestore.Timestamp,O=n(6),f=Object(a.createContext)(),g=function(e,t){switch(t.type){case"LOGIN":return Object(l.a)(Object(l.a)({},e),{},{user:t.payload});case"LOGOUT":return Object(l.a)(Object(l.a)({},e),{},{user:null});case"AUTH_IS_READY":return{user:t.payload,authIsReady:!0};default:return e}},x=function(e){var t=e.children,n=Object(a.useReducer)(g,{user:null,authIsReady:!1}),r=Object(u.a)(n,2),s=r[0],c=r[1];return Object(a.useEffect)((function(){var e=b.onAuthStateChanged((function(t){c({type:"AUTH_IS_READY",payload:t}),e()}))}),[]),Object(O.jsx)(f.Provider,{value:Object(l.a)(Object(l.a)({},s),{},{dispatch:c}),children:t})},v=function(){var e=Object(a.useContext)(f);if(!e)throw Error("useAuthContext must be used inside an AuthContextProvider");return e};n(75),n(76);function y(){return Object(O.jsx)("div",{children:Object(O.jsx)("h2",{className:"page-title",children:"Dahsboard"})})}var N,w,E=n(0),D=n.n(E),S=n(15),k=n(1),L={document:null,isPending:!1,error:null,success:null},U=function(e,t){switch(t.type){case"IS_PENDING":return{isPending:!0,document:null,success:!1,error:null};case"ADDED_DOCUMENT":return{isPending:!1,document:t.payload,success:!0,error:null};case"DELETED_DOCUMENT":return{isPending:!1,document:null,success:!0,error:null};case"UPDATED_DOCUMENT":return{isPending:!1,document:t.payload,success:!0,error:null};case"ERROR":return{isPending:!1,document:null,success:!1,error:t.payload};default:return e}},R=n(110),I=function(){var e,t,n,a,r,s,c=(new Date).toLocaleDateString();return{formatDate:function(i){var o=i.createdAt.toDate();return t=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"][o.getDay()],a=o.getFullYear(),n=o.getMonth()+1<10?"0"+o.getMonth()+1:o.getMonth()+1,e=o.getDate()<10?"0"+o.getDate().toString():o.getDate().toString(),s="".concat(e,"/").concat(n,"/").concat(a),r=o.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),s===c?r:s!==c?"".concat(t,". ").concat(r):function(e){var t=new Date;return t.setDate(t.getDate()-(t.getDay()-1)),t.setHours(0,0,0,0),t.getTime()<=e.getTime()&&e.getTime()<t.getTime()+6048e5}(o)?void 0:"".concat(e,".").concat(n,".").concat(a,", ").concat(r)},dayOfMonth:e,dayOfWeek:t,month:n,year:a,hour:r,curDate:s}},P=n(46),C=n(47),B=n(60),T=n.n(B);n(97);function A(e){var t=e.src;return Object(O.jsx)("div",{className:"avatar",children:Object(O.jsx)("img",{src:t,alt:"User avatar"})})}var _=["title","titleId"];function M(){return(M=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function G(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},s=Object.keys(e);for(a=0;a<s.length;a++)n=s[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(a=0;a<s.length;a++)n=s[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function W(e,t){var n=e.title,r=e.titleId,s=G(e,_);return a.createElement("svg",M({id:"Layer_1","data-name":"Layer 1",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 122.56 122.88",ref:t,"aria-labelledby":r},s),N||(N=a.createElement("defs",null,a.createElement("style",null,".cls-1{fill-rule:evenodd;}"))),void 0===n?a.createElement("title",{id:r},"send"):n?a.createElement("title",{id:r},n):null,w||(w=a.createElement("path",{className:"cls-1",fill:"#3e2a49",d:"M2.33,44.58,117.33.37a3.63,3.63,0,0,1,5,4.56l-44,115.61h0a3.63,3.63,0,0,1-6.67.28L53.93,84.14,89.12,33.77,38.85,68.86,2.06,51.24a3.63,3.63,0,0,1,.27-6.66Z"})))}var F,q,Y=a.forwardRef(W),z=(n.p,["title","titleId"]);function K(){return(K=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function H(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},s=Object.keys(e);for(a=0;a<s.length;a++)n=s[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(a=0;a<s.length;a++)n=s[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function J(e,t){var n=e.title,r=e.titleId,s=H(e,z);return a.createElement("svg",K({xmlns:"http://www.w3.org/2000/svg",width:12,height:12,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2.5,strokeLinecap:"round",strokeLinejoin:"round",className:"feather feather-x",ref:t,"aria-labelledby":r},s),n?a.createElement("title",{id:r},n):null,F||(F=a.createElement("line",{x1:18,y1:6,x2:6,y2:18})),q||(q=a.createElement("line",{x1:6,y1:6,x2:18,y2:18})))}var Z,Q,V,X,$=a.forwardRef(J),ee=(n.p,["title","titleId"]);function te(){return(te=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function ne(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},s=Object.keys(e);for(a=0;a<s.length;a++)n=s[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(a=0;a<s.length;a++)n=s[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function ae(e,t){var n=e.title,r=e.titleId,s=ne(e,ee);return a.createElement("svg",te({xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round",className:"feather feather-smile",ref:t,"aria-labelledby":r},s),n?a.createElement("title",{id:r},n):null,Z||(Z=a.createElement("circle",{cx:12,cy:12,r:10})),Q||(Q=a.createElement("path",{d:"M8 14s1.5 2 4 2 4-2 4-2"})),V||(V=a.createElement("line",{x1:9,y1:9,x2:9.01,y2:9})),X||(X=a.createElement("line",{x1:15,y1:9,x2:15.01,y2:9})))}var re=a.forwardRef(ae),se=(n.p,n.p+"static/media/image.47145ce5.svg");function ce(e){var t=e.project,n=Object(R.a)(),s=I().formatDate,c=function(e){var t=Object(a.useReducer)(U,L),n=Object(u.a)(t,2),r=n[0],s=n[1],c=Object(a.useState)(!1),i=Object(u.a)(c,2),o=i[0],d=i[1],b=j.collection(e),p=function(e){o||s(e)},m=function(){var e=Object(k.a)(D.a.mark((function e(t){var n,a;return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s({type:"IS_PENDING"}),e.prev=1,n=h.fromDate(new Date),e.next=5,b.add(Object(l.a)(Object(l.a)({},t),{},{createdAt:n}));case 5:a=e.sent,p({type:"ADDED_DOCUMENT",payload:a}),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),p({type:"ERROR",payload:e.t0.message});case 12:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(t){return e.apply(this,arguments)}}(),O=function(){var e=Object(k.a)(D.a.mark((function e(t){return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s({type:"IS_PENDING"}),e.prev=1,e.next=4,b.doc(t).delete();case 4:p({type:"DELETED_DOCUMENT"}),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(1),p({type:"ERROR",payload:"could not delete"});case 10:case"end":return e.stop()}}),e,null,[[1,7]])})));return function(t){return e.apply(this,arguments)}}(),f=function(){var e=Object(k.a)(D.a.mark((function e(t,n){var a;return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s({type:"IS_PENDING"}),e.prev=1,e.next=4,b.doc(t).update(n);case 4:return a=e.sent,p({type:"UPDATED_DOCUMENT",payload:a}),e.abrupt("return",a);case 9:return e.prev=9,e.t0=e.catch(1),p({type:"ERROR",payload:e.t0.message}),e.abrupt("return",null);case 13:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(t,n){return e.apply(this,arguments)}}();return Object(a.useEffect)((function(){return function(){return d(!0)}}),[]),{addDocument:m,deleteDocument:O,updateDocument:f,response:r}}("projects"),i=c.updateDocument,o=c.response,d=v().user,b=Object(a.useState)(""),m=Object(u.a)(b,2),f=m[0],g=m[1],x=Object(a.useState)(null),y=Object(u.a)(x,2),N=y[0],w=y[1],E=Object(a.useState)(!1),B=Object(u.a)(E,2),_=B[0],M=B[1],G=Object(a.useRef)(null);Object(a.useEffect)((function(){t.assignedUsersId.forEach((function(e){e===d.uid&&M(!0)}))}),[M,t.assignedUsersId,d.uid]);var W=function(){var e=Object(k.a)(D.a.mark((function e(){var a;return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a={displayName:d.displayName,photoURL:d.photoURL,content:f,createdAt:h.fromDate(new Date),createdBy:d.uid,id:n},!(""!==f.trim()&&f.length<900&&_)){e.next=5;break}return e.next=4,i(t.id,{messages:[].concat(Object(S.a)(t.messages),[a]),updatedAt:h.fromDate(new Date)});case 4:o.error||g("");case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),F=function(){var e=Object(k.a)(D.a.mark((function e(){var a;return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:["image","video"].includes(N.type.split("/")[0])&&(a=Object(P.b)(p,"imgs/".concat(t.assignedUsersId[0]+t.assignedUsersId[1],"/").concat(N.name+Object(R.a)())),Object(P.c)(a,N).then((function(e){Object(P.a)(e.ref).then(function(){var e=Object(k.a)(D.a.mark((function e(a){var r;return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r={displayName:d.displayName,photoURL:d.photoURL,fileType:N.type.includes("image/")?"image":"video",image:a,createdAt:h.fromDate(new Date),createdBy:d.uid,id:n},!_){e.next=5;break}return e.next=4,i(t.id,{messages:[].concat(Object(S.a)(t.messages),[r]),updatedAt:h.fromDate(new Date)});case 4:o.error||w(null);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())})));case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),q=function(e){e.preventDefault(),N?F():W()},z=function(e,t,n){return!n[t-1]||n[t+1]&&n[t-1]&&e.createdBy!==n[t-1].createdBy&&e.createdBy===n[t+1].createdBy?e.createdBy===d.uid?"owner group-top":"group-top":n[t+1]&&n[t-1]&&e.createdBy===n[t-1].createdBy&&e.createdBy===n[t+1].createdBy?e.createdBy===d.uid?"owner group-middle":"group-middle":!n[t-1]||e.createdBy!==n[t-1].createdBy||n[t+1]&&e.createdBy===n[t+1].createdBy?e.createdBy===d.uid?"owner":"":e.createdBy===d.uid?"owner group-down":"group-down"},K=function(e,t,n){if(e&&t[n-1]){var a=e.createdAt.toDate().toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),r=t[n-1].createdAt.toDate().toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),s=new Date("01/01/2022 "+a+":00").getTime(),c=new Date("01/01/2022 "+r+":00").getTime();if(Math.abs(s-c)>=9e5)return!0}},H=Object(a.useState)(""),J=Object(u.a)(H,2),Z=J[0],Q=J[1],V=function(e,t){g((function(t){return t+e.emoji}))},X=Object(a.useState)(!1),ee=Object(u.a)(X,2),te=ee[0],ne=ee[1];return Object(O.jsxs)("div",{className:"project-comments",children:[Object(O.jsx)("ul",{children:Object(O.jsxs)("div",{className:"comments-wrapper",children:[Object(O.jsx)("p",{className:"conv-start",children:"This is the start of your conversation with this user"}),t.messages.length>0&&t.messages.map((function(e,t,n){return Object(O.jsxs)(r.a.Fragment,{children:[K(e,n,t)&&Object(O.jsx)("div",{className:"time-passed",children:s(e)}),Object(O.jsxs)("li",{className:"".concat(z(e,t,n)),children:[e.createdBy!==d.uid&&(!n[t-1]||e.createdBy!==n[t-1].createdBy)&&Object(O.jsx)("p",{className:"comment-author",children:e.displayName}),Object(O.jsxs)("div",{className:"comment-bottom",children:[e.createdBy!==d.uid&&(!n[t+1]||e.createdBy!==n[t+1].createdBy)&&Object(O.jsx)(A,{src:e.photoURL}),Object(O.jsxs)("div",{className:"comment-content",style:e.image?{padding:0,backgroundColor:"transparent"}:null,children:[e.content&&Object(O.jsx)("p",{children:e.content}),e.image&&"image"===e.fileType&&Object(O.jsx)("img",{src:e.image,alt:""}),e.image&&"video"===e.fileType&&Object(O.jsx)("video",{src:e.image,controls:!0,playsInline:!0})]})]})]})]},e.id)}))]})}),Object(O.jsxs)("form",{onSubmit:q,children:[Object(O.jsxs)("div",{className:"add-comment",children:[Object(O.jsxs)("label",{className:"attach-image",children:[Object(O.jsx)("input",{ref:G,type:"file",accept:"video/*, image/*",onChange:function(e){return function(e){w(e.target.files[0]),Q(URL.createObjectURL(e.target.files[0]))}(e)}}),Object(O.jsx)("img",{src:se,alt:""})]}),Object(O.jsxs)("div",{className:"message-field",children:[Object(O.jsxs)("div",{className:"column",children:[N&&Object(O.jsx)("div",{className:"thumbnails",children:Object(O.jsxs)("div",{className:"file-thumbnail",children:[Object(O.jsx)("img",{src:Z,alt:""}),Object(O.jsx)("button",{className:"remove-img",onClick:function(e){return function(e){e.preventDefault(),G.current.value="",w(null)}(e)},children:Object(O.jsx)($,{className:"close-btn"})})]})}),Object(O.jsx)("label",{children:Object(O.jsx)("input",{maxLength:"900",placeholder:"Aa",onChange:function(e){return g(e.target.value)},value:f,onKeyDown:function(e){return function(e){"Enter"===e.code&&q(e)}(e)}})})]}),Object(O.jsx)("button",{className:"toggle-emoji-picker",onClick:function(){return ne(!te)},children:Object(O.jsx)(re,{})}),te&&Object(O.jsx)(T.a,{onOutsideClick:function(){ne(!1)},children:Object(O.jsx)(C.c,{className:"emoji-picker",onEmojiClick:V,theme:C.b.DARK,previewConfig:{defaultCaption:"",defaultEmoji:null},emojiStyle:C.a.NATIVE})})]}),!N&&""===f.trim()&&Object(O.jsx)("button",{className:"input-tool",onClick:function(){return V({emoji:"\ud83d\udc4d",isQuickEmoji:!0})},children:Object(O.jsx)("span",{title:"it doesn't work as it should",children:"\ud83d\udc4d"})}),(""!==f.trim()||N)&&Object(O.jsx)("button",{type:"submit",className:"input-tool",children:Object(O.jsx)(Y,{})})]}),f.length>=900&&Object(O.jsx)("p",{className:"error",children:"Message can't be longer than 900 characters"})]})]})}n(98);function ie(){var e=v().user,t=function(e,t){var n=Object(a.useState)(null),r=Object(u.a)(n,2),s=r[0],c=r[1],i=Object(a.useState)(null),o=Object(u.a)(i,2),d=o[0],b=o[1];return Object(a.useEffect)((function(){var n=j.collection(e).doc(t).onSnapshot((function(e){e.data()?(c(Object(l.a)(Object(l.a)({},e.data()),{},{id:e.id})),b(null)):b("No such document exists")}),(function(e){console.log(e.message),b("Failed to get document")}));return function(){return n()}}),[e,t]),{document:s,error:d}}("projects",Object(o.g)().id),n=t.error,r=t.document,s="",c="",i=Object(a.useState)(!1),d=Object(u.a)(i,2),b=d[0],p=d[1];return Object(a.useEffect)((function(){r&&r.assignedUsersId.forEach((function(t){t===e.uid&&p(!0)}))}),[r,e.uid]),n?Object(O.jsx)("div",{className:"error",children:n}):r?(r.assignedUsersPhotoURL.forEach((function(t){t!==e.photoURL&&(s=t)})),r.assignedUsersName.forEach((function(t){t!==e.displayName&&(c=t)})),Object(O.jsx)(O.Fragment,{children:b&&Object(O.jsxs)("div",{className:"project-details",children:[e&&Object(O.jsxs)("div",{className:"top-bar",children:[Object(O.jsx)(A,{src:s}),Object(O.jsx)("h3",{children:c})]}),Object(O.jsx)(ce,{project:r})]})})):Object(O.jsx)("div",{className:"loading",children:"Loading..."})}n(101);var oe=n.p+"static/media/btn_google_dark_normal_ios.9fe90a17.svg";function ue(){var e=Object(a.useState)(""),t=Object(u.a)(e,2),n=t[0],r=t[1],s=Object(a.useState)(""),c=Object(u.a)(s,2),i=c[0],o=c[1],l=function(){var e=Object(a.useState)(!1),t=Object(u.a)(e,2),n=t[0],r=t[1],s=Object(a.useState)(null),c=Object(u.a)(s,2),i=c[0],o=c[1],l=Object(a.useState)(!1),d=Object(u.a)(l,2),p=d[0],h=d[1],O=v().dispatch,f=function(){var e=Object(k.a)(D.a.mark((function e(t,a){var r;return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o(null),h(!0),e.prev=2,e.next=5,b.signInWithEmailAndPassword(t,a);case 5:return r=e.sent,e.next=8,j.collection("users").doc(r.user.uid).update({online:!0});case 8:O({type:"LOGIN",payload:r.user}),n||(h(!1),o(null)),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(2),n||(o(e.t0.message),h(!1));case 15:case"end":return e.stop()}}),e,null,[[2,12]])})));return function(t,n){return e.apply(this,arguments)}}(),g=function(){var e=Object(k.a)(D.a.mark((function e(){var t;return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o(null),h(!0),e.prev=2,e.next=5,b.signInWithPopup(m);case 5:return t=e.sent,e.next=8,j.collection("users").doc(t.user.uid).update({online:!0});case 8:O({type:"LOGIN",payload:t.user}),n||(h(!1),o(null)),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(2),n||(o(e.t0.message),h(!1));case 15:case"end":return e.stop()}}),e,null,[[2,12]])})));return function(){return e.apply(this,arguments)}}();return Object(a.useEffect)((function(){return function(){return r(!0)}}),[]),{login:f,loginWithGoogle:g,isPending:p,error:i}}(),d=l.login,p=l.loginWithGoogle,h=l.isPending,f=l.error;return Object(O.jsxs)("form",{className:"auth-form",onSubmit:function(e){e.preventDefault(),d(n,i)},children:[Object(O.jsx)("h2",{children:"Login"}),Object(O.jsxs)("label",{children:[Object(O.jsx)("span",{children:"Email:"}),Object(O.jsx)("input",{type:"email",required:!0,onChange:function(e){return r(e.target.value)},value:n})]}),Object(O.jsxs)("label",{children:[Object(O.jsx)("span",{children:"Password:"}),Object(O.jsx)("input",{type:"password",required:!0,onChange:function(e){return o(e.target.value)},value:i})]}),!h&&Object(O.jsx)("button",{className:"btn",children:"Login in"}),h&&Object(O.jsx)("button",{className:"btn",disabled:!0,children:"Loading"}),Object(O.jsx)("div",{className:"others-separator",children:Object(O.jsx)("span",{children:"or"})}),Object(O.jsxs)("button",{className:"google-btn",onClick:function(e){e.preventDefault(),p()},children:[Object(O.jsx)("img",{src:oe,alt:"google logo"}),Object(O.jsx)("span",{children:"Sign in with google"})]}),f&&Object(O.jsx)("div",{className:"error",children:f})]})}n(102);function le(){var e=Object(a.useState)(""),t=Object(u.a)(e,2),n=t[0],r=t[1],s=Object(a.useState)(""),c=Object(u.a)(s,2),i=c[0],o=c[1],l=Object(a.useState)(""),d=Object(u.a)(l,2),h=d[0],f=d[1],g=Object(a.useState)(null),x=Object(u.a)(g,2),y=x[0],N=x[1],w=Object(a.useState)(null),E=Object(u.a)(w,2),S=E[0],L=E[1],U=function(){var e=Object(a.useState)(!1),t=Object(u.a)(e,2),n=t[0],r=t[1],s=Object(a.useState)(null),c=Object(u.a)(s,2),i=c[0],o=c[1],l=Object(a.useState)(!1),d=Object(u.a)(l,2),h=d[0],O=d[1],f=v().dispatch,g=function(){var e=Object(k.a)(D.a.mark((function e(t,a,r,s){var c,i,u,l;return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o(null),O(!0),e.prev=2,e.next=5,b.createUserWithEmailAndPassword(t,a);case 5:if(c=e.sent){e.next=8;break}throw new Error("Could not complete signup");case 8:return i="thumbnails/".concat(c.user.uid,"/").concat(s.name),e.next=11,p.ref(i).put(s);case 11:return u=e.sent,e.next=14,u.ref.getDownloadURL();case 14:return l=e.sent,e.next=17,c.user.updateProfile({displayName:r,photoURL:l});case 17:return e.next=19,j.collection("users").doc(c.user.uid).set({online:!0,displayName:r,photoURL:l});case 19:f({type:"LOGIN",payload:c.user}),n||(O(!1),o(null)),e.next=26;break;case 23:e.prev=23,e.t0=e.catch(2),n||(o(e.t0.message),O(!1));case 26:case"end":return e.stop()}}),e,null,[[2,23]])})));return function(t,n,a,r){return e.apply(this,arguments)}}(),x=function(){var e=Object(k.a)(D.a.mark((function e(){var t;return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o(null),O(!0),e.prev=2,e.next=5,b.signInWithPopup(m);case 5:if(t=e.sent){e.next=8;break}throw new Error("Could not complete signup");case 8:return e.next=10,t.user.updateProfile({displayName:t.user.displayName,photoURL:t.user.photoURL});case 10:return e.next=12,j.collection("users").doc(t.user.uid).set({online:!0,displayName:t.user.displayName,photoURL:t.user.photoURL});case 12:f({type:"LOGIN",payload:t.user}),n||(O(!1),o(null)),e.next=19;break;case 16:e.prev=16,e.t0=e.catch(2),n||(o(e.t0.message),O(!1));case 19:case"end":return e.stop()}}),e,null,[[2,16]])})));return function(){return e.apply(this,arguments)}}();return Object(a.useEffect)((function(){return function(){return r(!0)}}),[]),{signup:g,signInWithGoogle:x,error:i,isPending:h}}(),R=U.signup,I=U.signInWithGoogle,P=U.isPending,C=U.error;return Object(O.jsxs)("form",{className:"auth-form",onSubmit:function(e){e.preventDefault(),R(n,i,h,y)},children:[Object(O.jsx)("h2",{children:"Sign up"}),Object(O.jsxs)("label",{children:[Object(O.jsx)("span",{children:"Email:"}),Object(O.jsx)("input",{type:"email",required:!0,onChange:function(e){return r(e.target.value)},value:n})]}),Object(O.jsxs)("label",{children:[Object(O.jsx)("span",{children:"Password:"}),Object(O.jsx)("input",{type:"password",required:!0,onChange:function(e){return o(e.target.value)},value:i})]}),Object(O.jsxs)("label",{children:[Object(O.jsx)("span",{children:"Display name:"}),Object(O.jsx)("input",{type:"text",required:!0,onChange:function(e){return f(e.target.value)},value:h})]}),Object(O.jsxs)("label",{children:[Object(O.jsx)("span",{children:"Profile thumbnail:"}),Object(O.jsx)("input",{type:"file",required:!0,onChange:function(e){N(null);var t=e.target.files[0];t?t.type.includes("image")?!t.size>1e5?L("Image file size must be less than 100kb"):(L(null),N(t)):L("Selected file must be an image"):L("Please select a file")}}),S&&Object(O.jsx)("div",{className:"error",children:S})]}),!P&&Object(O.jsx)("button",{className:"btn",children:"Sign up"}),P&&Object(O.jsx)("button",{className:"btn",disabled:!0,children:"Loading"}),Object(O.jsx)("div",{className:"others-separator",children:Object(O.jsx)("span",{children:"or"})}),Object(O.jsxs)("button",{className:"google-btn",onClick:function(e){e.preventDefault(),I()},children:[Object(O.jsx)("img",{src:oe,alt:"google logo"}),Object(O.jsx)("span",{children:"Sign in with google"})]}),C&&Object(O.jsx)("div",{className:"error",children:C})]})}n(103);var de=n.p+"static/media/temple.c57f882d.svg";function je(){var e=v().user;return Object(O.jsx)("nav",{className:"navbar",children:Object(O.jsxs)("div",{className:"container",children:[Object(O.jsxs)(i.b,{to:"/",className:"logo",children:[Object(O.jsx)("img",{src:de,alt:"autismChat logo"}),Object(O.jsx)("span",{children:"The Better Messenger"})]}),!e&&Object(O.jsxs)(O.Fragment,{children:[Object(O.jsx)(i.b,{to:"/login",children:"Login"}),Object(O.jsx)(i.b,{to:"/signup",children:"Signup"})]})]})})}var be=n(38),pe=function(e,t,n){var r=Object(a.useState)(null),s=Object(u.a)(r,2),c=s[0],i=s[1],o=Object(a.useState)(null),d=Object(u.a)(o,2),b=d[0],p=d[1],m=Object(a.useRef)(t).current,h=Object(a.useRef)(n).current;return Object(a.useEffect)((function(){var t,n,a=j.collection(e);m&&(a=(t=a).where.apply(t,Object(S.a)(m)));h&&(a=(n=a).orderBy.apply(n,Object(S.a)(h)));var r=a.onSnapshot((function(e){var t=[];e.docs.forEach((function(e){t.push(Object(l.a)(Object(l.a)({},e.data()),{},{id:e.id}))})),i(t),p(null)}),(function(e){console.log(e),p("could not fetch the data")}));return function(){return r()}}),[e,m,h]),{documents:c,error:b}},me=n(8),he=n(63);n(104);function Oe(e){var t=e.projects,n=v().user,a=pe("users").documents,r=[],s="",c="",o="",u={about:"",minute:"min","less than a minute":"1 min"};return Object(O.jsxs)("div",{className:"chat-list",onMouseMove:function(e){var t,n=Object(me.a)(document.getElementsByClassName("card"));try{for(n.s();!(t=n.n()).done;){var a=t.value,r=a.getBoundingClientRect(),s=e.clientX-r.left,c=e.clientY-r.top;a.style.setProperty("--mouse-x","".concat(s,"px")),a.style.setProperty("--mouse-y","".concat(c,"px"))}}catch(i){n.e(i)}finally{n.f()}},children:[0===t.length&&Object(O.jsx)("p",{children:"No chats yet!"}),t.map((function(e){return Object(O.jsx)(i.b,{to:"/projects/".concat(e.id),className:"card",children:Object(O.jsxs)("div",{className:"card-content",children:[e.assignedUsersPhotoURL.forEach((function(e){e!==n.photoURL&&(s=e)})),e.assignedUsersName.forEach((function(e){e!==n.displayName&&(c=e)})),e.assignedUsersId.forEach((function(e){e!==n.uid&&(o=e)})),a&&a.forEach((function(e){e.online&&!r.includes(e.id)&&r.push(e.id)})),Object(O.jsxs)("div",{className:"avatar-container",children:[Object(O.jsx)(A,{src:s}),r.includes(o)&&Object(O.jsx)("span",{className:"online-user",children:Object(O.jsx)("div",{className:"status-circle"})})]}),Object(O.jsxs)("div",{className:"chat-info",children:[Object(O.jsx)("p",{className:"display-name",children:c.substring(0,18)}),c.length>=18&&"...",Object(O.jsxs)("div",{className:"last-chat",children:[Object(O.jsxs)("span",{className:"last-message",children:[e&&e.messages[e.messages.length-1]&&e.messages[e.messages.length-1].createdBy===n.uid&&"You: ",0!==e.messages.length&&e.messages[e.messages.length-1].content&&void 0===e.messages[e.messages.length-1].fileType&&e.messages[e.messages.length-1].content.substring(0,15),0!==e.messages.length&&!e.messages[e.messages.length-1].content&&"image"===e.messages[e.messages.length-1].fileType&&"sent a photo",0!==e.messages.length&&!e.messages[e.messages.length-1].content&&"video"===e.messages[e.messages.length-1].fileType&&"sent a video",0!==e.messages.length&&e.messages[e.messages.length-1].content&&e.messages[e.messages.length-1].content.length>=15&&"...",0===e.messages.length&&"No messages yet"]}),0!==e.messages.length&&Object(O.jsx)("div",{className:"dot"}),Object(O.jsx)("span",{className:"comment-date",children:0!==e.messages.length&&Object(he.a)(e.messages[e.messages.length-1].createdAt.toDate(),{addSuffix:!1}).replace(/\b(?:about|less than a minute)\b/gi,(function(e){return u[e]}))})]})]})]})},e.id)}))]})}n(105);function fe(){var e=v().user,t=function(){var e=Object(a.useState)(!1),t=Object(u.a)(e,2),n=t[0],r=t[1],s=Object(a.useState)(null),c=Object(u.a)(s,2),i=c[0],o=c[1],l=Object(a.useState)(!1),d=Object(u.a)(l,2),p=d[0],m=d[1],h=v(),O=h.dispatch,f=h.user,g=function(){var e=Object(k.a)(D.a.mark((function e(){var t;return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o(null),m(!0),e.prev=2,t=f.uid,e.next=6,j.collection("users").doc(t).update({online:!1});case 6:return e.next=8,b.signOut();case 8:O({type:"LOGOUT"}),n||(m(!1),o(null)),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(2),n||(o(e.t0.message),m(!1));case 15:case"end":return e.stop()}}),e,null,[[2,12]])})));return function(){return e.apply(this,arguments)}}();return Object(a.useEffect)((function(){return function(){return r(!0)}}),[]),{logout:g,error:i,isPending:p}}(),n=t.logout,r=t.isPending,s=pe("users").documents,c=pe("projects",["assignedUsersId","array-contains",e.uid],["updatedAt","desc"]).documents,i=Object(a.useState)(""),o=Object(u.a)(i,2),l=o[0],d=o[1],p=function(){var t=Object(k.a)(D.a.mark((function t(n){var a;return D.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=e.uid>n.id?e.uid+n.id:n.id+e.uid,t.prev=1,t.next=4,Object(be.b)(Object(be.a)(j,"projects",a));case 4:if(t.sent.exists()){t.next=8;break}return t.next=8,Object(be.c)(Object(be.a)(j,"projects",a),{id:a,assignedUsersId:[e.uid,n.id],assignedUsersName:[e.displayName,n.displayName],assignedUsersPhotoURL:[e.photoURL,n.photoURL],messages:[],updatedAt:h.fromDate(new Date)});case 8:t.next=12;break;case 10:t.prev=10,t.t0=t.catch(1);case 12:d("");case 13:case"end":return t.stop()}}),t,null,[[1,10]])})));return function(e){return t.apply(this,arguments)}}();return Object(O.jsxs)("div",{className:"user-list",children:[Object(O.jsxs)("div",{className:"search",children:[Object(O.jsx)("h2",{children:"Chats"}),Object(O.jsxs)("div",{children:[Object(O.jsx)("div",{className:"search-form",children:Object(O.jsx)("input",{type:"text",placeholder:"Find a user",onChange:function(e){return d(e.target.value)},value:l})}),""!==l&&Object(O.jsx)(O.Fragment,{children:Object(O.jsxs)("div",{className:"add-users",children:[s&&s.filter((function(e){return e.displayName.toLowerCase().trim().replace(/\s+/g,"").includes(l)})).map((function(e){return Object(O.jsxs)("div",{className:"user-chat",onClick:function(){return p(e)},children:[Object(O.jsx)("img",{src:e.photoURL,alt:""}),Object(O.jsx)("div",{className:"user-chat-info",children:Object(O.jsx)("span",{children:e.displayName})})]},e.id)})),""===l.trim()&&Object(O.jsx)("span",{children:"User not found!"})]})}),Object(O.jsx)("div",{className:"chats",children:""===l&&c&&Object(O.jsx)(Oe,{projects:c})})]})]}),Object(O.jsxs)("div",{className:"user",children:[Object(O.jsxs)("div",{children:[Object(O.jsx)(A,{src:e.photoURL}),Object(O.jsx)("span",{children:e.displayName})]}),!r&&e&&Object(O.jsx)("button",{className:"btn",onClick:n,children:"Logout"}),r&&Object(O.jsx)("button",{className:"btn",disabled:!0,children:"Logging out..."})]})]})}var ge=function(){var e=v(),t=e.user,n=e.authIsReady;return Object(O.jsx)("div",{className:"App",children:n&&Object(O.jsxs)(i.a,{children:[t&&Object(O.jsx)(fe,{}),Object(O.jsxs)("div",{className:"container",children:[!t&&Object(O.jsx)(je,{}),Object(O.jsxs)(o.d,{children:[Object(O.jsxs)(o.b,{exact:!0,path:"/",children:[!t&&Object(O.jsx)(o.a,{to:"/login"}),t&&Object(O.jsx)(y,{})]}),Object(O.jsxs)(o.b,{path:"/projects/:id",children:[!t&&Object(O.jsx)(o.a,{to:"/login"}),t&&Object(O.jsx)(ie,{})]}),Object(O.jsxs)(o.b,{path:"/login",children:[t&&Object(O.jsx)(o.a,{to:"/"}),!t&&Object(O.jsx)(ue,{})]}),Object(O.jsxs)(o.b,{path:"/signup",children:[t&&Object(O.jsx)(o.a,{to:"/"}),!t&&Object(O.jsx)(le,{})]})]})]})]})})};c.a.render(Object(O.jsx)(r.a.StrictMode,{children:Object(O.jsx)(x,{children:Object(O.jsx)(ge,{})})}),document.getElementById("root"))},69:function(e,t,n){},75:function(e,t,n){},76:function(e,t,n){},97:function(e,t,n){},98:function(e,t,n){}},[[106,1,2]]]);
//# sourceMappingURL=main.fab6f54f.chunk.js.map