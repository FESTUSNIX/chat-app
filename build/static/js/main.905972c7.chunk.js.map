{"version":3,"sources":["firebase/config.js","context/AuthContext.js","hooks/useAuthContext.js","pages/dashboard/Dashboard.js","hooks/useDocument.js","hooks/useFirestore.js","hooks/useDates.js","components/Avatar.js","hooks/useEscapeKey.js","components/Modal.js","components/Message.js","components/Messages.js","components/ChatInput.js","pages/chat/Chat.js","hooks/useLogin.js","assets/btn_google_dark_normal_ios.svg","assets/GitHub-Mark-Light-32px.png","pages/login/Login.js","pages/signup/Signup.js","hooks/useSignup.js","pages/privacyPolicy/privacyPolicy.js","assets/shrek-gif.gif","pages/resetPassword/ResetPassword.js","pages/resetPassword/SetNewPassword.js","hooks/useQuery.js","hooks/useCollection.js","components/ChatsList.js","components/Chats.js","hooks/useLogout.js","App.js","index.js"],"names":["firebase","initializeApp","apiKey","authDomain","projectId","storageBucket","messagingSenderId","appId","projectFirestore","firestore","projectAuth","auth","projectStorage","storage","projectGoogle","GoogleAuthProvider","projectGitHub","GithubAuthProvider","setCustomParameters","prompt","timestamp","Timestamp","AuthContext","createContext","authReducer","state","action","type","user","payload","authIsReady","AuthContextProvider","children","useReducer","dispatch","useEffect","unsub","onAuthStateChanged","Provider","value","useAuthContext","context","useContext","Error","Dashboard","className","initialState","document","isPending","error","success","firestoreReducer","useFirestore","collection","response","useState","isCancelled","setIsCancelled","ref","dispatchIfNotCancelled","addDocument","doc","a","createdAt","fromDate","Date","add","addedDocument","message","deleteDocument","id","delete","updateDocument","updates","update","updatedDocument","useDates","dayOfMonth","dayOfWeek","month","year","hour","curDate","fullDate","today","toLocaleDateString","weekday","formatDate","comment","date","toDate","getDay","getFullYear","getMonth","getDate","toString","toLocaleTimeString","minute","dateToFormat","lastMonday","setDate","setHours","getTime","isCurrentWeek","dates","Avatar","src","alt","KEY_EVENT_TYPE","Modal","show","setShow","onClose","handleClose","handleEscKey","useCallback","event","key","addEventListener","removeEventListener","useEscapeKey","onOutsideClick","onClick","Message","elements","i","chat","onMessageResponse","setMessageToDelete","showImage","setShowImage","otherUser","showEmojis","setShowEmojis","showModal","setShowModal","emojiReactions","setEmojiReactions","showSendDate","value1","value2","date1","date2","Math","abs","showSendDate2","reactWithEmoji","e","indexOfMessage","messages","indexOf","otherUserReaction","length","forEach","rec","uid","emojiToAdd","photoURL","content","emoji","displayName","console","log","handleReactionNicknames","reaction","nickname","assignedUsers","u","deleteEmojiReaction","prev","next","prevIsDate","nextIsDate","createdBy","handleMessageStyle","deleted","getElementById","scrollIntoView","block","setTimeout","classList","remove","scrollToResponse","substring","image","fileType","style","padding","backgroundColor","target","showFullImage","controls","playsInline","map","disabled","onEmojiClick","theme","Theme","DARK","previewConfig","defaultCaption","defaultEmoji","width","height","emojiStyle","EmojiStyle","NATIVE","viewBox","d","Number","Messages","setBottomDiv","currentUser","messageToDelete","history","useHistory","bottomRef","useRef","scrollDownRef","scrollToBottom","listen","deleteMessage","current","onScroll","winScroll","scrollTop","handleScrollDownBtn","FileSaver","saveAs","ChatInput","messageResponse","bottomDiv","inputRef","uniqueId","uuid","newComment","setNewComment","imgUpload","setImgUpload","isAssignedUser","setIsAssignedUser","chatEmoji","fastEmoji","setFastEmoji","sendFastEmoji","setSendFastEmoji","fileInputRef","focus","assignedUsersId","sendMessage","commentToAdd","trim","updatedAt","isRead","sendImage","includes","split","storageRef","name","uploadBytes","then","snapshot","getDownloadURL","downloadURL","handleImageUpload","imageFile","files","options","maxSizeMB","maxWidthOrHeight","useWebWorker","imageCompression","compressedFile","handleSubmit","preventDefault","fileThumbnail","setFileThumbnail","onSubmit","accept","onChange","URL","createObjectURL","handleFileChange","resetFileInput","maxLength","placeholder","onKeyDown","code","handleKey","handleEmojis","innerText","unified","size","Chat","setCurrentChat","useParams","setDocument","setError","onSnapshot","data","err","useDocument","showChatOptions","setShowChatOptions","showEmojiPicker","setShowEmojiPicker","showNicknameInput","setShowNicknameInput","newNickname","setNewNickname","setOtherUser","setCurrentUser","online","prevValue","toggle","handleNicknameInput","changeNickname","changeChatEmoji","useLogin","setIsPending","isFinished","setIsFinished","login","email","password","signInWithEmailAndPassword","res","loginWithGoogle","signInWithPopup","loginWithGithub","sendPasswordReset","sendPasswordResetEmail","push","resetPassword","newPassword","confirmPasswordReset","Login","setEmail","setPassword","required","to","googleLogo","githubLogo","Signup","setDisplayName","thumbnail","setThumbnail","thumbnailError","setThumbnailError","signup","createUserWithEmailAndPassword","uploadPath","put","img","imgUrl","updateProfile","set","signInWithGoogle","signInWithGithub","additionalUserInfo","username","useSignup","selected","PrivacyPolicy","class","ResetPassword","timeToRedirect","setTimeToRedirect","handlePasswordReset","countdown","redirectCountdown","setInterval","clearInterval","prevTimeToRedirect","ShrekGif","SetNewPassword","setNewPassword","oobCode","queryName","location","useLocation","URLSearchParams","search","get","useQuery","useCollection","_query","_orderBy","documents","setDocuments","query","orderBy","where","unsubscribe","results","docs","ChatsList","chats","currentChat","users","onlineUsers","rightUrl","rightDisplayName","rightId","replaceDistanceToNow","about","minutes","onMouseMove","getElementsByClassName","card","rect","getBoundingClientRect","x","clientX","left","y","clientY","top","setProperty","undefined","formatDistanceToNowStrict","addSuffix","replace","matched","Chats","logout","signOut","useLogout","setQuery","handleSelect","addUser","combinedId","getDoc","exists","setDoc","filter","toLowerCase","App","exact","path","ReactDOM","render","StrictMode"],"mappings":"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","file":"static/js/main.905972c7.chunk.js","sourcesContent":["import firebase from 'firebase/compat/app'\r\nimport 'firebase/compat/firestore'\r\nimport 'firebase/compat/auth'\r\nimport 'firebase/compat/storage'\r\n\r\nconst firebaseConfig = {\r\n\tapiKey: 'AIzaSyBMB6C-_B61S1wd1RYAr34jomKZpvq16eA',\r\n\tauthDomain: 'better-react-messenger.firebaseapp.com',\r\n\tprojectId: 'better-react-messenger',\r\n\tstorageBucket: 'better-react-messenger.appspot.com',\r\n\tmessagingSenderId: '381225253186',\r\n\tappId: '1:381225253186:web:43a9fb8cce6b202f31f0db',\r\n}\r\n\r\n// Firebase init\r\nfirebase.initializeApp(firebaseConfig)\r\n\r\n// Services init\r\nconst projectFirestore = firebase.firestore()\r\nconst projectAuth = firebase.auth()\r\nconst projectStorage = firebase.storage()\r\n\r\nconst projectGoogle = new firebase.auth.GoogleAuthProvider()\r\nconst projectGitHub = new firebase.auth.GithubAuthProvider()\r\n\r\nprojectGoogle.setCustomParameters({ prompt: 'select_account' })\r\n// Timestamp\r\nconst timestamp = firebase.firestore.Timestamp\r\n\r\nexport { projectFirestore, projectAuth, timestamp, projectStorage, projectGoogle, projectGitHub }\r\n","import { createContext, useReducer, useEffect } from 'react'\nimport { projectAuth } from '../firebase/config'\n\nexport const AuthContext = createContext()\n\nexport const authReducer = (state, action) => {\n\tswitch (action.type) {\n\t\tcase 'LOGIN':\n\t\t\treturn { ...state, user: action.payload }\n\t\tcase 'LOGOUT':\n\t\t\treturn { ...state, user: null }\n\t\tcase 'AUTH_IS_READY':\n\t\t\treturn { user: action.payload, authIsReady: true }\n\t\tdefault:\n\t\t\treturn state\n\t}\n}\n\nexport const AuthContextProvider = ({ children }) => {\n\tconst [state, dispatch] = useReducer(authReducer, {\n\t\tuser: null,\n\t\tauthIsReady: false,\n\t})\n\n\tuseEffect(() => {\n\t\tconst unsub = projectAuth.onAuthStateChanged(user => {\n\t\t\tdispatch({ type: 'AUTH_IS_READY', payload: user })\n\t\t\tunsub()\n\t\t})\n\t}, [])\n\n\treturn <AuthContext.Provider value={{ ...state, dispatch }}>{children}</AuthContext.Provider>\n}\n","import { AuthContext } from \"../context/AuthContext\"\nimport { useContext } from \"react\"\n\nexport const useAuthContext = () => {\n  const context = useContext(AuthContext)\n\n  if(!context) {\n    throw Error('useAuthContext must be used inside an AuthContextProvider')\n  }\n\n  return context\n}","// Styles\r\nimport './Dashboard.scss'\r\n\r\nexport default function Dashboard() {\r\n\treturn (\r\n\t\t<div className='dashboard'>\r\n\t\t\t<div className='wise-mystical-tree'></div>\r\n\t\t</div>\r\n\t)\r\n}\r\n","import { useEffect, useState } from 'react'\r\nimport { projectFirestore } from '../firebase/config'\r\n\r\nexport const useDocument = (collection, id) => {\r\n\tconst [document, setDocument] = useState(null)\r\n\tconst [error, setError] = useState(null)\r\n\r\n\t// Realtime data for document\r\n\tuseEffect(() => {\r\n\t\tif (id !== null) {\r\n\t\t\tconst ref = projectFirestore.collection(collection).doc(id)\r\n\r\n\t\t\tconst unsub = ref.onSnapshot(\r\n\t\t\t\tsnapshot => {\r\n\t\t\t\t\tif (snapshot.data()) {\r\n\t\t\t\t\t\tsetDocument({ ...snapshot.data(), id: snapshot.id })\r\n\t\t\t\t\t\tsetError(null)\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tsetError('No such document exists')\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\terr => {\r\n\t\t\t\t\tconsole.log(err.message)\r\n\t\t\t\t\tsetError('Failed to get document')\r\n\t\t\t\t}\r\n\t\t\t)\r\n\r\n\t\t\treturn () => unsub()\r\n\t\t}\r\n\t}, [collection, id])\r\n\r\n\treturn { document, error }\r\n}\r\n","import { useReducer, useEffect, useState } from 'react'\nimport { projectFirestore, timestamp } from '../firebase/config'\n\nlet initialState = {\n\tdocument: null,\n\tisPending: false,\n\terror: null,\n\tsuccess: null,\n}\n\nconst firestoreReducer = (state, action) => {\n\tswitch (action.type) {\n\t\tcase 'IS_PENDING':\n\t\t\treturn { isPending: true, document: null, success: false, error: null }\n\t\tcase 'ADDED_DOCUMENT':\n\t\t\treturn { isPending: false, document: action.payload, success: true, error: null }\n\t\tcase 'DELETED_DOCUMENT':\n\t\t\treturn { isPending: false, document: null, success: true, error: null }\n\t\tcase 'UPDATED_DOCUMENT':\n\t\t\treturn { isPending: false, document: action.payload, success: true, error: null }\n\t\tcase 'ERROR':\n\t\t\treturn { isPending: false, document: null, success: false, error: action.payload }\n\t\tdefault:\n\t\t\treturn state\n\t}\n}\n\nexport const useFirestore = collection => {\n\tconst [response, dispatch] = useReducer(firestoreReducer, initialState)\n\tconst [isCancelled, setIsCancelled] = useState(false)\n\n\t// Collection ref\n\tconst ref = projectFirestore.collection(collection)\n\n\t// Only dispatch is not cancelled\n\tconst dispatchIfNotCancelled = action => {\n\t\tif (!isCancelled) {\n\t\t\tdispatch(action)\n\t\t}\n\t}\n\n\t// Add a document\n\tconst addDocument = async doc => {\n\t\tdispatch({ type: 'IS_PENDING' })\n\n\t\ttry {\n\t\t\tconst createdAt = timestamp.fromDate(new Date())\n\n\t\t\tconst addedDocument = await ref.add({ ...doc, createdAt })\n\t\t\tdispatchIfNotCancelled({ type: 'ADDED_DOCUMENT', payload: addedDocument })\n\t\t} catch (err) {\n\t\t\tdispatchIfNotCancelled({ type: 'ERROR', payload: err.message })\n\t\t}\n\t}\n\n\t// Delete a document\n\tconst deleteDocument = async id => {\n\t\tdispatch({ type: 'IS_PENDING' })\n\n\t\ttry {\n\t\t\tawait ref.doc(id).delete()\n\t\t\tdispatchIfNotCancelled({ type: 'DELETED_DOCUMENT' })\n\t\t} catch (err) {\n\t\t\tdispatchIfNotCancelled({ type: 'ERROR', payload: 'could not delete' })\n\t\t}\n\t}\n\n\t// Update documents\n\n\tconst updateDocument = async (id, updates) => {\n\t\tdispatch({ type: 'IS_PENDING' })\n\n\t\ttry {\n\t\t\tconst updatedDocument = await ref.doc(id).update(updates)\n\n\t\t\tdispatchIfNotCancelled({ type: 'UPDATED_DOCUMENT', payload: updatedDocument })\n\t\t\treturn updatedDocument\n\t\t} catch (err) {\n\t\t\tdispatchIfNotCancelled({ type: 'ERROR', payload: err.message })\n\t\t\treturn null\n\t\t}\n\t}\n\n\tuseEffect(() => {\n\t\treturn () => setIsCancelled(true)\n\t}, [])\n\n\treturn { addDocument, deleteDocument, updateDocument, response }\n}\n","export const useDates = () => {\r\n\tlet today = new Date().toLocaleDateString()\r\n\tlet weekday = []\r\n\tlet dayOfMonth, dayOfWeek, month, year, hour, curDate, fullDate\r\n\r\n\tconst dates = dateToFormat => {\r\n\t\tconst date = dateToFormat.toDate()\r\n\t\tweekday = ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun']\r\n\t\tdayOfWeek = weekday[date.getDay()]\r\n\r\n\t\tyear = date.getFullYear()\r\n\r\n\t\tmonth = date.getMonth() + 1 < 10 ? '0' + date.getMonth() + 1 : date.getMonth() + 1\r\n\r\n\t\tdayOfMonth = date.getDate() < 10 ? '0' + date.getDate().toString() : date.getDate().toString()\r\n\r\n\t\tcurDate = `${dayOfMonth}/${month}/${year}`\r\n\t\thour = date.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })\r\n\r\n\t\tfullDate = `${dayOfMonth}.${month}.${year}, ${hour}`\r\n\r\n\t\treturn { weekday, dayOfWeek, year, month, dayOfMonth, curDate, hour, fullDate }\r\n\t}\r\n\r\n\tconst isCurrentWeek = dateToFormat => {\r\n\t\tlet lastMonday = new Date() // Creating new date object for today\r\n\t\tlastMonday.setDate(lastMonday.getDate() - (lastMonday.getDay() - 1)) // Setting date to last monday\r\n\t\tlastMonday.setHours(0, 0, 0, 0) // Setting Hour to 00:00:00:00\r\n\r\n\t\tconst res =\r\n\t\t\tlastMonday.getTime() <= dateToFormat.getTime() && dateToFormat.getTime() < lastMonday.getTime() + 604800000\r\n\r\n\t\treturn res\r\n\t}\r\n\r\n\tconst formatDate = comment => {\r\n\t\tconst date = comment.createdAt.toDate()\r\n\r\n\t\tweekday = ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun']\r\n\t\tdayOfWeek = weekday[date.getDay()]\r\n\r\n\t\tyear = date.getFullYear()\r\n\r\n\t\tmonth = date.getMonth() + 1 < 10 ? '0' + date.getMonth() + 1 : date.getMonth() + 1\r\n\r\n\t\tdayOfMonth = date.getDate() < 10 ? '0' + date.getDate().toString() : date.getDate().toString()\r\n\r\n\t\tcurDate = `${dayOfMonth}/${month}/${year}`\r\n\t\thour = date.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })\r\n\r\n\t\tif (curDate === today) {\r\n\t\t\treturn hour\r\n\t\t} else if (isCurrentWeek(date)) {\r\n\t\t\treturn `${dayOfWeek}. ${hour}`\r\n\t\t} else {\r\n\t\t\treturn `${dayOfMonth}.${month}.${year}, ${hour}`\r\n\t\t}\r\n\t}\r\n\r\n\treturn { formatDate, dates, dayOfMonth, dayOfWeek, month, year, hour, curDate }\r\n}\r\n","// Styles\r\nimport './Avatar.scss'\r\n\r\nexport default function Avatar({ src }) {\r\n\treturn (\r\n\t\t<div className='avatar'>\r\n\t\t\t<img src={src} alt='' />\r\n\t\t</div>\r\n\t)\r\n}\r\n","import { useCallback, useEffect } from 'react'\r\n\r\nconst KEY_NAME_ESC = 'Escape'\r\nconst KEY_EVENT_TYPE = 'keyup'\r\n\r\nexport function useEscapeKey(handleClose) {\r\n\tconst handleEscKey = useCallback(\r\n\t\tevent => {\r\n\t\t\tif (event.key === KEY_NAME_ESC) {\r\n\t\t\t\thandleClose()\r\n\t\t\t}\r\n\t\t},\r\n\t\t[handleClose]\r\n\t)\r\n\r\n\tuseEffect(() => {\r\n\t\tdocument.addEventListener(KEY_EVENT_TYPE, handleEscKey, false)\r\n\r\n\t\treturn () => {\r\n\t\t\tdocument.removeEventListener(KEY_EVENT_TYPE, handleEscKey, false)\r\n\t\t}\r\n\t}, [handleEscKey])\r\n}\r\n","import { useEffect } from 'react'\r\nimport OutsideClickHandler from 'react-outside-click-handler'\r\nimport { useEscapeKey } from '../hooks/useEscapeKey'\r\n\r\n// Styles\r\nimport './Modal.scss'\r\n\r\nexport default function Modal({ children, show, setShow, onClose }) {\r\n\tuseEffect(() => {\r\n\t\tif (show === false && onClose) {\r\n\t\t\tonClose()\r\n\t\t}\r\n\t}, [show])\r\n\r\n\tconst hideModal = () => {\r\n\t\tsetShow()\r\n\t}\r\n\r\n\tuseEscapeKey(hideModal)\r\n\r\n\treturn (\r\n\t\tshow && (\r\n\t\t\t<div className='modal'>\r\n\t\t\t\t<OutsideClickHandler\r\n\t\t\t\t\tonOutsideClick={() => {\r\n\t\t\t\t\t\tsetShow()\r\n\t\t\t\t\t}}>\r\n\t\t\t\t\t<div className='modal__content'>\r\n\t\t\t\t\t\t{children}\r\n\t\t\t\t\t\t<i className='fa-solid fa-xmark close-btn' onClick={() => setShow()}></i>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</OutsideClickHandler>\r\n\t\t\t</div>\r\n\t\t)\r\n\t)\r\n}\r\n","import React from 'react'\r\nimport { useState } from 'react'\r\nimport { useAuthContext } from '../hooks/useAuthContext'\r\nimport { useFirestore } from '../hooks/useFirestore'\r\nimport EmojiPicker, { EmojiStyle, Theme } from 'emoji-picker-react'\r\nimport { useDates } from '../hooks/useDates'\r\nimport OutsideClickHandler from 'react-outside-click-handler'\r\n\r\n// Styles && Assets\r\nimport './Message.scss'\r\nimport Avatar from './Avatar'\r\nimport Modal from './Modal'\r\n\r\nexport default function Message({\r\n\tmessage,\r\n\telements,\r\n\ti,\r\n\tchat,\r\n\tonMessageResponse,\r\n\tsetMessageToDelete,\r\n\tshowImage,\r\n\tsetShowImage,\r\n\totherUser,\r\n}) {\r\n\tconst { user } = useAuthContext()\r\n\tconst { updateDocument } = useFirestore('projects')\r\n\tconst { formatDate } = useDates()\r\n\r\n\tconst [showEmojis, setShowEmojis] = useState(null)\r\n\tconst [showModal, setShowModal] = useState(false)\r\n\tconst [emojiReactions, setEmojiReactions] = useState([])\r\n\r\n\tconst showSendDate = (elements, i) => {\r\n\t\tif (elements[i] && elements[i - 1]) {\r\n\t\t\tconst value1 = elements[i].createdAt.toDate().toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })\r\n\t\t\tconst value2 = elements[i - 1].createdAt.toDate().toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })\r\n\r\n\t\t\t// Get miliseconds of each message.createdAt\r\n\t\t\tconst date1 = new Date('01/01/2022 ' + value1 + ':00').getTime()\r\n\t\t\tconst date2 = new Date('01/01/2022 ' + value2 + ':00').getTime()\r\n\r\n\t\t\tconst minuteDiff = Math.abs(date1 - date2)\r\n\r\n\t\t\t// Check if difference between when message was created is greater than 15 minutes\r\n\t\t\tif (minuteDiff >= 900000) {\r\n\t\t\t\treturn true\r\n\t\t\t} else {\r\n\t\t\t\treturn false\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tconst showSendDate2 = (elements, i) => {\r\n\t\tif (elements[i + 1] && elements[i]) {\r\n\t\t\tconst value1 = elements[i + 1].createdAt.toDate().toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })\r\n\t\t\tconst value2 = elements[i].createdAt.toDate().toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })\r\n\r\n\t\t\t// Get miliseconds of each message.createdAt\r\n\t\t\tconst date1 = new Date('01/01/2022 ' + value1 + ':00').getTime()\r\n\t\t\tconst date2 = new Date('01/01/2022 ' + value2 + ':00').getTime()\r\n\r\n\t\t\tconst minuteDiff = Math.abs(date1 - date2)\r\n\r\n\t\t\t// Check if difference between when message was created is greater than 15 minutes\r\n\t\t\tif (minuteDiff >= 900000) {\r\n\t\t\t\treturn true\r\n\t\t\t} else {\r\n\t\t\t\treturn false\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tconst showFullImage = e => {\r\n\t\tif (showImage !== e.target.src) {\r\n\t\t\tsetShowImage(e.target.src)\r\n\t\t}\r\n\t}\r\n\r\n\tconst scrollToResponse = id => {\r\n\t\tconst ref = document.getElementById(id)\r\n\t\tref.scrollIntoView({ block: 'center' })\r\n\t\tsetTimeout(() => {\r\n\t\t\tref.classList.add('pop')\r\n\t\t\tsetTimeout(() => {\r\n\t\t\t\tref.classList.remove('pop')\r\n\t\t\t}, 800)\r\n\t\t}, 400)\r\n\t}\r\n\r\n\tconst reactWithEmoji = async (e, message) => {\r\n\t\tconst indexOfMessage = chat.messages.indexOf(message)\r\n\r\n\t\tlet otherUserReaction = null\r\n\r\n\t\tif (message.emojiReactions && message.emojiReactions.length > 0) {\r\n\t\t\tmessage.emojiReactions.forEach(rec => {\r\n\t\t\t\tif (rec !== null) {\r\n\t\t\t\t\tif (rec.id !== user.uid) {\r\n\t\t\t\t\t\totherUserReaction = rec\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t}\r\n\r\n\t\tconst emojiToAdd = {\r\n\t\t\tid: user.uid,\r\n\t\t\tphotoURL: user.photoURL,\r\n\t\t\tcontent: e.emoji,\r\n\t\t\tdisplayName: user.displayName,\r\n\t\t}\r\n\r\n\t\tchat.messages[indexOfMessage] = {\r\n\t\t\t...chat.messages[indexOfMessage],\r\n\t\t\temojiReactions: [\r\n\t\t\t\totherUserReaction ? otherUserReaction : null,\r\n\t\t\t\t{\r\n\t\t\t\t\t...emojiToAdd,\r\n\t\t\t\t},\r\n\t\t\t],\r\n\t\t}\r\n\r\n\t\ttry {\r\n\t\t\tawait updateDocument(chat.id, {\r\n\t\t\t\tmessages: [...chat.messages],\r\n\t\t\t})\r\n\t\t} catch (error) {\r\n\t\t\tconsole.log(error)\r\n\t\t}\r\n\t}\r\n\r\n\tconst handleMessageStyle = (message, prev, next, prevIsDate, nextIsDate) => {\r\n\t\tif (\r\n\t\t\tnext &&\r\n\t\t\t(!prev ||\r\n\t\t\t\tprev.createdBy !== message.createdBy ||\r\n\t\t\t\tnext.response !== null ||\r\n\t\t\t\tprevIsDate ||\r\n\t\t\t\tmessage.response !== null) &&\r\n\t\t\tnext.createdBy === message.createdBy &&\r\n\t\t\tnext.response === null &&\r\n\t\t\t!nextIsDate\r\n\t\t) {\r\n\t\t\tif (message.createdBy === user.uid) {\r\n\t\t\t\treturn 'group-top owner'\r\n\t\t\t} else {\r\n\t\t\t\treturn 'group-top'\r\n\t\t\t}\r\n\t\t} else if (\r\n\t\t\tprev &&\r\n\t\t\tnext &&\r\n\t\t\t(prev.createdBy === message.createdBy || prev.response !== null) &&\r\n\t\t\tnext.createdBy === message.createdBy &&\r\n\t\t\tnext.response === null &&\r\n\t\t\t!prevIsDate &&\r\n\t\t\t!nextIsDate\r\n\t\t) {\r\n\t\t\tif (message.createdBy === user.uid) {\r\n\t\t\t\treturn 'group-middle owner'\r\n\t\t\t} else {\r\n\t\t\t\treturn 'group-middle'\r\n\t\t\t}\r\n\t\t} else if (\r\n\t\t\t// prettier-ignore\r\n\t\t\tprev &&\r\n\t\t\tprev.createdBy === message.createdBy &&\r\n\t\t\tmessage.response === null &&\r\n\t\t\t(\r\n\t\t\t\t(!next && message.response === null) ||\r\n\t\t\t\t(\r\n\t\t\t\t\tnext && \r\n\t\t\t\t\t(\r\n\t\t\t\t\t\tnext.response !== null ||\r\n\t\t\t\t\t\tnext.createdBy !== message.createdBy ||\r\n\t\t\t\t\t\tnextIsDate\r\n\t\t\t\t\t)\r\n\t\t\t\t)\r\n\t\t\t) &&\r\n\t\t\t!prevIsDate\r\n\t\t) {\r\n\t\t\tif (message.createdBy === user.uid) {\r\n\t\t\t\treturn 'group-bottom owner'\r\n\t\t\t} else {\r\n\t\t\t\treturn 'group-bottom'\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tif (message.createdBy === user.uid) {\r\n\t\t\t\treturn 'owner'\r\n\t\t\t} else {\r\n\t\t\t\treturn ''\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tconst handleReactionNicknames = reaction => {\r\n\t\tlet nickname\r\n\t\tchat.assignedUsers.forEach(u => {\r\n\t\t\tif (u.id === reaction.id) {\r\n\t\t\t\tif (u.nickname !== '') {\r\n\t\t\t\t\tnickname = u.nickname\r\n\t\t\t\t} else {\r\n\t\t\t\t\tnickname = u.displayName\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t})\r\n\t\treturn nickname\r\n\t}\r\n\r\n\tconst deleteEmojiReaction = async (message, reaction) => {\r\n\t\tlet otherUserReaction = null\r\n\t\tif (reaction.id === user.uid) {\r\n\t\t\tif (message.emojiReactions.length > 0) {\r\n\t\t\t\t// otherUserReaction = message.emojiReactions.find(rec => rec.id !== user.uid)\r\n\r\n\t\t\t\tmessage.emojiReactions.forEach(rec => {\r\n\t\t\t\t\tif (rec !== null && rec.id !== user.uid) {\r\n\t\t\t\t\t\totherUserReaction = rec\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t}\r\n\r\n\t\t\tconst indexOfMessage = chat.messages.indexOf(message)\r\n\r\n\t\t\tchat.messages[indexOfMessage] = {\r\n\t\t\t\t...chat.messages[indexOfMessage],\r\n\t\t\t\temojiReactions: [otherUserReaction],\r\n\t\t\t}\r\n\r\n\t\t\ttry {\r\n\t\t\t\tawait updateDocument(chat.id, {\r\n\t\t\t\t\tmessages: [...chat.messages],\r\n\t\t\t\t})\r\n\t\t\t\tsetEmojiReactions([])\r\n\t\t\t\tsetShowModal(false)\r\n\t\t\t} catch (error) {\r\n\t\t\t\tconsole.log(error)\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\treturn (\r\n\t\t<>\r\n\t\t\t{showSendDate(elements, i) && <div className='messages__time-passed'>{formatDate(message)}</div>}\r\n\t\t\t<li\r\n\t\t\t\tclassName={`${handleMessageStyle(\r\n\t\t\t\t\tmessage,\r\n\t\t\t\t\telements[i - 1],\r\n\t\t\t\t\telements[i + 1],\r\n\t\t\t\t\tshowSendDate(elements, i),\r\n\t\t\t\t\tshowSendDate2(elements, i)\r\n\t\t\t\t)} ${message.deleted ? 'deleted' : ''} ${message.emojiReactions ? 'emoji-response' : ''}`}\r\n\t\t\t\tid={message.id}>\r\n\t\t\t\t{\r\n\t\t\t\t\t// prettier-ignore\r\n\t\t\t\t\t(\r\n\t\t\t\t\t\tmessage.createdBy !== user.uid &&\r\n\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t// top\r\n\t\t\t\t\t\t\t\telements[i + 1] &&\r\n\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t!elements[i - 1] ||\r\n\t\t\t\t\t\t\t\t\telements[i - 1].createdBy !== message.createdBy ||\r\n\t\t\t\t\t\t\t\t\telements[i + 1].response !== null ||\r\n\t\t\t\t\t\t\t\t\tshowSendDate(elements, i) ||\r\n\t\t\t\t\t\t\t\t\tmessage.response !== null\r\n\t\t\t\t\t\t\t\t) &&\r\n\t\t\t\t\t\t\t\telements[i + 1].createdBy === message.createdBy &&\r\n\t\t\t\t\t\t\t\telements[i + 1].response === null &&\r\n\t\t\t\t\t\t\t\t!showSendDate2(elements, i)\r\n\t\t\t\t\t\t\t) ||\r\n\t\t\t\t\t\t\t!(\t\r\n\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t// middle\r\n\t\t\t\t\t\t\t\t\telements[i - 1] &&\r\n\t\t\t\t\t\t\t\t\telements[i + 1] &&\r\n\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\telements[i - 1].createdBy === message.createdBy || \r\n\t\t\t\t\t\t\t\t\t\telements[i - 1].response !== null\r\n\t\t\t\t\t\t\t\t\t) &&\r\n\t\t\t\t\t\t\t\t\telements[i + 1].createdBy === message.createdBy &&\r\n\t\t\t\t\t\t\t\t\telements[i + 1].response === null &&\r\n\t\t\t\t\t\t\t\t\t!showSendDate(elements, i) &&\r\n\t\t\t\t\t\t\t\t\t!showSendDate2(elements, i)\r\n\t\t\t\t\t\t\t\t) ||\r\n\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t// bottom\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\telements[i - 1] &&\r\n\t\t\t\t\t\t\t\t\telements[i - 1].createdBy === message.createdBy &&\r\n\t\t\t\t\t\t\t\t\tmessage.response === null &&\r\n\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\t(!elements[i + 1] && message.response === null) ||\r\n\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\t\telements[i + 1] && \r\n\t\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\t\t\telements[i + 1].response !== null ||\r\n\t\t\t\t\t\t\t\t\t\t\t\telements[i + 1].createdBy !== message.createdBy ||\r\n\t\t\t\t\t\t\t\t\t\t\t\tshowSendDate2(elements, i)\r\n\t\t\t\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\t\t) &&\r\n\t\t\t\t\t\t\t\t\t!showSendDate(elements, i)\r\n\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t)\r\n\t\t\t\t\t) && (\r\n\t\t\t\t\t\t// !! Show nickname instead\r\n\t\t\t\t\t\t<p className='message-author'>{otherUser.nickname}</p>\r\n\t\t\t\t\t)\r\n\t\t\t\t}\r\n\r\n\t\t\t\t{message.response !== null && (\r\n\t\t\t\t\t<div\r\n\t\t\t\t\t\tonClick={() => scrollToResponse(chat.messages[message.response].id)}\r\n\t\t\t\t\t\tclassName={`response ${chat.messages[message.response].deleted ? 'deleted' : ''}`}>\r\n\t\t\t\t\t\t{message.createdBy !== user.uid && <div className='left-margin'></div>}\r\n\r\n\t\t\t\t\t\t{chat.messages[message.response].content && (\r\n\t\t\t\t\t\t\t<div className='response__message'>{chat.messages[message.response].content.substring(0, 55)}</div>\r\n\t\t\t\t\t\t)}\r\n\r\n\t\t\t\t\t\t<div className='response__img'>\r\n\t\t\t\t\t\t\t{chat.messages[message.response].image &&\r\n\t\t\t\t\t\t\t\t(chat.messages[message.response].fileType === 'image' ? (\r\n\t\t\t\t\t\t\t\t\t<img src={chat.messages[message.response].image} alt='' />\r\n\t\t\t\t\t\t\t\t) : (\r\n\t\t\t\t\t\t\t\t\t<video src={chat.messages[message.response].image}></video>\r\n\t\t\t\t\t\t\t\t))}\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t)}\r\n\t\t\t\t<div className='message-content'>\r\n\t\t\t\t\t{message.createdBy !== user.uid && (\r\n\t\t\t\t\t\t<div className='left-margin'>\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t// prettier-ignore\r\n\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\t!(\r\n\t\t\t\t\t\t\t\t\t\t\t// middle\r\n\t\t\t\t\t\t\t\t\t\t\telements[i - 1] &&\r\n\t\t\t\t\t\t\t\t\t\t\telements[i + 1] &&\r\n\t\t\t\t\t\t\t\t\t\t\t(elements[i - 1].createdBy === message.createdBy || elements[i - 1].response !== null) &&\r\n\t\t\t\t\t\t\t\t\t\t\telements[i + 1].createdBy === message.createdBy &&\r\n\t\t\t\t\t\t\t\t\t\t\telements[i + 1].response === null &&\r\n\t\t\t\t\t\t\t\t\t\t\t!showSendDate(elements, i) &&\r\n\t\t\t\t\t\t\t\t\t\t\t!showSendDate2(elements, i)\r\n\t\t\t\t\t\t\t\t\t\t) &&\r\n\t\t\t\t\t\t\t\t\t\t!(\r\n\t\t\t\t\t\t\t\t\t\t\t// top\r\n\t\t\t\t\t\t\t\t\t\t\telements[i + 1] &&\r\n\t\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\t\t\t!elements[i - 1] ||\r\n\t\t\t\t\t\t\t\t\t\t\t\telements[i - 1].createdBy !== message.createdBy ||\r\n\t\t\t\t\t\t\t\t\t\t\t\telements[i + 1].response !== null ||\r\n\t\t\t\t\t\t\t\t\t\t\t\tshowSendDate(elements, i) ||\r\n\t\t\t\t\t\t\t\t\t\t\t\tmessage.response !== null\r\n\t\t\t\t\t\t\t\t\t\t\t) &&\r\n\t\t\t\t\t\t\t\t\t\t\telements[i + 1].createdBy === message.createdBy &&\r\n\t\t\t\t\t\t\t\t\t\t\telements[i + 1].response === null &&\r\n\t\t\t\t\t\t\t\t\t\t\t!showSendDate2(elements, i)\r\n\t\t\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t) && <Avatar src={message.photoURL} />\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t)}\r\n\t\t\t\t\t<div\r\n\t\t\t\t\t\tclassName='message-content__text'\r\n\t\t\t\t\t\tstyle={message.image ? { padding: 0, backgroundColor: 'transparent' } : null}>\r\n\t\t\t\t\t\t{message.content && <p>{message.content}</p>}\r\n\r\n\t\t\t\t\t\t{message.image && message.fileType === 'image' && (\r\n\t\t\t\t\t\t\t<div className='file-message' onClick={e => showFullImage(e)}>\r\n\t\t\t\t\t\t\t\t<img src={message.image} alt='' />\r\n\t\t\t\t\t\t\t\t<div className='file-message__preview'>\r\n\t\t\t\t\t\t\t\t\t<i className='fa-solid fa-up-right-and-down-left-from-center'></i>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t)}\r\n\r\n\t\t\t\t\t\t{message.image && message.fileType === 'video' && (\r\n\t\t\t\t\t\t\t<div className='file-message'>\r\n\t\t\t\t\t\t\t\t<video src={message.image} controls playsInline />\r\n\t\t\t\t\t\t\t\t<div className='file-message__preview'>\r\n\t\t\t\t\t\t\t\t\t<i className='fa-solid fa-up-right-and-down-left-from-center'></i>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t)}\r\n\r\n\t\t\t\t\t\t{message.emojiReactions && message.emojiReactions.length > 0 && (\r\n\t\t\t\t\t\t\t<>\r\n\t\t\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\t\t\tclassName='emoji-reactions'\r\n\t\t\t\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\t\t\t\tsetEmojiReactions(message.emojiReactions)\r\n\t\t\t\t\t\t\t\t\t\tsetShowModal(true)\r\n\t\t\t\t\t\t\t\t\t}}>\r\n\t\t\t\t\t\t\t\t\t{message.emojiReactions.map(reaction =>\r\n\t\t\t\t\t\t\t\t\t\treaction !== null ? (\r\n\t\t\t\t\t\t\t\t\t\t\t<div key={reaction.id} className='emoji-reactions__reaction'>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<span className='content'>{reaction.content}</span>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<span className='display-name'>{handleReactionNicknames(reaction)}</span>\r\n\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t) : null\r\n\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t\t<Modal show={showModal} setShow={() => setShowModal(false)} onClose={() => setEmojiReactions([])}>\r\n\t\t\t\t\t\t\t\t\t<div className='show-reactions'>\r\n\t\t\t\t\t\t\t\t\t\t<h3>Reactions</h3>\r\n\t\t\t\t\t\t\t\t\t\t{emojiReactions.map(reaction =>\r\n\t\t\t\t\t\t\t\t\t\t\treaction !== null ? (\r\n\t\t\t\t\t\t\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tclassName={`reaction ${reaction.id === user.uid ? 'cursor-pointer' : ''}`}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tdeleteEmojiReaction(message, reaction)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tkey={reaction.id}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<div className='reaction__author'>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Avatar src={reaction.photoURL} />\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<p>{reaction.displayName}</p>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{reaction.id === user.uid && <p>Click to delete</p>}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<span className='reaction__emoji'>{reaction.content}</span>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t) : null\r\n\t\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t</Modal>\r\n\t\t\t\t\t\t\t</>\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t{showEmojis === message && (\r\n\t\t\t\t\t\t<div className='react-with-emoji'>\r\n\t\t\t\t\t\t\t<OutsideClickHandler\r\n\t\t\t\t\t\t\t\tonOutsideClick={() => {\r\n\t\t\t\t\t\t\t\t\tsetShowEmojis(null)\r\n\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\tdisabled={showEmojis === message ? false : true}>\r\n\t\t\t\t\t\t\t\t<EmojiPicker\r\n\t\t\t\t\t\t\t\t\tclassName='emoji-picker'\r\n\t\t\t\t\t\t\t\t\tonEmojiClick={e => {\r\n\t\t\t\t\t\t\t\t\t\treactWithEmoji(e, message)\r\n\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\ttheme={Theme.DARK}\r\n\t\t\t\t\t\t\t\t\tpreviewConfig={{\r\n\t\t\t\t\t\t\t\t\t\tdefaultCaption: '',\r\n\t\t\t\t\t\t\t\t\t\tdefaultEmoji: null,\r\n\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\twidth={300}\r\n\t\t\t\t\t\t\t\t\theight={400}\r\n\t\t\t\t\t\t\t\t\t// lazyLoadEmojis={true}\r\n\t\t\t\t\t\t\t\t\temojiStyle={EmojiStyle.NATIVE}\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t</OutsideClickHandler>\r\n\r\n\t\t\t\t\t\t\t<svg height='12' viewBox='0 0 25 12' width='25' data-darkreader-inline-fill=''>\r\n\t\t\t\t\t\t\t\t<path d='M24.553.103c-2.791.32-5.922 1.53-7.78 3.455l-9.62 7.023c-2.45 2.54-5.78 1.645-5.78-2.487V2.085C1.373 1.191.846.422.1.102h24.453z'></path>\r\n\t\t\t\t\t\t\t</svg>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t)}\r\n\r\n\t\t\t\t\t{!message.deleted && (\r\n\t\t\t\t\t\t<div className={`message-tools ${showEmojis === message ? 'visible' : ''}`}>\r\n\t\t\t\t\t\t\t<i\r\n\t\t\t\t\t\t\t\tclassName='fa-regular fa-face-smile'\r\n\t\t\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\t\t\tsetShowEmojis(message)\r\n\t\t\t\t\t\t\t\t}}>\r\n\t\t\t\t\t\t\t\t<div className='tool-tip'>React</div>\r\n\t\t\t\t\t\t\t</i>\r\n\r\n\t\t\t\t\t\t\t{user.uid === message.createdBy && (\r\n\t\t\t\t\t\t\t\t<i className='fa-solid fa-trash-can' onClick={() => setMessageToDelete(message)}>\r\n\t\t\t\t\t\t\t\t\t<div className='tool-tip'>Remove</div>\r\n\t\t\t\t\t\t\t\t</i>\r\n\t\t\t\t\t\t\t)}\r\n\r\n\t\t\t\t\t\t\t<i\r\n\t\t\t\t\t\t\t\tclassName='fa-solid fa-reply'\r\n\t\t\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\t\t\tonMessageResponse(Number(chat.messages.indexOf(message)))\r\n\t\t\t\t\t\t\t\t}}>\r\n\t\t\t\t\t\t\t\t<div className='tool-tip'>Reply</div>\r\n\t\t\t\t\t\t\t</i>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t)}\r\n\r\n\t\t\t\t\t<div className={`message-createdAt ${showEmojis === message ? 'hidden' : ''}`}>{formatDate(message)}</div>\r\n\t\t\t\t</div>\r\n\t\t\t</li>\r\n\t\t</>\r\n\t)\r\n}\r\n","import React, { useState, useEffect, useRef } from 'react'\r\nimport { useAuthContext } from '../hooks/useAuthContext'\r\nimport { useDates } from '../hooks/useDates'\r\nimport { useFirestore } from '../hooks/useFirestore'\r\nimport { useHistory } from 'react-router-dom'\r\nimport FileSaver from 'file-saver'\r\nimport Message from './Message'\r\n\r\n// Styles && Assets\r\nimport './Messages.scss'\r\nimport Modal from './Modal'\r\n\r\nconst Messages = ({ chat, onMessageResponse, setBottomDiv, otherUser, currentUser }) => {\r\n\tconst { user } = useAuthContext()\r\n\tconst { dates } = useDates()\r\n\tconst { updateDocument } = useFirestore('projects')\r\n\r\n\tconst [showImage, setShowImage] = useState('')\r\n\tconst [messageToDelete, setMessageToDelete] = useState(null)\r\n\tconst [showModal, setShowModal] = useState(false)\r\n\r\n\tconst history = useHistory()\r\n\tconst bottomRef = useRef()\r\n\tconst scrollDownRef = useRef()\r\n\r\n\tuseEffect(() => {\r\n\t\tsetBottomDiv(bottomRef)\r\n\t\tscrollToBottom()\r\n\t}, [])\r\n\r\n\tuseEffect(() => {\r\n\t\treturn history.listen(() => {\r\n\t\t\tsetBottomDiv(bottomRef)\r\n\t\t\tscrollToBottom()\r\n\t\t\tonMessageResponse(null)\r\n\t\t})\r\n\t}, [history])\r\n\r\n\tuseEffect(() => {\r\n\t\tif (messageToDelete !== null) {\r\n\t\t\tsetShowModal(true)\r\n\t\t} else {\r\n\t\t\tsetShowModal(false)\r\n\t\t}\r\n\t}, [messageToDelete, showModal])\r\n\r\n\tconst deleteMessage = async message => {\r\n\t\tif (user.uid === message.createdBy) {\r\n\t\t\tchat.messages[chat.messages.indexOf(message)] = {\r\n\t\t\t\t...chat.messages[chat.messages.indexOf(message)],\r\n\t\t\t\tcontent: 'Message deleted',\r\n\t\t\t\temojiReactions: null,\r\n\t\t\t\tdeleted: true,\r\n\t\t\t}\r\n\r\n\t\t\ttry {\r\n\t\t\t\tawait updateDocument(chat.id, {\r\n\t\t\t\t\tmessages: [...chat.messages],\r\n\t\t\t\t})\r\n\t\t\t\tsetMessageToDelete(null)\r\n\t\t\t} catch (error) {\r\n\t\t\t\tconsole.log(error)\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tconst hideFullImage = () => {\r\n\t\tsetShowImage('')\r\n\t}\r\n\r\n\tconst downloadImage = () => {\r\n\t\tFileSaver.saveAs(showImage)\r\n\t}\r\n\r\n\tconst scrollToBottom = () => {\r\n\t\tif (bottomRef.current) {\r\n\t\t\tbottomRef.current.scrollIntoView({\r\n\t\t\t\tblock: 'end',\r\n\t\t\t})\r\n\t\t}\r\n\t}\r\n\r\n\tconst handleScrollDownBtn = e => {\r\n\t\tconst winScroll = e.target.scrollTop\r\n\r\n\t\tif (-winScroll <= 300) {\r\n\t\t\tscrollDownRef.current.classList.remove('active')\r\n\t\t}\r\n\r\n\t\tif (-winScroll >= 300) {\r\n\t\t\tscrollDownRef.current.classList.add('active')\r\n\t\t}\r\n\t}\r\n\r\n\treturn (\r\n\t\t<ul className='messages custom-scrollbar' id='messages' onScroll={e => handleScrollDownBtn(e)}>\r\n\t\t\t{showImage && (\r\n\t\t\t\t<div className='full-img'>\r\n\t\t\t\t\t<div className='full-img__background'>\r\n\t\t\t\t\t\t<div className='backdrop-blur'></div>\r\n\t\t\t\t\t\t<img src={showImage} alt='' className='' />\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div className='wrapper'>\r\n\t\t\t\t\t\t<img src={showImage} alt='' className='full-img__img' />\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t<div className='full-img__tools'>\r\n\t\t\t\t\t\t<div className='tool' onClick={() => downloadImage()}>\r\n\t\t\t\t\t\t\t<i className='fa-solid fa-download'></i>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<div className='tool' onClick={() => hideFullImage()}>\r\n\t\t\t\t\t\t\t<i className='fa-solid fa-xmark'></i>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t)}\r\n\t\t\t<div className='messages-wrapper'>\r\n\t\t\t\t<div className='messages__conversation-start'>\r\n\t\t\t\t\t<p>This is the start of your conversation with this user</p>\r\n\t\t\t\t\t<p>{dates(chat.createdAt).fullDate}</p>\r\n\t\t\t\t</div>\r\n\r\n\t\t\t\t{chat.messages.length > 0 &&\r\n\t\t\t\t\tchat.messages.map((message, i, elements) => (\r\n\t\t\t\t\t\t<Message\r\n\t\t\t\t\t\t\tkey={message.id}\r\n\t\t\t\t\t\t\tmessage={message}\r\n\t\t\t\t\t\t\telements={elements}\r\n\t\t\t\t\t\t\ti={i}\r\n\t\t\t\t\t\t\tchat={chat}\r\n\t\t\t\t\t\t\tonMessageResponse={onMessageResponse}\r\n\t\t\t\t\t\t\tsetMessageToDelete={setMessageToDelete}\r\n\t\t\t\t\t\t\tshowImage={showImage}\r\n\t\t\t\t\t\t\tsetShowImage={setShowImage}\r\n\t\t\t\t\t\t\totherUser={otherUser}\r\n\t\t\t\t\t\t\tcurrentUser={currentUser}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t))}\r\n\t\t\t\t<div ref={bottomRef} className='bottom-ref'></div>\r\n\t\t\t</div>\r\n\t\t\t<div className='scroll-down' onClick={() => scrollToBottom()} ref={scrollDownRef}>\r\n\t\t\t\t<i className='fa-solid fa-arrow-down'></i>\r\n\t\t\t</div>\r\n\t\t\t{messageToDelete !== null && (\r\n\t\t\t\t<Modal\r\n\t\t\t\t\tshow={showModal}\r\n\t\t\t\t\tsetShow={() => setMessageToDelete(null)}\r\n\t\t\t\t\t// onClose={() => {}}\r\n\t\t\t\t>\r\n\t\t\t\t\t<div className='confirm-message-delete'>\r\n\t\t\t\t\t\t<h2>Delete message</h2>\r\n\t\t\t\t\t\t<p>Do you really want to delete this message?</p>\r\n\r\n\t\t\t\t\t\t<p>Message to delete: </p>\r\n\t\t\t\t\t\t<div className='message-to-delete custom-scrollbar'>\r\n\t\t\t\t\t\t\t{messageToDelete.content && <span>\"{messageToDelete.content}\"</span>}\r\n\t\t\t\t\t\t\t{messageToDelete.image && <img src={messageToDelete.image} alt='' />}\r\n\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t<div className='vertical-btns'>\r\n\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\tclassName='btn btn--secondary'\r\n\t\t\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\t\t\tsetMessageToDelete(null)\r\n\t\t\t\t\t\t\t\t}}>\r\n\t\t\t\t\t\t\t\tCancel\r\n\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t<button className='btn' onClick={() => deleteMessage(messageToDelete)}>\r\n\t\t\t\t\t\t\t\tDelete\r\n\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</Modal>\r\n\t\t\t)}\r\n\t\t</ul>\r\n\t)\r\n}\r\n\r\nexport default Messages\r\n","import React, { useEffect, useRef, useState } from 'react'\r\nimport { timestamp, projectStorage } from '../firebase/config'\r\nimport { useAuthContext } from '../hooks/useAuthContext'\r\nimport { useFirestore } from '../hooks/useFirestore'\r\nimport { v4 as uuid } from 'uuid'\r\nimport { getDownloadURL, ref, uploadBytes } from 'firebase/storage'\r\nimport EmojiPicker, { Emoji, EmojiStyle, Theme } from 'emoji-picker-react'\r\nimport OutsideClickHandler from 'react-outside-click-handler'\r\nimport imageCompression from 'browser-image-compression'\r\n\r\n// Styles && Assets\r\nimport './ChatInput.scss'\r\n\r\nconst ChatInput = ({ chat, messageResponse, onMessageResponse, bottomDiv, inputRef }) => {\r\n\tconst uniqueId = uuid()\r\n\r\n\tconst { updateDocument, response } = useFirestore('projects')\r\n\tconst { user } = useAuthContext()\r\n\r\n\tconst [newComment, setNewComment] = useState('')\r\n\tconst [imgUpload, setImgUpload] = useState(null)\r\n\tconst [isAssignedUser, setIsAssignedUser] = useState(false)\r\n\tconst [fastEmoji, setFastEmoji] = useState(chat.chatEmoji)\r\n\tconst [sendFastEmoji, setSendFastEmoji] = useState(false)\r\n\tconst [showEmojis, setShowEmojis] = useState(false)\r\n\r\n\tconst fileInputRef = useRef(null)\r\n\r\n\tuseEffect(() => {\r\n\t\tinputRef.current.focus()\r\n\t}, [messageResponse])\r\n\r\n\tuseEffect(() => {\r\n\t\tchat.assignedUsersId.forEach(id => {\r\n\t\t\tif (id === user.uid) setIsAssignedUser(true)\r\n\t\t})\r\n\t}, [setIsAssignedUser, chat.assignedUsersId, user.uid])\r\n\r\n\tconst scrollToBottom = () => {\r\n\t\tbottomDiv.current.scrollIntoView({\r\n\t\t\tblock: 'end',\r\n\t\t})\r\n\t}\r\n\r\n\tconst sendMessage = async () => {\r\n\t\tconst commentToAdd = {\r\n\t\t\tid: uniqueId,\r\n\t\t\tdisplayName: user.displayName,\r\n\t\t\tphotoURL: user.photoURL,\r\n\t\t\tcontent: sendFastEmoji ? fastEmoji : newComment,\r\n\t\t\tcreatedAt: timestamp.fromDate(new Date()),\r\n\t\t\tcreatedBy: user.uid,\r\n\t\t\tresponse: messageResponse !== null ? messageResponse : null,\r\n\t\t}\r\n\r\n\t\tif (commentToAdd.content.trim() !== '' && newComment.length < 900 && isAssignedUser) {\r\n\t\t\tawait updateDocument(chat.id, {\r\n\t\t\t\tmessages: [...chat.messages, commentToAdd],\r\n\t\t\t\tupdatedAt: timestamp.fromDate(new Date()),\r\n\t\t\t\tisRead: false,\r\n\t\t\t})\r\n\t\t\tif (!response.error) {\r\n\t\t\t\tscrollToBottom()\r\n\t\t\t\tsetNewComment('')\r\n\t\t\t\tsetSendFastEmoji(false)\r\n\t\t\t\tonMessageResponse(null)\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tconst sendImage = async () => {\r\n\t\tconst acceptedFileTypes = ['image', 'video']\r\n\r\n\t\tif (acceptedFileTypes.includes(imgUpload.type.split('/')[0])) {\r\n\t\t\tconst storageRef = ref(\r\n\t\t\t\tprojectStorage,\r\n\t\t\t\t`imgs/${chat.assignedUsersId[0] + chat.assignedUsersId[1]}/${uuid() + imgUpload.name}`\r\n\t\t\t)\r\n\t\t\tconst uploadTask = uploadBytes(storageRef, imgUpload)\r\n\r\n\t\t\tuploadTask.then(snapshot => {\r\n\t\t\t\tgetDownloadURL(snapshot.ref).then(async downloadURL => {\r\n\t\t\t\t\tconst commentToAdd = {\r\n\t\t\t\t\t\tid: uniqueId,\r\n\t\t\t\t\t\tdisplayName: user.displayName,\r\n\t\t\t\t\t\tphotoURL: user.photoURL,\r\n\t\t\t\t\t\t// content: newComment,\r\n\t\t\t\t\t\tfileType: imgUpload.type.includes('image/') ? 'image' : 'video',\r\n\t\t\t\t\t\timage: downloadURL,\r\n\t\t\t\t\t\tcreatedAt: timestamp.fromDate(new Date()),\r\n\t\t\t\t\t\tcreatedBy: user.uid,\r\n\t\t\t\t\t\tresponse: messageResponse !== null ? messageResponse : null,\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif (isAssignedUser) {\r\n\t\t\t\t\t\tawait updateDocument(chat.id, {\r\n\t\t\t\t\t\t\tmessages: [...chat.messages, commentToAdd],\r\n\t\t\t\t\t\t\tupdatedAt: timestamp.fromDate(new Date()),\r\n\t\t\t\t\t\t\tisRead: false,\r\n\t\t\t\t\t\t})\r\n\r\n\t\t\t\t\t\tif (!response.error) {\r\n\t\t\t\t\t\t\tscrollToBottom()\r\n\t\t\t\t\t\t\tsetImgUpload(null)\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t})\r\n\t\t}\r\n\t}\r\n\r\n\tconst handleImageUpload = async e => {\r\n\t\tconst imageFile = e.target.files[0]\r\n\r\n\t\tconst options = {\r\n\t\t\tmaxSizeMB: 1,\r\n\t\t\tmaxWidthOrHeight: 1920,\r\n\t\t\tuseWebWorker: true,\r\n\t\t}\r\n\t\ttry {\r\n\t\t\tconst compressedFile = await imageCompression(imageFile, options)\r\n\t\t\tawait setImgUpload(compressedFile)\r\n\t\t} catch (error) {\r\n\t\t\tconsole.log(error)\r\n\t\t}\r\n\t}\r\n\r\n\tconst handleSubmit = e => {\r\n\t\te.preventDefault()\r\n\r\n\t\tif (imgUpload) {\r\n\t\t\tsendImage()\r\n\t\t} else {\r\n\t\t\tsendMessage()\r\n\t\t}\r\n\t}\r\n\r\n\tconst handleKey = e => {\r\n\t\te.code === 'Enter' && handleSubmit(e)\r\n\t}\r\n\r\n\tconst [fileThumbnail, setFileThumbnail] = useState('')\r\n\r\n\tconst handleFileChange = e => {\r\n\t\thandleImageUpload(e)\r\n\t\tsetFileThumbnail(URL.createObjectURL(e.target.files[0]))\r\n\t}\r\n\r\n\tconst resetFileInput = e => {\r\n\t\te.preventDefault()\r\n\t\tfileInputRef.current.value = ''\r\n\t\tsetImgUpload(null)\r\n\t}\r\n\r\n\tconst handleEmojis = e => {\r\n\t\tsetNewComment(newComment => newComment + e.emoji)\r\n\t}\r\n\r\n\treturn (\r\n\t\tchat && (\r\n\t\t\t<form onSubmit={handleSubmit}>\r\n\t\t\t\t{messageResponse !== null && (\r\n\t\t\t\t\t<div className='response'>\r\n\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t<p className='response__to'>\r\n\t\t\t\t\t\t\t\tResponding to{' '}\r\n\t\t\t\t\t\t\t\t<span>\r\n\t\t\t\t\t\t\t\t\t{chat.messages[messageResponse].displayName === user.displayName ? (\r\n\t\t\t\t\t\t\t\t\t\t'yourself'\r\n\t\t\t\t\t\t\t\t\t) : (\r\n\t\t\t\t\t\t\t\t\t\t<b>{chat.messages[messageResponse].displayName}</b>\r\n\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t</p>\r\n\t\t\t\t\t\t\t<p className='response__content'>\r\n\t\t\t\t\t\t\t\t{chat.messages[messageResponse].content && (\r\n\t\t\t\t\t\t\t\t\t<>\r\n\t\t\t\t\t\t\t\t\t\t{chat.messages[messageResponse].content.substring(0, 70)}\r\n\t\t\t\t\t\t\t\t\t\t{chat.messages[messageResponse].content.length > 70 ? <span>...</span> : ''}\r\n\t\t\t\t\t\t\t\t\t</>\r\n\t\t\t\t\t\t\t\t)}\r\n\r\n\t\t\t\t\t\t\t\t{chat.messages[messageResponse].image && chat.messages[messageResponse].fileType === 'image'\r\n\t\t\t\t\t\t\t\t\t? 'Image'\r\n\t\t\t\t\t\t\t\t\t: ''}\r\n\t\t\t\t\t\t\t\t{chat.messages[messageResponse].image && chat.messages[messageResponse].fileType === 'video'\r\n\t\t\t\t\t\t\t\t\t? 'Video'\r\n\t\t\t\t\t\t\t\t\t: ''}\r\n\t\t\t\t\t\t\t</p>\r\n\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t<div className='response__close-btn' onClick={() => onMessageResponse(null)}>\r\n\t\t\t\t\t\t\t<i className='fa-solid fa-xmark'></i>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t)}\r\n\r\n\t\t\t\t<div className='add-comment'>\r\n\t\t\t\t\t<label className='attach-image'>\r\n\t\t\t\t\t\t<input ref={fileInputRef} type='file' accept='video/*, image/*' onChange={e => handleFileChange(e)} />\r\n\t\t\t\t\t\t<i className='fa-regular fa-image'></i>\r\n\t\t\t\t\t</label>\r\n\r\n\t\t\t\t\t<div className='message-field'>\r\n\t\t\t\t\t\t<div className='column'>\r\n\t\t\t\t\t\t\t{imgUpload && (\r\n\t\t\t\t\t\t\t\t<div className='thumbnails'>\r\n\t\t\t\t\t\t\t\t\t<div className='file-thumbnail'>\r\n\t\t\t\t\t\t\t\t\t\t<img src={fileThumbnail} alt='' />\r\n\t\t\t\t\t\t\t\t\t\t<button className='remove-img' onClick={e => resetFileInput(e)}>\r\n\t\t\t\t\t\t\t\t\t\t\t<i className='fa-solid fa-xmark close-btn'></i>\r\n\t\t\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t<label>\r\n\t\t\t\t\t\t\t\t<input\r\n\t\t\t\t\t\t\t\t\tmaxLength='900'\r\n\t\t\t\t\t\t\t\t\tplaceholder='Aa'\r\n\t\t\t\t\t\t\t\t\tonChange={e => setNewComment(e.target.value)}\r\n\t\t\t\t\t\t\t\t\tvalue={newComment}\r\n\t\t\t\t\t\t\t\t\tonKeyDown={e => handleKey(e)}\r\n\t\t\t\t\t\t\t\t\tref={inputRef}\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t</label>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\tclassName='toggle-emoji-picker'\r\n\t\t\t\t\t\t\tonClick={e => {\r\n\t\t\t\t\t\t\t\te.preventDefault()\r\n\t\t\t\t\t\t\t\tsetShowEmojis(!showEmojis)\r\n\t\t\t\t\t\t\t}}>\r\n\t\t\t\t\t\t\t<i className='fa-regular fa-face-smile'></i>\r\n\t\t\t\t\t\t</button>\r\n\r\n\t\t\t\t\t\t{showEmojis && (\r\n\t\t\t\t\t\t\t<OutsideClickHandler\r\n\t\t\t\t\t\t\t\tonOutsideClick={() => {\r\n\t\t\t\t\t\t\t\t\tsetShowEmojis(false)\r\n\t\t\t\t\t\t\t\t}}>\r\n\t\t\t\t\t\t\t\t<EmojiPicker\r\n\t\t\t\t\t\t\t\t\tclassName='emoji-picker'\r\n\t\t\t\t\t\t\t\t\tonEmojiClick={e => {\r\n\t\t\t\t\t\t\t\t\t\thandleEmojis(e)\r\n\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\ttheme={Theme.DARK}\r\n\t\t\t\t\t\t\t\t\tpreviewConfig={{\r\n\t\t\t\t\t\t\t\t\t\tdefaultCaption: '',\r\n\t\t\t\t\t\t\t\t\t\tdefaultEmoji: null,\r\n\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t// lazyLoadEmojis={true}\r\n\t\t\t\t\t\t\t\t\temojiStyle={EmojiStyle.NATIVE}\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t</OutsideClickHandler>\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t{!imgUpload && newComment.trim() === '' && (\r\n\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\tclassName='input-tool'\r\n\t\t\t\t\t\t\tonClick={e => {\r\n\t\t\t\t\t\t\t\tsetFastEmoji(e.target.innerText)\r\n\t\t\t\t\t\t\t\tconsole.log(fastEmoji)\r\n\t\t\t\t\t\t\t\tsetSendFastEmoji(true)\r\n\t\t\t\t\t\t\t\t// sendMessage()\r\n\t\t\t\t\t\t\t}}>\r\n\t\t\t\t\t\t\t{chat.chatEmoji && <Emoji unified={chat.chatEmoji} emojiStyle={EmojiStyle.NATIVE} size={33} />}\r\n\t\t\t\t\t\t</button>\r\n\t\t\t\t\t)}\r\n\r\n\t\t\t\t\t{(newComment.trim() !== '' || imgUpload) && (\r\n\t\t\t\t\t\t<button type='submit' className='input-tool'>\r\n\t\t\t\t\t\t\t<i className='fa-solid fa-paper-plane'></i>\r\n\t\t\t\t\t\t</button>\r\n\t\t\t\t\t)}\r\n\t\t\t\t</div>\r\n\t\t\t\t{newComment.length >= 900 && <p className='error'>Message can't be longer than 900 characters</p>}\r\n\t\t\t</form>\r\n\t\t)\r\n\t)\r\n}\r\n\r\nexport default ChatInput\r\n","import { useEffect, useState } from 'react'\r\nimport { useParams } from 'react-router-dom'\r\nimport { useDocument } from '../../hooks/useDocument'\r\nimport { useAuthContext } from '../../hooks/useAuthContext'\r\nimport { useFirestore } from '../../hooks/useFirestore'\r\n\r\n// Components\r\nimport Messages from '../../components/Messages'\r\nimport ChatInput from '../../components/ChatInput'\r\nimport Avatar from '../../components/Avatar'\r\nimport OutsideClickHandler from 'react-outside-click-handler'\r\nimport EmojiPicker, { EmojiStyle, Theme } from 'emoji-picker-react'\r\nimport Modal from '../../components/Modal'\r\n\r\n// Styles && Assets\r\nimport './Chat.scss'\r\n\r\nexport default function Chat({ setCurrentChat, inputRef }) {\r\n\tconst { user } = useAuthContext()\r\n\tconst { id } = useParams()\r\n\tconst { error, document } = useDocument('projects', id)\r\n\tconst { updateDocument } = useFirestore('projects')\r\n\r\n\tconst [isAssignedUser, setIsAssignedUser] = useState(false)\r\n\tconst [messageResponse, onMessageResponse] = useState(null)\r\n\tconst [bottomDiv, setBottomDiv] = useState(null)\r\n\tconst [showChatOptions, setShowChatOptions] = useState(false)\r\n\tconst [showEmojiPicker, setShowEmojiPicker] = useState(false)\r\n\tconst [showModal, setShowModal] = useState(false)\r\n\tconst [showNicknameInput, setShowNicknameInput] = useState(null)\r\n\tconst [newNickname, setNewNickname] = useState('')\r\n\tconst [otherUser, setOtherUser] = useState(null)\r\n\tconst [currentUser, setCurrentUser] = useState(null)\r\n\r\n\tuseEffect(() => {\r\n\t\tif (document !== null) {\r\n\t\t\tdocument.assignedUsers.forEach(u => {\r\n\t\t\t\tif (u.id !== user.uid) {\r\n\t\t\t\t\tsetOtherUser(u)\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t}\r\n\r\n\t\tif (document) {\r\n\t\t\tdocument.assignedUsers.forEach(u => {\r\n\t\t\t\tif (u.id === user.uid) {\r\n\t\t\t\t\tsetCurrentUser(u)\r\n\t\t\t\t\tsetIsAssignedUser(true)\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t}\r\n\r\n\t\tsetCurrentChat(document)\r\n\t}, [id, document])\r\n\r\n\tif (error) {\r\n\t\treturn <div className='error'>{error}</div>\r\n\t}\r\n\r\n\tif (!document) {\r\n\t\treturn <div className='loading'>Loading...</div>\r\n\t}\r\n\r\n\tconst handleSeen = () => {\r\n\t\tif (\r\n\t\t\tdocument.messages[document.messages.length - 1] &&\r\n\t\t\tdocument.messages[document.messages.length - 1].createdBy !== user.uid\r\n\t\t) {\r\n\t\t\tupdateDocument(document.id, {\r\n\t\t\t\tisRead: true,\r\n\t\t\t})\r\n\t\t}\r\n\t}\r\n\r\n\tconst changeChatEmoji = e => {\r\n\t\tupdateDocument(document.id, {\r\n\t\t\tchatEmoji: e.unified,\r\n\t\t})\r\n\t}\r\n\r\n\tconst handleNicknameInput = u => {\r\n\t\tsetShowNicknameInput(u.id)\r\n\t}\r\n\r\n\tconst changeNickname = user => {\r\n\t\tif (newNickname.trim() !== '' && newNickname.trim().length < 80) {\r\n\t\t\tdocument.assignedUsers.forEach(u => {\r\n\t\t\t\tif (u !== user) {\r\n\t\t\t\t\tconsole.log(newNickname)\r\n\t\t\t\t\tupdateDocument(document.id, {\r\n\t\t\t\t\t\tassignedUsers: [\r\n\t\t\t\t\t\t\tu,\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\tid: user.id,\r\n\t\t\t\t\t\t\t\tdisplayName: user.displayName,\r\n\t\t\t\t\t\t\t\tnickname: newNickname.trim(),\r\n\t\t\t\t\t\t\t\tphotoURL: user.photoURL,\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t],\r\n\t\t\t\t\t})\r\n\t\t\t\t\tsetShowModal(false)\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t}\r\n\t}\r\n\treturn (\r\n\t\t<>\r\n\t\t\t{isAssignedUser && otherUser && (\r\n\t\t\t\t<div className='chat'>\r\n\t\t\t\t\t<div className='vertical-container'>\r\n\t\t\t\t\t\t<div className='chat__top-bar'>\r\n\t\t\t\t\t\t\t<div className='flex-row'>\r\n\t\t\t\t\t\t\t\t<Avatar src={otherUser.photoURL} />\r\n\t\t\t\t\t\t\t\t<div className='vertical-container'>\r\n\t\t\t\t\t\t\t\t\t<h3>{otherUser.nickname}</h3>\r\n\t\t\t\t\t\t\t\t\t{otherUser.online && <p className='isActive'>Active now</p>}\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\t\tclassName='top-bar-options'\r\n\t\t\t\t\t\t\t\tonClick={e => {\r\n\t\t\t\t\t\t\t\t\tsetShowChatOptions(prevValue => !prevValue)\r\n\t\t\t\t\t\t\t\t\te.target.classList.toggle('active')\r\n\t\t\t\t\t\t\t\t}}>\r\n\t\t\t\t\t\t\t\t<i className='fa-solid fa-ellipsis-vertical'></i>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\tclassName='chat__comments'\r\n\t\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\t\thandleSeen()\r\n\t\t\t\t\t\t\t\tinputRef.current.focus()\r\n\t\t\t\t\t\t\t}}>\r\n\t\t\t\t\t\t\t<Messages\r\n\t\t\t\t\t\t\t\tchat={document}\r\n\t\t\t\t\t\t\t\tonMessageResponse={onMessageResponse}\r\n\t\t\t\t\t\t\t\tsetBottomDiv={setBottomDiv}\r\n\t\t\t\t\t\t\t\totherUser={otherUser}\r\n\t\t\t\t\t\t\t\tcurrentUser={currentUser}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t<ChatInput\r\n\t\t\t\t\t\t\t\tchat={document}\r\n\t\t\t\t\t\t\t\tmessageResponse={messageResponse}\r\n\t\t\t\t\t\t\t\tonMessageResponse={onMessageResponse}\r\n\t\t\t\t\t\t\t\tbottomDiv={bottomDiv}\r\n\t\t\t\t\t\t\t\tinputRef={inputRef}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t{showChatOptions && (\r\n\t\t\t\t\t\t<aside className='chat__options'>\r\n\t\t\t\t\t\t\t<Avatar src={otherUser.photoURL} />\r\n\r\n\t\t\t\t\t\t\t<h3>{otherUser.nickname}</h3>\r\n\r\n\t\t\t\t\t\t\t<div className='option'>\r\n\t\t\t\t\t\t\t\t<div className='option__icon'>\r\n\t\t\t\t\t\t\t\t\t<i className='fa-solid fa-paint-roller'></i>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t<div className='option__name'>Change theme</div>\r\n\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\t\tclassName='option'\r\n\t\t\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\t\t\tsetShowEmojiPicker(true)\r\n\t\t\t\t\t\t\t\t}}>\r\n\t\t\t\t\t\t\t\t<div className='option__icon'>\r\n\t\t\t\t\t\t\t\t\t<i className='fa-solid fa-thumbs-up'></i>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t<div className='option__name'>Change emoji icon</div>\r\n\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\t\tclassName='option'\r\n\t\t\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\t\t\tsetShowModal(true)\r\n\t\t\t\t\t\t\t\t}}>\r\n\t\t\t\t\t\t\t\t<div className='option__icon'>Aa</div>\r\n\t\t\t\t\t\t\t\t<div className='option__name'>Edit nicknames</div>\r\n\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t<Modal\r\n\t\t\t\t\t\t\t\tshow={showModal}\r\n\t\t\t\t\t\t\t\tsetShow={() => setShowModal(false)}\r\n\t\t\t\t\t\t\t\tonClose={() => {\r\n\t\t\t\t\t\t\t\t\tsetNewNickname('')\r\n\t\t\t\t\t\t\t\t\tsetShowNicknameInput(null)\r\n\t\t\t\t\t\t\t\t}}>\r\n\t\t\t\t\t\t\t\t{document.assignedUsers.map(u => (\r\n\t\t\t\t\t\t\t\t\t// <OutsideClickHandler onOutsideClick={() => setShowNicknameInput(null)}>\r\n\t\t\t\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\t\t\t\tkey={u.id}\r\n\t\t\t\t\t\t\t\t\t\tclassName='user'\r\n\t\t\t\t\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\t\t\t\t\tsetNewNickname(' ')\r\n\t\t\t\t\t\t\t\t\t\t\thandleNicknameInput(u)\r\n\t\t\t\t\t\t\t\t\t\t}}>\r\n\t\t\t\t\t\t\t\t\t\t<div className='author'>\r\n\t\t\t\t\t\t\t\t\t\t\t<Avatar src={u.photoURL} />\r\n\t\t\t\t\t\t\t\t\t\t\t{showNicknameInput !== u.id && (\r\n\t\t\t\t\t\t\t\t\t\t\t\t<div className='flex-column'>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<p className='user__display-name'>{u.nickname}</p>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<p>Set nickname</p>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t\t\t\t{showNicknameInput === u.id && (\r\n\t\t\t\t\t\t\t\t\t\t\t\t<input\r\n\t\t\t\t\t\t\t\t\t\t\t\t\ttype='text'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tplaceholder={u.nickname}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tvalue={newNickname}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tonChange={e => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tsetNewNickname(e.target.value)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t\t\t\t{showNicknameInput !== u.id && <i className='fa-solid fa-pen-to-square'></i>}\r\n\t\t\t\t\t\t\t\t\t\t{showNicknameInput === u.id && (\r\n\t\t\t\t\t\t\t\t\t\t\t<i\r\n\t\t\t\t\t\t\t\t\t\t\t\tclassName='fa-solid fa-check'\r\n\t\t\t\t\t\t\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tchangeNickname(u)\r\n\t\t\t\t\t\t\t\t\t\t\t\t}}></i>\r\n\t\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t// </OutsideClickHandler>\r\n\t\t\t\t\t\t\t\t))}\r\n\t\t\t\t\t\t\t</Modal>\r\n\r\n\t\t\t\t\t\t\t{showEmojiPicker && (\r\n\t\t\t\t\t\t\t\t<OutsideClickHandler\r\n\t\t\t\t\t\t\t\t\tonOutsideClick={() => {\r\n\t\t\t\t\t\t\t\t\t\tsetShowEmojiPicker(false)\r\n\t\t\t\t\t\t\t\t\t}}>\r\n\t\t\t\t\t\t\t\t\t<EmojiPicker\r\n\t\t\t\t\t\t\t\t\t\tclassName='emoji-picker'\r\n\t\t\t\t\t\t\t\t\t\tonEmojiClick={e => {\r\n\t\t\t\t\t\t\t\t\t\t\tchangeChatEmoji(e)\r\n\t\t\t\t\t\t\t\t\t\t\tsetShowEmojiPicker(false)\r\n\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t\ttheme={Theme.DARK}\r\n\t\t\t\t\t\t\t\t\t\tpreviewConfig={{\r\n\t\t\t\t\t\t\t\t\t\t\tdefaultCaption: '',\r\n\t\t\t\t\t\t\t\t\t\t\tdefaultEmoji: null,\r\n\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t\t// lazyLoadEmojis={true}\r\n\t\t\t\t\t\t\t\t\t\temojiStyle={EmojiStyle.NATIVE}\r\n\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t</OutsideClickHandler>\r\n\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t</aside>\r\n\t\t\t\t\t)}\r\n\t\t\t\t</div>\r\n\t\t\t)}\r\n\t\t</>\r\n\t)\r\n}\r\n","import { useState, useEffect } from 'react'\r\nimport { useHistory } from 'react-router-dom'\r\nimport { projectAuth, projectFirestore, projectGitHub, projectGoogle } from '../firebase/config'\r\nimport { useAuthContext } from './useAuthContext'\r\n\r\nexport const useLogin = () => {\r\n\tconst [isCancelled, setIsCancelled] = useState(false)\r\n\tconst [error, setError] = useState(null)\r\n\tconst [isPending, setIsPending] = useState(false)\r\n\tconst { dispatch } = useAuthContext()\r\n\tconst [isFinished, setIsFinished] = useState(false)\r\n\r\n\tlet history = useHistory()\r\n\r\n\tconst login = async (email, password) => {\r\n\t\tsetError(null)\r\n\t\tsetIsPending(true)\r\n\r\n\t\ttry {\r\n\t\t\t// Login\r\n\t\t\tconst res = await projectAuth.signInWithEmailAndPassword(email, password)\r\n\r\n\t\t\t// Update online status\r\n\r\n\t\t\tawait projectFirestore.collection('users').doc(res.user.uid).update({\r\n\t\t\t\tonline: true,\r\n\t\t\t})\r\n\r\n\t\t\t// Dispatch login action\r\n\t\t\tdispatch({ type: 'LOGIN', payload: res.user })\r\n\r\n\t\t\t// Update state\r\n\t\t\tif (!isCancelled) {\r\n\t\t\t\tsetIsPending(false)\r\n\t\t\t\tsetError(null)\r\n\t\t\t}\r\n\t\t} catch (err) {\r\n\t\t\tif (!isCancelled) {\r\n\t\t\t\tsetError(err.message)\r\n\t\t\t\tsetIsPending(false)\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tconst loginWithGoogle = async () => {\r\n\t\tsetError(null)\r\n\t\tsetIsPending(true)\r\n\r\n\t\ttry {\r\n\t\t\t// Login\r\n\t\t\tconst res = await projectAuth.signInWithPopup(projectGoogle)\r\n\r\n\t\t\t// Update online status\r\n\r\n\t\t\tawait projectFirestore.collection('users').doc(res.user.uid).update({\r\n\t\t\t\tonline: true,\r\n\t\t\t})\r\n\r\n\t\t\t// Dispatch login action\r\n\t\t\tdispatch({ type: 'LOGIN', payload: res.user })\r\n\r\n\t\t\t// Update state\r\n\t\t\tif (!isCancelled) {\r\n\t\t\t\tsetIsPending(false)\r\n\t\t\t\tsetError(null)\r\n\t\t\t}\r\n\t\t} catch (err) {\r\n\t\t\tif (!isCancelled) {\r\n\t\t\t\tsetError(err.message)\r\n\t\t\t\tsetIsPending(false)\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tconst loginWithGithub = async () => {\r\n\t\tsetError(null)\r\n\t\tsetIsPending(true)\r\n\r\n\t\ttry {\r\n\t\t\t// Login\r\n\t\t\tconst res = await projectAuth.signInWithPopup(projectGitHub)\r\n\t\t\t// Update online status\r\n\r\n\t\t\tawait projectFirestore.collection('users').doc(res.user.uid).update({\r\n\t\t\t\tonline: true,\r\n\t\t\t})\r\n\r\n\t\t\t// Dispatch login action\r\n\t\t\tdispatch({ type: 'LOGIN', payload: res.user })\r\n\r\n\t\t\t// Update state\r\n\t\t\tif (!isCancelled) {\r\n\t\t\t\tsetIsPending(false)\r\n\t\t\t\tsetError(null)\r\n\t\t\t}\r\n\t\t} catch (err) {\r\n\t\t\tif (!isCancelled) {\r\n\t\t\t\tsetError(err.message)\r\n\t\t\t\tsetIsPending(false)\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tconst sendPasswordReset = async email => {\r\n\t\tsetError(null)\r\n\t\tsetIsPending(true)\r\n\t\tsetIsFinished(false)\r\n\r\n\t\ttry {\r\n\t\t\tawait projectAuth.sendPasswordResetEmail(email)\r\n\t\t\tif (!isCancelled) {\r\n\t\t\t\tsetIsPending(false)\r\n\t\t\t\tsetError(null)\r\n\t\t\t\tsetIsFinished(true)\r\n\r\n\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\thistory.push('/login')\r\n\t\t\t\t}, 15000)\r\n\t\t\t}\r\n\t\t} catch (err) {\r\n\t\t\tif (!isCancelled) {\r\n\t\t\t\tsetError(err.message)\r\n\t\t\t\tsetIsPending(false)\r\n\t\t\t\tsetIsFinished(false)\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tconst resetPassword = async (code, newPassword) => {\r\n\t\tsetError(null)\r\n\t\tsetIsPending(true)\r\n\t\tsetIsFinished(false)\r\n\r\n\t\ttry {\r\n\t\t\tawait projectAuth.confirmPasswordReset(code, newPassword)\r\n\r\n\t\t\tif (!isCancelled) {\r\n\t\t\t\tsetIsPending(false)\r\n\t\t\t\tsetError(null)\r\n\t\t\t\tsetIsFinished(true)\r\n\t\t\t}\r\n\t\t} catch (err) {\r\n\t\t\tif (!isCancelled) {\r\n\t\t\t\tsetError(err.message)\r\n\t\t\t\tsetIsPending(false)\r\n\t\t\t\tsetIsFinished(false)\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tuseEffect(() => {\r\n\t\treturn () => setIsCancelled(true)\r\n\t}, [])\r\n\r\n\treturn { login, loginWithGoogle, loginWithGithub, sendPasswordReset, resetPassword, isPending, error, isFinished }\r\n}\r\n","export default __webpack_public_path__ + \"static/media/btn_google_dark_normal_ios.9fe90a17.svg\";","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyRpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNS1jMDIxIDc5LjE1NDkxMSwgMjAxMy8xMC8yOS0xMTo0NzoxNiAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6RERCMUIwOUY4NkNFMTFFM0FBNTJFRTMzNTJEMUJDNDYiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6RERCMUIwOUU4NkNFMTFFM0FBNTJFRTMzNTJEMUJDNDYiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNiAoTWFjaW50b3NoKSI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkU1MTc4QTJBOTlBMDExRTI5QTE1QkMxMDQ2QTg5MDREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOkU1MTc4QTJCOTlBMDExRTI5QTE1QkMxMDQ2QTg5MDREIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+jUqS1wAAApVJREFUeNq0l89rE1EQx3e3gVJoSPzZeNEWPKgHoa0HBak0iHiy/4C3WvDmoZ56qJ7txVsPQu8qlqqHIhRKJZceesmhioQEfxTEtsoSpdJg1u/ABJ7Pmc1m8zLwgWTmzcw3L+/te+tHUeQltONgCkyCi2AEDHLsJ6iBMlgHL8FeoqokoA2j4CloRMmtwTmj7erHBXPgCWhG6a3JNXKdCiDl1cidVbXZkJoXQRi5t5BrxwoY71FzU8S4JuAIqFkJ2+BFSlEh525b/hr3+k/AklDkNsf6wTT4yv46KIMNpsy+iMdMc47HNWxbsgVcUn7FmLAzzoFAWDsBx+wVP6bUpp5ewI+DOeUx0Wd9D8F70BTGNjkWtqnhmT1JQAHcUgZd8Lo3rQb1LAT8eJVUfgGvHQigGp+V2Z0iAUUl8QH47kAA1XioxIo+bRN8OG8F/oBjwv+Z1nJgX5jpdzQDw0LCjsPmrcW7I/iHScCAEDj03FtD8A0EyuChHgg4KTlJQF3wZ7WELppnBX+dBFSVpJsOBWi1qiRgSwnOgoyD5hmuJdkWCVhTgnTvW3AgYIFrSbZGh0UW/Io5Vp+DQoK7o80pztWMemZbgxeNwCNwDbw1fIfgGZjhU6xPaJgBV8BdsMw5cbZoHsenwYFxkZzl83xTSKTiviCAfCsJLysH3POfC8m8NegyGAGfLP/VmGmfSChgXroR0RSWjEFv2J/nG84cuKFMf4sTCZqXuJd4KaXFVjEG3+tw4eXbNK/YC9oXXs3O8NY8y99L4BXY5cvLY/Bb2VZ58EOJVcB18DHJq9lRsKr8inyKGVjlmh29mtHs3AHfuhCwy1vXT/Nu2GKQt+UHsGdctyX6eQyNvc+5sfX9Dl7Pe2J/BRgAl2CpwmrsHR0AAAAASUVORK5CYII=\"","import { useState } from 'react'\r\nimport { useLogin } from '../../hooks/useLogin'\r\nimport { Link } from 'react-router-dom'\r\n\r\n// Styles & assets\r\nimport './Login.scss'\r\nimport googleLogo from '../../assets/btn_google_dark_normal_ios.svg'\r\nimport githubLogo from '../../assets/GitHub-Mark-Light-32px.png'\r\n\r\nexport default function Login() {\r\n\tconst [email, setEmail] = useState('')\r\n\tconst [password, setPassword] = useState('')\r\n\tconst { login, loginWithGoogle, loginWithGithub, isPending, error } = useLogin()\r\n\r\n\tconst handleSubmit = e => {\r\n\t\te.preventDefault()\r\n\t\tlogin(email, password)\r\n\t}\r\n\tconst handleSubmitWithGoogle = e => {\r\n\t\te.preventDefault()\r\n\t\tloginWithGoogle()\r\n\t}\r\n\tconst handleSubmitWithGithub = e => {\r\n\t\te.preventDefault()\r\n\t\tloginWithGithub()\r\n\t}\r\n\r\n\treturn (\r\n\t\t<div className='login'>\r\n\t\t\t<div className='auth-decoration'>\r\n\t\t\t\t<div className='circle'></div>\r\n\t\t\t\t<div className='blur'></div>\r\n\t\t\t</div>\r\n\r\n\t\t\t<form className='auth-form' onSubmit={handleSubmit}>\r\n\t\t\t\t<div className='auth-form__title'>\r\n\t\t\t\t\t<h2>Welcome back</h2>\r\n\t\t\t\t</div>\r\n\r\n\t\t\t\t<label>\r\n\t\t\t\t\t<span>Email</span>\r\n\t\t\t\t\t<input\r\n\t\t\t\t\t\ttype='email'\r\n\t\t\t\t\t\trequired\r\n\t\t\t\t\t\tonChange={e => setEmail(e.target.value)}\r\n\t\t\t\t\t\tvalue={email}\r\n\t\t\t\t\t\tplaceholder='Enter your email'\r\n\t\t\t\t\t/>\r\n\t\t\t\t</label>\r\n\r\n\t\t\t\t<label>\r\n\t\t\t\t\t<span>Password</span>\r\n\t\t\t\t\t<input\r\n\t\t\t\t\t\ttype='password'\r\n\t\t\t\t\t\trequired\r\n\t\t\t\t\t\tonChange={e => setPassword(e.target.value)}\r\n\t\t\t\t\t\tvalue={password}\r\n\t\t\t\t\t\tplaceholder='Enter your password'\r\n\t\t\t\t\t/>\r\n\t\t\t\t</label>\r\n\t\t\t\t<Link to={'/recover-password'} className='reset-password'>\r\n\t\t\t\t\tForgot password?\r\n\t\t\t\t</Link>\r\n\r\n\t\t\t\t{!isPending && <button className='btn'>Login</button>}\r\n\t\t\t\t{isPending && (\r\n\t\t\t\t\t<button className='btn' disabled>\r\n\t\t\t\t\t\tLoading\r\n\t\t\t\t\t</button>\r\n\t\t\t\t)}\r\n\r\n\t\t\t\t<div className='others-separator'>\r\n\t\t\t\t\t<span>or</span>\r\n\t\t\t\t</div>\r\n\r\n\t\t\t\t<button className='google-btn' onClick={handleSubmitWithGoogle}>\r\n\t\t\t\t\t<img src={googleLogo} alt='google logo' />\r\n\t\t\t\t\t<span>Sign in with google</span>\r\n\t\t\t\t</button>\r\n\r\n\t\t\t\t<button className='github-btn' onClick={handleSubmitWithGithub}>\r\n\t\t\t\t\t<img src={githubLogo} alt='github logo' />\r\n\t\t\t\t\t<span>Sign in with GitHub</span>\r\n\t\t\t\t</button>\r\n\r\n\t\t\t\t<p className='change-page'>\r\n\t\t\t\t\tDon't have an account? <Link to='/signup'>Sign up</Link>\r\n\t\t\t\t</p>\r\n\r\n\t\t\t\t{error && <div className='error'>{error}</div>}\r\n\t\t\t</form>\r\n\t\t</div>\r\n\t)\r\n}\r\n","import { useState } from 'react'\r\nimport { useSignup } from '../../hooks/useSignup'\r\nimport { Link } from 'react-router-dom'\r\n\r\n// Styles\r\nimport './Signup.scss'\r\nimport googleLogo from '../../assets/btn_google_dark_normal_ios.svg'\r\nimport githubLogo from '../../assets/GitHub-Mark-Light-32px.png'\r\n\r\nexport default function Signup() {\r\n\tconst [email, setEmail] = useState('')\r\n\tconst [password, setPassword] = useState('')\r\n\tconst [displayName, setDisplayName] = useState('')\r\n\tconst [thumbnail, setThumbnail] = useState(null)\r\n\tconst [thumbnailError, setThumbnailError] = useState(null)\r\n\tconst { signup, signInWithGoogle, signInWithGithub, isPending, error } = useSignup()\r\n\r\n\tconst handleSubmit = e => {\r\n\t\te.preventDefault()\r\n\t\tsignup(email, password, displayName, thumbnail)\r\n\t}\r\n\r\n\tconst handleSubmitWithGoogle = e => {\r\n\t\te.preventDefault()\r\n\t\tsignInWithGoogle()\r\n\t}\r\n\r\n\tconst handleSubmitWithGithub = e => {\r\n\t\te.preventDefault()\r\n\t\tsignInWithGithub()\r\n\t}\r\n\r\n\tconst handleFileChange = e => {\r\n\t\tsetThumbnail(null)\r\n\t\tlet selected = e.target.files[0]\r\n\r\n\t\tif (!selected) {\r\n\t\t\tsetThumbnailError('Please select a file')\r\n\t\t\treturn\r\n\t\t}\r\n\t\tif (!selected.type.includes('image')) {\r\n\t\t\tsetThumbnailError('Selected file must be an image')\r\n\t\t\treturn\r\n\t\t}\r\n\t\tif (!selected.size > 100000) {\r\n\t\t\tsetThumbnailError('Image file size must be less than 100kb')\r\n\t\t\treturn\r\n\t\t}\r\n\r\n\t\tsetThumbnailError(null)\r\n\t\tsetThumbnail(selected)\r\n\t}\r\n\r\n\treturn (\r\n\t\t<div className='signup'>\r\n\t\t\t<div className='auth-decoration'>\r\n\t\t\t\t<div className='circle'></div>\r\n\t\t\t\t<div className='blur'></div>\r\n\t\t\t</div>\r\n\t\t\t<form className='auth-form' onSubmit={handleSubmit}>\r\n\t\t\t\t<div className='auth-form__title'>\r\n\t\t\t\t\t<h2>Join us</h2>\r\n\t\t\t\t</div>\r\n\r\n\t\t\t\t<label>\r\n\t\t\t\t\t<span>Email:</span>\r\n\t\t\t\t\t<input type='email' required onChange={e => setEmail(e.target.value)} value={email} placeholder='Aa' />\r\n\t\t\t\t</label>\r\n\t\t\t\t<label>\r\n\t\t\t\t\t<span>Password:</span>\r\n\t\t\t\t\t<input\r\n\t\t\t\t\t\ttype='password'\r\n\t\t\t\t\t\trequired\r\n\t\t\t\t\t\tonChange={e => setPassword(e.target.value)}\r\n\t\t\t\t\t\tvalue={password}\r\n\t\t\t\t\t\tplaceholder='Aa'\r\n\t\t\t\t\t/>\r\n\t\t\t\t</label>\r\n\t\t\t\t<label>\r\n\t\t\t\t\t<span>Display name:</span>\r\n\t\t\t\t\t<input\r\n\t\t\t\t\t\ttype='text'\r\n\t\t\t\t\t\trequired\r\n\t\t\t\t\t\tonChange={e => setDisplayName(e.target.value)}\r\n\t\t\t\t\t\tvalue={displayName}\r\n\t\t\t\t\t\tplaceholder='Aa'\r\n\t\t\t\t\t/>\r\n\t\t\t\t</label>\r\n\t\t\t\t<label>\r\n\t\t\t\t\t<span>Profile thumbnail:</span>\r\n\t\t\t\t\t<input type='file' required onChange={handleFileChange} />\r\n\r\n\t\t\t\t\t{thumbnailError && <div className='error'>{thumbnailError}</div>}\r\n\t\t\t\t</label>\r\n\r\n\t\t\t\t{!isPending && <button className='btn'>Sign up</button>}\r\n\t\t\t\t{isPending && (\r\n\t\t\t\t\t<button className='btn' disabled>\r\n\t\t\t\t\t\tLoading\r\n\t\t\t\t\t</button>\r\n\t\t\t\t)}\r\n\r\n\t\t\t\t<div className='others-separator'>\r\n\t\t\t\t\t<span>or</span>\r\n\t\t\t\t</div>\r\n\r\n\t\t\t\t<button className='google-btn' onClick={handleSubmitWithGoogle}>\r\n\t\t\t\t\t<img src={googleLogo} alt='google logo' />\r\n\t\t\t\t\t<span>Sign in with google</span>\r\n\t\t\t\t</button>\r\n\r\n\t\t\t\t<button className='github-btn' onClick={handleSubmitWithGithub}>\r\n\t\t\t\t\t<img src={githubLogo} alt='github logo' />\r\n\t\t\t\t\t<span>Sign in with GitHub</span>\r\n\t\t\t\t</button>\r\n\r\n\t\t\t\t<p className='change-page'>\r\n\t\t\t\t\tAlready have an account? <Link to='/login'>Login</Link>\r\n\t\t\t\t</p>\r\n\r\n\t\t\t\t{error && <div className='error'>{error}</div>}\r\n\t\t\t</form>\r\n\t\t</div>\r\n\t)\r\n}\r\n","import { useState, useEffect } from 'react'\r\nimport { projectAuth, projectFirestore, projectStorage, projectGoogle, projectGitHub } from '../firebase/config'\r\nimport { useAuthContext } from './useAuthContext'\r\n\r\nexport const useSignup = () => {\r\n\tconst [isCancelled, setIsCancelled] = useState(false)\r\n\tconst [error, setError] = useState(null)\r\n\tconst [isPending, setIsPending] = useState(false)\r\n\tconst { dispatch } = useAuthContext()\r\n\r\n\tconst signup = async (email, password, displayName, thumbnail) => {\r\n\t\tsetError(null)\r\n\t\tsetIsPending(true)\r\n\r\n\t\ttry {\r\n\t\t\t// Signup\r\n\t\t\tconst res = await projectAuth.createUserWithEmailAndPassword(email, password)\r\n\r\n\t\t\tif (!res) {\r\n\t\t\t\tthrow new Error('Could not complete signup')\r\n\t\t\t}\r\n\r\n\t\t\t// Upload thumbnail\r\n\r\n\t\t\tconst uploadPath = `thumbnails/${res.user.uid}/${thumbnail.name}`\r\n\t\t\tconst img = await projectStorage.ref(uploadPath).put(thumbnail)\r\n\t\t\tconst imgUrl = await img.ref.getDownloadURL()\r\n\r\n\t\t\t// Add display name to user\r\n\t\t\tawait res.user.updateProfile({ displayName, photoURL: imgUrl })\r\n\r\n\t\t\t// Create a user document\r\n\t\t\tawait projectFirestore.collection('users').doc(res.user.uid).set({\r\n\t\t\t\tonline: true,\r\n\t\t\t\tdisplayName: displayName,\r\n\t\t\t\tphotoURL: imgUrl,\r\n\t\t\t})\r\n\r\n\t\t\t// Dispatch login action\r\n\t\t\tdispatch({ type: 'LOGIN', payload: res.user })\r\n\r\n\t\t\tif (!isCancelled) {\r\n\t\t\t\tsetIsPending(false)\r\n\t\t\t\tsetError(null)\r\n\t\t\t}\r\n\t\t} catch (err) {\r\n\t\t\tif (!isCancelled) {\r\n\t\t\t\tsetError(err.message)\r\n\t\t\t\tsetIsPending(false)\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tconst signInWithGoogle = async () => {\r\n\t\tsetError(null)\r\n\t\tsetIsPending(true)\r\n\r\n\t\ttry {\r\n\t\t\t// Signup\r\n\t\t\tconst res = await projectAuth.signInWithPopup(projectGoogle)\r\n\r\n\t\t\tif (!res) {\r\n\t\t\t\tthrow new Error('Could not complete signup')\r\n\t\t\t}\r\n\r\n\t\t\t// Add display name to user\r\n\t\t\tawait res.user.updateProfile({ displayName: res.user.displayName, photoURL: res.user.photoURL })\r\n\r\n\t\t\t// Create a user document\r\n\t\t\tawait projectFirestore.collection('users').doc(res.user.uid).set({\r\n\t\t\t\tonline: true,\r\n\t\t\t\tdisplayName: res.user.displayName,\r\n\t\t\t\tphotoURL: res.user.photoURL,\r\n\t\t\t})\r\n\r\n\t\t\t// Dispatch login action\r\n\t\t\tdispatch({ type: 'LOGIN', payload: res.user })\r\n\r\n\t\t\tif (!isCancelled) {\r\n\t\t\t\tsetIsPending(false)\r\n\t\t\t\tsetError(null)\r\n\t\t\t}\r\n\t\t} catch (err) {\r\n\t\t\tif (!isCancelled) {\r\n\t\t\t\tsetError(err.message)\r\n\t\t\t\tsetIsPending(false)\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tconst signInWithGithub = async () => {\r\n\t\tsetError(null)\r\n\t\tsetIsPending(true)\r\n\r\n\t\ttry {\r\n\t\t\t// Signup\r\n\t\t\tconst res = await projectAuth.signInWithPopup(projectGitHub)\r\n\r\n\t\t\tif (!res) {\r\n\t\t\t\tthrow new Error('Could not complete signup')\r\n\t\t\t}\r\n\r\n\t\t\t// Add display name to user\r\n\t\t\tawait res.user.updateProfile({ displayName: res.additionalUserInfo.username, photoURL: res.user.photoURL })\r\n\r\n\t\t\t// Create a user document\r\n\t\t\tawait projectFirestore.collection('users').doc(res.user.uid).set({\r\n\t\t\t\tonline: true,\r\n\t\t\t\tdisplayName: res.user.displayName,\r\n\t\t\t\tphotoURL: res.user.photoURL,\r\n\t\t\t})\r\n\r\n\t\t\t// Dispatch login action\r\n\t\t\tdispatch({ type: 'LOGIN', payload: res.user })\r\n\r\n\t\t\tif (!isCancelled) {\r\n\t\t\t\tsetIsPending(false)\r\n\t\t\t\tsetError(null)\r\n\t\t\t}\r\n\t\t} catch (err) {\r\n\t\t\tif (!isCancelled) {\r\n\t\t\t\tsetError(err.message)\r\n\t\t\t\tsetIsPending(false)\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tuseEffect(() => {\r\n\t\treturn () => setIsCancelled(true)\r\n\t}, [])\r\n\r\n\treturn { signup, signInWithGoogle, signInWithGithub, error, isPending }\r\n}\r\n","import React from 'react'\r\n\r\nexport default function PrivacyPolicy() {\r\n\treturn (\r\n\t\t<>\r\n\t\t\t<div class='privacy-section'>\r\n\t\t\t\t<h3>Zbieranie danych</h3>\r\n\t\t\t\t<p>Kiedy zbieramy Twoje dane? Twój email oraz hasło zapisywane są podczas rejestracji na naszej stronie.</p>\r\n\t\t\t</div>\r\n\r\n\t\t\t<div class='privacy-section'>\r\n\t\t\t\t<h3>Cele przetwarzania danych</h3>\r\n\r\n\t\t\t\t<p>\r\n\t\t\t\t\tTwoje dane zebrane podczas rejestracji przetwarzane są jedynie w celu umożliwienia korzystania ze strony. Nie\r\n\t\t\t\t\tudostępniamy ich nikomu, nie sprzedajemy ich. Rejestracja jest dobrowolna.\r\n\t\t\t\t</p>\r\n\t\t\t</div>\r\n\t\t\t<div class='privacy-section'>\r\n\t\t\t\t<h3>Bezpieczeństwo danych</h3>\r\n\r\n\t\t\t\t<p>\r\n\t\t\t\t\tTwoje dane są automatycznie szyfrowane przez usługę firebase od google. Nikt nieautoryzowany nie ma dostępu do\r\n\t\t\t\t\ttwoich danych.\r\n\t\t\t\t</p>\r\n\t\t\t</div>\r\n\t\t\t<div class='privacy-section'>\r\n\t\t\t\t<h3>Usuwanie danych</h3>\r\n\r\n\t\t\t\t<p>\r\n\t\t\t\t\tJeśli zrezygnujesz z używania naszej aplikacji w każdym momencie możesz do nas napisać na maila \"matkowsky808@gmail\" lub wykorzystać funkcję w ustawieniach, aby usunąć konto oraz swoje dane.\r\n\t\t\t\t</p>\r\n\t\t\t</div>\r\n\r\n\t\t\t<div class='privacy-section'>\r\n\t\t\t\t<h3>Pozostałe informacje</h3>\r\n\r\n\t\t\t\t<p>\r\n\t\t\t\t\t<span>W razie jakichkolwiek pytań, prosimy o kontakt na adresie mailowym: matkowsky808@gmail.com</span>\r\n\t\t\t\t</p>\r\n\t\t\t</div>\r\n\t\t</>\r\n\t)\r\n}\r\n","export default __webpack_public_path__ + \"static/media/shrek-gif.df094210.gif\";","import { useEffect, useState } from 'react'\r\nimport { useLogin } from '../../hooks/useLogin'\r\nimport { Link } from 'react-router-dom'\r\n\r\n// Styles & assets\r\nimport '../login/Login.scss'\r\nimport ShrekGif from '../../assets/shrek-gif.gif'\r\n\r\nexport default function ResetPassword() {\r\n\tconst [email, setEmail] = useState('')\r\n\tconst { sendPasswordReset, isPending, error, isFinished } = useLogin()\r\n\tconst [timeToRedirect, setTimeToRedirect] = useState(15)\r\n\r\n\tconst handlePasswordReset = e => {\r\n\t\te.preventDefault()\r\n\t\tsendPasswordReset(email)\r\n\t}\r\n\r\n\tuseEffect(() => {\r\n\t\tif (isFinished === true) {\r\n\t\t\tcountdown()\r\n\t\t}\r\n\t}, [isFinished])\r\n\tconst countdown = () => {\r\n\t\tlet redirectCountdown = setInterval(() => {\r\n\t\t\tif (timeToRedirect <= 0) {\r\n\t\t\t\tclearInterval(redirectCountdown)\r\n\t\t\t} else {\r\n\t\t\t\tsetTimeToRedirect(prevTimeToRedirect => prevTimeToRedirect - 1)\r\n\t\t\t}\r\n\t\t}, 1000)\r\n\t}\r\n\r\n\tconst handleKey = e => {\r\n\t\te.code === 'Enter' && handlePasswordReset(e)\r\n\t}\r\n\r\n\treturn (\r\n\t\t<div className='login'>\r\n\t\t\t<div className='auth-decoration'>\r\n\t\t\t\t<div className='circle'></div>\r\n\t\t\t\t<div className='blur'></div>\r\n\t\t\t</div>\r\n\r\n\t\t\t<div className='auth-form'>\r\n\t\t\t\t{isFinished && (\r\n\t\t\t\t\t<div className='text-center email-sent'>\r\n\t\t\t\t\t\t<img src={ShrekGif} alt='' className='email-sent__img' />\r\n\t\t\t\t\t\t<h2>Check your email</h2>\r\n\t\t\t\t\t\t<p>A password reset email has been sent to your email address</p>\r\n\r\n\t\t\t\t\t\t<Link to='/login'>\r\n\t\t\t\t\t\t\t<button className='btn'>Back to Login</button>\r\n\t\t\t\t\t\t</Link>\r\n\r\n\t\t\t\t\t\t<p className='redirect'>Redirecting in {timeToRedirect} s</p>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t)}\r\n\r\n\t\t\t\t{!isFinished && (\r\n\t\t\t\t\t<>\r\n\t\t\t\t\t\t<div className='auth-form__title'>\r\n\t\t\t\t\t\t\t<h2>Forgot password?</h2>\r\n\t\t\t\t\t\t\t<p>Enter your email below to recieve password reset instructions</p>\r\n\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t<label>\r\n\t\t\t\t\t\t\t<span>Email</span>\r\n\t\t\t\t\t\t\t<input\r\n\t\t\t\t\t\t\t\ttype='email'\r\n\t\t\t\t\t\t\t\trequired\r\n\t\t\t\t\t\t\t\tonChange={e => setEmail(e.target.value)}\r\n\t\t\t\t\t\t\t\tvalue={email}\r\n\t\t\t\t\t\t\t\tplaceholder='Enter your email'\r\n\t\t\t\t\t\t\t\tonKeyDown={e => handleKey(e)}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t</label>\r\n\r\n\t\t\t\t\t\t{!isPending && (\r\n\t\t\t\t\t\t\t<button className='btn' onClick={handlePasswordReset}>\r\n\t\t\t\t\t\t\t\tSend reset link\r\n\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t{isPending && (\r\n\t\t\t\t\t\t\t<button className='btn' disabled>\r\n\t\t\t\t\t\t\t\tSending email...\r\n\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t)}\r\n\r\n\t\t\t\t\t\t<p className='change-page'>\r\n\t\t\t\t\t\t\tNo longer have Alzheimer? <Link to='/login'>Login</Link>\r\n\t\t\t\t\t\t</p>\r\n\r\n\t\t\t\t\t\t{error && <div className='error'>{error}</div>}\r\n\t\t\t\t\t</>\r\n\t\t\t\t)}\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t)\r\n}\r\n","import { useState } from 'react'\r\nimport { useLogin } from '../../hooks/useLogin'\r\nimport { Link } from 'react-router-dom'\r\nimport { useQuery } from '../../hooks/useQuery'\r\n\r\n// Styles & assets\r\nimport '../login/Login.scss'\r\nimport ShrekGif from '../../assets/shrek-gif.gif'\r\n\r\nexport default function SetNewPassword() {\r\n\tconst { resetPassword, isPending, error, isFinished } = useLogin()\r\n\r\n\tconst [newPassword, setNewPassword] = useState('')\r\n\r\n\tconst oobCode = useQuery('oobCode')\r\n\r\n\tconst handleSubmit = async e => {\r\n\t\te.preventDefault()\r\n\t\tresetPassword(oobCode, newPassword)\r\n\t}\r\n\r\n\tconst handleKey = e => {\r\n\t\te.code === 'Enter' && handleSubmit(e)\r\n\t}\r\n\r\n\treturn (\r\n\t\t<div className='login'>\r\n\t\t\t<div className='auth-decoration'>\r\n\t\t\t\t<div className='circle'></div>\r\n\t\t\t\t<div className='blur'></div>\r\n\t\t\t</div>\r\n\r\n\t\t\t<form className='auth-form' onSubmit={e => handleSubmit(e)}>\r\n\t\t\t\t{isFinished && (\r\n\t\t\t\t\t<div className='text-center email-sent'>\r\n\t\t\t\t\t\t<img src={ShrekGif} alt='' className='email-sent__img' />\r\n\t\t\t\t\t\t<h2>Password set successfully</h2>\r\n\t\t\t\t\t\t<p>You can now log in with your new password</p>\r\n\r\n\t\t\t\t\t\t<Link to='/login'>\r\n\t\t\t\t\t\t\t<button className='btn'>Back to Login</button>\r\n\t\t\t\t\t\t</Link>\r\n\r\n\t\t\t\t\t\t<p className='change-page'>\r\n\t\t\t\t\t\t\tNow log in and remember your password. <Link to='/login'> Login</Link>\r\n\t\t\t\t\t\t</p>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t)}\r\n\r\n\t\t\t\t{!isFinished && (\r\n\t\t\t\t\t<>\r\n\t\t\t\t\t\t<div className='auth-form__title'>\r\n\t\t\t\t\t\t\t<h2>Set a new password</h2>\r\n\t\t\t\t\t\t\t<p>Enter a password that you will remember this time...</p>\r\n\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t<label>\r\n\t\t\t\t\t\t\t<span>Password</span>\r\n\t\t\t\t\t\t\t<input\r\n\t\t\t\t\t\t\t\ttype='password'\r\n\t\t\t\t\t\t\t\trequired\r\n\t\t\t\t\t\t\t\tonChange={e => setNewPassword(e.target.value)}\r\n\t\t\t\t\t\t\t\tvalue={newPassword}\r\n\t\t\t\t\t\t\t\tplaceholder='Enter new password'\r\n\t\t\t\t\t\t\t\tonKeyDown={e => handleKey(e)}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t</label>\r\n\r\n\t\t\t\t\t\t{!isPending && <button className='btn'>Reset password</button>}\r\n\t\t\t\t\t\t{isPending && (\r\n\t\t\t\t\t\t\t<button className='btn' disabled>\r\n\t\t\t\t\t\t\t\tSetting new password...\r\n\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t)}\r\n\r\n\t\t\t\t\t\t<p className='change-page'>\r\n\t\t\t\t\t\t\t<Link to='/login'> Login</Link> instead?\r\n\t\t\t\t\t\t</p>\r\n\r\n\t\t\t\t\t\t{error && <div className='error'>{error}</div>}\r\n\t\t\t\t\t</>\r\n\t\t\t\t)}\r\n\t\t\t</form>\r\n\t\t</div>\r\n\t)\r\n}\r\n","import { useLocation } from 'react-router-dom'\r\n\r\nexport const useQuery = queryName => {\r\n\tconst location = useLocation()\r\n\tconst query = new URLSearchParams(location.search).get(queryName)\r\n\treturn query\r\n}\r\n","import { useEffect, useState, useRef } from \"react\"\nimport { projectFirestore } from \"../firebase/config\"\n\nexport const useCollection = (collection, _query, _orderBy) => {\n  const [documents, setDocuments] = useState(null)\n  const [error, setError] = useState(null)\n\n  // if we don't use a ref --> infinite loop in useEffect\n  // _query is an array and is \"different\" on every function call\n  const query = useRef(_query).current\n  const orderBy = useRef(_orderBy).current\n\n  useEffect(() => {\n    let ref = projectFirestore.collection(collection)\n\n    if (query) {\n      ref = ref.where(...query)\n    }\n    if (orderBy) {\n      ref = ref.orderBy(...orderBy)\n    }\n\n    const unsubscribe = ref.onSnapshot(snapshot => {\n      let results = []\n      snapshot.docs.forEach(doc => {\n        results.push({...doc.data(), id: doc.id})\n      });\n      \n      // update state\n      setDocuments(results)\n      setError(null)\n    }, error => {\n      console.log(error)\n      setError('could not fetch the data')\n    })\n\n    // unsubscribe on unmount\n    return () => unsubscribe()\n\n  }, [collection, query, orderBy])\n\n  return { documents, error }\n}","import { Link } from 'react-router-dom'\r\nimport { useAuthContext } from '../hooks/useAuthContext'\r\nimport { useCollection } from '../hooks/useCollection'\r\nimport { useFirestore } from '../hooks/useFirestore'\r\nimport formatDistanceToNowStrict from 'date-fns/formatDistanceToNow'\r\n\r\n// Styles && Assets\r\nimport './ChatsList.scss'\r\nimport Avatar from './Avatar'\r\n\r\nexport default function ChatsList({ chats, currentChat, inputRef }) {\r\n\tconst { user } = useAuthContext()\r\n\tconst { documents: users } = useCollection('users')\r\n\tconst { updateDocument } = useFirestore('projects')\r\n\r\n\tlet onlineUsers = []\r\n\tlet rightUrl = ''\r\n\tlet rightDisplayName = ''\r\n\tlet rightId = ''\r\n\r\n\tconst replaceDistanceToNow = {\r\n\t\tabout: '',\r\n\t\tminute: 'min',\r\n\t\tminutes: 'min',\r\n\r\n\t\t'less than a minute': '1 min',\r\n\t}\r\n\r\n\tconst handleOnMouseMove = e => {\r\n\t\tfor (const card of document.getElementsByClassName('card')) {\r\n\t\t\tconst rect = card.getBoundingClientRect(),\r\n\t\t\t\tx = e.clientX - rect.left,\r\n\t\t\t\ty = e.clientY - rect.top\r\n\r\n\t\t\tcard.style.setProperty('--mouse-x', `${x}px`)\r\n\t\t\tcard.style.setProperty('--mouse-y', `${y}px`)\r\n\t\t}\r\n\t}\r\n\r\n\tconst handleSeen = () => {\r\n\t\tif (inputRef.current !== null) {\r\n\t\t\tinputRef.current.focus()\r\n\t\t}\r\n\t\tif (\r\n\t\t\tcurrentChat &&\r\n\t\t\tcurrentChat.messages[currentChat.messages.length - 1] &&\r\n\t\t\tcurrentChat.messages[currentChat.messages.length - 1].createdBy !== user.uid\r\n\t\t) {\r\n\t\t\tupdateDocument(currentChat.id, {\r\n\t\t\t\tisRead: true,\r\n\t\t\t})\r\n\t\t}\r\n\t}\r\n\r\n\treturn (\r\n\t\t<div className='chat-list custom-scrollbar' onMouseMove={handleOnMouseMove}>\r\n\t\t\t{chats.length === 0 && <p>No chats yet!</p>}\r\n\t\t\t{chats.map(chat => (\r\n\t\t\t\t<Link\r\n\t\t\t\t\tto={`/u/${chat.id}`}\r\n\t\t\t\t\tkey={chat.id}\r\n\t\t\t\t\tclassName={`card ${\r\n\t\t\t\t\t\tchat.messages &&\r\n\t\t\t\t\t\tchat.messages[chat.messages.length - 1] &&\r\n\t\t\t\t\t\t!chat.isRead &&\r\n\t\t\t\t\t\tchat.messages[chat.messages.length - 1].createdBy !== user.uid\r\n\t\t\t\t\t\t\t? 'unread'\r\n\t\t\t\t\t\t\t: ''\r\n\t\t\t\t\t}`}\r\n\t\t\t\t\tonClick={() => handleSeen()}>\r\n\t\t\t\t\t<div className='card-content'>\r\n\t\t\t\t\t\t{chat.assignedUsers.forEach(u => {\r\n\t\t\t\t\t\t\tif (u.id !== user.uid) {\r\n\t\t\t\t\t\t\t\trightId = u.id\r\n\t\t\t\t\t\t\t\trightUrl = u.photoURL\r\n\t\t\t\t\t\t\t\trightDisplayName = u.nickname\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t})}\r\n\r\n\t\t\t\t\t\t{users &&\r\n\t\t\t\t\t\t\tusers.forEach(user => {\r\n\t\t\t\t\t\t\t\tif (user.online && !onlineUsers.includes(user.id)) {\r\n\t\t\t\t\t\t\t\t\tonlineUsers.push(user.id)\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t})}\r\n\r\n\t\t\t\t\t\t<div className='avatar-container'>\r\n\t\t\t\t\t\t\t<Avatar src={rightUrl} />\r\n\r\n\t\t\t\t\t\t\t{onlineUsers.includes(rightId) && (\r\n\t\t\t\t\t\t\t\t<span className='online-user'>\r\n\t\t\t\t\t\t\t\t\t<div className='status-circle'></div>\r\n\t\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t{/* {console.log(chat.messages[chat.messages.length - 1].createdAt.toDate().getTime())}\r\n\t\t\t\t\t{console.log(chat)} */}\r\n\t\t\t\t\t\t<div className='chat-info'>\r\n\t\t\t\t\t\t\t<p className='display-name'>\r\n\t\t\t\t\t\t\t\t{rightDisplayName.substring(0, 18)}\r\n\t\t\t\t\t\t\t\t<span>{rightDisplayName.length >= 18 && '...'}</span>\r\n\t\t\t\t\t\t\t</p>\r\n\r\n\t\t\t\t\t\t\t<div className='last-chat'>\r\n\t\t\t\t\t\t\t\t<span className='last-message'>\r\n\t\t\t\t\t\t\t\t\t{chat &&\r\n\t\t\t\t\t\t\t\t\t\tchat.messages[chat.messages.length - 1] &&\r\n\t\t\t\t\t\t\t\t\t\tchat.messages[chat.messages.length - 1].createdBy === user.uid &&\r\n\t\t\t\t\t\t\t\t\t\t'You: '}\r\n\r\n\t\t\t\t\t\t\t\t\t{chat.messages.length !== 0 &&\r\n\t\t\t\t\t\t\t\t\t\tchat.messages[chat.messages.length - 1].content &&\r\n\t\t\t\t\t\t\t\t\t\tchat.messages[chat.messages.length - 1].fileType === undefined &&\r\n\t\t\t\t\t\t\t\t\t\tchat.messages[chat.messages.length - 1].content.substring(0, 15)}\r\n\r\n\t\t\t\t\t\t\t\t\t{chat.messages.length !== 0 &&\r\n\t\t\t\t\t\t\t\t\t\t!chat.messages[chat.messages.length - 1].content &&\r\n\t\t\t\t\t\t\t\t\t\tchat.messages[chat.messages.length - 1].fileType === 'image' &&\r\n\t\t\t\t\t\t\t\t\t\t`sent a photo`}\r\n\r\n\t\t\t\t\t\t\t\t\t{chat.messages.length !== 0 &&\r\n\t\t\t\t\t\t\t\t\t\t!chat.messages[chat.messages.length - 1].content &&\r\n\t\t\t\t\t\t\t\t\t\tchat.messages[chat.messages.length - 1].fileType === 'video' &&\r\n\t\t\t\t\t\t\t\t\t\t`sent a video`}\r\n\r\n\t\t\t\t\t\t\t\t\t{chat.messages.length !== 0 &&\r\n\t\t\t\t\t\t\t\t\t\tchat.messages[chat.messages.length - 1].content &&\r\n\t\t\t\t\t\t\t\t\t\tchat.messages[chat.messages.length - 1].content.length >= 15 &&\r\n\t\t\t\t\t\t\t\t\t\t'...'}\r\n\t\t\t\t\t\t\t\t\t{/* {console.log(chat.messages[chat.messages.length - 1].fileType !== undefined)} */}\r\n\t\t\t\t\t\t\t\t\t{chat.messages.length === 0 && 'No messages yet'}\r\n\t\t\t\t\t\t\t\t</span>\r\n\r\n\t\t\t\t\t\t\t\t{chat.messages.length !== 0 && <div className='dot'></div>}\r\n\t\t\t\t\t\t\t\t<span className='comment-date'>\r\n\t\t\t\t\t\t\t\t\t{chat.messages.length !== 0 &&\r\n\t\t\t\t\t\t\t\t\t\tformatDistanceToNowStrict(chat.messages[chat.messages.length - 1].createdAt.toDate(), {\r\n\t\t\t\t\t\t\t\t\t\t\taddSuffix: false,\r\n\t\t\t\t\t\t\t\t\t\t}).replace(/\\b(?:about|less than a minute)\\b/gi, matched => replaceDistanceToNow[matched])}\r\n\t\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</Link>\r\n\t\t\t))}\r\n\t\t</div>\r\n\t)\r\n}\r\n","import { useEffect, useState } from 'react'\r\nimport { setDoc, doc, getDoc } from 'firebase/firestore'\r\nimport { projectFirestore, timestamp } from '../firebase/config'\r\nimport { useCollection } from '../hooks/useCollection'\r\nimport { useAuthContext } from '../hooks/useAuthContext'\r\nimport { useLogout } from '../hooks/useLogout'\r\n\r\n// Compontents\r\nimport ChatsList from './ChatsList'\r\n\r\n// Styles\r\nimport './Chats.scss'\r\nimport Avatar from './Avatar'\r\n\r\nexport default function Chats({ currentChat, inputRef }) {\r\n\tconst { user } = useAuthContext()\r\n\tconst { logout, isPending } = useLogout()\r\n\tconst { documents: users } = useCollection('users')\r\n\tconst { documents: chats } = useCollection(\r\n\t\t'projects',\r\n\t\t['assignedUsersId', 'array-contains', user.uid],\r\n\t\t['updatedAt', 'desc']\r\n\t)\r\n\r\n\tconst [query, setQuery] = useState('')\r\n\r\n\tconst handleSelect = async addUser => {\r\n\t\t// Check whether the group(chats in firestore) exists, if not create\r\n\t\tconst combinedId = user.uid > addUser.id ? user.uid + addUser.id : addUser.id + user.uid\r\n\r\n\t\ttry {\r\n\t\t\tconst res = await getDoc(doc(projectFirestore, 'projects', combinedId))\r\n\r\n\t\t\tif (!res.exists() && user.uid !== addUser.id) {\r\n\t\t\t\t// Create a chat in chats collection\r\n\r\n\t\t\t\tawait setDoc(doc(projectFirestore, 'projects', combinedId), {\r\n\t\t\t\t\tid: combinedId,\r\n\t\t\t\t\tassignedUsers: [\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tid: user.uid,\r\n\t\t\t\t\t\t\tdisplayName: user.displayName,\r\n\t\t\t\t\t\t\tnickname: user.displayName,\r\n\t\t\t\t\t\t\tphotoURL: user.photoURL,\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tid: addUser.id,\r\n\t\t\t\t\t\t\tdisplayName: addUser.displayName,\r\n\t\t\t\t\t\t\tnickname: addUser.displayName,\r\n\t\t\t\t\t\t\tphotoURL: addUser.photoURL,\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t],\r\n\t\t\t\t\tassignedUsersId: [user.uid, addUser.id],\r\n\t\t\t\t\tchatEmoji: '1f44d',\r\n\t\t\t\t\tmessages: [],\r\n\t\t\t\t\tupdatedAt: timestamp.fromDate(new Date()),\r\n\t\t\t\t\tcreatedAt: timestamp.fromDate(new Date()),\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t} catch (err) {}\r\n\r\n\t\tsetQuery('')\r\n\t}\r\n\r\n\treturn (\r\n\t\t<div className='user-list'>\r\n\t\t\t{/* <div className=\"blur\"></div> */}\r\n\t\t\t<div className='search'>\r\n\t\t\t\t<h2>Chats</h2>\r\n\t\t\t\t<div>\r\n\t\t\t\t\t<div className='search-form'>\r\n\t\t\t\t\t\t<label>\r\n\t\t\t\t\t\t\t<i className='fa-solid fa-magnifying-glass'></i>\r\n\t\t\t\t\t\t\t<input type='text' placeholder='Find a user' onChange={e => setQuery(e.target.value)} value={query} />\r\n\t\t\t\t\t\t</label>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t{query !== '' && (\r\n\t\t\t\t\t\t<>\r\n\t\t\t\t\t\t\t<div className='add-users'>\r\n\t\t\t\t\t\t\t\t{users &&\r\n\t\t\t\t\t\t\t\t\tusers\r\n\t\t\t\t\t\t\t\t\t\t.filter(user => user.displayName.toLowerCase().trim().replace(/\\s+/g, '').includes(query))\r\n\t\t\t\t\t\t\t\t\t\t.map(user => (\r\n\t\t\t\t\t\t\t\t\t\t\t<div key={user.id} className='user-chat' onClick={() => handleSelect(user)}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<img src={user.photoURL} alt='' />\r\n\t\t\t\t\t\t\t\t\t\t\t\t<div className='user-chat-info'>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<span>{user.displayName}</span>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t))}\r\n\r\n\t\t\t\t\t\t\t\t{query.trim() === '' && <span>User not found!</span>}\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</>\r\n\t\t\t\t\t)}\r\n\t\t\t\t\t<div className='chats'>\r\n\t\t\t\t\t\t{query === '' && chats && <ChatsList chats={chats} currentChat={currentChat} inputRef={inputRef} />}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t\t<div className='user'>\r\n\t\t\t\t<div>\r\n\t\t\t\t\t<Avatar src={user.photoURL} />\r\n\t\t\t\t\t<span>{user.displayName}</span>\r\n\t\t\t\t</div>\r\n\r\n\t\t\t\t{!isPending && user && (\r\n\t\t\t\t\t<button className='btn ' onClick={logout}>\r\n\t\t\t\t\t\t{/* <i className='fa-solid fa-right-from-bracket'></i> */}\r\n\t\t\t\t\t\t<i className='fa-solid fa-gear'></i>\r\n\t\t\t\t\t\t{/* <span> Log out </span> */}\r\n\t\t\t\t\t</button>\r\n\t\t\t\t)}\r\n\r\n\t\t\t\t{isPending && (\r\n\t\t\t\t\t<button className='btn' disabled>\r\n\t\t\t\t\t\t{/* <i class='fa-solid fa-right-from-bracket'></i> */}\r\n\t\t\t\t\t\t<span>...</span>\r\n\t\t\t\t\t\t{/* <span> Logging out...</span> */}\r\n\t\t\t\t\t</button>\r\n\t\t\t\t)}\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t)\r\n}\r\n","import { useEffect, useState } from 'react'\nimport { projectAuth, projectFirestore } from '../firebase/config'\nimport { useAuthContext } from './useAuthContext'\n\nexport const useLogout = () => {\n\tconst [isCancelled, setIsCancelled] = useState(false)\n\tconst [error, setError] = useState(null)\n\tconst [isPending, setIsPending] = useState(false)\n\tconst { dispatch, user } = useAuthContext()\n\n\tconst logout = async () => {\n\t\tsetError(null)\n\t\tsetIsPending(true)\n\n\t\ttry {\n\t\t\t// Update online status\n\t\t\tconst { uid } = user\n\t\t\tawait projectFirestore.collection('users').doc(uid).update({\n\t\t\t\tonline: false,\n\t\t\t})\n\n\t\t\t// Sign the user out\n\t\t\tawait projectAuth.signOut()\n\n\t\t\t// Dispatch logout action\n\t\t\tdispatch({ type: 'LOGOUT' })\n\n\t\t\t// Update state\n\t\t\tif (!isCancelled) {\n\t\t\t\tsetIsPending(false)\n\t\t\t\tsetError(null)\n\t\t\t}\n\t\t} catch (err) {\n\t\t\tif (!isCancelled) {\n\t\t\t\tsetError(err.message)\n\t\t\t\tsetIsPending(false)\n\t\t\t}\n\t\t}\n\t}\n\n\tuseEffect(() => {\n\t\treturn () => setIsCancelled(true)\n\t}, [])\n\n\treturn { logout, error, isPending }\n}\n","import { useRef, useState } from 'react'\r\nimport { BrowserRouter, Route, Switch, Redirect } from 'react-router-dom'\r\nimport { useAuthContext } from './hooks/useAuthContext'\r\n\r\n// Styles\r\nimport './App.scss'\r\n\r\n// Components && Pages\r\nimport Dashboard from './pages/dashboard/Dashboard'\r\nimport Chat from './pages/chat/Chat'\r\nimport Login from './pages/login/Login'\r\nimport Signup from './pages/signup/Signup'\r\nimport PrivacyPolicy from './pages/privacyPolicy/privacyPolicy'\r\nimport ResetPassword from './pages/resetPassword/ResetPassword'\r\nimport SetNewPassword from './pages/resetPassword/SetNewPassword'\r\nimport Chats from './components/Chats'\r\n\r\nfunction App() {\r\n\tconst { user, authIsReady } = useAuthContext()\r\n\tconst [currentChat, setCurrentChat] = useState(null)\r\n\tconst inputRef = useRef(null)\r\n\r\n\treturn (\r\n\t\t<div className='App'>\r\n\t\t\t{authIsReady && (\r\n\t\t\t\t<BrowserRouter>\r\n\t\t\t\t\t{user && <Chats currentChat={currentChat} inputRef={inputRef} />}\r\n\r\n\t\t\t\t\t<Switch>\r\n\t\t\t\t\t\t<Route exact path='/'>\r\n\t\t\t\t\t\t\t{!user && <Redirect to='/login' />}\r\n\t\t\t\t\t\t\t{user && <Dashboard />}\r\n\t\t\t\t\t\t</Route>\r\n\r\n\t\t\t\t\t\t<Route path='/u/:id'>\r\n\t\t\t\t\t\t\t{!user && <Redirect to='/login' />}\r\n\t\t\t\t\t\t\t{user && <Chat setCurrentChat={setCurrentChat} inputRef={inputRef} />}\r\n\t\t\t\t\t\t</Route>\r\n\r\n\t\t\t\t\t\t<Route path='/privacy-policy'>\r\n\t\t\t\t\t\t\t<PrivacyPolicy />\r\n\t\t\t\t\t\t</Route>\r\n\r\n\t\t\t\t\t\t<Route path='/recover-password'>\r\n\t\t\t\t\t\t\t<ResetPassword />\r\n\t\t\t\t\t\t</Route>\r\n\r\n\t\t\t\t\t\t<Route path='/login'>\r\n\t\t\t\t\t\t\t{user && <Redirect to='/' />}\r\n\t\t\t\t\t\t\t{!user && <Login />}\r\n\t\t\t\t\t\t</Route>\r\n\r\n\t\t\t\t\t\t<Route path='/signup'>\r\n\t\t\t\t\t\t\t{user && <Redirect to='/' />}\r\n\t\t\t\t\t\t\t{!user && <Signup />}\r\n\t\t\t\t\t\t</Route>\r\n\r\n\t\t\t\t\t\t<Route path='/set-new-password'>\r\n\t\t\t\t\t\t\t<SetNewPassword />\r\n\t\t\t\t\t\t</Route>\r\n\t\t\t\t\t</Switch>\r\n\t\t\t\t</BrowserRouter>\r\n\t\t\t)}\r\n\t\t</div>\r\n\t)\r\n}\r\n\r\nexport default App\r\n","import React from 'react'\nimport ReactDOM from 'react-dom'\nimport './index.scss'\nimport App from './App'\nimport { AuthContextProvider } from './context/AuthContext'\n\nReactDOM.render(\n\t<React.StrictMode>\n\t\t<AuthContextProvider>\n\t\t\t<App />\n\t\t</AuthContextProvider>\n\t</React.StrictMode>,\n\tdocument.getElementById('root')\n)\n\t"],"sourceRoot":""}