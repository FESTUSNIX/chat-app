{"version":3,"sources":["firebase/config.js","context/AuthContext.js","hooks/useAuthContext.js","theme/GlobalStyles.js","hooks/useCollection.js","pages/dashboard/Dashboard.js","hooks/useDocument.js","hooks/useFirestore.js","hooks/useDates.js","assets/logo-default.png","components/Avatar/Avatar.js","hooks/useEscapeKey.js","components/Modal/Modal.js","components/Tooltip/Tooltip.js","components/AvatarWithStatus/AvatarWithStatus.js","components/ProfilePreview/ProfilePreview.js","pages/chat/Messages/Message/Message.js","pages/chat/Messages/Messages.js","pages/chat/MessageField/MessageField.js","assets/british-person.jpg","components/ThemeCreator/ThemePreview.js","components/ThemeCreator/Field.js","components/ColorPicker/ColorPicker.js","components/ThemeCreator/ThemeCreator.js","components/ThemePicker/ThemePicker.js","pages/chat/ChatOptions/ChatOptions.js","pages/chat/Chat.js","hooks/useLogin.js","assets/btn_google_dark_normal_ios.svg","assets/GitHub-Mark-Light-32px.png","pages/login/Login.js","pages/signup/Signup.js","hooks/useSignup.js","pages/privacyPolicy/privacyPolicy.js","assets/shrek-gif.gif","pages/resetPassword/ResetPassword.js","pages/resetPassword/SetNewPassword.js","hooks/useQuery.js","hooks/useLogout.js","components/Chats/ChatsList.js","components/Chats/Chats.js","components/ToolBar/ToolBar.js","assets/premium-account.png","pages/profile/Profile.js","components/Loader/Loader.js","pages/settings/subpages/AccountDetails/fields/Username.js","pages/settings/subpages/AccountDetails/fields/Email.js","pages/settings/subpages/AccountDetails/fields/PhoneNumber.js","pages/settings/subpages/AccountDetails/fields/Password.js","pages/settings/subpages/AccountDetails/fields/DeleteAccount.js","pages/settings/subpages/AccountDetails/AccountDetails.js","pages/settings/subpages/Profile/CropImg.js","pages/settings/subpages/Profile/fields/AvatarField.js","pages/settings/subpages/Profile/fields/BannerField.js","pages/settings/subpages/Profile/fields/AboutField.js","pages/settings/subpages/Profile/Preview.js","pages/settings/subpages/Profile/Profile.js","pages/settings/subpages/Theme/Theme.js","pages/settings/subpages/Premium/Premium.js","pages/settings/subpages/PrivacyAndSecurity/PrivacyAndSecurity.js","pages/settings/Settings.js","App.js","index.js"],"names":["firebase","initializeApp","apiKey","authDomain","projectId","storageBucket","messagingSenderId","appId","projectFirestore","firestore","projectAuth","auth","projectStorage","storage","projectGoogle","GoogleAuthProvider","projectGitHub","GithubAuthProvider","setCustomParameters","prompt","timestamp","Timestamp","AuthContext","createContext","authReducer","state","action","type","user","payload","authIsReady","AuthContextProvider","children","useReducer","dispatch","useEffect","unsub","onAuthStateChanged","Provider","value","useAuthContext","context","useContext","Error","adjustBrightness","col","amt","usePound","slice","R","parseInt","substring","G","B","toString","length","GlobalStyles","createGlobalStyle","theme","colors","bgDark","bgSecondary","inputBg","inputText","inputBorder","msgBg","messageColor","msgBorder","msgBgOwner","forEach","color","spreadColors","messageColorOwner","msgBorderOwner","textAccent","borderRadius","textPrimary","textLowContrast","buttonColor","useCollection","collection","_query","_orderBy","useState","documents","setDocuments","error","setError","query","useRef","current","orderBy","ref","where","unsubscribe","onSnapshot","snapshot","results","docs","doc","push","data","id","console","log","Dashboard","className","useDocument","document","setDocument","err","message","initialState","isPending","success","firestoreReducer","useFirestore","response","isCancelled","setIsCancelled","dispatchIfNotCancelled","addDocument","a","createdAt","fromDate","Date","add","addedDocument","deleteDocument","delete","updateDocument","updates","update","updatedDocument","useDates","dayOfMonth","dayOfWeek","month","year","hour","curDate","fullDate","today","toLocaleDateString","formatDate","date","toDate","getDay","getFullYear","getMonth","getDate","toLocaleTimeString","minute","dateToFormat","lastMonday","setDate","setHours","getTime","isCurrentWeek","dates","Avatar","src","appLogo","alt","KEY_EVENT_TYPE","Modal","show","setShow","onClose","disableOCH","button1","button2","handleClose","handleEscKey","useCallback","event","key","addEventListener","removeEventListener","useEscapeKey","onOutsideClick","disabled","onClick","Tooltip","pos","align","AvatarWithStatus","userId","linkToProfile","noTooltip","noStatus","users","setUser","filter","u","undefined","to","photoURL","status","ConditionalWrapper","condition","wrapper","ProfilePreview","disableTooltip","userDoc","handleStatus","uid","style","backgroundColor","banner","displayName","bio","map","Message","elements","i","chat","onMessageResponse","setMessageToDelete","showImage","setShowImage","otherUser","showEmojis","setShowEmojis","showModal","setShowModal","emojiReactions","setEmojiReactions","showProfilePrev","setShowProfilePrev","showSendDate","value1","value2","date1","date2","Math","abs","showSendDate2","reactWithEmoji","e","indexOfMessage","messages","indexOf","otherUserReaction","rec","emojiToAdd","content","emoji","handleReactionNicknames","reaction","nickname","assignedUsers","deleteEmojiReaction","getDoc","res","isSpecial","prev","next","prevIsDate","nextIsDate","createdBy","handleMessageStyle","deleted","getElementById","scrollIntoView","block","setTimeout","classList","remove","scrollToResponse","image","fileType","target","showFullImage","controls","playsInline","onEmojiClick","Theme","DARK","previewConfig","defaultCaption","defaultEmoji","width","height","emojiStyle","EmojiStyle","NATIVE","viewBox","d","Number","lastRead","Messages","setBottomDiv","currentUser","messageToDelete","location","useLocation","bottomRef","scrollDownRef","scrollToBottom","deleteMessage","onScroll","winScroll","scrollTop","handleScrollDownBtn","FileSaver","saveAs","MessageField","messageResponse","bottomDiv","inputRef","uniqueId","uuid","newComment","setNewComment","imgUpload","setImgUpload","isAssignedUser","setIsAssignedUser","chatEmoji","fastEmoji","setFastEmoji","sendFastEmoji","setSendFastEmoji","seen","setSeen","fileInputRef","focus","assignedUsersId","sendMessage","commentToAdd","trim","updatedAt","isRead","sendImage","includes","split","storageRef","name","uploadBytes","then","getDownloadURL","downloadURL","handleImageUpload","imageFile","files","options","maxSizeMB","maxWidthOrHeight","useWebWorker","imageCompression","compressedFile","handleSubmit","preventDefault","fileThumbnail","setFileThumbnail","onSubmit","accept","onChange","URL","createObjectURL","handleFileChange","resetFileInput","maxLength","placeholder","onKeyDown","code","handleKey","handleEmojis","innerText","unified","size","ThemePreview","otherUserMessage","curUserMessage","textColors","inputColors","confirmCustomTheme","setConfirmCustomTheme","submitCustomTheme","editedTheme","setShowThemePicker","setShowThemeCreator","messageStyles","bg","text","border","messageOwnerStyles","backgroundImage","backgroundAttachment","backgroundPosition","backgroundSize","britImg","primary","accent","lowContrast","Field","title","ColorPicker","setValue","separator","ThemeCreator","setName","setBgDark","setBgSecondary","setBorderRadius","setCurUserMessage","setOtherUserMessage","setInputColors","btn","btnText","setTextColors","setButtonColor","themeToAdd","isCustom","customThemes","updateCustomThemes","index","newArr","required","Fragment","updateMessageBg","c","random","min","max","ThemePicker","themes","setEditedTheme","setConfirmThemeDelete","confirmThemeDelete","changeTheme","removeCustomTheme","t","background","stopPropagation","editCustomTheme","ChatOptions","currentTheme","otherUserLocal","defaultThemeDoc","showEmojiPicker","setShowEmojiPicker","showNicknameModal","setShowNicknameModal","showNicknameInput","setShowNicknameInput","newNickname","setNewNickname","showThemePicker","showThemeCreator","changeChatEmoji","handleNicknameInput","Chat","setCurrentChat","useParams","showChatOptions","setShowChatOptions","setOtherUserLocal","currentUserLocal","setCurrentUserLocal","otherUserDoc","currentUserDoc","handleSeen","prevValue","toggle","useLogin","navigate","useNavigate","setIsPending","isFinished","setIsFinished","login","email","password","signInWithEmailAndPassword","online","loginWithGoogle","signInWithPopup","loginWithGithub","sendPasswordReset","sendPasswordResetEmail","resetPassword","newPassword","confirmPasswordReset","setUpRecaptcha","number","provider","PhoneAuthProvider","recaptchaVerifier","RecaptchaVerifier","render","verifyPhoneNumber","verificationId","Login","setEmail","setPassword","googleLogo","githubLogo","Signup","setDisplayName","thumbnail","setThumbnail","thumbnailError","setThumbnailError","randColor","randomColor","signup","createUserWithEmailAndPassword","uploadPath","put","img","imgUrl","updateProfile","set","metadata","creationTime","toLocaleString","day","signInWithGoogle","signInWithGithub","additionalUserInfo","username","useSignup","selected","PrivacyPolicy","class","ResetPassword","timeToRedirect","setTimeToRedirect","handlePasswordReset","countdown","redirectCountdown","setInterval","clearInterval","prevTimeToRedirect","ShrekGif","SetNewPassword","setNewPassword","oobCode","queryName","URLSearchParams","search","get","useQuery","useLogout","logout","signOut","ChatsList","chats","replaceDistanceToNow","about","minutes","formatDistanceToNowStrict","addSuffix","replace","matched","Chats","currentChat","setQuery","eyes","handleMouseMove","eye","x","getBoundingClientRect","left","clientWidth","y","top","clientHeight","rotation","atan2","pageX","pageY","PI","transform","window","result","toLowerCase","filterChats","ToolBar","latestChat","setLatestChat","currentPath","setCurrentPath","favs","setFavs","showFavs","setShowFavs","searchValue","setSearchValue","favsCopy","setFavsCopy","showProfile","setShowProfile","pinned","pathname","handleOnDragEnd","destination","items","Array","from","splice","source","reorderedItem","fav","onDragEnd","droppableId","provided","droppableProps","innerRef","f","draggableId","draggable","draggableProps","dragHandleProps","userToAdd","chatToAdd","isGroup","item","direction","handleRemoveFav","isDropDisabled","isDragging","draggingOver","addFav","Profile","confirmDelete","setConfirmDelete","comment","setComment","showInputControls","setShowInputControls","addComment","profileComments","deleteComment","comm","pronouns","country","countryCode","svg","premium","premiumIcon","classicAccIcon","getChatId","Loader","Username","setUsername","updateUsername","toast","position","autoClose","hideProgressBar","closeOnClick","pauseOnHover","progress","Email","currentPassword","setCurrentPassword","updateEmail","regex","match","userCredential","catch","PhoneNumber","phoneNumber","setPhoneNumber","confirmUnlink","setConfirmUnlink","showOTP","setShowOTP","captchaResponse","setCaptchaResponse","OTPCode","setOTPCode","notify","sendOTP","verifyOTP","authCredential","credential","linkWithCredential","updatePhoneNumber","unlink","providerId","unlinkPhoneNumber","enableSearch","dropdownClass","copyNumbersOnly","searchPlaceholder","fontWeight","handleOTPInput","Password","confirmNewPassword","setConfirmNewPassword","updatePassword","DeleteAccount","confirm","setConfirm","startCountdown","setStartCountdown","timeToDelete","setTimeToDelete","setCredential","finalCountdown","handleDeleteUser","deleteUser","isPasswordProvider","providerData","checkPassword","AccountDetails","docError","createImage","url","Promise","resolve","reject","Image","setAttribute","getRadianAngle","degreeValue","rotateSize","rotRad","cos","sin","getCroppedImg","imageSrc","pixelCrop","flip","horizontal","vertical","canvas","createElement","ctx","getContext","bBoxWidth","bBoxHeight","translate","rotate","scale","drawImage","getImageData","putImageData","toBlob","file","AvatarField","setAvatarState","setShowAvatarModal","showAvatarModal","useDropzone","noClick","multiple","onDrop","acceptedFiles","setFiles","Object","assign","preview","getRootProps","getInputProps","isDragAccept","isDragReject","open","crop","setCrop","zoom","setZoom","croppedAreaPixels","setCroppedAreaPixels","setCroppedImage","onCropComplete","croppedArea","showCroppedImage","croppedImage","updateAvatar","Undo","onUndo","closeToast","deletePhotoURLFromStorage","list","deleteRef","fullPath","deleteObject","removePhotoURLs","getStorage","aspect","cropShape","onCropChange","onZoomChange","maxZoom","step","info","BannerField","setBannerColor","bannerColor","updateBanner","AboutField","setAbout","updateBio","Preview","avatarState","Premium","href","rel","PrivacyAndSecurity","Settings","confirmLogout","setConfirmLogout","path","element","App","setTheme","filterTheme","themeToSet","filteredTheme","ReactDOM","StrictMode"],"mappings":"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","file":"static/js/main.e12933b5.chunk.js","sourcesContent":["import firebase from 'firebase/compat/app'\r\nimport 'firebase/compat/firestore'\r\nimport 'firebase/compat/auth'\r\nimport 'firebase/compat/storage'\r\n\r\nconst firebaseConfig = {\r\n\tapiKey: 'AIzaSyBMB6C-_B61S1wd1RYAr34jomKZpvq16eA',\r\n\tauthDomain: 'better-react-messenger.firebaseapp.com',\r\n\tprojectId: 'better-react-messenger',\r\n\tstorageBucket: 'better-react-messenger.appspot.com',\r\n\tmessagingSenderId: '381225253186',\r\n\tappId: '1:381225253186:web:43a9fb8cce6b202f31f0db',\r\n}\r\n\r\n// Firebase init\r\nfirebase.initializeApp(firebaseConfig)\r\n\r\n// Services init\r\nconst projectFirestore = firebase.firestore()\r\nconst projectAuth = firebase.auth()\r\nconst projectStorage = firebase.storage()\r\n\r\nconst projectGoogle = new firebase.auth.GoogleAuthProvider()\r\nconst projectGitHub = new firebase.auth.GithubAuthProvider()\r\n\r\nprojectGoogle.setCustomParameters({ prompt: 'select_account' })\r\n\r\n// Timestamp\r\nconst timestamp = firebase.firestore.Timestamp\r\n\r\nexport { projectFirestore, projectAuth, timestamp, projectStorage, projectGoogle, projectGitHub }\r\n","import { createContext, useReducer, useEffect } from 'react'\nimport { projectAuth } from '../firebase/config'\n\nexport const AuthContext = createContext()\n\nexport const authReducer = (state, action) => {\n\tswitch (action.type) {\n\t\tcase 'LOGIN':\n\t\t\treturn { ...state, user: action.payload }\n\t\tcase 'LOGOUT':\n\t\t\treturn { ...state, user: null }\n\t\tcase 'AUTH_IS_READY':\n\t\t\treturn { user: action.payload, authIsReady: true }\n\t\tdefault:\n\t\t\treturn state\n\t}\n}\n\nexport const AuthContextProvider = ({ children }) => {\n\tconst [state, dispatch] = useReducer(authReducer, {\n\t\tuser: null,\n\t\tauthIsReady: false,\n\t})\n\n\tuseEffect(() => {\n\t\tconst unsub = projectAuth.onAuthStateChanged(user => {\n\t\t\tdispatch({ type: 'AUTH_IS_READY', payload: user })\n\t\t\tunsub()\n\t\t})\n\t}, [])\n\n\treturn <AuthContext.Provider value={{ ...state, dispatch }}>{children}</AuthContext.Provider>\n}\n","import { AuthContext } from \"../context/AuthContext\"\nimport { useContext } from \"react\"\n\nexport const useAuthContext = () => {\n  const context = useContext(AuthContext)\n\n  if(!context) {\n    throw Error('useAuthContext must be used inside an AuthContextProvider')\n  }\n\n  return context\n}","import { createGlobalStyle } from 'styled-components'\r\n\r\nconst spreadColors = theme => {\r\n\tlet colors = null\r\n\ttheme.colors.msgBgOwner.forEach(color => {\r\n\t\tcolors === null ? (colors = `${color.value}`) : (colors = `${colors}, ${color.value}`)\r\n\t})\r\n\r\n\tif (theme.colors.msgBgOwner.length === 1) {\r\n\t\treturn colors\r\n\t} else {\r\n\t\treturn `linear-gradient(${colors})`\r\n\t}\r\n}\r\n\r\n// function hexToHSL(H) {\r\n// \tif (H) {\r\n// \t\t// Convert hex to RGB first\r\n// \t\tlet r = 0,\r\n// \t\t\tg = 0,\r\n// \t\t\tb = 0\r\n// \t\tif (H.length === 4) {\r\n// \t\t\tr = '0x' + H[1] + H[1]\r\n// \t\t\tg = '0x' + H[2] + H[2]\r\n// \t\t\tb = '0x' + H[3] + H[3]\r\n// \t\t} else if (H.length === 7) {\r\n// \t\t\tr = '0x' + H[1] + H[2]\r\n// \t\t\tg = '0x' + H[3] + H[4]\r\n// \t\t\tb = '0x' + H[5] + H[6]\r\n// \t\t}\r\n// \t\t// Then to HSL\r\n// \t\tr /= 255\r\n// \t\tg /= 255\r\n// \t\tb /= 255\r\n// \t\tlet cmin = Math.min(r, g, b),\r\n// \t\t\tcmax = Math.max(r, g, b),\r\n// \t\t\tdelta = cmax - cmin,\r\n// \t\t\th = 0,\r\n// \t\t\ts = 0,\r\n// \t\t\tl = 0\r\n\r\n// \t\tif (delta === 0) h = 0\r\n// \t\telse if (cmax === r) h = ((g - b) / delta) % 6\r\n// \t\telse if (cmax === g) h = (b - r) / delta + 2\r\n// \t\telse h = (r - g) / delta + 4\r\n\r\n// \t\th = Math.round(h * 60)\r\n\r\n// \t\tif (h < 0) h += 360\r\n\r\n// \t\tl = (cmax + cmin) / 2\r\n// \t\ts = delta === 0 ? 0 : delta / (1 - Math.abs(2 * l - 1))\r\n// \t\ts = +(s * 100).toFixed(1)\r\n// \t\tl = +(l * 100).toFixed(1)\r\n\r\n// \t\treturn 'hsl(' + h + ',' + s + '%,' + l + '%)'\r\n// \t}\r\n// }\r\n\r\nfunction adjustBrightness(col, amt) {\r\n\tvar usePound = false\r\n\tif (col) {\r\n\t\tif (col[0] === '#') {\r\n\t\t\tcol = col.slice(1)\r\n\t\t\tusePound = true\r\n\t\t}\r\n\r\n\t\tvar R = parseInt(col.substring(0, 2), 16)\r\n\t\tvar G = parseInt(col.substring(2, 4), 16)\r\n\t\tvar B = parseInt(col.substring(4, 6), 16)\r\n\r\n\t\t// to make the colour less bright than the input\r\n\t\t// change the following three \"+\" symbols to \"-\"\r\n\t\tR = R + amt\r\n\t\tG = G + amt\r\n\t\tB = B + amt\r\n\r\n\t\tif (R > 255) R = 255\r\n\t\telse if (R < 0) R = 0\r\n\r\n\t\tif (G > 255) G = 255\r\n\t\telse if (G < 0) G = 0\r\n\r\n\t\tif (B > 255) B = 255\r\n\t\telse if (B < 0) B = 0\r\n\r\n\t\tvar RR = R.toString(16).length === 1 ? '0' + R.toString(16) : R.toString(16)\r\n\t\tvar GG = G.toString(16).length === 1 ? '0' + G.toString(16) : G.toString(16)\r\n\t\tvar BB = B.toString(16).length === 1 ? '0' + B.toString(16) : B.toString(16)\r\n\r\n\t\treturn (usePound ? '#' : '') + RR + GG + BB\r\n\t}\r\n}\r\n\r\nexport const GlobalStyles = createGlobalStyle`\r\n#root {\r\n    --bg-dark: ${({ theme }) => theme.colors.bgDark};\r\n    --bg-dark-lighten5: ${({ theme }) => adjustBrightness(theme.colors.bgDark, 5)};\r\n    --bg-dark-lighten7: ${({ theme }) => adjustBrightness(theme.colors.bgDark, 7)};\r\n    --bg-dark-lighten10: ${({ theme }) => adjustBrightness(theme.colors.bgDark, 10)};\r\n    --bg-dark-lighten15: ${({ theme }) => adjustBrightness(theme.colors.bgDark, 15)};\r\n    --bg-dark-lighten20: ${({ theme }) => adjustBrightness(theme.colors.bgDark, 20)};\r\n    --bg-dark-lighten25: ${({ theme }) => adjustBrightness(theme.colors.bgDark, 25)};\r\n    --bg-dark-lighten90: ${({ theme }) => adjustBrightness(theme.colors.bgDark, 90)};\r\n    --bg-dark-lighten120: ${({ theme }) => adjustBrightness(theme.colors.bgDark, 120)};\r\n\r\n    --bg-secondary: ${({ theme }) => theme.colors.bgSecondary};\r\n\t--bg-secondary-lighten5: ${({ theme }) => adjustBrightness(theme.colors.bgSecondary, 5)};\r\n\t--bg-secondary-lighten10: ${({ theme }) => adjustBrightness(theme.colors.bgSecondary, 10)};\r\n\t--bg-secondary-lighten15: ${({ theme }) => adjustBrightness(theme.colors.bgSecondary, 15)};\r\n\t--bg-secondary-lighten50: ${({ theme }) => adjustBrightness(theme.colors.bgSecondary, 50)};\r\n\r\n    --input-bg: ${({ theme }) => theme.colors.inputBg};\r\n    --input-text: ${({ theme }) => theme.colors.inputText};\r\n\t--input-border: ${({ theme }) => theme.colors.inputBorder};\r\n\r\n    --message-bg: ${({ theme }) => theme.colors.msgBg};\r\n    --message-color: ${({ theme }) => theme.colors.messageColor};\r\n\t--message-border: ${({ theme }) => theme.colors.msgBorder};\r\n\t\r\n    --message-bg-owner: ${({ theme }) => spreadColors(theme)};\r\n    --message-color-owner: ${({ theme }) => theme.colors.messageColorOwner};\r\n\t--message-border-owner: ${({ theme }) => theme.colors.msgBorderOwner};\r\n\t\r\n    --text-accent: ${({ theme }) => theme.colors.textAccent};\r\n    --text-accent-darken25: ${({ theme }) => adjustBrightness(theme.colors.textAccent, -25)};\r\n    --text-accent-darken35: ${({ theme }) => adjustBrightness(theme.colors.textAccent, -55)};\r\n\r\n    --border-radius: ${({ theme }) => theme.borderRadius}px;\r\n    --border-color: ${({ theme }) => adjustBrightness(theme.colors.bgDark, 15)};\r\n\r\n    --text-primary:  ${({ theme }) => theme.colors.textPrimary};\r\n    --text-primary-darken20:  ${({ theme }) => adjustBrightness(theme.colors.textPrimary, -20)};\r\n    --text-primary-darken50:  ${({ theme }) => adjustBrightness(theme.colors.textPrimary, -50)};\r\n    --text-primary-darken100:  ${({ theme }) => adjustBrightness(theme.colors.textPrimary, -100)};\r\n\r\n    --text-heading: ${({ theme }) => adjustBrightness(theme.colors.textPrimary, 30)};\r\n    --text-low-contrast: ${({ theme }) => theme.colors.textLowContrast}; \r\n    --text-mid-contrast: ${({ theme }) => adjustBrightness(theme.colors.textLowContrast, 40)}; \r\n\t\r\n    --btn-text: ${({ theme }) => theme.colors.buttonColor};\r\n\r\n}\r\n`\r\n","import { useEffect, useState, useRef } from \"react\"\nimport { projectFirestore } from \"../firebase/config\"\n\nexport const useCollection = (collection, _query, _orderBy) => {\n  const [documents, setDocuments] = useState(null)\n  const [error, setError] = useState(null)\n\n  // if we don't use a ref --> infinite loop in useEffect\n  // _query is an array and is \"different\" on every function call\n  const query = useRef(_query).current\n  const orderBy = useRef(_orderBy).current\n\n  useEffect(() => {\n    let ref = projectFirestore.collection(collection)\n\n    if (query) {\n      ref = ref.where(...query)\n    }\n    if (orderBy) {\n      ref = ref.orderBy(...orderBy)\n    }\n\n    const unsubscribe = ref.onSnapshot(snapshot => {\n      let results = []\n      snapshot.docs.forEach(doc => {\n        results.push({...doc.data(), id: doc.id})\n      });\n      \n      // update state\n      setDocuments(results)\n      setError(null)\n    }, error => {\n      console.log(error)\n      setError('could not fetch the data')\n    })\n\n    // unsubscribe on unmount\n    return () => unsubscribe()\n\n  }, [collection, query, orderBy])\n\n  return { documents, error }\n}","// Styles\r\nimport './Dashboard.scss'\r\n\r\nexport default function Dashboard() {\r\n\treturn <div className='dashboard'></div>\r\n}\r\n","import { useEffect, useState } from 'react'\r\nimport { projectFirestore } from '../firebase/config'\r\n\r\nexport const useDocument = (collection, id) => {\r\n\tconst [document, setDocument] = useState(null)\r\n\tconst [error, setError] = useState(null)\r\n\r\n\t// Realtime data for document\r\n\tuseEffect(() => {\r\n\t\tif (id !== null) {\r\n\t\t\tconst ref = projectFirestore.collection(collection).doc(id)\r\n\r\n\t\t\tconst unsub = ref.onSnapshot(\r\n\t\t\t\tsnapshot => {\r\n\t\t\t\t\tif (snapshot.data()) {\r\n\t\t\t\t\t\tsetDocument({ ...snapshot.data(), id: snapshot.id })\r\n\t\t\t\t\t\tsetError(null)\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tsetError('No such document exists')\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\terr => {\r\n\t\t\t\t\tconsole.log(err.message)\r\n\t\t\t\t\tsetError('Failed to get document')\r\n\t\t\t\t}\r\n\t\t\t)\r\n\r\n\t\t\treturn () => unsub()\r\n\t\t}\r\n\t}, [collection, id])\r\n\r\n\treturn { document, error }\r\n}\r\n","import { useReducer, useEffect, useState } from 'react'\nimport { projectFirestore, timestamp } from '../firebase/config'\n\nlet initialState = {\n\tdocument: null,\n\tisPending: false,\n\terror: null,\n\tsuccess: null,\n}\n\nconst firestoreReducer = (state, action) => {\n\tswitch (action.type) {\n\t\tcase 'IS_PENDING':\n\t\t\treturn { isPending: true, document: null, success: false, error: null }\n\t\tcase 'ADDED_DOCUMENT':\n\t\t\treturn { isPending: false, document: action.payload, success: true, error: null }\n\t\tcase 'DELETED_DOCUMENT':\n\t\t\treturn { isPending: false, document: null, success: true, error: null }\n\t\tcase 'UPDATED_DOCUMENT':\n\t\t\treturn { isPending: false, document: action.payload, success: true, error: null }\n\t\tcase 'ERROR':\n\t\t\treturn { isPending: false, document: null, success: false, error: action.payload }\n\t\tdefault:\n\t\t\treturn state\n\t}\n}\n\nexport const useFirestore = collection => {\n\tconst [response, dispatch] = useReducer(firestoreReducer, initialState)\n\tconst [isCancelled, setIsCancelled] = useState(false)\n\n\t// Collection ref\n\tconst ref = projectFirestore.collection(collection)\n\n\t// Only dispatch is not cancelled\n\tconst dispatchIfNotCancelled = action => {\n\t\tif (!isCancelled) {\n\t\t\tdispatch(action)\n\t\t}\n\t}\n\n\t// Add a document\n\tconst addDocument = async doc => {\n\t\tdispatch({ type: 'IS_PENDING' })\n\n\t\ttry {\n\t\t\tconst createdAt = timestamp.fromDate(new Date())\n\n\t\t\tconst addedDocument = await ref.add({ ...doc, createdAt })\n\t\t\tdispatchIfNotCancelled({ type: 'ADDED_DOCUMENT', payload: addedDocument })\n\t\t} catch (err) {\n\t\t\tdispatchIfNotCancelled({ type: 'ERROR', payload: err.message })\n\t\t}\n\t}\n\n\t// Delete a document\n\tconst deleteDocument = async id => {\n\t\tdispatch({ type: 'IS_PENDING' })\n\n\t\ttry {\n\t\t\tawait ref.doc(id).delete()\n\t\t\tdispatchIfNotCancelled({ type: 'DELETED_DOCUMENT' })\n\t\t} catch (err) {\n\t\t\tdispatchIfNotCancelled({ type: 'ERROR', payload: 'could not delete' })\n\t\t}\n\t}\n\n\t// Update documents\n\n\tconst updateDocument = async (id, updates) => {\n\t\tdispatch({ type: 'IS_PENDING' })\n\n\t\ttry {\n\t\t\tconst updatedDocument = await ref.doc(id).update(updates)\n\n\t\t\tdispatchIfNotCancelled({ type: 'UPDATED_DOCUMENT', payload: updatedDocument })\n\t\t\treturn updatedDocument\n\t\t} catch (err) {\n\t\t\tdispatchIfNotCancelled({ type: 'ERROR', payload: err.message })\n\t\t\treturn null\n\t\t}\n\t}\n\n\tuseEffect(() => {\n\t\treturn () => setIsCancelled(true)\n\t}, [])\n\n\treturn { addDocument, deleteDocument, updateDocument, response }\n}\n","export const useDates = () => {\r\n\tlet today = new Date().toLocaleDateString()\r\n\tlet weekday = []\r\n\tlet dayOfMonth, dayOfWeek, month, year, hour, curDate, fullDate\r\n\r\n\tconst dates = dateToFormat => {\r\n\t\tconst date = dateToFormat.toDate()\r\n\t\tweekday = ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun']\r\n\t\tdayOfWeek = weekday[date.getDay()]\r\n\r\n\t\tyear = date.getFullYear()\r\n\r\n\t\tmonth = date.getMonth() + 1 < 10 ? '0' + date.getMonth() + 1 : date.getMonth() + 1\r\n\r\n\t\tdayOfMonth = date.getDate() < 10 ? '0' + date.getDate().toString() : date.getDate().toString()\r\n\r\n\t\tcurDate = `${dayOfMonth}/${month}/${year}`\r\n\t\thour = date.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })\r\n\r\n\t\tfullDate = `${dayOfMonth}.${month}.${year}, ${hour}`\r\n\r\n\t\treturn { dayOfWeek, year, month, dayOfMonth, curDate, hour, fullDate }\r\n\t}\r\n\r\n\tconst isCurrentWeek = dateToFormat => {\r\n\t\tlet lastMonday = new Date() // Creating new date object for today\r\n\t\tlastMonday.setDate(lastMonday.getDate() - (lastMonday.getDay() - 1)) // Setting date to last monday\r\n\t\tlastMonday.setHours(0, 0, 0, 0) // Setting Hour to 00:00:00:00\r\n\r\n\t\tconst res =\r\n\t\t\tlastMonday.getTime() <= dateToFormat.getTime() && dateToFormat.getTime() < lastMonday.getTime() + 604800000\r\n\r\n\t\treturn res\r\n\t}\r\n\r\n\tconst formatDate = createdAt => {\r\n\t\tconst date = createdAt.toDate()\r\n\r\n\t\tweekday = ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun']\r\n\t\tdayOfWeek = weekday[date.getDay()]\r\n\r\n\t\tyear = date.getFullYear()\r\n\r\n\t\tmonth = date.getMonth() + 1 < 10 ? `0${date.getMonth() + 1}` : date.getMonth() + 1\r\n\r\n\t\tdayOfMonth = date.getDate() < 10 ? '0' + date.getDate().toString() : date.getDate().toString()\r\n\r\n\t\tcurDate = `${dayOfMonth}/${month}/${year}`\r\n\t\thour = date.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })\r\n\r\n\t\tif (curDate === today) {\r\n\t\t\treturn hour\r\n\t\t} else if (isCurrentWeek(date)) {\r\n\t\t\treturn `${dayOfWeek}. ${hour}`\r\n\t\t} else {\r\n\t\t\treturn `${dayOfMonth}.${month}.${year}, ${hour}`\r\n\t\t}\r\n\t}\r\n\r\n\treturn { formatDate, dates, dayOfMonth, dayOfWeek, month, year, hour, curDate }\r\n}\r\n","export default __webpack_public_path__ + \"static/media/logo-default.9dacd6cd.png\";","// Styles && Assets\r\nimport './Avatar.scss'\r\nimport appLogo from '../../assets/logo-default.png'\r\n\r\nexport default function Avatar({ src }) {\r\n\treturn (\r\n\t\t<div className='avatar'>\r\n\t\t\t<img src={src ? src : appLogo} alt='' />\r\n\t\t</div>\r\n\t)\r\n}\r\n","import { useCallback, useEffect } from 'react'\r\n\r\nconst KEY_NAME_ESC = 'Escape'\r\nconst KEY_EVENT_TYPE = 'keyup'\r\n\r\nexport function useEscapeKey(handleClose) {\r\n\tconst handleEscKey = useCallback(\r\n\t\tevent => {\r\n\t\t\tif (event.key === KEY_NAME_ESC) {\r\n\t\t\t\thandleClose()\r\n\t\t\t}\r\n\t\t},\r\n\t\t[handleClose]\r\n\t)\r\n\r\n\tuseEffect(() => {\r\n\t\tdocument.addEventListener(KEY_EVENT_TYPE, handleEscKey, false)\r\n\r\n\t\treturn () => {\r\n\t\t\tdocument.removeEventListener(KEY_EVENT_TYPE, handleEscKey, false)\r\n\t\t}\r\n\t}, [handleEscKey])\r\n}\r\n","import { useEffect } from 'react'\r\nimport OutsideClickHandler from 'react-outside-click-handler'\r\nimport { useEscapeKey } from '../../hooks/useEscapeKey'\r\n\r\n// Styles\r\nimport './Modal.scss'\r\n\r\nexport default function Modal({ children, show, setShow, onClose, disableOCH, button1, button2 }) {\r\n\tuseEffect(() => {\r\n\t\tif (show === false && onClose) {\r\n\t\t\tonClose()\r\n\t\t}\r\n\t}, [show])\r\n\r\n\tconst hideModal = () => {\r\n\t\tsetShow()\r\n\t}\r\n\r\n\tuseEscapeKey(hideModal)\r\n\r\n\treturn (\r\n\t\tshow && (\r\n\t\t\t<div className='modal'>\r\n\t\t\t\t<OutsideClickHandler\r\n\t\t\t\t\tonOutsideClick={() => {\r\n\t\t\t\t\t\tsetShow()\r\n\t\t\t\t\t}}\r\n\t\t\t\t\tdisabled={disableOCH}>\r\n\t\t\t\t\t<div className='modal__content'>\r\n\t\t\t\t\t\t{children}\r\n\t\t\t\t\t\t<i className='fa-solid fa-xmark close-btn' onClick={() => setShow()}></i>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</OutsideClickHandler>\r\n\t\t\t</div>\r\n\t\t)\r\n\t)\r\n}\r\n","// Styles\r\nimport './Tooltip.scss'\r\n\r\nconst Tooltip = ({ children, pos, align, className }) => {\r\n\treturn (\r\n\t\t<div className={`tooltip ${pos ? pos : ''} ${align ? align : ''} ${className ? className : ''}`}>\r\n\t\t\t<div className='tooltip__content'>{children ? children : 'tooltip'}</div>\r\n\t\t</div>\r\n\t)\r\n}\r\n\r\nexport default Tooltip\r\n","import React, { useEffect, useState } from 'react'\r\nimport { useCollection } from '../../hooks/useCollection'\r\nimport { Link } from 'react-router-dom'\r\n\r\n// Styles\r\nimport './AvatarWithStatus.scss'\r\n\r\n// Components\r\nimport Avatar from '../Avatar/Avatar'\r\nimport Tooltip from '../Tooltip/Tooltip'\r\n\r\nconst AvatarWithStatus = ({ userId, linkToProfile, noTooltip, noStatus, src }) => {\r\n\tconst { documents: users } = useCollection('users')\r\n\r\n\tconst [user, setUser] = useState(null)\r\n\r\n\tuseEffect(() => {\r\n\t\tif (users && userId && userId !== null) {\r\n\t\t\tsetUser(\r\n\t\t\t\tusers.filter(u => {\r\n\t\t\t\t\treturn u.id === userId\r\n\t\t\t\t})[0]\r\n\t\t\t)\r\n\t\t}\r\n\t}, [userId, users])\r\n\r\n\tif (user && user !== undefined && user !== null) {\r\n\t\treturn (\r\n\t\t\t<div className='avatar-container'>\r\n\t\t\t\t{linkToProfile && (\r\n\t\t\t\t\t<Link to={`/profile/${user.id}`}>\r\n\t\t\t\t\t\t<Avatar src={src || src === '' ? src : user.photoURL} />\r\n\t\t\t\t\t</Link>\r\n\t\t\t\t)}\r\n\r\n\t\t\t\t{!linkToProfile && <Avatar src={src || src === '' ? src : user.photoURL} />}\r\n\r\n\t\t\t\t{user && user.status && !noStatus && (\r\n\t\t\t\t\t<span className={`status`}>\r\n\t\t\t\t\t\t<div className={`status__dot status__dot--${user.status}`}>\r\n\t\t\t\t\t\t\t{(!noTooltip || noTooltip === undefined) && <Tooltip>{user.status}</Tooltip>}\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</span>\r\n\t\t\t\t)}\r\n\t\t\t</div>\r\n\t\t)\r\n\t} else {\r\n\t\treturn null\r\n\t}\r\n}\r\n\r\nexport default AvatarWithStatus\r\n","import React from 'react'\r\nimport { useFirestore } from '../../hooks/useFirestore'\r\nimport { Link } from 'react-router-dom'\r\nimport { useDocument } from '../../hooks/useDocument'\r\nimport { useAuthContext } from '../../hooks/useAuthContext'\r\n\r\n// Styles\r\nimport './ProfilePreview.scss'\r\n\r\n// Components\r\nimport OutsideClickHandler from 'react-outside-click-handler'\r\nimport AvatarWithStatus from '../AvatarWithStatus/AvatarWithStatus'\r\nimport Tooltip from '../Tooltip/Tooltip'\r\n\r\nconst ConditionalWrapper = ({ condition, wrapper, children }) => (condition ? wrapper(children) : children)\r\n\r\nexport default function ProfilePreview({ show, setShow, userId, pos, align, disableTooltip }) {\r\n\tconst statuses = ['online', 'idle', 'do-not-disturb', 'invisible']\r\n\r\n\tconst { updateDocument } = useFirestore('users')\r\n\tconst { document: userDoc } = useDocument('users', userId)\r\n\tconst { user } = useAuthContext()\r\n\r\n\tconst handleStatus = async status => {\r\n\t\tawait updateDocument(user.uid, {\r\n\t\t\tstatus: status,\r\n\t\t})\r\n\t}\r\n\r\n\tif (show === true && setShow && userDoc) {\r\n\t\treturn (\r\n\t\t\t<ConditionalWrapper\r\n\t\t\t\tcondition={!disableTooltip}\r\n\t\t\t\twrapper={children => (\r\n\t\t\t\t\t<OutsideClickHandler onOutsideClick={() => setShow(false)}>\r\n\t\t\t\t\t\t<Tooltip pos={pos ? pos : 'top'} align={align ? align : 'end'} className='profile-preview-tooltip'>\r\n\t\t\t\t\t\t\t{children}\r\n\t\t\t\t\t\t</Tooltip>\r\n\t\t\t\t\t</OutsideClickHandler>\r\n\t\t\t\t)}>\r\n\t\t\t\t<div className='profile-preview'>\r\n\t\t\t\t\t<div className='profile-preview__banner' style={{ backgroundColor: userDoc.banner }}></div>\r\n\r\n\t\t\t\t\t<div className='profile-preview__header'>\r\n\t\t\t\t\t\t{userDoc && (\r\n\t\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\t\t\tsetShow(false)\r\n\t\t\t\t\t\t\t\t}}>\r\n\t\t\t\t\t\t\t\t<AvatarWithStatus userId={userDoc.id} linkToProfile={true} />\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t)}\r\n\r\n\t\t\t\t\t\t{userId === user.uid && (\r\n\t\t\t\t\t\t\t<Link\r\n\t\t\t\t\t\t\t\tto='/settings'\r\n\t\t\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\t\t\tsetShow(false)\r\n\t\t\t\t\t\t\t\t}}>\r\n\t\t\t\t\t\t\t\t<i className='fa-solid fa-gear'></i>\r\n\t\t\t\t\t\t\t</Link>\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t<div className='profile-preview__info'>\r\n\t\t\t\t\t\t<h3 className='name'>{userDoc.displayName}</h3>\r\n\r\n\t\t\t\t\t\t<div className='separator'></div>\r\n\r\n\t\t\t\t\t\t<div className='cards'>\r\n\t\t\t\t\t\t\t<div className='cards__card'>\r\n\t\t\t\t\t\t\t\t<h4>About me</h4>\r\n\t\t\t\t\t\t\t\t{userDoc.bio && <p className='bio'>{userDoc.bio}</p>}\r\n\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t<div className='cards__card'>\r\n\t\t\t\t\t\t\t\t<h4>Member since</h4>\r\n\t\t\t\t\t\t\t\t<p>{userDoc.createdAt}</p>\r\n\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t{userId === user.uid && (\r\n\t\t\t\t\t\t\t\t<>\r\n\t\t\t\t\t\t\t\t\t<div className='separator'></div>\r\n\t\t\t\t\t\t\t\t\t<div className='status-picker'>\r\n\t\t\t\t\t\t\t\t\t\t<div className='flex-row'>\r\n\t\t\t\t\t\t\t\t\t\t\t<div className={`status-dot status-dot--${userDoc.status}`}></div>\r\n\t\t\t\t\t\t\t\t\t\t\t<span>{userDoc.status === 'do-not-disturb' ? 'do not disturb' : userDoc.status}</span>\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t\t\t\t<i className='fa-solid fa-angle-right'></i>\r\n\r\n\t\t\t\t\t\t\t\t\t\t<div className='tooltip-container'>\r\n\t\t\t\t\t\t\t\t\t\t\t<Tooltip>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<div className='picker'>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t{statuses.map(status => (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclassName={`status ${status === userDoc.status ? 'status--current' : ''}`}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tonClick={() => handleStatus(status)}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tkey={status}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span className={`status-dot status-dot--${status}`}></span>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span className='status__name'>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{status === 'do-not-disturb' ? 'do not disturb' : status}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t))}\r\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t</Tooltip>\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t</>\r\n\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t</ConditionalWrapper>\r\n\t\t)\r\n\t} else {\r\n\t\treturn null\r\n\t}\r\n}\r\n","import React from 'react'\r\nimport { useState } from 'react'\r\nimport { useAuthContext } from '../../../../hooks/useAuthContext'\r\nimport { useFirestore } from '../../../../hooks/useFirestore'\r\nimport { useDates } from '../../../../hooks/useDates'\r\nimport { useCollection } from '../../../../hooks/useCollection'\r\n\r\n// Styles\r\nimport './Message.scss'\r\n\r\n// Components\r\nimport Avatar from '../../../../components/Avatar/Avatar'\r\nimport Modal from '../../../../components/Modal/Modal'\r\nimport Tooltip from '../../../../components/Tooltip/Tooltip'\r\nimport AvatarWithStatus from '../../../../components/AvatarWithStatus/AvatarWithStatus'\r\nimport ProfilePreview from '../../../../components/ProfilePreview/ProfilePreview'\r\nimport EmojiPicker, { EmojiStyle, Theme } from 'emoji-picker-react'\r\nimport OutsideClickHandler from 'react-outside-click-handler'\r\n\r\nexport default function Message({\r\n\tmessage,\r\n\telements,\r\n\ti,\r\n\tchat,\r\n\tonMessageResponse,\r\n\tsetMessageToDelete,\r\n\tshowImage,\r\n\tsetShowImage,\r\n\totherUser,\r\n}) {\r\n\tconst { user } = useAuthContext()\r\n\tconst { updateDocument } = useFirestore('projects')\r\n\tconst { formatDate } = useDates()\r\n\tconst { documents: users } = useCollection('users')\r\n\r\n\tconst [showEmojis, setShowEmojis] = useState(null)\r\n\tconst [showModal, setShowModal] = useState(false)\r\n\tconst [emojiReactions, setEmojiReactions] = useState([])\r\n\tconst [showProfilePrev, setShowProfilePrev] = useState(false)\r\n\r\n\tconst showSendDate = (elements, i) => {\r\n\t\tif (elements[i] && elements[i - 1]) {\r\n\t\t\tconst value1 = elements[i].createdAt.toDate().toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })\r\n\t\t\tconst value2 = elements[i - 1].createdAt.toDate().toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })\r\n\r\n\t\t\t// Get miliseconds of each message.createdAt\r\n\t\t\tconst date1 = new Date('01/01/2022 ' + value1 + ':00').getTime()\r\n\t\t\tconst date2 = new Date('01/01/2022 ' + value2 + ':00').getTime()\r\n\r\n\t\t\tconst minuteDiff = Math.abs(date1 - date2)\r\n\r\n\t\t\t// Check if difference between when message was created is greater than 15 minutes\r\n\t\t\tif (minuteDiff >= 900000) {\r\n\t\t\t\treturn true\r\n\t\t\t} else {\r\n\t\t\t\treturn false\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tconst showSendDate2 = (elements, i) => {\r\n\t\tif (elements[i + 1] && elements[i]) {\r\n\t\t\tconst value1 = elements[i + 1].createdAt.toDate().toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })\r\n\t\t\tconst value2 = elements[i].createdAt.toDate().toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })\r\n\r\n\t\t\t// Get miliseconds of each message.createdAt\r\n\t\t\tconst date1 = new Date('01/01/2022 ' + value1 + ':00').getTime()\r\n\t\t\tconst date2 = new Date('01/01/2022 ' + value2 + ':00').getTime()\r\n\r\n\t\t\tconst minuteDiff = Math.abs(date1 - date2)\r\n\r\n\t\t\t// Check if difference between when message was created is greater than 15 minutes\r\n\t\t\tif (minuteDiff >= 900000) {\r\n\t\t\t\treturn true\r\n\t\t\t} else {\r\n\t\t\t\treturn false\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tconst showFullImage = e => {\r\n\t\tif (showImage !== e.target.src) {\r\n\t\t\tsetShowImage(e.target.src)\r\n\t\t}\r\n\t}\r\n\r\n\tconst scrollToResponse = id => {\r\n\t\tconst ref = document.getElementById(id)\r\n\t\tref.scrollIntoView({ block: 'center' })\r\n\t\tsetTimeout(() => {\r\n\t\t\tref.classList.add('pop')\r\n\t\t\tsetTimeout(() => {\r\n\t\t\t\tref.classList.remove('pop')\r\n\t\t\t}, 800)\r\n\t\t}, 400)\r\n\t}\r\n\r\n\tconst reactWithEmoji = async (e, message) => {\r\n\t\tconst indexOfMessage = chat.messages.indexOf(message)\r\n\r\n\t\tlet otherUserReaction = null\r\n\r\n\t\tif (message.emojiReactions && message.emojiReactions.length > 0) {\r\n\t\t\tmessage.emojiReactions.forEach(rec => {\r\n\t\t\t\tif (rec !== null) {\r\n\t\t\t\t\tif (rec.id !== user.uid) {\r\n\t\t\t\t\t\totherUserReaction = rec\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t}\r\n\r\n\t\tconst emojiToAdd = {\r\n\t\t\tid: user.uid,\r\n\t\t\tphotoURL: user.photoURL,\r\n\t\t\tcontent: e.emoji,\r\n\t\t\tdisplayName: user.displayName,\r\n\t\t}\r\n\r\n\t\tchat.messages[indexOfMessage] = {\r\n\t\t\t...chat.messages[indexOfMessage],\r\n\t\t\temojiReactions: [\r\n\t\t\t\totherUserReaction ? otherUserReaction : null,\r\n\t\t\t\t{\r\n\t\t\t\t\t...emojiToAdd,\r\n\t\t\t\t},\r\n\t\t\t],\r\n\t\t}\r\n\r\n\t\ttry {\r\n\t\t\tawait updateDocument(chat.id, {\r\n\t\t\t\tmessages: [...chat.messages],\r\n\t\t\t})\r\n\t\t} catch (error) {\r\n\t\t\tconsole.log(error)\r\n\t\t}\r\n\t}\r\n\r\n\tconst handleMessageStyle = (message, prev, next, prevIsDate, nextIsDate) => {\r\n\t\tif (\r\n\t\t\tnext &&\r\n\t\t\t(!prev ||\r\n\t\t\t\tprev.createdBy !== message.createdBy ||\r\n\t\t\t\tnext.response !== null ||\r\n\t\t\t\tprevIsDate ||\r\n\t\t\t\tmessage.response !== null) &&\r\n\t\t\tnext.createdBy === message.createdBy &&\r\n\t\t\tnext.response === null &&\r\n\t\t\t!nextIsDate\r\n\t\t) {\r\n\t\t\tif (message.createdBy === user.uid) {\r\n\t\t\t\treturn 'group-top owner'\r\n\t\t\t} else {\r\n\t\t\t\treturn 'group-top'\r\n\t\t\t}\r\n\t\t} else if (\r\n\t\t\tprev &&\r\n\t\t\tnext &&\r\n\t\t\t(prev.createdBy === message.createdBy || prev.response !== null) &&\r\n\t\t\tnext.createdBy === message.createdBy &&\r\n\t\t\tnext.response === null &&\r\n\t\t\t!prevIsDate &&\r\n\t\t\t!nextIsDate\r\n\t\t) {\r\n\t\t\tif (message.createdBy === user.uid) {\r\n\t\t\t\treturn 'group-middle owner'\r\n\t\t\t} else {\r\n\t\t\t\treturn 'group-middle'\r\n\t\t\t}\r\n\t\t} else if (\r\n\t\t\t// prettier-ignore\r\n\t\t\tprev &&\r\n\t\t\tprev.createdBy === message.createdBy &&\r\n\t\t\tmessage.response === null &&\r\n\t\t\t(\r\n\t\t\t\t(!next && message.response === null) ||\r\n\t\t\t\t(\r\n\t\t\t\t\tnext && \r\n\t\t\t\t\t(\r\n\t\t\t\t\t\tnext.response !== null ||\r\n\t\t\t\t\t\tnext.createdBy !== message.createdBy ||\r\n\t\t\t\t\t\tnextIsDate\r\n\t\t\t\t\t)\r\n\t\t\t\t)\r\n\t\t\t) &&\r\n\t\t\t!prevIsDate\r\n\t\t) {\r\n\t\t\tif (message.createdBy === user.uid) {\r\n\t\t\t\treturn 'group-bottom owner'\r\n\t\t\t} else {\r\n\t\t\t\treturn 'group-bottom'\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tif (message.createdBy === user.uid) {\r\n\t\t\t\treturn 'owner'\r\n\t\t\t} else {\r\n\t\t\t\treturn ''\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tconst handleReactionNicknames = reaction => {\r\n\t\tlet nickname\r\n\t\tchat.assignedUsers.forEach(u => {\r\n\t\t\tif (u.id === reaction.id) {\r\n\t\t\t\tif (u.nickname !== '') {\r\n\t\t\t\t\tnickname = u.nickname\r\n\t\t\t\t} else {\r\n\t\t\t\t\tnickname = u.displayName\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t})\r\n\t\treturn nickname\r\n\t}\r\n\r\n\tconst deleteEmojiReaction = async (message, reaction) => {\r\n\t\tlet otherUserReaction = null\r\n\t\tif (reaction.id === user.uid) {\r\n\t\t\tif (message.emojiReactions.length > 0) {\r\n\t\t\t\t// otherUserReaction = message.emojiReactions.find(rec => rec.id !== user.uid)\r\n\r\n\t\t\t\tmessage.emojiReactions.forEach(rec => {\r\n\t\t\t\t\tif (rec !== null && rec.id !== user.uid) {\r\n\t\t\t\t\t\totherUserReaction = rec\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t}\r\n\r\n\t\t\tconst indexOfMessage = chat.messages.indexOf(message)\r\n\r\n\t\t\tchat.messages[indexOfMessage] = {\r\n\t\t\t\t...chat.messages[indexOfMessage],\r\n\t\t\t\temojiReactions: [otherUserReaction],\r\n\t\t\t}\r\n\r\n\t\t\ttry {\r\n\t\t\t\tawait updateDocument(chat.id, {\r\n\t\t\t\t\tmessages: [...chat.messages],\r\n\t\t\t\t})\r\n\t\t\t\tsetEmojiReactions([])\r\n\t\t\t\tsetShowModal(false)\r\n\t\t\t} catch (error) {\r\n\t\t\t\tconsole.log(error)\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tconst getDoc = id => {\r\n\t\tlet res = null\r\n\r\n\t\tif (users) {\r\n\t\t\tres = users.filter(doc => {\r\n\t\t\t\tif (doc.id === id) {\r\n\t\t\t\t\treturn true\r\n\t\t\t\t}\r\n\t\t\t\treturn false\r\n\t\t\t})[0]\r\n\t\t}\r\n\r\n\t\treturn res\r\n\t}\r\n\r\n\treturn (\r\n\t\t<>\r\n\t\t\t{message.isSpecial && <div className='messages__centered mb05'>{message.content}</div>}\r\n\t\t\t{!message.isSpecial && (\r\n\t\t\t\t<>\r\n\t\t\t\t\t{showSendDate(elements, i) && (\r\n\t\t\t\t\t\t<div className='messages__centered mb1 mt2'>{formatDate(message.createdAt)}</div>\r\n\t\t\t\t\t)}\r\n\t\t\t\t\t<li\r\n\t\t\t\t\t\tclassName={`${handleMessageStyle(\r\n\t\t\t\t\t\t\tmessage,\r\n\t\t\t\t\t\t\telements[i - 1],\r\n\t\t\t\t\t\t\telements[i + 1],\r\n\t\t\t\t\t\t\tshowSendDate(elements, i),\r\n\t\t\t\t\t\t\tshowSendDate2(elements, i)\r\n\t\t\t\t\t\t)} ${message.deleted ? 'deleted' : ''} ${message.emojiReactions ? 'emoji-response' : ''}`}\r\n\t\t\t\t\t\tid={message.id}>\r\n\t\t\t\t\t\t{message.createdBy !== user.uid && // top\r\n\t\t\t\t\t\t\t((elements[i + 1] &&\r\n\t\t\t\t\t\t\t\t(!elements[i - 1] ||\r\n\t\t\t\t\t\t\t\t\telements[i - 1].createdBy !== message.createdBy ||\r\n\t\t\t\t\t\t\t\t\telements[i + 1].response !== null ||\r\n\t\t\t\t\t\t\t\t\tshowSendDate(elements, i) ||\r\n\t\t\t\t\t\t\t\t\tmessage.response !== null) &&\r\n\t\t\t\t\t\t\t\telements[i + 1].createdBy === message.createdBy &&\r\n\t\t\t\t\t\t\t\telements[i + 1].response === null &&\r\n\t\t\t\t\t\t\t\t!showSendDate2(elements, i)) ||\r\n\t\t\t\t\t\t\t\t!(\r\n\t\t\t\t\t\t\t\t\t// middle\r\n\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\t(elements[i - 1] &&\r\n\t\t\t\t\t\t\t\t\t\t\telements[i + 1] &&\r\n\t\t\t\t\t\t\t\t\t\t\t(elements[i - 1].createdBy === message.createdBy || elements[i - 1].response !== null) &&\r\n\t\t\t\t\t\t\t\t\t\t\telements[i + 1].createdBy === message.createdBy &&\r\n\t\t\t\t\t\t\t\t\t\t\telements[i + 1].response === null &&\r\n\t\t\t\t\t\t\t\t\t\t\t!showSendDate(elements, i) &&\r\n\t\t\t\t\t\t\t\t\t\t\t!showSendDate2(elements, i)) ||\r\n\t\t\t\t\t\t\t\t\t\t// bottom\r\n\t\t\t\t\t\t\t\t\t\t(elements[i - 1] &&\r\n\t\t\t\t\t\t\t\t\t\t\telements[i - 1].createdBy === message.createdBy &&\r\n\t\t\t\t\t\t\t\t\t\t\tmessage.response === null &&\r\n\t\t\t\t\t\t\t\t\t\t\t((!elements[i + 1] && message.response === null) ||\r\n\t\t\t\t\t\t\t\t\t\t\t\t(elements[i + 1] &&\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t(elements[i + 1].response !== null ||\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\telements[i + 1].createdBy !== message.createdBy ||\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tshowSendDate2(elements, i)))) &&\r\n\t\t\t\t\t\t\t\t\t\t\t!showSendDate(elements, i))\r\n\t\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\t)) && <p className='message-author'>{otherUser.nickname}</p>}\r\n\r\n\t\t\t\t\t\t{message.response !== null && (\r\n\t\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\t\tonClick={() => scrollToResponse(chat.messages[message.response].id)}\r\n\t\t\t\t\t\t\t\tclassName={`response ${chat.messages[message.response].deleted ? 'deleted' : ''}`}>\r\n\t\t\t\t\t\t\t\t{message.createdBy !== user.uid && <div className='left-margin'></div>}\r\n\r\n\t\t\t\t\t\t\t\t{chat.messages[message.response].content && (\r\n\t\t\t\t\t\t\t\t\t<div className='response__message'>{chat.messages[message.response].content.substring(0, 55)}</div>\r\n\t\t\t\t\t\t\t\t)}\r\n\r\n\t\t\t\t\t\t\t\t<div className='response__img'>\r\n\t\t\t\t\t\t\t\t\t{chat.messages[message.response].image &&\r\n\t\t\t\t\t\t\t\t\t\t(chat.messages[message.response].fileType === 'image' ? (\r\n\t\t\t\t\t\t\t\t\t\t\t<img src={chat.messages[message.response].image} alt='' />\r\n\t\t\t\t\t\t\t\t\t\t) : (\r\n\t\t\t\t\t\t\t\t\t\t\t<video src={chat.messages[message.response].image}></video>\r\n\t\t\t\t\t\t\t\t\t\t))}\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t<div className='message-content'>\r\n\t\t\t\t\t\t\t{message.createdBy !== user.uid && (\r\n\t\t\t\t\t\t\t\t<div className='left-margin'>\r\n\t\t\t\t\t\t\t\t\t{!(\r\n\t\t\t\t\t\t\t\t\t\t// middle\r\n\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\t\telements[i - 1] &&\r\n\t\t\t\t\t\t\t\t\t\t\telements[i + 1] &&\r\n\t\t\t\t\t\t\t\t\t\t\t(elements[i - 1].createdBy === message.createdBy || elements[i - 1].response !== null) &&\r\n\t\t\t\t\t\t\t\t\t\t\telements[i + 1].createdBy === message.createdBy &&\r\n\t\t\t\t\t\t\t\t\t\t\telements[i + 1].response === null &&\r\n\t\t\t\t\t\t\t\t\t\t\t!showSendDate(elements, i) &&\r\n\t\t\t\t\t\t\t\t\t\t\t!showSendDate2(elements, i)\r\n\t\t\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\t\t) &&\r\n\t\t\t\t\t\t\t\t\t\t!(\r\n\t\t\t\t\t\t\t\t\t\t\t// top\r\n\t\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\t\t\telements[i + 1] &&\r\n\t\t\t\t\t\t\t\t\t\t\t\t(!elements[i - 1] ||\r\n\t\t\t\t\t\t\t\t\t\t\t\t\telements[i - 1].createdBy !== message.createdBy ||\r\n\t\t\t\t\t\t\t\t\t\t\t\t\telements[i + 1].response !== null ||\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tshowSendDate(elements, i) ||\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tmessage.response !== null) &&\r\n\t\t\t\t\t\t\t\t\t\t\t\telements[i + 1].createdBy === message.createdBy &&\r\n\t\t\t\t\t\t\t\t\t\t\t\telements[i + 1].response === null &&\r\n\t\t\t\t\t\t\t\t\t\t\t\t!showSendDate2(elements, i)\r\n\t\t\t\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\t\t\t) && (\r\n\t\t\t\t\t\t\t\t\t\t\t<div className='cursor-pointer' onClick={() => setShowProfilePrev(message.id)}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<AvatarWithStatus userId={message.createdBy} noStatus={true} />\r\n\t\t\t\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<ProfilePreview\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tshow={showProfilePrev === message.id}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tsetShow={setShowProfilePrev}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tuserId={message.createdBy}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tpos='right'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\talign='end'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t<div className='message-content__text'>\r\n\t\t\t\t\t\t\t\t{message.content && <p>{message.content}</p>}\r\n\r\n\t\t\t\t\t\t\t\t{message.image && message.fileType === 'image' && (\r\n\t\t\t\t\t\t\t\t\t<div className='file-message' onClick={e => showFullImage(e)}>\r\n\t\t\t\t\t\t\t\t\t\t<img src={message.image} alt='' />\r\n\t\t\t\t\t\t\t\t\t\t<div className='file-message__preview'>\r\n\t\t\t\t\t\t\t\t\t\t\t<i className='fa-solid fa-up-right-and-down-left-from-center'></i>\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t)}\r\n\r\n\t\t\t\t\t\t\t\t{message.image && message.fileType === 'video' && (\r\n\t\t\t\t\t\t\t\t\t<div className='file-message'>\r\n\t\t\t\t\t\t\t\t\t\t<video src={message.image} controls playsInline />\r\n\t\t\t\t\t\t\t\t\t\t<div className='file-message__preview'>\r\n\t\t\t\t\t\t\t\t\t\t\t<i className='fa-solid fa-up-right-and-down-left-from-center'></i>\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t)}\r\n\r\n\t\t\t\t\t\t\t\t{message.emojiReactions && message.emojiReactions.length > 0 && (\r\n\t\t\t\t\t\t\t\t\t<>\r\n\t\t\t\t\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\t\t\t\t\tclassName='emoji-reactions'\r\n\t\t\t\t\t\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\t\t\t\t\t\tsetEmojiReactions(message.emojiReactions)\r\n\t\t\t\t\t\t\t\t\t\t\t\tsetShowModal(true)\r\n\t\t\t\t\t\t\t\t\t\t\t}}>\r\n\t\t\t\t\t\t\t\t\t\t\t{message.emojiReactions.map(reaction =>\r\n\t\t\t\t\t\t\t\t\t\t\t\treaction !== null ? (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<div key={reaction.id} className='emoji-reactions__reaction'>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span className='content'>{reaction.content}</span>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span className='display-name'>{handleReactionNicknames(reaction)}</span>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t) : null\r\n\t\t\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t\t\t\t<Modal show={showModal} setShow={() => setShowModal(false)} onClose={() => setEmojiReactions([])}>\r\n\t\t\t\t\t\t\t\t\t\t\t<div className='show-reactions'>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<h3>Reactions</h3>\r\n\t\t\t\t\t\t\t\t\t\t\t\t{emojiReactions.map(reaction =>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\treaction !== null ? (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclassName={`reaction ${reaction.id === user.uid ? 'cursor-pointer' : ''}`}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tdeleteEmojiReaction(message, reaction)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tkey={reaction.id}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div className='reaction__author'>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Avatar src={reaction.photoURL} />\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<p>{reaction.displayName}</p>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{reaction.id === user.uid && <p>Click to delete</p>}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span className='reaction__emoji'>{reaction.content}</span>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t) : null\r\n\t\t\t\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t</Modal>\r\n\t\t\t\t\t\t\t\t\t</>\r\n\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t{showEmojis === message && (\r\n\t\t\t\t\t\t\t\t<div className='react-with-emoji'>\r\n\t\t\t\t\t\t\t\t\t<OutsideClickHandler\r\n\t\t\t\t\t\t\t\t\t\tonOutsideClick={() => {\r\n\t\t\t\t\t\t\t\t\t\t\tsetShowEmojis(null)\r\n\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t\tdisabled={showEmojis === message ? false : true}>\r\n\t\t\t\t\t\t\t\t\t\t<EmojiPicker\r\n\t\t\t\t\t\t\t\t\t\t\tclassName='emoji-picker'\r\n\t\t\t\t\t\t\t\t\t\t\tonEmojiClick={e => {\r\n\t\t\t\t\t\t\t\t\t\t\t\treactWithEmoji(e, message)\r\n\t\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t\t\ttheme={Theme.DARK}\r\n\t\t\t\t\t\t\t\t\t\t\tpreviewConfig={{\r\n\t\t\t\t\t\t\t\t\t\t\t\tdefaultCaption: '',\r\n\t\t\t\t\t\t\t\t\t\t\t\tdefaultEmoji: null,\r\n\t\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t\t\twidth={300}\r\n\t\t\t\t\t\t\t\t\t\t\theight={400}\r\n\t\t\t\t\t\t\t\t\t\t\t// lazyLoadEmojis={true}\r\n\t\t\t\t\t\t\t\t\t\t\temojiStyle={EmojiStyle.NATIVE}\r\n\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t</OutsideClickHandler>\r\n\r\n\t\t\t\t\t\t\t\t\t<svg height='12' viewBox='0 0 25 12' width='25' data-darkreader-inline-fill=''>\r\n\t\t\t\t\t\t\t\t\t\t<path d='M24.553.103c-2.791.32-5.922 1.53-7.78 3.455l-9.62 7.023c-2.45 2.54-5.78 1.645-5.78-2.487V2.085C1.373 1.191.846.422.1.102h24.453z'></path>\r\n\t\t\t\t\t\t\t\t\t</svg>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t)}\r\n\r\n\t\t\t\t\t\t\t{!message.deleted && (\r\n\t\t\t\t\t\t\t\t<div className={`message-tools ${showEmojis === message ? 'visible' : ''}`}>\r\n\t\t\t\t\t\t\t\t\t<i\r\n\t\t\t\t\t\t\t\t\t\tclassName='fa-regular fa-face-smile'\r\n\t\t\t\t\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\t\t\t\t\tsetShowEmojis(message)\r\n\t\t\t\t\t\t\t\t\t\t}}>\r\n\t\t\t\t\t\t\t\t\t\t<Tooltip>React</Tooltip>\r\n\t\t\t\t\t\t\t\t\t</i>\r\n\r\n\t\t\t\t\t\t\t\t\t{user.uid === message.createdBy && (\r\n\t\t\t\t\t\t\t\t\t\t<i className='fa-solid fa-trash-can' onClick={() => setMessageToDelete(message)}>\r\n\t\t\t\t\t\t\t\t\t\t\t<Tooltip>Remove</Tooltip>\r\n\t\t\t\t\t\t\t\t\t\t</i>\r\n\t\t\t\t\t\t\t\t\t)}\r\n\r\n\t\t\t\t\t\t\t\t\t<i\r\n\t\t\t\t\t\t\t\t\t\tclassName='fa-solid fa-reply'\r\n\t\t\t\t\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\t\t\t\t\tonMessageResponse(Number(chat.messages.indexOf(message)))\r\n\t\t\t\t\t\t\t\t\t\t}}>\r\n\t\t\t\t\t\t\t\t\t\t<Tooltip>Reply</Tooltip>\r\n\t\t\t\t\t\t\t\t\t</i>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t)}\r\n\r\n\t\t\t\t\t\t\t<div className={`message-createdAt ${showEmojis === message ? 'hidden' : ''}`}>\r\n\t\t\t\t\t\t\t\t{formatDate(message.createdAt)}\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t<div className='seen'>\r\n\t\t\t\t\t\t\t{chat.assignedUsers.map(\r\n\t\t\t\t\t\t\t\tu =>\r\n\t\t\t\t\t\t\t\t\tu.lastRead === message.id &&\r\n\t\t\t\t\t\t\t\t\tu.id !== user.uid && (\r\n\t\t\t\t\t\t\t\t\t\t<>\r\n\t\t\t\t\t\t\t\t\t\t\t<Avatar src={getDoc(u.id) !== null ? getDoc(u.id).photoURL : ''} key={u.id} />\r\n\t\t\t\t\t\t\t\t\t\t</>\r\n\t\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</li>\r\n\t\t\t\t</>\r\n\t\t\t)}\r\n\t\t</>\r\n\t)\r\n}\r\n","import React, { useState, useEffect, useRef } from 'react'\r\nimport { useAuthContext } from '../../../hooks/useAuthContext'\r\nimport { useDates } from '../../../hooks/useDates'\r\nimport { useFirestore } from '../../../hooks/useFirestore'\r\nimport { useLocation } from 'react-router-dom'\r\nimport FileSaver from 'file-saver'\r\nimport Message from './Message/Message'\r\n\r\n// Styles && Assets\r\nimport './Messages.scss'\r\nimport Modal from '../../../components/Modal/Modal'\r\n\r\nconst Messages = ({ chat, onMessageResponse, setBottomDiv, otherUser, currentUser }) => {\r\n\tconst { user } = useAuthContext()\r\n\tconst { dates } = useDates()\r\n\tconst { updateDocument } = useFirestore('projects')\r\n\r\n\tconst [showImage, setShowImage] = useState('')\r\n\tconst [messageToDelete, setMessageToDelete] = useState(null)\r\n\tconst [showModal, setShowModal] = useState(false)\r\n\r\n\tconst location = useLocation()\r\n\tconst bottomRef = useRef()\r\n\tconst scrollDownRef = useRef()\r\n\r\n\tuseEffect(() => {\r\n\t\tsetBottomDiv(bottomRef)\r\n\t\tscrollToBottom()\r\n\t}, [])\r\n\r\n\tuseEffect(() => {\r\n\t\tsetBottomDiv(bottomRef)\r\n\t\tscrollToBottom()\r\n\t\tonMessageResponse(null)\r\n\t}, [location])\r\n\r\n\tuseEffect(() => {\r\n\t\tif (messageToDelete !== null) {\r\n\t\t\tsetShowModal(true)\r\n\t\t} else {\r\n\t\t\tsetShowModal(false)\r\n\t\t}\r\n\t}, [messageToDelete, showModal])\r\n\r\n\tconst deleteMessage = async message => {\r\n\t\tif (user.uid === message.createdBy) {\r\n\t\t\tchat.messages[chat.messages.indexOf(message)] = {\r\n\t\t\t\t...chat.messages[chat.messages.indexOf(message)],\r\n\t\t\t\tcontent: 'Message deleted',\r\n\t\t\t\temojiReactions: null,\r\n\t\t\t\tdeleted: true,\r\n\t\t\t}\r\n\r\n\t\t\ttry {\r\n\t\t\t\tawait updateDocument(chat.id, {\r\n\t\t\t\t\tmessages: [...chat.messages],\r\n\t\t\t\t})\r\n\t\t\t\tsetMessageToDelete(null)\r\n\t\t\t} catch (error) {\r\n\t\t\t\tconsole.log(error)\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tconst hideFullImage = () => {\r\n\t\tsetShowImage('')\r\n\t}\r\n\r\n\tconst downloadImage = () => {\r\n\t\tFileSaver.saveAs(showImage)\r\n\t}\r\n\r\n\tconst scrollToBottom = () => {\r\n\t\tif (bottomRef.current) {\r\n\t\t\tbottomRef.current.scrollIntoView({\r\n\t\t\t\tblock: 'end',\r\n\t\t\t})\r\n\t\t}\r\n\t}\r\n\r\n\tconst handleScrollDownBtn = e => {\r\n\t\tconst winScroll = e.target.scrollTop\r\n\r\n\t\tif (-winScroll <= 300) {\r\n\t\t\tscrollDownRef.current.classList.remove('active')\r\n\t\t}\r\n\r\n\t\tif (-winScroll >= 300) {\r\n\t\t\tscrollDownRef.current.classList.add('active')\r\n\t\t}\r\n\t}\r\n\r\n\treturn (\r\n\t\t<ul className='messages custom-scrollbar' id='messages' onScroll={e => handleScrollDownBtn(e)}>\r\n\t\t\t{showImage && (\r\n\t\t\t\t<div className='full-img'>\r\n\t\t\t\t\t<div className='full-img__background'>\r\n\t\t\t\t\t\t<div className='backdrop-blur'></div>\r\n\t\t\t\t\t\t<img src={showImage} alt='' className='' />\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div className='wrapper'>\r\n\t\t\t\t\t\t<img src={showImage} alt='' className='full-img__img' />\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t<div className='full-img__tools'>\r\n\t\t\t\t\t\t<div className='tool' onClick={() => downloadImage()}>\r\n\t\t\t\t\t\t\t<i className='fa-solid fa-download'></i>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<div className='tool' onClick={() => hideFullImage()}>\r\n\t\t\t\t\t\t\t<i className='fa-solid fa-xmark'></i>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t)}\r\n\t\t\t<div className='messages-wrapper'>\r\n\t\t\t\t<div className='messages__conversation-start'>\r\n\t\t\t\t\t<p>This is the start of your conversation with this user</p>\r\n\t\t\t\t\t<p>{dates(chat.createdAt).fullDate}</p>\r\n\t\t\t\t</div>\r\n\r\n\t\t\t\t{chat.messages.length > 0 &&\r\n\t\t\t\t\tchat.messages.map((message, i, elements) => (\r\n\t\t\t\t\t\t<Message\r\n\t\t\t\t\t\t\tkey={message.id}\r\n\t\t\t\t\t\t\tmessage={message}\r\n\t\t\t\t\t\t\telements={elements}\r\n\t\t\t\t\t\t\ti={i}\r\n\t\t\t\t\t\t\tchat={chat}\r\n\t\t\t\t\t\t\tonMessageResponse={onMessageResponse}\r\n\t\t\t\t\t\t\tsetMessageToDelete={setMessageToDelete}\r\n\t\t\t\t\t\t\tshowImage={showImage}\r\n\t\t\t\t\t\t\tsetShowImage={setShowImage}\r\n\t\t\t\t\t\t\totherUser={otherUser}\r\n\t\t\t\t\t\t\tcurrentUser={currentUser}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t))}\r\n\t\t\t\t<div ref={bottomRef} className='bottom-ref'></div>\r\n\t\t\t</div>\r\n\t\t\t<div className='scroll-down' onClick={() => scrollToBottom()} ref={scrollDownRef}>\r\n\t\t\t\t<i className='fa-solid fa-arrow-down'></i>\r\n\t\t\t</div>\r\n\t\t\t{messageToDelete !== null && (\r\n\t\t\t\t<Modal\r\n\t\t\t\t\tshow={showModal}\r\n\t\t\t\t\tsetShow={() => setMessageToDelete(null)}\r\n\t\t\t\t\t// onClose={() => {}}\r\n\t\t\t\t>\r\n\t\t\t\t\t<div className='confirm-message-delete'>\r\n\t\t\t\t\t\t<h2>Delete message</h2>\r\n\t\t\t\t\t\t<p>Do you really want to delete this message?</p>\r\n\r\n\t\t\t\t\t\t<p>Message to delete: </p>\r\n\t\t\t\t\t\t<div className='message-to-delete custom-scrollbar'>\r\n\t\t\t\t\t\t\t{messageToDelete.content && <span>\"{messageToDelete.content}\"</span>}\r\n\t\t\t\t\t\t\t{messageToDelete.image && <img src={messageToDelete.image} alt='' />}\r\n\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t<div className='vertical-btns'>\r\n\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\tclassName='btn btn--secondary'\r\n\t\t\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\t\t\tsetMessageToDelete(null)\r\n\t\t\t\t\t\t\t\t}}>\r\n\t\t\t\t\t\t\t\tCancel\r\n\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t<button className='btn' onClick={() => deleteMessage(messageToDelete)}>\r\n\t\t\t\t\t\t\t\tDelete\r\n\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</Modal>\r\n\t\t\t)}\r\n\t\t</ul>\r\n\t)\r\n}\r\n\r\nexport default Messages\r\n","import React, { useEffect, useRef, useState } from 'react'\r\nimport { timestamp, projectStorage } from '../../../firebase/config'\r\nimport { useAuthContext } from '../../../hooks/useAuthContext'\r\nimport { useFirestore } from '../../../hooks/useFirestore'\r\nimport { v4 as uuid } from 'uuid'\r\nimport { getDownloadURL, ref, uploadBytes } from 'firebase/storage'\r\nimport EmojiPicker, { Emoji, EmojiStyle, Theme } from 'emoji-picker-react'\r\nimport OutsideClickHandler from 'react-outside-click-handler'\r\nimport imageCompression from 'browser-image-compression'\r\n\r\n// Styles && Assets\r\nimport './MessageField.scss'\r\n\r\nconst MessageField = ({ chat, messageResponse, onMessageResponse, bottomDiv, inputRef, otherUser, currentUser }) => {\r\n\tconst uniqueId = uuid()\r\n\r\n\tconst { updateDocument, response } = useFirestore('projects')\r\n\tconst { user } = useAuthContext()\r\n\r\n\tconst [newComment, setNewComment] = useState('')\r\n\tconst [imgUpload, setImgUpload] = useState(null)\r\n\tconst [isAssignedUser, setIsAssignedUser] = useState(false)\r\n\tconst [fastEmoji, setFastEmoji] = useState(chat.chatEmoji)\r\n\tconst [sendFastEmoji, setSendFastEmoji] = useState(false)\r\n\tconst [showEmojis, setShowEmojis] = useState(false)\r\n\tconst [seen, setSeen] = useState(false)\r\n\r\n\tconst fileInputRef = useRef(null)\r\n\r\n\tuseEffect(() => {\r\n\t\tinputRef.current.focus()\r\n\t}, [messageResponse])\r\n\r\n\tuseEffect(() => {\r\n\t\tchat.assignedUsersId.forEach(id => {\r\n\t\t\tif (id === user.uid) setIsAssignedUser(true)\r\n\t\t})\r\n\t}, [setIsAssignedUser, chat.assignedUsersId, user.uid])\r\n\r\n\tconst scrollToBottom = () => {\r\n\t\tbottomDiv.current.scrollIntoView({\r\n\t\t\tblock: 'end',\r\n\t\t})\r\n\t}\r\n\r\n\tconst sendMessage = async () => {\r\n\t\tconst commentToAdd = {\r\n\t\t\tid: uniqueId,\r\n\t\t\tdisplayName: user.displayName,\r\n\t\t\tphotoURL: user.photoURL,\r\n\t\t\tcontent: sendFastEmoji ? fastEmoji : newComment,\r\n\t\t\tcreatedAt: timestamp.fromDate(new Date()),\r\n\t\t\tcreatedBy: user.uid,\r\n\t\t\tresponse: messageResponse !== null ? messageResponse : null,\r\n\t\t}\r\n\r\n\t\tif (commentToAdd.content.trim() !== '' && newComment.length < 900 && isAssignedUser) {\r\n\t\t\tawait updateDocument(chat.id, {\r\n\t\t\t\tmessages: [...chat.messages, commentToAdd],\r\n\t\t\t\tupdatedAt: timestamp.fromDate(new Date()),\r\n\t\t\t})\r\n\t\t\tif (!response.error) {\r\n\t\t\t\tsetSeen(!seen)\r\n\t\t\t\tscrollToBottom()\r\n\t\t\t\tsetNewComment('')\r\n\t\t\t\tsetSendFastEmoji(false)\r\n\t\t\t\tonMessageResponse(null)\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tuseEffect(() => {\r\n\t\tif (document.messages && document.messages.length > 0) {\r\n\t\t\tupdateDocument(chat.id, {\r\n\t\t\t\tisRead: true,\r\n\t\t\t\tassignedUsers: [\r\n\t\t\t\t\totherUser,\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tdisplayName: currentUser.displayName,\r\n\t\t\t\t\t\tid: currentUser.id,\r\n\t\t\t\t\t\tnickname: currentUser.nickname,\r\n\t\t\t\t\t\tphotoURL: currentUser.photoURL,\r\n\t\t\t\t\t\tlastRead: chat.messages[chat.messages.length - 1].id,\r\n\t\t\t\t\t},\r\n\t\t\t\t],\r\n\t\t\t})\r\n\t\t}\r\n\t}, [seen])\r\n\r\n\tconst sendImage = async () => {\r\n\t\tconst acceptedFileTypes = ['image', 'video']\r\n\r\n\t\tif (acceptedFileTypes.includes(imgUpload.type.split('/')[0])) {\r\n\t\t\tconst storageRef = ref(\r\n\t\t\t\tprojectStorage,\r\n\t\t\t\t`imgs/${chat.assignedUsersId[0] + chat.assignedUsersId[1]}/${uuid() + imgUpload.name}`\r\n\t\t\t)\r\n\t\t\tconst uploadTask = uploadBytes(storageRef, imgUpload)\r\n\r\n\t\t\tuploadTask.then(snapshot => {\r\n\t\t\t\tgetDownloadURL(snapshot.ref).then(async downloadURL => {\r\n\t\t\t\t\tconst commentToAdd = {\r\n\t\t\t\t\t\tid: uniqueId,\r\n\t\t\t\t\t\tdisplayName: user.displayName,\r\n\t\t\t\t\t\tphotoURL: user.photoURL,\r\n\t\t\t\t\t\t// content: newComment,\r\n\t\t\t\t\t\tfileType: imgUpload.type.includes('image/') ? 'image' : 'video',\r\n\t\t\t\t\t\timage: downloadURL,\r\n\t\t\t\t\t\tcreatedAt: timestamp.fromDate(new Date()),\r\n\t\t\t\t\t\tcreatedBy: user.uid,\r\n\t\t\t\t\t\tresponse: messageResponse !== null ? messageResponse : null,\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif (isAssignedUser) {\r\n\t\t\t\t\t\tawait updateDocument(chat.id, {\r\n\t\t\t\t\t\t\tmessages: [...chat.messages, commentToAdd],\r\n\t\t\t\t\t\t\tupdatedAt: timestamp.fromDate(new Date()),\r\n\t\t\t\t\t\t\tisRead: false,\r\n\t\t\t\t\t\t})\r\n\r\n\t\t\t\t\t\tif (!response.error) {\r\n\t\t\t\t\t\t\tsetSeen(!seen)\r\n\t\t\t\t\t\t\tscrollToBottom()\r\n\t\t\t\t\t\t\tsetImgUpload(null)\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t})\r\n\t\t}\r\n\t}\r\n\r\n\tconst handleImageUpload = async e => {\r\n\t\tconst imageFile = e.target.files[0]\r\n\r\n\t\tconst options = {\r\n\t\t\tmaxSizeMB: 1,\r\n\t\t\tmaxWidthOrHeight: 1920,\r\n\t\t\tuseWebWorker: true,\r\n\t\t}\r\n\t\ttry {\r\n\t\t\tconst compressedFile = await imageCompression(imageFile, options)\r\n\t\t\tawait setImgUpload(compressedFile)\r\n\t\t} catch (error) {\r\n\t\t\tconsole.log(error)\r\n\t\t}\r\n\t}\r\n\r\n\tconst handleSubmit = e => {\r\n\t\te.preventDefault()\r\n\r\n\t\tif (imgUpload) {\r\n\t\t\tsendImage()\r\n\t\t} else {\r\n\t\t\tsendMessage()\r\n\t\t}\r\n\t}\r\n\r\n\tconst handleKey = e => {\r\n\t\te.code === 'Enter' && handleSubmit(e)\r\n\t}\r\n\r\n\tconst [fileThumbnail, setFileThumbnail] = useState('')\r\n\r\n\tconst handleFileChange = e => {\r\n\t\thandleImageUpload(e)\r\n\t\tsetFileThumbnail(URL.createObjectURL(e.target.files[0]))\r\n\t}\r\n\r\n\tconst resetFileInput = e => {\r\n\t\te.preventDefault()\r\n\t\tfileInputRef.current.value = ''\r\n\t\tsetImgUpload(null)\r\n\t}\r\n\r\n\tconst handleEmojis = e => {\r\n\t\tsetNewComment(newComment => newComment + e.emoji)\r\n\t}\r\n\r\n\treturn (\r\n\t\tchat && (\r\n\t\t\t<form onSubmit={handleSubmit}>\r\n\t\t\t\t{messageResponse !== null && (\r\n\t\t\t\t\t<div className='response'>\r\n\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t<p className='response__to'>\r\n\t\t\t\t\t\t\t\tResponding to{' '}\r\n\t\t\t\t\t\t\t\t<span>\r\n\t\t\t\t\t\t\t\t\t{chat.messages[messageResponse].displayName === user.displayName ? (\r\n\t\t\t\t\t\t\t\t\t\t'yourself'\r\n\t\t\t\t\t\t\t\t\t) : (\r\n\t\t\t\t\t\t\t\t\t\t<b>{chat.messages[messageResponse].displayName}</b>\r\n\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t</p>\r\n\t\t\t\t\t\t\t<p className='response__content'>\r\n\t\t\t\t\t\t\t\t{chat.messages[messageResponse].content && (\r\n\t\t\t\t\t\t\t\t\t<>\r\n\t\t\t\t\t\t\t\t\t\t{chat.messages[messageResponse].content.substring(0, 70)}\r\n\t\t\t\t\t\t\t\t\t\t{chat.messages[messageResponse].content.length > 70 ? <span>...</span> : ''}\r\n\t\t\t\t\t\t\t\t\t</>\r\n\t\t\t\t\t\t\t\t)}\r\n\r\n\t\t\t\t\t\t\t\t{chat.messages[messageResponse].image && chat.messages[messageResponse].fileType === 'image'\r\n\t\t\t\t\t\t\t\t\t? 'Image'\r\n\t\t\t\t\t\t\t\t\t: ''}\r\n\t\t\t\t\t\t\t\t{chat.messages[messageResponse].image && chat.messages[messageResponse].fileType === 'video'\r\n\t\t\t\t\t\t\t\t\t? 'Video'\r\n\t\t\t\t\t\t\t\t\t: ''}\r\n\t\t\t\t\t\t\t</p>\r\n\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t<div className='response__close-btn' onClick={() => onMessageResponse(null)}>\r\n\t\t\t\t\t\t\t<i className='fa-solid fa-xmark'></i>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t)}\r\n\r\n\t\t\t\t<div className='add-comment'>\r\n\t\t\t\t\t<label className='attach-image'>\r\n\t\t\t\t\t\t<input ref={fileInputRef} type='file' accept='video/*, image/*' onChange={e => handleFileChange(e)} />\r\n\t\t\t\t\t\t<i className='fa-regular fa-image'></i>\r\n\t\t\t\t\t</label>\r\n\r\n\t\t\t\t\t<div className='message-field'>\r\n\t\t\t\t\t\t<div className='column'>\r\n\t\t\t\t\t\t\t{imgUpload && (\r\n\t\t\t\t\t\t\t\t<div className='thumbnails'>\r\n\t\t\t\t\t\t\t\t\t<div className='file-thumbnail'>\r\n\t\t\t\t\t\t\t\t\t\t<img src={fileThumbnail} alt='' />\r\n\t\t\t\t\t\t\t\t\t\t<button className='remove-img' onClick={e => resetFileInput(e)}>\r\n\t\t\t\t\t\t\t\t\t\t\t<i className='fa-solid fa-xmark close-btn'></i>\r\n\t\t\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t<label>\r\n\t\t\t\t\t\t\t\t<input\r\n\t\t\t\t\t\t\t\t\tmaxLength='900'\r\n\t\t\t\t\t\t\t\t\tplaceholder='Aa'\r\n\t\t\t\t\t\t\t\t\tonChange={e => setNewComment(e.target.value)}\r\n\t\t\t\t\t\t\t\t\tvalue={newComment}\r\n\t\t\t\t\t\t\t\t\tonKeyDown={e => handleKey(e)}\r\n\t\t\t\t\t\t\t\t\tref={inputRef}\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t</label>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\tclassName='toggle-emoji-picker'\r\n\t\t\t\t\t\t\tonClick={e => {\r\n\t\t\t\t\t\t\t\te.preventDefault()\r\n\t\t\t\t\t\t\t\tsetShowEmojis(!showEmojis)\r\n\t\t\t\t\t\t\t}}>\r\n\t\t\t\t\t\t\t<i className='fa-regular fa-face-smile'></i>\r\n\t\t\t\t\t\t</button>\r\n\r\n\t\t\t\t\t\t{showEmojis && (\r\n\t\t\t\t\t\t\t<OutsideClickHandler\r\n\t\t\t\t\t\t\t\tonOutsideClick={() => {\r\n\t\t\t\t\t\t\t\t\tsetShowEmojis(false)\r\n\t\t\t\t\t\t\t\t}}>\r\n\t\t\t\t\t\t\t\t<EmojiPicker\r\n\t\t\t\t\t\t\t\t\tclassName='emoji-picker'\r\n\t\t\t\t\t\t\t\t\tonEmojiClick={e => {\r\n\t\t\t\t\t\t\t\t\t\thandleEmojis(e)\r\n\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\ttheme={Theme.DARK}\r\n\t\t\t\t\t\t\t\t\tpreviewConfig={{\r\n\t\t\t\t\t\t\t\t\t\tdefaultCaption: '',\r\n\t\t\t\t\t\t\t\t\t\tdefaultEmoji: null,\r\n\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t// lazyLoadEmojis={true}\r\n\t\t\t\t\t\t\t\t\temojiStyle={EmojiStyle.NATIVE}\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t</OutsideClickHandler>\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t{!imgUpload && newComment.trim() === '' && (\r\n\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\tclassName='input-tool'\r\n\t\t\t\t\t\t\tonClick={e => {\r\n\t\t\t\t\t\t\t\tsetFastEmoji(e.target.innerText)\r\n\t\t\t\t\t\t\t\tsetSendFastEmoji(true)\r\n\t\t\t\t\t\t\t\t// sendMessage()\r\n\t\t\t\t\t\t\t}}>\r\n\t\t\t\t\t\t\t{chat.chatEmoji && <Emoji unified={chat.chatEmoji} emojiStyle={EmojiStyle.NATIVE} size={33} />}\r\n\t\t\t\t\t\t</button>\r\n\t\t\t\t\t)}\r\n\r\n\t\t\t\t\t{(newComment.trim() !== '' || imgUpload) && (\r\n\t\t\t\t\t\t<button type='submit' className='input-tool'>\r\n\t\t\t\t\t\t\t<i className='fa-solid fa-paper-plane'></i>\r\n\t\t\t\t\t\t</button>\r\n\t\t\t\t\t)}\r\n\t\t\t\t</div>\r\n\t\t\t\t{newComment.length >= 900 && <p className='error'>Message can't be longer than 900 characters</p>}\r\n\t\t\t</form>\r\n\t\t)\r\n\t)\r\n}\r\n\r\nexport default MessageField\r\n","export default __webpack_public_path__ + \"static/media/british-person.a8ef58d2.jpg\";","// Components\r\nimport Avatar from '../Avatar/Avatar'\r\n\r\n// Styles && Assets\r\nimport britImg from '../../assets/british-person.jpg'\r\nimport Modal from '../Modal/Modal'\r\n\r\nconst ThemePreview = ({\r\n\totherUserMessage,\r\n\tcurUserMessage,\r\n\tbgDark,\r\n\tborderRadius,\r\n\ttextColors,\r\n\tinputColors,\r\n\tconfirmCustomTheme,\r\n\tsetConfirmCustomTheme,\r\n\tsubmitCustomTheme,\r\n\teditedTheme,\r\n\tsetShowThemePicker,\r\n\tsetShowThemeCreator,\r\n\tbuttonColor,\r\n\tname,\r\n}) => {\r\n\tconst spreadColors = () => {\r\n\t\tlet colors = null\r\n\r\n\t\tcurUserMessage.bg.forEach(color => {\r\n\t\t\tcolors === null ? (colors = `${color.value}`) : (colors = `${colors}, ${color.value}`)\r\n\t\t})\r\n\r\n\t\tif (curUserMessage.bg.length === 1) {\r\n\t\t\treturn `linear-gradient(${colors}, ${colors})`\r\n\t\t} else {\r\n\t\t\treturn `linear-gradient(${colors})`\r\n\t\t}\r\n\t}\r\n\r\n\tconst messageStyles = {\r\n\t\tbackgroundColor: otherUserMessage.bg,\r\n\t\tcolor: otherUserMessage.text,\r\n\t\tborder: `1px solid ${otherUserMessage.border}`,\r\n\t}\r\n\r\n\tconst messageOwnerStyles = {\r\n\t\tbackgroundImage: `${spreadColors()}`,\r\n\t\tbackgroundAttachment: 'fixed',\r\n\t\tbackgroundPosition: 'center 100%',\r\n\t\tbackgroundSize: 'auto 35%',\r\n\t\tborderRadius: '25px',\r\n\t\tborder: `1px solid ${curUserMessage.border}`,\r\n\t\tcolor: curUserMessage.text,\r\n\t}\r\n\r\n\treturn (\r\n\t\t<div className='theme-creator__preview'>\r\n\t\t\t<div className='chat-preview' style={{ backgroundColor: bgDark.value, borderRadius: `${borderRadius.value}px` }}>\r\n\t\t\t\t<div className='chat-preview__top-bar'>\r\n\t\t\t\t\t<div className='chat-preview__top-bar__user'>\r\n\t\t\t\t\t\t<Avatar src={britImg} />\r\n\t\t\t\t\t\t<span style={{ color: textColors.primary }}>John Doe</span>\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t<i className='fa-solid fa-ellipsis-vertical' style={{ color: textColors.accent }}></i>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div className='chat-preview__messages'>\r\n\t\t\t\t\t<div className='message owner' style={{ ...messageOwnerStyles, borderRadius: '25px 25px 5px 25px' }}>\r\n\t\t\t\t\t\tHello mate\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div className='message owner' style={{ ...messageOwnerStyles, borderRadius: '25px 5px 25px 25px' }}>\r\n\t\t\t\t\t\tit's tuesday init?\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t<div className='centered' style={{ color: textColors.lowContrast }}>\r\n\t\t\t\t\t\tSet quick emoji to \r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t<div className='message' style={{ ...messageStyles, borderRadius: '25px 25px 25px 5px' }}>\r\n\t\t\t\t\t\toh yes yes\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t<div className='message' style={{ ...messageStyles, borderRadius: '5px 25px 25px 5px' }}>\r\n\t\t\t\t\t\twhat a lovely weather we have today\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t<div className='message' style={{ ...messageStyles, borderRadius: '5px 25px 25px 25px' }}>\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t<br />\r\n\r\n\t\t\t\t\t<div className='message owner' style={{ ...messageOwnerStyles, borderRadius: '25px 25px 25px 25px' }}>\r\n\t\t\t\t\t\t*sips tea *\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div className='flex-row'>\r\n\t\t\t\t\t<i className='fa-regular fa-image' style={{ color: textColors.accent }}></i>\r\n\t\t\t\t\t<div\r\n\t\t\t\t\t\tclassName='chat-preview__input'\r\n\t\t\t\t\t\tstyle={{\r\n\t\t\t\t\t\t\tbackgroundColor: inputColors.bg,\r\n\t\t\t\t\t\t\tcolor: inputColors.text,\r\n\t\t\t\t\t\t\tborder: `1px solid ${inputColors.border}`,\r\n\t\t\t\t\t\t}}>\r\n\t\t\t\t\t\t<span>I love tea </span>\r\n\r\n\t\t\t\t\t\t<i className='fa-regular fa-face-smile' style={{ color: textColors.accent }}></i>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div className='chat-preview__quick-emoji'></div>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\r\n\t\t\t<Modal show={confirmCustomTheme} setShow={() => setConfirmCustomTheme(false)}>\r\n\t\t\t\t<h3>Are you sure you want to proceed?</h3>\r\n\t\t\t\t<div className='btn-group'>\r\n\t\t\t\t\t<div className='btn btn--secondary' onClick={() => setConfirmCustomTheme(false)}>\r\n\t\t\t\t\t\tgo back\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div className='btn' onClick={() => submitCustomTheme()}>\r\n\t\t\t\t\t\t{editedTheme !== null ? 'edit' : 'create'} theme\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t</Modal>\r\n\r\n\t\t\t<div className='btn-group'>\r\n\t\t\t\t<button\r\n\t\t\t\t\tclassName='btn btn--secondary'\r\n\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\tsetShowThemeCreator(false)\r\n\t\t\t\t\t\tsetShowThemePicker(true)\r\n\t\t\t\t\t}}\r\n\t\t\t\t\tstyle={{\r\n\t\t\t\t\t\tcolor: textColors.accent,\r\n\t\t\t\t\t\tborder: `1px solid ${textColors.accent}`,\r\n\t\t\t\t\t\tborderRadius: `${borderRadius.value}px`,\r\n\t\t\t\t\t}}>\r\n\t\t\t\t\tcancel\r\n\t\t\t\t</button>\r\n\r\n\t\t\t\t{name.length > 0 && (\r\n\t\t\t\t\t<button\r\n\t\t\t\t\t\ttype='submit'\r\n\t\t\t\t\t\tclassName='btn'\r\n\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\tsetConfirmCustomTheme(true)\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t\tstyle={{\r\n\t\t\t\t\t\t\tcolor: buttonColor.value,\r\n\t\t\t\t\t\t\tborderRadius: `${borderRadius.value}px`,\r\n\t\t\t\t\t\t\tborder: `1px solid ${textColors.accent}`,\r\n\t\t\t\t\t\t\tbackgroundColor: textColors.accent,\r\n\t\t\t\t\t\t}}>\r\n\t\t\t\t\t\t{editedTheme !== null ? 'edit' : 'create'}\r\n\t\t\t\t\t</button>\r\n\t\t\t\t)}\r\n\r\n\t\t\t\t{name.length <= 0 && (\r\n\t\t\t\t\t<button\r\n\t\t\t\t\t\tclassName='btn'\r\n\t\t\t\t\t\tdisabled\r\n\t\t\t\t\t\tstyle={{\r\n\t\t\t\t\t\t\tcolor: buttonColor.value,\r\n\t\t\t\t\t\t\tborderRadius: `${borderRadius.value}px`,\r\n\t\t\t\t\t\t\tborder: `1px solid ${textColors.accent}`,\r\n\t\t\t\t\t\t\tbackgroundColor: textColors.accent,\r\n\t\t\t\t\t\t}}>\r\n\t\t\t\t\t\t{editedTheme !== null ? 'edit' : 'create'}\r\n\t\t\t\t\t</button>\r\n\t\t\t\t)}\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t)\r\n}\r\n\r\nexport default ThemePreview\r\n","const Field = ({ title, setShow, show, children }) => {\r\n\treturn (\r\n\t\t<div className='field'>\r\n\t\t\t<p\r\n\t\t\t\tonClick={() => {\r\n\t\t\t\t\tsetShow()\r\n\t\t\t\t}}>\r\n\t\t\t\t<i className={`fa-solid fa-angle-right ${show ? 'active' : ''}`}></i>\r\n\t\t\t\t<span>{title}</span>\r\n\t\t\t</p>\r\n\r\n\t\t\t{show && children}\r\n\t\t</div>\r\n\t)\r\n}\r\n\r\nexport default Field\r\n","// Styles\r\nimport './ColorPicker.scss'\r\n\r\nconst ColorPicker = ({ value, setValue, separator, children }) => {\r\n\treturn (\r\n\t\t<>\r\n\t\t\t{separator && (\r\n\t\t\t\t<div className='separator'>\r\n\t\t\t\t\t<span>{separator}</span>\r\n\t\t\t\t</div>\r\n\t\t\t)}\r\n\t\t\t<div className='color-picker'>\r\n\t\t\t\t<input\r\n\t\t\t\t\ttype='text'\r\n\t\t\t\t\tclassName='color-picker__value'\r\n\t\t\t\t\tvalue={value}\r\n\t\t\t\t\tonChange={e => {\r\n\t\t\t\t\t\tsetValue(e)\r\n\t\t\t\t\t}}\r\n\t\t\t\t/>\r\n\t\t\t\t<input\r\n\t\t\t\t\ttype='color'\r\n\t\t\t\t\tvalue={value}\r\n\t\t\t\t\tonChange={e => {\r\n\t\t\t\t\t\tsetValue(e)\r\n\t\t\t\t\t}}\r\n\t\t\t\t/>\r\n\r\n\t\t\t\t{children}\r\n\t\t\t</div>\r\n\t\t</>\r\n\t)\r\n}\r\n\r\nexport default ColorPicker\r\n","import React, { useState } from 'react'\r\nimport { useFirestore } from '../../hooks/useFirestore'\r\n\r\n// Components\r\nimport ThemePreview from './ThemePreview'\r\nimport Field from './Field.js'\r\nimport ColorPicker from '../ColorPicker/ColorPicker'\r\n\r\n// Styles && Assets\r\nimport './ThemeCreator.scss'\r\n\r\nexport default function ThemeCreator({\r\n\tsetShowThemePicker,\r\n\tsetShowThemeCreator,\r\n\tchat,\r\n\teditedTheme,\r\n\tsetConfirmCustomTheme,\r\n\tconfirmCustomTheme,\r\n}) {\r\n\tconst { updateDocument } = useFirestore('projects')\r\n\r\n\tconst [name, setName] = useState(editedTheme ? editedTheme.name : '')\r\n\tconst [bgDark, setBgDark] = useState({\r\n\t\tshow: true,\r\n\t\tvalue: editedTheme ? editedTheme.colors.bgDark : '#121212',\r\n\t})\r\n\tconst [bgSecondary, setBgSecondary] = useState({\r\n\t\tshow: false,\r\n\t\tvalue: editedTheme ? editedTheme.colors.bgSecondary : '#1e1e1e',\r\n\t})\r\n\r\n\tconst [borderRadius, setBorderRadius] = useState({\r\n\t\tshow: false,\r\n\t\tvalue: editedTheme ? editedTheme.borderRadius : 8,\r\n\t})\r\n\tconst [curUserMessage, setCurUserMessage] = useState({\r\n\t\tshow: false,\r\n\t\tbg: editedTheme\r\n\t\t\t? editedTheme.colors.msgBgOwner\r\n\t\t\t: [\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tid: 0,\r\n\t\t\t\t\t\tvalue: '#643e7a',\r\n\t\t\t\t\t},\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tid: 1,\r\n\t\t\t\t\t\tvalue: '#643e7a',\r\n\t\t\t\t\t},\r\n\t\t\t  ],\r\n\t\ttext: editedTheme ? editedTheme.colors.messageColorOwner : '#cacaca',\r\n\t\tborder: editedTheme ? editedTheme.colors.msgBorderOwner : '#252525',\r\n\t})\r\n\r\n\tconst [otherUserMessage, setOtherUserMessage] = useState({\r\n\t\tshow: false,\r\n\t\tbg: editedTheme ? editedTheme.colors.msgBg : '#1e1e1e',\r\n\t\ttext: editedTheme ? editedTheme.colors.messageColor : '#cacaca',\r\n\t\tborder: editedTheme ? editedTheme.colors.msgBorder : '#252525',\r\n\t})\r\n\r\n\tconst [inputColors, setInputColors] = useState({\r\n\t\tshow: false,\r\n\t\tbg: editedTheme ? editedTheme.colors.inputBg : '#1e1e1e',\r\n\t\ttext: editedTheme ? editedTheme.colors.inputText : '#c4c4c4',\r\n\t\tborder: editedTheme ? editedTheme.colors.inputBorder : '#1e1e1e',\r\n\t})\r\n\r\n\tconst [textColors, setTextColors] = useState({\r\n\t\tshow: false,\r\n\t\tprimary: editedTheme ? editedTheme.colors.textPrimary : '#ffffff',\r\n\t\taccent: editedTheme ? editedTheme.colors.textAccent : '#643e7a',\r\n\t\tlowContrast: editedTheme ? editedTheme.colors.textLowContrast : '#646464',\r\n\t\tbtn: editedTheme ? editedTheme.colors.btnText : '#ffffff',\r\n\t})\r\n\tconst [buttonColor, setButtonColor] = useState({\r\n\t\tshow: false,\r\n\t\tvalue: editedTheme ? editedTheme.colors.buttonColor : '#ffffff',\r\n\t})\r\n\r\n\tconst updateMessageBg = (index, e) => {\r\n\t\tlet newArr = [...curUserMessage.bg]\r\n\t\tnewArr[index] = { value: e.target.value, id: index }\r\n\t\tsetCurUserMessage({ ...curUserMessage, bg: newArr })\r\n\t}\r\n\r\n\tconst submitCustomTheme = async () => {\r\n\t\t// setDoc(doc(projectFirestore, 'themes', 'green'), {\r\n\t\t// \tid: name,\r\n\t\t// \tname: name,\r\n\t\t// \tcolors: {\r\n\t\t// \t\tbgDark: bgDark.value,\r\n\t\t// \t\tbgSecondary: bgSecondary.value,\r\n\t\t// \t\tinputBg: inputColors.bg,\r\n\t\t// \t\tinputText: inputColors.text,\r\n\t\t// \t\ttextAccent: textColors.accent,\r\n\t\t// \t\ttextLowContrast: textColors.lowContrast,\r\n\t\t// \t\tmsgBg: otherUserMessage.bg,\r\n\t\t// \t\tmessageColor: otherUserMessage.text,\r\n\t\t// \t\tmsgBgOwner: curUserMessage.bg,\r\n\t\t// \t\tmessageColorOwner: curUserMessage.text,\r\n\t\t// \t},\r\n\t\t// \tborderRadius: borderRadius.value,\r\n\t\t// })\r\n\r\n\t\tconst themeToAdd = {\r\n\t\t\tid: `${name}`,\r\n\t\t\tname: `${name}`,\r\n\t\t\tcolors: {\r\n\t\t\t\tbgDark: `${bgDark.value}`,\r\n\t\t\t\tbgSecondary: `${bgSecondary.value}`,\r\n\t\t\t\tinputBg: `${inputColors.bg}`,\r\n\t\t\t\tinputText: `${inputColors.text}`,\r\n\t\t\t\tinputBorder: `${inputColors.border}`,\r\n\t\t\t\ttextPrimary: `${textColors.primary}`,\r\n\t\t\t\ttextAccent: `${textColors.accent}`,\r\n\t\t\t\ttextLowContrast: `${textColors.lowContrast}`,\r\n\t\t\t\tmsgBg: `${otherUserMessage.bg}`,\r\n\t\t\t\tmessageColor: `${otherUserMessage.text}`,\r\n\t\t\t\tmsgBgOwner: curUserMessage.bg,\r\n\t\t\t\tmessageColorOwner: `${curUserMessage.text}`,\r\n\t\t\t\tmsgBorderOwner: `${curUserMessage.border}`,\r\n\t\t\t\tmsgBorder: `${otherUserMessage.border}`,\r\n\t\t\t\tbuttonColor: `${buttonColor.value}`,\r\n\t\t\t},\r\n\t\t\tborderRadius: borderRadius.value,\r\n\t\t\tisCustom: true,\r\n\t\t}\r\n\t\tif (editedTheme === null) {\r\n\t\t\tawait updateDocument(chat.id, {\r\n\t\t\t\tcustomThemes: [...chat.customThemes, themeToAdd],\r\n\t\t\t})\r\n\t\t\tsetConfirmCustomTheme(false)\r\n\t\t\tsetShowThemeCreator(false)\r\n\t\t}\r\n\t\tif (editedTheme !== null) {\r\n\t\t\tawait updateDocument(chat.id, {\r\n\t\t\t\tcustomThemes: updateCustomThemes(editedTheme, themeToAdd),\r\n\t\t\t\ttheme: {\r\n\t\t\t\t\tisCustom: true,\r\n\t\t\t\t\tname: name,\r\n\t\t\t\t},\r\n\t\t\t})\r\n\t\t\tsetConfirmCustomTheme(false)\r\n\t\t\tsetShowThemeCreator(false)\r\n\t\t}\r\n\t}\r\n\r\n\tconst updateCustomThemes = (editedTheme, theme) => {\r\n\t\tconst index = chat.customThemes.indexOf(editedTheme)\r\n\t\tlet newArr = [...chat.customThemes]\r\n\r\n\t\tnewArr[index] = theme\r\n\r\n\t\treturn newArr\r\n\t}\r\n\r\n\treturn (\r\n\t\t<div className='theme-creator'>\r\n\t\t\t<form className='theme-creator__form custom-scrollbar'>\r\n\t\t\t\t<div className='field'>\r\n\t\t\t\t\t<p>Name your theme</p>\r\n\r\n\t\t\t\t\t<input type='text' placeholder='Aa' required value={name} onChange={e => setName(e.target.value)} />\r\n\t\t\t\t</div>\r\n\r\n\t\t\t\t<Field\r\n\t\t\t\t\ttitle={'Background color'}\r\n\t\t\t\t\tsetShow={() => setBgDark({ ...bgDark, show: !bgDark.show })}\r\n\t\t\t\t\tshow={bgDark.show}>\r\n\t\t\t\t\t<ColorPicker\r\n\t\t\t\t\t\tvalue={bgDark.value}\r\n\t\t\t\t\t\tsetValue={e => {\r\n\t\t\t\t\t\t\tsetBgDark({ ...bgDark, value: e.target.value })\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t/>\r\n\t\t\t\t</Field>\r\n\r\n\t\t\t\t<Field\r\n\t\t\t\t\ttitle={'Secondary background color'}\r\n\t\t\t\t\tsetShow={() => setBgSecondary({ ...bgSecondary, show: !bgSecondary.show })}\r\n\t\t\t\t\tshow={bgSecondary.show}>\r\n\t\t\t\t\t<ColorPicker\r\n\t\t\t\t\t\tvalue={bgSecondary.value}\r\n\t\t\t\t\t\tsetValue={e => {\r\n\t\t\t\t\t\t\tsetBgSecondary({ ...bgSecondary, value: e.target.value })\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t/>\r\n\t\t\t\t</Field>\r\n\r\n\t\t\t\t<Field\r\n\t\t\t\t\ttitle={'Input colors'}\r\n\t\t\t\t\tsetShow={() => setInputColors({ ...inputColors, show: !inputColors.show })}\r\n\t\t\t\t\tshow={inputColors.show}>\r\n\t\t\t\t\t<ColorPicker\r\n\t\t\t\t\t\tvalue={inputColors.bg}\r\n\t\t\t\t\t\tsetValue={e => {\r\n\t\t\t\t\t\t\tsetInputColors({ ...inputColors, bg: e.target.value })\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t\tseparator={'background'}\r\n\t\t\t\t\t/>\r\n\t\t\t\t\t<ColorPicker\r\n\t\t\t\t\t\tvalue={inputColors.text}\r\n\t\t\t\t\t\tsetValue={e => {\r\n\t\t\t\t\t\t\tsetInputColors({ ...inputColors, text: e.target.value })\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t\tseparator={'text'}\r\n\t\t\t\t\t/>\r\n\t\t\t\t\t<ColorPicker\r\n\t\t\t\t\t\tvalue={inputColors.border}\r\n\t\t\t\t\t\tsetValue={e => {\r\n\t\t\t\t\t\t\tsetInputColors({ ...inputColors, border: e.target.value })\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t\tseparator={'border'}\r\n\t\t\t\t\t/>\r\n\t\t\t\t</Field>\r\n\r\n\t\t\t\t<Field\r\n\t\t\t\t\ttitle={'Button color'}\r\n\t\t\t\t\tsetShow={() => setButtonColor({ ...buttonColor, show: !buttonColor.show })}\r\n\t\t\t\t\tshow={buttonColor.show}>\r\n\t\t\t\t\t<ColorPicker\r\n\t\t\t\t\t\tvalue={buttonColor.value}\r\n\t\t\t\t\t\tsetValue={e => {\r\n\t\t\t\t\t\t\tsetButtonColor({ ...buttonColor, value: e.target.value })\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t/>\r\n\t\t\t\t</Field>\r\n\r\n\t\t\t\t<Field\r\n\t\t\t\t\ttitle={'Text colors'}\r\n\t\t\t\t\tsetShow={() => setTextColors({ ...textColors, show: !textColors.show })}\r\n\t\t\t\t\tshow={textColors.show}>\r\n\t\t\t\t\t<ColorPicker\r\n\t\t\t\t\t\tvalue={textColors.primary}\r\n\t\t\t\t\t\tsetValue={e => {\r\n\t\t\t\t\t\t\tsetTextColors({ ...textColors, primary: e.target.value })\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t\tseparator={'primary'}\r\n\t\t\t\t\t/>\r\n\t\t\t\t\t<ColorPicker\r\n\t\t\t\t\t\tvalue={textColors.accent}\r\n\t\t\t\t\t\tsetValue={e => {\r\n\t\t\t\t\t\t\tsetTextColors({ ...textColors, accent: e.target.value })\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t\tseparator={'accent'}\r\n\t\t\t\t\t/>\r\n\t\t\t\t\t<ColorPicker\r\n\t\t\t\t\t\tvalue={textColors.lowContrast}\r\n\t\t\t\t\t\tsetValue={e => {\r\n\t\t\t\t\t\t\tsetTextColors({ ...textColors, lowContrast: e.target.value })\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t\tseparator={'low contrast'}\r\n\t\t\t\t\t/>\r\n\t\t\t\t</Field>\r\n\r\n\t\t\t\t<Field\r\n\t\t\t\t\ttitle={'Other user messages'}\r\n\t\t\t\t\tsetShow={() => setOtherUserMessage({ ...otherUserMessage, show: !otherUserMessage.show })}\r\n\t\t\t\t\tshow={otherUserMessage.show}>\r\n\t\t\t\t\t<ColorPicker\r\n\t\t\t\t\t\tvalue={otherUserMessage.bg}\r\n\t\t\t\t\t\tsetValue={e => {\r\n\t\t\t\t\t\t\tsetOtherUserMessage({ ...otherUserMessage, bg: e.target.value })\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t\tseparator={'background'}\r\n\t\t\t\t\t/>\r\n\t\t\t\t\t<ColorPicker\r\n\t\t\t\t\t\tvalue={otherUserMessage.text}\r\n\t\t\t\t\t\tsetValue={e => {\r\n\t\t\t\t\t\t\tsetOtherUserMessage({ ...otherUserMessage, text: e.target.value })\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t\tseparator={'text'}\r\n\t\t\t\t\t/>\r\n\t\t\t\t\t<ColorPicker\r\n\t\t\t\t\t\tvalue={otherUserMessage.border}\r\n\t\t\t\t\t\tsetValue={e => {\r\n\t\t\t\t\t\t\tsetOtherUserMessage({ ...otherUserMessage, border: e.target.value })\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t\tseparator={'border'}\r\n\t\t\t\t\t/>\r\n\t\t\t\t</Field>\r\n\r\n\t\t\t\t<Field\r\n\t\t\t\t\ttitle={'Current user messages'}\r\n\t\t\t\t\tsetShow={() => setCurUserMessage({ ...curUserMessage, show: !curUserMessage.show })}\r\n\t\t\t\t\tshow={curUserMessage.show}>\r\n\t\t\t\t\t<div className='separator'>\r\n\t\t\t\t\t\t<span>background</span>\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t<div className='colors-list custom-scrollbar'>\r\n\t\t\t\t\t\t{curUserMessage.bg.map((color, index) => (\r\n\t\t\t\t\t\t\t<React.Fragment key={color.id}>\r\n\t\t\t\t\t\t\t\t<ColorPicker\r\n\t\t\t\t\t\t\t\t\tvalue={color.value}\r\n\t\t\t\t\t\t\t\t\tsetValue={e => {\r\n\t\t\t\t\t\t\t\t\t\tupdateMessageBg(index, e)\r\n\t\t\t\t\t\t\t\t\t}}>\r\n\t\t\t\t\t\t\t\t\t<i\r\n\t\t\t\t\t\t\t\t\t\tclassName='fa-solid fa-xmark remove-color'\r\n\t\t\t\t\t\t\t\t\t\tonClick={() =>\r\n\t\t\t\t\t\t\t\t\t\t\tsetCurUserMessage({ ...curUserMessage, bg: curUserMessage.bg.filter(c => c !== color) })\r\n\t\t\t\t\t\t\t\t\t\t}></i>\r\n\t\t\t\t\t\t\t\t</ColorPicker>\r\n\t\t\t\t\t\t\t</React.Fragment>\r\n\t\t\t\t\t\t))}\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t<div\r\n\t\t\t\t\t\tclassName='add-color'\r\n\t\t\t\t\t\tonClick={() =>\r\n\t\t\t\t\t\t\tsetCurUserMessage({\r\n\t\t\t\t\t\t\t\t...curUserMessage,\r\n\t\t\t\t\t\t\t\tbg: [...curUserMessage.bg, { value: '#643e7a', id: Math.random(0, 100) * 100 }],\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t}>\r\n\t\t\t\t\t\t<i className='fa-solid fa-plus'></i>\r\n\t\t\t\t\t\t<span>add another color</span>\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t<ColorPicker\r\n\t\t\t\t\t\tvalue={curUserMessage.text}\r\n\t\t\t\t\t\tsetValue={e => {\r\n\t\t\t\t\t\t\tsetCurUserMessage({ ...curUserMessage, text: e.target.value })\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t\tseparator={'text'}\r\n\t\t\t\t\t/>\r\n\r\n\t\t\t\t\t<ColorPicker\r\n\t\t\t\t\t\tvalue={curUserMessage.border}\r\n\t\t\t\t\t\tsetValue={e => {\r\n\t\t\t\t\t\t\tsetCurUserMessage({ ...curUserMessage, border: e.target.value })\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t\tseparator={'border'}\r\n\t\t\t\t\t/>\r\n\t\t\t\t</Field>\r\n\r\n\t\t\t\t<Field\r\n\t\t\t\t\ttitle={'Border radius'}\r\n\t\t\t\t\tsetShow={() => setBorderRadius({ ...borderRadius, show: !borderRadius.show })}\r\n\t\t\t\t\tshow={borderRadius.show}>\r\n\t\t\t\t\t<div className='flex-row'>\r\n\t\t\t\t\t\t<input\r\n\t\t\t\t\t\t\ttype='range'\r\n\t\t\t\t\t\t\tvalue={borderRadius.value}\r\n\t\t\t\t\t\t\tonChange={e => setBorderRadius({ ...borderRadius, value: e.target.value })}\r\n\t\t\t\t\t\t\tmin='0'\r\n\t\t\t\t\t\t\tmax='25'\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t<span>{borderRadius.value}px</span>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</Field>\r\n\t\t\t</form>\r\n\r\n\t\t\t<ThemePreview\r\n\t\t\t\totherUserMessage={otherUserMessage}\r\n\t\t\t\tcurUserMessage={curUserMessage}\r\n\t\t\t\tbgDark={bgDark}\r\n\t\t\t\tborderRadius={borderRadius}\r\n\t\t\t\ttextColors={textColors}\r\n\t\t\t\tinputColors={inputColors}\r\n\t\t\t\tconfirmCustomTheme={confirmCustomTheme}\r\n\t\t\t\tsetConfirmCustomTheme={setConfirmCustomTheme}\r\n\t\t\t\tsubmitCustomTheme={submitCustomTheme}\r\n\t\t\t\teditedTheme={editedTheme}\r\n\t\t\t\tsetShowThemeCreator={setShowThemeCreator}\r\n\t\t\t\tsetShowThemePicker={setShowThemePicker}\r\n\t\t\t\tname={name}\r\n\t\t\t\tbuttonColor={buttonColor}\r\n\t\t\t/>\r\n\t\t</div>\r\n\t)\r\n}\r\n","import { useFirestore } from '../../hooks/useFirestore'\r\nimport Modal from '../Modal/Modal'\r\n\r\n// Styles\r\nimport './ThemePicker.scss'\r\n\r\nconst ThemePicker = ({\r\n\tthemes,\r\n\tchat,\r\n\tsetShowThemeCreator,\r\n\tsetEditedTheme,\r\n\tsetConfirmThemeDelete,\r\n\tconfirmThemeDelete,\r\n}) => {\r\n\tconst { updateDocument } = useFirestore('projects')\r\n\r\n\tconst changeTheme = async theme => {\r\n\t\ttry {\r\n\t\t\tawait updateDocument(chat.id, {\r\n\t\t\t\ttheme: {\r\n\t\t\t\t\tname: theme.id,\r\n\t\t\t\t\tisCustom: theme.isCustom ? theme.isCustom : false,\r\n\t\t\t\t},\r\n\t\t\t})\r\n\t\t} catch (err) {\r\n\t\t\tconsole.log(err)\r\n\t\t}\r\n\t}\r\n\r\n\tconst spreadColors = theme => {\r\n\t\tlet colors = null\r\n\r\n\t\ttheme.colors.msgBgOwner.forEach(color => {\r\n\t\t\tcolors === null ? (colors = `${color.value}`) : (colors = `${colors}, ${color.value}`)\r\n\t\t})\r\n\r\n\t\tif (theme.colors.msgBgOwner.length === 1) {\r\n\t\t\treturn `linear-gradient(${colors}, ${colors})`\r\n\t\t} else {\r\n\t\t\treturn `linear-gradient(${colors})`\r\n\t\t}\r\n\t}\r\n\r\n\tconst removeCustomTheme = async theme => {\r\n\t\ttry {\r\n\t\t\tif (chat.theme && chat.theme.name === theme.id) {\r\n\t\t\t\tchangeTheme({ id: 'frosty', isCustom: false })\r\n\t\t\t}\r\n\t\t\tawait updateDocument(chat.id, {\r\n\t\t\t\tcustomThemes: [...chat.customThemes.filter(t => t !== theme)],\r\n\t\t\t})\r\n\t\t\tsetConfirmThemeDelete(null)\r\n\t\t} catch (err) {\r\n\t\t\tconsole.log(err)\r\n\t\t}\r\n\t}\r\n\r\n\tconst editCustomTheme = theme => {\r\n\t\tsetShowThemeCreator(true)\r\n\t\tsetEditedTheme(theme)\r\n\t}\r\n\r\n\treturn (\r\n\t\t<div className='theme-picker'>\r\n\t\t\t<div className='theme-picker__themes'>\r\n\t\t\t\t{themes &&\r\n\t\t\t\t\tchat &&\r\n\t\t\t\t\tthemes.map(theme => (\r\n\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\tclassName={`theme-picker__themes__theme ${\r\n\t\t\t\t\t\t\t\tchat.theme && theme.id === chat.theme.name && !theme.isCustom ? 'current' : ''\r\n\t\t\t\t\t\t\t}`}\r\n\t\t\t\t\t\t\tkey={theme.id}\r\n\t\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\t\tchangeTheme(theme)\r\n\t\t\t\t\t\t\t}}>\r\n\t\t\t\t\t\t\t<i\r\n\t\t\t\t\t\t\t\tclassName='fa-solid fa-check theme-tick'\r\n\t\t\t\t\t\t\t\tstyle={{\r\n\t\t\t\t\t\t\t\t\tbackgroundImage: spreadColors(theme),\r\n\t\t\t\t\t\t\t\t}}></i>\r\n\r\n\t\t\t\t\t\t\t<div className='theme-bg' style={{ background: spreadColors(theme) }}></div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t))}\r\n\t\t\t</div>\r\n\t\t\t<div className='separator'>\r\n\t\t\t\t<span>create your own theme</span>\r\n\t\t\t</div>\r\n\r\n\t\t\t<div className='theme-picker__themes'>\r\n\t\t\t\t{chat.customThemes.length > 0 &&\r\n\t\t\t\t\tchat.customThemes.map(theme => (\r\n\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\tkey={theme.id}\r\n\t\t\t\t\t\t\tclassName={`theme-picker__themes__theme ${\r\n\t\t\t\t\t\t\t\tchat.theme && theme.id === chat.theme.name && theme.isCustom === chat.theme.isCustom ? 'current' : ''\r\n\t\t\t\t\t\t\t}`}\r\n\t\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\t\tchangeTheme(theme)\r\n\t\t\t\t\t\t\t}}>\r\n\t\t\t\t\t\t\t<i\r\n\t\t\t\t\t\t\t\tclassName='fa-solid fa-check theme-tick'\r\n\t\t\t\t\t\t\t\tstyle={{\r\n\t\t\t\t\t\t\t\t\tbackgroundImage: `${spreadColors(theme)}`,\r\n\t\t\t\t\t\t\t\t}}></i>\r\n\t\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\t\tclassName='theme-bg'\r\n\t\t\t\t\t\t\t\tstyle={{\r\n\t\t\t\t\t\t\t\t\tbackground: spreadColors(theme),\r\n\t\t\t\t\t\t\t\t}}>\r\n\t\t\t\t\t\t\t\t<div className='theme-tools'>\r\n\t\t\t\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\t\t\t\tclassName='theme-tools__edit'\r\n\t\t\t\t\t\t\t\t\t\tonClick={e => {\r\n\t\t\t\t\t\t\t\t\t\t\te.stopPropagation()\r\n\t\t\t\t\t\t\t\t\t\t\teditCustomTheme(theme)\r\n\t\t\t\t\t\t\t\t\t\t}}>\r\n\t\t\t\t\t\t\t\t\t\t<i className='fa-solid fa-pen'></i>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\t\t\t\tclassName='theme-tools__remove'\r\n\t\t\t\t\t\t\t\t\t\tonClick={e => {\r\n\t\t\t\t\t\t\t\t\t\t\te.stopPropagation()\r\n\t\t\t\t\t\t\t\t\t\t\t// removeCustomTheme(theme)\r\n\t\t\t\t\t\t\t\t\t\t\tsetConfirmThemeDelete(theme)\r\n\t\t\t\t\t\t\t\t\t\t}}>\r\n\t\t\t\t\t\t\t\t\t\t<i className='fa-solid fa-trash-can'></i>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t))}\r\n\r\n\t\t\t\t{chat.customThemes.length < 3 && (\r\n\t\t\t\t\t<button\r\n\t\t\t\t\t\tclassName='create-theme'\r\n\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\tsetShowThemeCreator(true)\r\n\t\t\t\t\t\t\t// setShowThemePicker(false)\r\n\t\t\t\t\t\t}}>\r\n\t\t\t\t\t\t<i className='fa-solid fa-plus'></i>\r\n\t\t\t\t\t</button>\r\n\t\t\t\t)}\r\n\r\n\t\t\t\t<Modal show={confirmThemeDelete !== null} setShow={() => setConfirmThemeDelete(null)}>\r\n\t\t\t\t\t<h3>Are you sure you want to proceed?</h3>\r\n\t\t\t\t\t<div className='btn-group'>\r\n\t\t\t\t\t\t<div className='btn btn--50 btn--secondary' onClick={() => setConfirmThemeDelete(null)}>\r\n\t\t\t\t\t\t\tgo back\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<div className='btn btn--50' onClick={() => removeCustomTheme(confirmThemeDelete)}>\r\n\t\t\t\t\t\t\tdelete theme\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</Modal>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t)\r\n}\r\n\r\nexport default ThemePicker\r\n","import { useEffect, useState } from 'react'\r\nimport { useFirestore } from '../../../hooks/useFirestore'\r\nimport { timestamp } from '../../../firebase/config'\r\nimport { useCollection } from '../../../hooks/useCollection'\r\nimport { v4 as uuid } from 'uuid'\r\nimport { useDocument } from '../../../hooks/useDocument'\r\n\r\n// Components\r\nimport OutsideClickHandler from 'react-outside-click-handler'\r\nimport EmojiPicker, { EmojiStyle, Theme } from 'emoji-picker-react'\r\nimport Modal from '../../../components/Modal/Modal'\r\nimport Avatar from '../../../components/Avatar/Avatar'\r\nimport ThemeCreator from '../../../components/ThemeCreator/ThemeCreator'\r\nimport ThemePicker from '../../../components/ThemePicker/ThemePicker'\r\n\r\n// Styles && Assets\r\nimport './ChatOptions.scss'\r\nimport AvatarWithStatus from '../../../components/AvatarWithStatus/AvatarWithStatus'\r\n\r\nexport default function ChatOptions({ onMessageResponse, otherUser, chat, currentTheme, otherUserLocal }) {\r\n\tconst uniqueId = uuid()\r\n\r\n\tconst { updateDocument, response } = useFirestore('projects')\r\n\tconst { documents: themes } = useCollection('themes')\r\n\tconst { document: defaultThemeDoc } = useDocument('themes', 'frosty')\r\n\tconst { documents: users } = useCollection('users')\r\n\r\n\tconst [showEmojiPicker, setShowEmojiPicker] = useState(false)\r\n\tconst [showNicknameModal, setShowNicknameModal] = useState(false)\r\n\tconst [showNicknameInput, setShowNicknameInput] = useState(null)\r\n\tconst [newNickname, setNewNickname] = useState('')\r\n\tconst [showThemePicker, setShowThemePicker] = useState(false)\r\n\tconst [showThemeCreator, setShowThemeCreator] = useState(false)\r\n\tconst [editedTheme, setEditedTheme] = useState(defaultThemeDoc)\r\n\tconst [confirmCustomTheme, setConfirmCustomTheme] = useState(false)\r\n\tconst [confirmThemeDelete, setConfirmThemeDelete] = useState(null)\r\n\r\n\tuseEffect(() => {\r\n\t\tsetShowThemeCreator(false)\r\n\t\tsetShowNicknameModal(false)\r\n\t}, [chat.id])\r\n\r\n\tconst sendMessage = async content => {\r\n\t\tconst commentToAdd = {\r\n\t\t\tid: uniqueId,\r\n\t\t\tcontent: content,\r\n\t\t\tcreatedAt: timestamp.fromDate(new Date()),\r\n\t\t\tisSpecial: true,\r\n\t\t}\r\n\r\n\t\tawait updateDocument(chat.id, {\r\n\t\t\tmessages: [...chat.messages, commentToAdd],\r\n\t\t})\r\n\t\tif (!response.error) {\r\n\t\t\tonMessageResponse(null)\r\n\t\t}\r\n\t}\r\n\r\n\tconst changeChatEmoji = async e => {\r\n\t\tawait updateDocument(chat.id, {\r\n\t\t\tchatEmoji: e.unified,\r\n\t\t})\r\n\t\tif (!response.error) {\r\n\t\t\tsendMessage(`Set quick emoji to ${e.emoji}`)\r\n\t\t}\r\n\t}\r\n\r\n\tconst handleNicknameInput = u => {\r\n\t\tsetShowNicknameInput(u.id)\r\n\t}\r\n\r\n\tconst changeNickname = user => {\r\n\t\tif (newNickname.trim() !== '' && newNickname.trim().length < 80) {\r\n\t\t\tchat.assignedUsers.forEach(u => {\r\n\t\t\t\tif (u.id !== user.id) {\r\n\t\t\t\t\tupdateDocument(chat.id, {\r\n\t\t\t\t\t\tassignedUsers: [\r\n\t\t\t\t\t\t\tu,\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\tid: user.id,\r\n\t\t\t\t\t\t\t\tnickname: newNickname.trim(),\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t],\r\n\t\t\t\t\t})\r\n\t\t\t\t\tsetShowNicknameModal(false)\r\n\t\t\t\t}\r\n\t\t\t\tif (u.id === user.id) {\r\n\t\t\t\t\tsendMessage(`Set nickname of user ${getDoc(u.id).displayName} to ${newNickname.trim()}`, newNickname.trim())\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t}\r\n\t}\r\n\r\n\tconst spreadColors = theme => {\r\n\t\tlet colors = null\r\n\r\n\t\ttheme.colors.msgBgOwner.forEach(color => {\r\n\t\t\tcolors === null ? (colors = `${color.value}`) : (colors = `${colors}, ${color.value}`)\r\n\t\t})\r\n\r\n\t\tif (theme.colors.msgBgOwner.length === 1) {\r\n\t\t\treturn colors\r\n\t\t} else {\r\n\t\t\treturn `linear-gradient(${colors})`\r\n\t\t}\r\n\t}\r\n\r\n\tconst getDoc = id => {\r\n\t\tlet res = null\r\n\r\n\t\tif (users) {\r\n\t\t\tres = users.filter(doc => {\r\n\t\t\t\tif (doc.id === id) {\r\n\t\t\t\t\treturn true\r\n\t\t\t\t}\r\n\t\t\t\treturn false\r\n\t\t\t})[0]\r\n\t\t}\r\n\r\n\t\treturn res\r\n\t}\r\n\r\n\treturn (\r\n\t\t<aside className='chat-options'>\r\n\t\t\t{otherUser && <AvatarWithStatus userId={otherUser.id} linkToProfile={true} />}\r\n\r\n\t\t\t<h3>{otherUserLocal.nickname}</h3>\r\n\r\n\t\t\t<div\r\n\t\t\t\tclassName='option'\r\n\t\t\t\tonClick={() => {\r\n\t\t\t\t\tsetShowThemePicker(true)\r\n\t\t\t\t}}>\r\n\t\t\t\t<div className='option__icon' style={{ background: spreadColors(currentTheme) }}></div>\r\n\r\n\t\t\t\t<div className='option__name'>Change theme</div>\r\n\t\t\t</div>\r\n\r\n\t\t\t<div\r\n\t\t\t\tclassName='option'\r\n\t\t\t\tonClick={() => {\r\n\t\t\t\t\tsetShowEmojiPicker(true)\r\n\t\t\t\t}}>\r\n\t\t\t\t<div className='option__icon'>\r\n\t\t\t\t\t<i className='fa-solid fa-thumbs-up'></i>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div className='option__name'>Change emoji icon</div>\r\n\t\t\t</div>\r\n\r\n\t\t\t<div\r\n\t\t\t\tclassName='option'\r\n\t\t\t\tonClick={() => {\r\n\t\t\t\t\tsetShowNicknameModal(true)\r\n\t\t\t\t}}>\r\n\t\t\t\t<div className='option__icon'>Aa</div>\r\n\t\t\t\t<div className='option__name'>Edit nicknames</div>\r\n\t\t\t</div>\r\n\r\n\t\t\t{themes && (showThemePicker || showThemeCreator) && (\r\n\t\t\t\t<>\r\n\t\t\t\t\t<Modal\r\n\t\t\t\t\t\tshow={showThemePicker}\r\n\t\t\t\t\t\tsetShow={() => setShowThemePicker(false)}\r\n\t\t\t\t\t\tonClose={() => setConfirmThemeDelete(null)}\r\n\t\t\t\t\t\tdisableOCH={showThemeCreator}>\r\n\t\t\t\t\t\t<ThemePicker\r\n\t\t\t\t\t\t\tthemes={themes}\r\n\t\t\t\t\t\t\tchat={chat}\r\n\t\t\t\t\t\t\tsetShowThemeCreator={setShowThemeCreator}\r\n\t\t\t\t\t\t\tsetEditedTheme={setEditedTheme}\r\n\t\t\t\t\t\t\tsetConfirmThemeDelete={setConfirmThemeDelete}\r\n\t\t\t\t\t\t\tconfirmThemeDelete={confirmThemeDelete}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</Modal>\r\n\t\t\t\t\t<Modal\r\n\t\t\t\t\t\tshow={showThemeCreator}\r\n\t\t\t\t\t\tsetShow={() => setShowThemeCreator(false)}\r\n\t\t\t\t\t\tonClose={() => {\r\n\t\t\t\t\t\t\tsetEditedTheme(null)\r\n\t\t\t\t\t\t\tsetConfirmCustomTheme(false)\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t\tdisableOCH={confirmCustomTheme}>\r\n\t\t\t\t\t\t<ThemeCreator\r\n\t\t\t\t\t\t\tsetShowThemePicker={setShowThemePicker}\r\n\t\t\t\t\t\t\tsetShowThemeCreator={setShowThemeCreator}\r\n\t\t\t\t\t\t\tchat={chat}\r\n\t\t\t\t\t\t\teditedTheme={editedTheme}\r\n\t\t\t\t\t\t\tsetConfirmCustomTheme={setConfirmCustomTheme}\r\n\t\t\t\t\t\t\tconfirmCustomTheme={confirmCustomTheme}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</Modal>\r\n\t\t\t\t</>\r\n\t\t\t)}\r\n\r\n\t\t\t{showEmojiPicker && (\r\n\t\t\t\t<OutsideClickHandler\r\n\t\t\t\t\tonOutsideClick={() => {\r\n\t\t\t\t\t\tsetShowEmojiPicker(false)\r\n\t\t\t\t\t}}>\r\n\t\t\t\t\t<EmojiPicker\r\n\t\t\t\t\t\tclassName='emoji-picker'\r\n\t\t\t\t\t\tonEmojiClick={e => {\r\n\t\t\t\t\t\t\tchangeChatEmoji(e)\r\n\t\t\t\t\t\t\tsetShowEmojiPicker(false)\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t\ttheme={Theme.DARK}\r\n\t\t\t\t\t\tpreviewConfig={{\r\n\t\t\t\t\t\t\tdefaultCaption: '',\r\n\t\t\t\t\t\t\tdefaultEmoji: null,\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t// lazyLoadEmojis={true}\r\n\t\t\t\t\t\temojiStyle={EmojiStyle.NATIVE}\r\n\t\t\t\t\t/>\r\n\t\t\t\t</OutsideClickHandler>\r\n\t\t\t)}\r\n\r\n\t\t\t<Modal\r\n\t\t\t\tshow={showNicknameModal}\r\n\t\t\t\tsetShow={() => setShowNicknameModal(false)}\r\n\t\t\t\tonClose={() => {\r\n\t\t\t\t\tsetNewNickname('')\r\n\t\t\t\t\tsetShowNicknameInput(null)\r\n\t\t\t\t}}>\r\n\t\t\t\t{chat.assignedUsers.map(u => (\r\n\t\t\t\t\t// <OutsideClickHandler onOutsideClick={() => setShowNicknameInput(null)}>\r\n\t\t\t\t\t<div\r\n\t\t\t\t\t\tkey={u.id}\r\n\t\t\t\t\t\tclassName='user'\r\n\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\tsetNewNickname(' ')\r\n\t\t\t\t\t\t\thandleNicknameInput(u)\r\n\t\t\t\t\t\t}}>\r\n\t\t\t\t\t\t<div className='author'>\r\n\t\t\t\t\t\t\t<Avatar src={getDoc(u.id) !== null ? getDoc(u.id).photoURL : ''} />\r\n\t\t\t\t\t\t\t{showNicknameInput !== u.id && (\r\n\t\t\t\t\t\t\t\t<div className='flex-column'>\r\n\t\t\t\t\t\t\t\t\t<p className='user__display-name'>{u.nickname}</p>\r\n\t\t\t\t\t\t\t\t\t<p>Set nickname</p>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t{showNicknameInput === u.id && (\r\n\t\t\t\t\t\t\t\t<input\r\n\t\t\t\t\t\t\t\t\ttype='text'\r\n\t\t\t\t\t\t\t\t\tplaceholder={u.nickname}\r\n\t\t\t\t\t\t\t\t\tvalue={newNickname}\r\n\t\t\t\t\t\t\t\t\tonChange={e => {\r\n\t\t\t\t\t\t\t\t\t\tsetNewNickname(e.target.value)\r\n\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t{showNicknameInput !== u.id && <i className='fa-solid fa-pen-to-square'></i>}\r\n\t\t\t\t\t\t{showNicknameInput === u.id && (\r\n\t\t\t\t\t\t\t<i\r\n\t\t\t\t\t\t\t\tclassName='fa-solid fa-check'\r\n\t\t\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\t\t\tchangeNickname(u)\r\n\t\t\t\t\t\t\t\t}}></i>\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t// </OutsideClickHandler>\r\n\t\t\t\t))}\r\n\t\t\t</Modal>\r\n\t\t</aside>\r\n\t)\r\n}\r\n","import { useEffect, useState } from 'react'\r\nimport { useParams } from 'react-router-dom'\r\nimport { useDocument } from '../../hooks/useDocument'\r\nimport { useAuthContext } from '../../hooks/useAuthContext'\r\nimport { useFirestore } from '../../hooks/useFirestore'\r\nimport { useCollection } from '../../hooks/useCollection'\r\n\r\n// Styles && Assets\r\nimport './Chat.scss'\r\n\r\n// Components\r\nimport Messages from './Messages/Messages'\r\nimport MessageField from './MessageField/MessageField'\r\nimport Avatar from '../../components/Avatar/Avatar'\r\nimport ChatOptions from './ChatOptions/ChatOptions'\r\n\r\nexport default function Chat({ setCurrentChat, inputRef, currentTheme }) {\r\n\tconst { user } = useAuthContext()\r\n\tconst { id } = useParams()\r\n\tconst { error, document } = useDocument('projects', id)\r\n\tconst { updateDocument } = useFirestore('projects')\r\n\r\n\tconst [isAssignedUser, setIsAssignedUser] = useState(false)\r\n\tconst [messageResponse, onMessageResponse] = useState(null)\r\n\tconst [bottomDiv, setBottomDiv] = useState(null)\r\n\tconst [showChatOptions, setShowChatOptions] = useState(false)\r\n\r\n\tconst [otherUserLocal, setOtherUserLocal] = useState(null)\r\n\tconst [currentUserLocal, setCurrentUserLocal] = useState(null)\r\n\r\n\tconst { document: otherUserDoc } = useDocument('users', otherUserLocal ? otherUserLocal.id : null)\r\n\tconst { document: currentUserDoc } = useDocument('users', currentUserLocal ? currentUserLocal.id : null)\r\n\r\n\tuseEffect(() => {\r\n\t\tif (document !== null) {\r\n\t\t\tdocument.assignedUsers.forEach(u => {\r\n\t\t\t\tif (u.id !== user.uid) {\r\n\t\t\t\t\tsetOtherUserLocal({ ...u })\r\n\t\t\t\t}\r\n\t\t\t})\r\n\r\n\t\t\tdocument.assignedUsers.forEach(u => {\r\n\t\t\t\tif (u.id === user.uid) {\r\n\t\t\t\t\tsetCurrentUserLocal({ ...u })\r\n\t\t\t\t\tsetIsAssignedUser(true)\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t}\r\n\r\n\t\tsetCurrentChat(document)\r\n\t}, [id, document])\r\n\r\n\tconst handleSeen = async () => {\r\n\t\tif (document.messages && document.messages.length > 0) {\r\n\t\t\tawait updateDocument(document.id, {\r\n\t\t\t\tisRead: true,\r\n\t\t\t\tassignedUsers: [\r\n\t\t\t\t\totherUserLocal,\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tid: currentUserDoc.id,\r\n\t\t\t\t\t\tnickname: currentUserLocal.nickname,\r\n\t\t\t\t\t\tlastRead: document.messages[document.messages.length - 1].id,\r\n\t\t\t\t\t},\r\n\t\t\t\t],\r\n\t\t\t})\r\n\t\t}\r\n\t}\r\n\r\n\tif (error) {\r\n\t\treturn <div className='error'>{error}</div>\r\n\t}\r\n\r\n\tif (!document) {\r\n\t\treturn <div className='loading'>Loading...</div>\r\n\t}\r\n\r\n\treturn (\r\n\t\t<>\r\n\t\t\t{isAssignedUser && otherUserDoc && currentUserDoc && (\r\n\t\t\t\t<div className='chat'>\r\n\t\t\t\t\t<div className='vertical-container'>\r\n\t\t\t\t\t\t<div className='chat__top-bar'>\r\n\t\t\t\t\t\t\t<div className='flex-row'>\r\n\t\t\t\t\t\t\t\t<Avatar src={otherUserDoc.photoURL} />\r\n\t\t\t\t\t\t\t\t<div className='vertical-container'>\r\n\t\t\t\t\t\t\t\t\t<h3>{otherUserLocal.nickname}</h3>\r\n\t\t\t\t\t\t\t\t\t{<p className='isActive'>{currentUserDoc.status ? currentUserDoc.status : ''}</p>}\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\t\tclassName='top-bar-options'\r\n\t\t\t\t\t\t\t\tonClick={e => {\r\n\t\t\t\t\t\t\t\t\tsetShowChatOptions(prevValue => !prevValue)\r\n\t\t\t\t\t\t\t\t\te.target.classList.toggle('active')\r\n\t\t\t\t\t\t\t\t}}>\r\n\t\t\t\t\t\t\t\t<i className='fa-solid fa-ellipsis-vertical'></i>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\tclassName='chat__comments'\r\n\t\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\t\thandleSeen()\r\n\t\t\t\t\t\t\t}}>\r\n\t\t\t\t\t\t\t<Messages\r\n\t\t\t\t\t\t\t\tchat={document}\r\n\t\t\t\t\t\t\t\tonMessageResponse={onMessageResponse}\r\n\t\t\t\t\t\t\t\tsetBottomDiv={setBottomDiv}\r\n\t\t\t\t\t\t\t\totherUser={otherUserDoc}\r\n\t\t\t\t\t\t\t\tcurrentUser={currentUserDoc}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t<MessageField\r\n\t\t\t\t\t\t\t\tchat={document}\r\n\t\t\t\t\t\t\t\tmessageResponse={messageResponse}\r\n\t\t\t\t\t\t\t\tonMessageResponse={onMessageResponse}\r\n\t\t\t\t\t\t\t\tbottomDiv={bottomDiv}\r\n\t\t\t\t\t\t\t\tinputRef={inputRef}\r\n\t\t\t\t\t\t\t\thandleSeen={handleSeen}\r\n\t\t\t\t\t\t\t\totherUser={otherUserDoc}\r\n\t\t\t\t\t\t\t\tcurrentUser={currentUserDoc}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t{showChatOptions && (\r\n\t\t\t\t\t\t<ChatOptions\r\n\t\t\t\t\t\t\tonMessageResponse={onMessageResponse}\r\n\t\t\t\t\t\t\totherUser={otherUserDoc}\r\n\t\t\t\t\t\t\tchat={document}\r\n\t\t\t\t\t\t\tcurrentTheme={currentTheme}\r\n\t\t\t\t\t\t\totherUserLocal={otherUserLocal}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t)}\r\n\t\t\t\t</div>\r\n\t\t\t)}\r\n\t\t</>\r\n\t)\r\n}\r\n","import { PhoneAuthProvider, RecaptchaVerifier } from 'firebase/auth'\r\nimport { useState, useEffect } from 'react'\r\nimport { useNavigate } from 'react-router-dom'\r\nimport { projectAuth, projectFirestore, projectGitHub, projectGoogle } from '../firebase/config'\r\nimport { useAuthContext } from './useAuthContext'\r\n\r\nexport const useLogin = () => {\r\n\tconst navigate = useNavigate()\r\n\r\n\tconst { dispatch } = useAuthContext()\r\n\r\n\tconst [isCancelled, setIsCancelled] = useState(false)\r\n\tconst [error, setError] = useState(null)\r\n\tconst [isPending, setIsPending] = useState(false)\r\n\tconst [isFinished, setIsFinished] = useState(false)\r\n\r\n\tconst login = async (email, password) => {\r\n\t\tsetError(null)\r\n\t\tsetIsPending(true)\r\n\r\n\t\ttry {\r\n\t\t\t// Login\r\n\t\t\tconst res = await projectAuth.signInWithEmailAndPassword(email, password)\r\n\r\n\t\t\t// Update online status\r\n\r\n\t\t\tawait projectFirestore.collection('users').doc(res.user.uid).update({\r\n\t\t\t\tonline: true,\r\n\t\t\t})\r\n\r\n\t\t\t// Dispatch login action\r\n\t\t\tdispatch({ type: 'LOGIN', payload: res.user })\r\n\r\n\t\t\t// Update state\r\n\t\t\tif (!isCancelled) {\r\n\t\t\t\tsetIsPending(false)\r\n\t\t\t\tsetError(null)\r\n\t\t\t}\r\n\t\t} catch (err) {\r\n\t\t\tif (!isCancelled) {\r\n\t\t\t\tsetError(err.message)\r\n\t\t\t\tsetIsPending(false)\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tconst loginWithGoogle = async () => {\r\n\t\tsetError(null)\r\n\t\tsetIsPending(true)\r\n\r\n\t\ttry {\r\n\t\t\t// Login\r\n\t\t\tconst res = await projectAuth.signInWithPopup(projectGoogle)\r\n\r\n\t\t\t// Update online status\r\n\r\n\t\t\tawait projectFirestore.collection('users').doc(res.user.uid).update({\r\n\t\t\t\tonline: true,\r\n\t\t\t})\r\n\r\n\t\t\t// Dispatch login action\r\n\t\t\tdispatch({ type: 'LOGIN', payload: res.user })\r\n\r\n\t\t\t// Update state\r\n\t\t\tif (!isCancelled) {\r\n\t\t\t\tsetIsPending(false)\r\n\t\t\t\tsetError(null)\r\n\t\t\t}\r\n\t\t} catch (err) {\r\n\t\t\tif (!isCancelled) {\r\n\t\t\t\tsetError(err.message)\r\n\t\t\t\tsetIsPending(false)\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tconst loginWithGithub = async () => {\r\n\t\tsetError(null)\r\n\t\tsetIsPending(true)\r\n\r\n\t\ttry {\r\n\t\t\t// Login\r\n\t\t\tconst res = await projectAuth.signInWithPopup(projectGitHub)\r\n\t\t\t// Update online status\r\n\r\n\t\t\tawait projectFirestore.collection('users').doc(res.user.uid).update({\r\n\t\t\t\tonline: true,\r\n\t\t\t})\r\n\r\n\t\t\t// Dispatch login action\r\n\t\t\tdispatch({ type: 'LOGIN', payload: res.user })\r\n\r\n\t\t\t// Update state\r\n\t\t\tif (!isCancelled) {\r\n\t\t\t\tsetIsPending(false)\r\n\t\t\t\tsetError(null)\r\n\t\t\t}\r\n\t\t} catch (err) {\r\n\t\t\tif (!isCancelled) {\r\n\t\t\t\tsetError(err.message)\r\n\t\t\t\tsetIsPending(false)\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tconst sendPasswordReset = async email => {\r\n\t\tsetError(null)\r\n\t\tsetIsPending(true)\r\n\t\tsetIsFinished(false)\r\n\r\n\t\ttry {\r\n\t\t\tawait projectAuth.sendPasswordResetEmail(email)\r\n\t\t\tif (!isCancelled) {\r\n\t\t\t\tsetIsPending(false)\r\n\t\t\t\tsetError(null)\r\n\t\t\t\tsetIsFinished(true)\r\n\r\n\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\tnavigate('/login')\r\n\t\t\t\t}, 15000)\r\n\t\t\t}\r\n\t\t} catch (err) {\r\n\t\t\tif (!isCancelled) {\r\n\t\t\t\tsetError(err.message)\r\n\t\t\t\tsetIsPending(false)\r\n\t\t\t\tsetIsFinished(false)\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tconst resetPassword = async (code, newPassword) => {\r\n\t\tsetError(null)\r\n\t\tsetIsPending(true)\r\n\t\tsetIsFinished(false)\r\n\r\n\t\ttry {\r\n\t\t\tawait projectAuth.confirmPasswordReset(code, newPassword)\r\n\r\n\t\t\tif (!isCancelled) {\r\n\t\t\t\tsetIsPending(false)\r\n\t\t\t\tsetError(null)\r\n\t\t\t\tsetIsFinished(true)\r\n\t\t\t}\r\n\t\t} catch (err) {\r\n\t\t\tif (!isCancelled) {\r\n\t\t\t\tsetError(err.message)\r\n\t\t\t\tsetIsPending(false)\r\n\t\t\t\tsetIsFinished(false)\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tconst setUpRecaptcha = async number => {\r\n\t\t// user.unlink(provider.providerId)\r\n\r\n\t\tconst provider = new PhoneAuthProvider(projectAuth)\r\n\t\tconst recaptchaVerifier = new RecaptchaVerifier('recaptcha-container', {}, projectAuth)\r\n\r\n\t\trecaptchaVerifier.render()\r\n\r\n\t\tconst verificationId = await provider.verifyPhoneNumber(number, recaptchaVerifier)\r\n\r\n\t\treturn verificationId\r\n\r\n\t\t// const credential = PhoneAuthProvider.credential(verificationId, OTPCode)\r\n\t\t// return signInWithPhoneNumber(projectAuth, number, recaptchaVerifier)\r\n\t}\r\n\r\n\tuseEffect(() => {\r\n\t\treturn () => setIsCancelled(true)\r\n\t}, [])\r\n\r\n\treturn {\r\n\t\tlogin,\r\n\t\tloginWithGoogle,\r\n\t\tloginWithGithub,\r\n\t\tsendPasswordReset,\r\n\t\tresetPassword,\r\n\t\tsetUpRecaptcha,\r\n\t\tisPending,\r\n\t\terror,\r\n\t\tisFinished,\r\n\t}\r\n}\r\n","export default __webpack_public_path__ + \"static/media/btn_google_dark_normal_ios.9fe90a17.svg\";","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyRpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNS1jMDIxIDc5LjE1NDkxMSwgMjAxMy8xMC8yOS0xMTo0NzoxNiAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6RERCMUIwOUY4NkNFMTFFM0FBNTJFRTMzNTJEMUJDNDYiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6RERCMUIwOUU4NkNFMTFFM0FBNTJFRTMzNTJEMUJDNDYiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNiAoTWFjaW50b3NoKSI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkU1MTc4QTJBOTlBMDExRTI5QTE1QkMxMDQ2QTg5MDREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOkU1MTc4QTJCOTlBMDExRTI5QTE1QkMxMDQ2QTg5MDREIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+jUqS1wAAApVJREFUeNq0l89rE1EQx3e3gVJoSPzZeNEWPKgHoa0HBak0iHiy/4C3WvDmoZ56qJ7txVsPQu8qlqqHIhRKJZceesmhioQEfxTEtsoSpdJg1u/ABJ7Pmc1m8zLwgWTmzcw3L+/te+tHUeQltONgCkyCi2AEDHLsJ6iBMlgHL8FeoqokoA2j4CloRMmtwTmj7erHBXPgCWhG6a3JNXKdCiDl1cidVbXZkJoXQRi5t5BrxwoY71FzU8S4JuAIqFkJ2+BFSlEh525b/hr3+k/AklDkNsf6wTT4yv46KIMNpsy+iMdMc47HNWxbsgVcUn7FmLAzzoFAWDsBx+wVP6bUpp5ewI+DOeUx0Wd9D8F70BTGNjkWtqnhmT1JQAHcUgZd8Lo3rQb1LAT8eJVUfgGvHQigGp+V2Z0iAUUl8QH47kAA1XioxIo+bRN8OG8F/oBjwv+Z1nJgX5jpdzQDw0LCjsPmrcW7I/iHScCAEDj03FtD8A0EyuChHgg4KTlJQF3wZ7WELppnBX+dBFSVpJsOBWi1qiRgSwnOgoyD5hmuJdkWCVhTgnTvW3AgYIFrSbZGh0UW/Io5Vp+DQoK7o80pztWMemZbgxeNwCNwDbw1fIfgGZjhU6xPaJgBV8BdsMw5cbZoHsenwYFxkZzl83xTSKTiviCAfCsJLysH3POfC8m8NegyGAGfLP/VmGmfSChgXroR0RSWjEFv2J/nG84cuKFMf4sTCZqXuJd4KaXFVjEG3+tw4eXbNK/YC9oXXs3O8NY8y99L4BXY5cvLY/Bb2VZ58EOJVcB18DHJq9lRsKr8inyKGVjlmh29mtHs3AHfuhCwy1vXT/Nu2GKQt+UHsGdctyX6eQyNvc+5sfX9Dl7Pe2J/BRgAl2CpwmrsHR0AAAAASUVORK5CYII=\"","import { useState } from 'react'\r\nimport { useLogin } from '../../hooks/useLogin'\r\nimport { Link } from 'react-router-dom'\r\n\r\n// Styles & assets\r\nimport './Login.scss'\r\nimport googleLogo from '../../assets/btn_google_dark_normal_ios.svg'\r\nimport githubLogo from '../../assets/GitHub-Mark-Light-32px.png'\r\n\r\nexport default function Login() {\r\n\tconst [email, setEmail] = useState('')\r\n\tconst [password, setPassword] = useState('')\r\n\tconst { login, loginWithGoogle, loginWithGithub, isPending, error } = useLogin()\r\n\r\n\tconst handleSubmit = e => {\r\n\t\te.preventDefault()\r\n\t\tlogin(email, password)\r\n\t}\r\n\tconst handleSubmitWithGoogle = e => {\r\n\t\te.preventDefault()\r\n\t\tloginWithGoogle()\r\n\t}\r\n\tconst handleSubmitWithGithub = e => {\r\n\t\te.preventDefault()\r\n\t\tloginWithGithub()\r\n\t}\r\n\r\n\treturn (\r\n\t\t<div className='login'>\r\n\t\t\t<div className='auth-decoration'>\r\n\t\t\t\t<div className='circle'></div>\r\n\t\t\t\t<div className='blur'></div>\r\n\t\t\t</div>\r\n\r\n\t\t\t<form className='auth-form' onSubmit={handleSubmit}>\r\n\t\t\t\t<div className='auth-form__title'>\r\n\t\t\t\t\t<h2>Welcome back</h2>\r\n\t\t\t\t</div>\r\n\r\n\t\t\t\t<label>\r\n\t\t\t\t\t<span>Email</span>\r\n\t\t\t\t\t<input\r\n\t\t\t\t\t\ttype='email'\r\n\t\t\t\t\t\trequired\r\n\t\t\t\t\t\tonChange={e => setEmail(e.target.value)}\r\n\t\t\t\t\t\tvalue={email}\r\n\t\t\t\t\t\tplaceholder='Enter your email'\r\n\t\t\t\t\t/>\r\n\t\t\t\t</label>\r\n\r\n\t\t\t\t<label>\r\n\t\t\t\t\t<span>Password</span>\r\n\t\t\t\t\t<input\r\n\t\t\t\t\t\ttype='password'\r\n\t\t\t\t\t\trequired\r\n\t\t\t\t\t\tonChange={e => setPassword(e.target.value)}\r\n\t\t\t\t\t\tvalue={password}\r\n\t\t\t\t\t\tplaceholder='Enter your password'\r\n\t\t\t\t\t/>\r\n\t\t\t\t</label>\r\n\t\t\t\t<Link to={'/recover-password'} className='reset-password'>\r\n\t\t\t\t\tForgot password?\r\n\t\t\t\t</Link>\r\n\r\n\t\t\t\t{!isPending && <button className='btn'>Login</button>}\r\n\t\t\t\t{isPending && (\r\n\t\t\t\t\t<button className='btn' disabled>\r\n\t\t\t\t\t\tLoading\r\n\t\t\t\t\t</button>\r\n\t\t\t\t)}\r\n\r\n\t\t\t\t<div className='others-separator'>\r\n\t\t\t\t\t<span>or</span>\r\n\t\t\t\t</div>\r\n\r\n\t\t\t\t<button className='google-btn' onClick={handleSubmitWithGoogle}>\r\n\t\t\t\t\t<img src={googleLogo} alt='google logo' />\r\n\t\t\t\t\t<span>Sign in with google</span>\r\n\t\t\t\t</button>\r\n\r\n\t\t\t\t<button className='github-btn' onClick={handleSubmitWithGithub}>\r\n\t\t\t\t\t<img src={githubLogo} alt='github logo' />\r\n\t\t\t\t\t<span>Sign in with GitHub</span>\r\n\t\t\t\t</button>\r\n\r\n\t\t\t\t<p className='change-page'>\r\n\t\t\t\t\tDon't have an account? <Link to='/signup'>Sign up</Link>\r\n\t\t\t\t</p>\r\n\r\n\t\t\t\t{error && <div className='error'>{error}</div>}\r\n\t\t\t</form>\r\n\t\t</div>\r\n\t)\r\n}\r\n","import { useState } from 'react'\r\nimport { useSignup } from '../../hooks/useSignup'\r\nimport { Link } from 'react-router-dom'\r\n\r\n// Styles\r\nimport './Signup.scss'\r\nimport googleLogo from '../../assets/btn_google_dark_normal_ios.svg'\r\nimport githubLogo from '../../assets/GitHub-Mark-Light-32px.png'\r\n\r\nexport default function Signup() {\r\n\tconst [email, setEmail] = useState('')\r\n\tconst [password, setPassword] = useState('')\r\n\tconst [displayName, setDisplayName] = useState('')\r\n\tconst [thumbnail, setThumbnail] = useState(null)\r\n\tconst [thumbnailError, setThumbnailError] = useState(null)\r\n\tconst { signup, signInWithGoogle, signInWithGithub, isPending, error } = useSignup()\r\n\r\n\tconst handleSubmit = e => {\r\n\t\te.preventDefault()\r\n\t\tsignup(email, password, displayName, thumbnail)\r\n\t}\r\n\r\n\tconst handleSubmitWithGoogle = e => {\r\n\t\te.preventDefault()\r\n\t\tsignInWithGoogle()\r\n\t}\r\n\r\n\tconst handleSubmitWithGithub = e => {\r\n\t\te.preventDefault()\r\n\t\tsignInWithGithub()\r\n\t}\r\n\r\n\tconst handleFileChange = e => {\r\n\t\tsetThumbnail(null)\r\n\t\tlet selected = e.target.files[0]\r\n\r\n\t\tif (!selected) {\r\n\t\t\tsetThumbnailError('Please select a file')\r\n\t\t\treturn\r\n\t\t}\r\n\t\tif (!selected.type.includes('image')) {\r\n\t\t\tsetThumbnailError('Selected file must be an image')\r\n\t\t\treturn\r\n\t\t}\r\n\t\tif (!selected.size > 100000) {\r\n\t\t\tsetThumbnailError('Image file size must be less than 100kb')\r\n\t\t\treturn\r\n\t\t}\r\n\r\n\t\tsetThumbnailError(null)\r\n\t\tsetThumbnail(selected)\r\n\t}\r\n\r\n\treturn (\r\n\t\t<div className='signup'>\r\n\t\t\t<div className='auth-decoration'>\r\n\t\t\t\t<div className='circle'></div>\r\n\t\t\t\t<div className='blur'></div>\r\n\t\t\t</div>\r\n\t\t\t<form className='auth-form' onSubmit={handleSubmit}>\r\n\t\t\t\t<div className='auth-form__title'>\r\n\t\t\t\t\t<h2>Join us</h2>\r\n\t\t\t\t</div>\r\n\r\n\t\t\t\t<label>\r\n\t\t\t\t\t<span>Email:</span>\r\n\t\t\t\t\t<input type='email' required onChange={e => setEmail(e.target.value)} value={email} placeholder='Aa' />\r\n\t\t\t\t</label>\r\n\t\t\t\t<label>\r\n\t\t\t\t\t<span>Password:</span>\r\n\t\t\t\t\t<input\r\n\t\t\t\t\t\ttype='password'\r\n\t\t\t\t\t\trequired\r\n\t\t\t\t\t\tonChange={e => setPassword(e.target.value)}\r\n\t\t\t\t\t\tvalue={password}\r\n\t\t\t\t\t\tplaceholder='Aa'\r\n\t\t\t\t\t/>\r\n\t\t\t\t</label>\r\n\t\t\t\t<label>\r\n\t\t\t\t\t<span>Display name:</span>\r\n\t\t\t\t\t<input\r\n\t\t\t\t\t\ttype='text'\r\n\t\t\t\t\t\trequired\r\n\t\t\t\t\t\tonChange={e => setDisplayName(e.target.value)}\r\n\t\t\t\t\t\tvalue={displayName}\r\n\t\t\t\t\t\tplaceholder='Aa'\r\n\t\t\t\t\t/>\r\n\t\t\t\t</label>\r\n\t\t\t\t<label>\r\n\t\t\t\t\t<span>Profile thumbnail:</span>\r\n\t\t\t\t\t<input type='file' required onChange={handleFileChange} />\r\n\r\n\t\t\t\t\t{thumbnailError && <div className='error'>{thumbnailError}</div>}\r\n\t\t\t\t</label>\r\n\r\n\t\t\t\t{!isPending && <button className='btn'>Sign up</button>}\r\n\t\t\t\t{isPending && (\r\n\t\t\t\t\t<button className='btn' disabled>\r\n\t\t\t\t\t\tLoading\r\n\t\t\t\t\t</button>\r\n\t\t\t\t)}\r\n\r\n\t\t\t\t<div className='others-separator'>\r\n\t\t\t\t\t<span>or</span>\r\n\t\t\t\t</div>\r\n\r\n\t\t\t\t<button className='google-btn' onClick={handleSubmitWithGoogle}>\r\n\t\t\t\t\t<img src={googleLogo} alt='google logo' />\r\n\t\t\t\t\t<span>Sign in with google</span>\r\n\t\t\t\t</button>\r\n\r\n\t\t\t\t<button className='github-btn' onClick={handleSubmitWithGithub}>\r\n\t\t\t\t\t<img src={githubLogo} alt='github logo' />\r\n\t\t\t\t\t<span>Sign in with GitHub</span>\r\n\t\t\t\t</button>\r\n\r\n\t\t\t\t<p className='change-page'>\r\n\t\t\t\t\tAlready have an account? <Link to='/login'>Login</Link>\r\n\t\t\t\t</p>\r\n\r\n\t\t\t\t{error && <div className='error'>{error}</div>}\r\n\t\t\t</form>\r\n\t\t</div>\r\n\t)\r\n}\r\n","import { useState, useEffect } from 'react'\r\nimport { projectAuth, projectFirestore, projectStorage, projectGoogle, projectGitHub } from '../firebase/config'\r\nimport { useAuthContext } from './useAuthContext'\r\nimport randomColor from 'randomcolor'\r\n\r\nexport const useSignup = () => {\r\n\tconst [isCancelled, setIsCancelled] = useState(false)\r\n\tconst [error, setError] = useState(null)\r\n\tconst [isPending, setIsPending] = useState(false)\r\n\tconst { dispatch } = useAuthContext()\r\n\r\n\tconst randColor = randomColor()\r\n\r\n\tconst signup = async (email, password, displayName, thumbnail) => {\r\n\t\tsetError(null)\r\n\t\tsetIsPending(true)\r\n\r\n\t\ttry {\r\n\t\t\t// Signup\r\n\t\t\tconst res = await projectAuth.createUserWithEmailAndPassword(email, password)\r\n\r\n\t\t\tif (!res) {\r\n\t\t\t\tthrow new Error('Could not complete signup')\r\n\t\t\t}\r\n\r\n\t\t\t// Upload thumbnail\r\n\r\n\t\t\tconst uploadPath = `thumbnails/${res.user.uid}/${thumbnail.name}`\r\n\t\t\tconst img = await projectStorage.ref(uploadPath).put(thumbnail)\r\n\t\t\tconst imgUrl = await img.ref.getDownloadURL()\r\n\r\n\t\t\t// Add display name to user\r\n\t\t\tawait res.user.updateProfile({ displayName, photoURL: imgUrl })\r\n\r\n\t\t\t// Create a user document\r\n\t\t\tawait projectFirestore\r\n\t\t\t\t.collection('users')\r\n\t\t\t\t.doc(res.user.uid)\r\n\t\t\t\t.set({\r\n\t\t\t\t\tonline: true,\r\n\t\t\t\t\tdisplayName: displayName,\r\n\t\t\t\t\tphotoURL: imgUrl,\r\n\t\t\t\t\tcreatedAt: `${new Date(res.user.metadata.creationTime).toLocaleString('default', {\r\n\t\t\t\t\t\tday: '2-digit',\r\n\t\t\t\t\t\tmonth: 'short',\r\n\t\t\t\t\t\tyear: 'numeric',\r\n\t\t\t\t\t})}`,\r\n\t\t\t\t\tstatus: 'invisible',\r\n\t\t\t\t\tbanner: `${randColor}`,\r\n\t\t\t\t})\r\n\r\n\t\t\t// Dispatch login action\r\n\t\t\tdispatch({ type: 'LOGIN', payload: res.user })\r\n\r\n\t\t\tif (!isCancelled) {\r\n\t\t\t\tsetIsPending(false)\r\n\t\t\t\tsetError(null)\r\n\t\t\t}\r\n\t\t} catch (err) {\r\n\t\t\tif (!isCancelled) {\r\n\t\t\t\tsetError(err.message)\r\n\t\t\t\tsetIsPending(false)\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tconst signInWithGoogle = async () => {\r\n\t\tsetError(null)\r\n\t\tsetIsPending(true)\r\n\r\n\t\ttry {\r\n\t\t\t// Signup\r\n\t\t\tconst res = await projectAuth.signInWithPopup(projectGoogle)\r\n\r\n\t\t\tif (!res) {\r\n\t\t\t\tthrow new Error('Could not complete signup')\r\n\t\t\t}\r\n\r\n\t\t\t// Add display name to user\r\n\t\t\tawait res.user.updateProfile({ displayName: res.user.displayName, photoURL: res.user.photoURL })\r\n\r\n\t\t\t// Create a user document\r\n\t\t\tawait projectFirestore.collection('users').doc(res.user.uid).set({\r\n\t\t\t\tonline: true,\r\n\t\t\t\tdisplayName: res.user.displayName,\r\n\t\t\t\tphotoURL: res.user.photoURL,\r\n\t\t\t})\r\n\r\n\t\t\t// Dispatch login action\r\n\t\t\tdispatch({ type: 'LOGIN', payload: res.user })\r\n\r\n\t\t\tif (!isCancelled) {\r\n\t\t\t\tsetIsPending(false)\r\n\t\t\t\tsetError(null)\r\n\t\t\t}\r\n\t\t} catch (err) {\r\n\t\t\tif (!isCancelled) {\r\n\t\t\t\tsetError(err.message)\r\n\t\t\t\tsetIsPending(false)\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tconst signInWithGithub = async () => {\r\n\t\tsetError(null)\r\n\t\tsetIsPending(true)\r\n\r\n\t\ttry {\r\n\t\t\t// Signup\r\n\t\t\tconst res = await projectAuth.signInWithPopup(projectGitHub)\r\n\r\n\t\t\tif (!res) {\r\n\t\t\t\tthrow new Error('Could not complete signup')\r\n\t\t\t}\r\n\r\n\t\t\t// Add display name to user\r\n\t\t\tawait res.user.updateProfile({ displayName: res.additionalUserInfo.username, photoURL: res.user.photoURL })\r\n\r\n\t\t\t// Create a user document\r\n\t\t\tawait projectFirestore.collection('users').doc(res.user.uid).set({\r\n\t\t\t\tonline: true,\r\n\t\t\t\tdisplayName: res.user.displayName,\r\n\t\t\t\tphotoURL: res.user.photoURL,\r\n\t\t\t})\r\n\r\n\t\t\t// Dispatch login action\r\n\t\t\tdispatch({ type: 'LOGIN', payload: res.user })\r\n\r\n\t\t\tif (!isCancelled) {\r\n\t\t\t\tsetIsPending(false)\r\n\t\t\t\tsetError(null)\r\n\t\t\t}\r\n\t\t} catch (err) {\r\n\t\t\tif (!isCancelled) {\r\n\t\t\t\tsetError(err.message)\r\n\t\t\t\tsetIsPending(false)\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tuseEffect(() => {\r\n\t\treturn () => setIsCancelled(true)\r\n\t}, [])\r\n\r\n\treturn { signup, signInWithGoogle, signInWithGithub, error, isPending }\r\n}\r\n","import React from 'react'\r\n\r\nexport default function PrivacyPolicy() {\r\n\treturn (\r\n\t\t<>\r\n\t\t\t<div class='privacy-section'>\r\n\t\t\t\t<h3>Zbieranie danych</h3>\r\n\t\t\t\t<p>Kiedy zbieramy Twoje dane? Twj email oraz haso zapisywane s podczas rejestracji na naszej stronie.</p>\r\n\t\t\t</div>\r\n\r\n\t\t\t<div class='privacy-section'>\r\n\t\t\t\t<h3>Cele przetwarzania danych</h3>\r\n\r\n\t\t\t\t<p>\r\n\t\t\t\t\tTwoje dane zebrane podczas rejestracji przetwarzane s jedynie w celu umoliwienia korzystania ze strony. Nie\r\n\t\t\t\t\tudostpniamy ich nikomu, nie sprzedajemy ich. Rejestracja jest dobrowolna.\r\n\t\t\t\t</p>\r\n\t\t\t</div>\r\n\t\t\t<div class='privacy-section'>\r\n\t\t\t\t<h3>Bezpieczestwo danych</h3>\r\n\r\n\t\t\t\t<p>\r\n\t\t\t\t\tTwoje dane s automatycznie szyfrowane przez usug firebase od google. Nikt nieautoryzowany nie ma dostpu do\r\n\t\t\t\t\ttwoich danych.\r\n\t\t\t\t</p>\r\n\t\t\t</div>\r\n\t\t\t<div class='privacy-section'>\r\n\t\t\t\t<h3>Usuwanie danych</h3>\r\n\r\n\t\t\t\t<p>\r\n\t\t\t\t\tJeli zrezygnujesz z uywania naszej aplikacji w kadym momencie moesz do nas napisa na maila \"matkowsky808@gmail\" lub wykorzysta funkcj w ustawieniach, aby usun konto oraz swoje dane.\r\n\t\t\t\t</p>\r\n\t\t\t</div>\r\n\r\n\t\t\t<div class='privacy-section'>\r\n\t\t\t\t<h3>Pozostae informacje</h3>\r\n\r\n\t\t\t\t<p>\r\n\t\t\t\t\t<span>W razie jakichkolwiek pyta, prosimy o kontakt na adresie mailowym: matkowsky808@gmail.com</span>\r\n\t\t\t\t</p>\r\n\t\t\t</div>\r\n\t\t</>\r\n\t)\r\n}\r\n","export default __webpack_public_path__ + \"static/media/shrek-gif.df094210.gif\";","import { useEffect, useState } from 'react'\r\nimport { useLogin } from '../../hooks/useLogin'\r\nimport { Link } from 'react-router-dom'\r\n\r\n// Styles & assets\r\nimport '../login/Login.scss'\r\nimport ShrekGif from '../../assets/shrek-gif.gif'\r\n\r\nexport default function ResetPassword() {\r\n\tconst [email, setEmail] = useState('')\r\n\tconst { sendPasswordReset, isPending, error, isFinished } = useLogin()\r\n\tconst [timeToRedirect, setTimeToRedirect] = useState(15)\r\n\r\n\tconst handlePasswordReset = e => {\r\n\t\te.preventDefault()\r\n\t\tsendPasswordReset(email)\r\n\t}\r\n\r\n\tuseEffect(() => {\r\n\t\tif (isFinished === true) {\r\n\t\t\tcountdown()\r\n\t\t}\r\n\t}, [isFinished])\r\n\r\n\t\r\n\tconst countdown = () => {\r\n\t\tlet redirectCountdown = setInterval(() => {\r\n\t\t\tif (timeToRedirect <= 0) {\r\n\t\t\t\tclearInterval(redirectCountdown)\r\n\t\t\t} else {\r\n\t\t\t\tsetTimeToRedirect(prevTimeToRedirect => prevTimeToRedirect - 1)\r\n\t\t\t}\r\n\t\t}, 1000)\r\n\t}\r\n\r\n\tconst handleKey = e => {\r\n\t\te.code === 'Enter' && handlePasswordReset(e)\r\n\t}\r\n\r\n\treturn (\r\n\t\t<div className='login'>\r\n\t\t\t<div className='auth-decoration'>\r\n\t\t\t\t<div className='circle'></div>\r\n\t\t\t\t<div className='blur'></div>\r\n\t\t\t</div>\r\n\r\n\t\t\t<div className='auth-form'>\r\n\t\t\t\t{isFinished && (\r\n\t\t\t\t\t<div className='text-center email-sent'>\r\n\t\t\t\t\t\t<img src={ShrekGif} alt='' className='email-sent__img' />\r\n\t\t\t\t\t\t<h2>Check your email</h2>\r\n\t\t\t\t\t\t<p>A password reset email has been sent to your email address</p>\r\n\r\n\t\t\t\t\t\t<Link to='/login'>\r\n\t\t\t\t\t\t\t<button className='btn'>Back to Login</button>\r\n\t\t\t\t\t\t</Link>\r\n\r\n\t\t\t\t\t\t<p className='redirect'>Redirecting in {timeToRedirect} s</p>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t)}\r\n\r\n\t\t\t\t{!isFinished && (\r\n\t\t\t\t\t<>\r\n\t\t\t\t\t\t<div className='auth-form__title'>\r\n\t\t\t\t\t\t\t<h2>Forgot password?</h2>\r\n\t\t\t\t\t\t\t<p>Enter your email below to recieve password reset instructions</p>\r\n\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t<label>\r\n\t\t\t\t\t\t\t<span>Email</span>\r\n\t\t\t\t\t\t\t<input\r\n\t\t\t\t\t\t\t\ttype='email'\r\n\t\t\t\t\t\t\t\trequired\r\n\t\t\t\t\t\t\t\tonChange={e => setEmail(e.target.value)}\r\n\t\t\t\t\t\t\t\tvalue={email}\r\n\t\t\t\t\t\t\t\tplaceholder='Enter your email'\r\n\t\t\t\t\t\t\t\tonKeyDown={e => handleKey(e)}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t</label>\r\n\r\n\t\t\t\t\t\t{!isPending && (\r\n\t\t\t\t\t\t\t<button className='btn' onClick={handlePasswordReset}>\r\n\t\t\t\t\t\t\t\tSend reset link\r\n\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t{isPending && (\r\n\t\t\t\t\t\t\t<button className='btn' disabled>\r\n\t\t\t\t\t\t\t\tSending email...\r\n\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t)}\r\n\r\n\t\t\t\t\t\t<p className='change-page'>\r\n\t\t\t\t\t\t\tNo longer have Alzheimer? <Link to='/login'>Login</Link>\r\n\t\t\t\t\t\t</p>\r\n\r\n\t\t\t\t\t\t{error && <div className='error'>{error}</div>}\r\n\t\t\t\t\t</>\r\n\t\t\t\t)}\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t)\r\n}\r\n","import { useState } from 'react'\r\nimport { useLogin } from '../../hooks/useLogin'\r\nimport { Link } from 'react-router-dom'\r\nimport { useQuery } from '../../hooks/useQuery'\r\n\r\n// Styles & assets\r\nimport '../login/Login.scss'\r\nimport ShrekGif from '../../assets/shrek-gif.gif'\r\n\r\nexport default function SetNewPassword() {\r\n\tconst { resetPassword, isPending, error, isFinished } = useLogin()\r\n\r\n\tconst [newPassword, setNewPassword] = useState('')\r\n\r\n\tconst oobCode = useQuery('oobCode')\r\n\r\n\tconst handleSubmit = async e => {\r\n\t\te.preventDefault()\r\n\t\tresetPassword(oobCode, newPassword)\r\n\t}\r\n\r\n\tconst handleKey = e => {\r\n\t\te.code === 'Enter' && handleSubmit(e)\r\n\t}\r\n\r\n\treturn (\r\n\t\t<div className='login'>\r\n\t\t\t<div className='auth-decoration'>\r\n\t\t\t\t<div className='circle'></div>\r\n\t\t\t\t<div className='blur'></div>\r\n\t\t\t</div>\r\n\r\n\t\t\t<form className='auth-form' onSubmit={e => handleSubmit(e)}>\r\n\t\t\t\t{isFinished && (\r\n\t\t\t\t\t<div className='text-center email-sent'>\r\n\t\t\t\t\t\t<img src={ShrekGif} alt='' className='email-sent__img' />\r\n\t\t\t\t\t\t<h2>Password set successfully</h2>\r\n\t\t\t\t\t\t<p>You can now log in with your new password</p>\r\n\r\n\t\t\t\t\t\t<Link to='/login'>\r\n\t\t\t\t\t\t\t<button className='btn'>Back to Login</button>\r\n\t\t\t\t\t\t</Link>\r\n\r\n\t\t\t\t\t\t<p className='change-page'>\r\n\t\t\t\t\t\t\tNow log in and remember your password. <Link to='/login'> Login</Link>\r\n\t\t\t\t\t\t</p>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t)}\r\n\r\n\t\t\t\t{!isFinished && (\r\n\t\t\t\t\t<>\r\n\t\t\t\t\t\t<div className='auth-form__title'>\r\n\t\t\t\t\t\t\t<h2>Set a new password</h2>\r\n\t\t\t\t\t\t\t<p>Enter a password that you will remember this time...</p>\r\n\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t<label>\r\n\t\t\t\t\t\t\t<span>Password</span>\r\n\t\t\t\t\t\t\t<input\r\n\t\t\t\t\t\t\t\ttype='password'\r\n\t\t\t\t\t\t\t\trequired\r\n\t\t\t\t\t\t\t\tonChange={e => setNewPassword(e.target.value)}\r\n\t\t\t\t\t\t\t\tvalue={newPassword}\r\n\t\t\t\t\t\t\t\tplaceholder='Enter new password'\r\n\t\t\t\t\t\t\t\tonKeyDown={e => handleKey(e)}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t</label>\r\n\r\n\t\t\t\t\t\t{!isPending && <button className='btn'>Reset password</button>}\r\n\t\t\t\t\t\t{isPending && (\r\n\t\t\t\t\t\t\t<button className='btn' disabled>\r\n\t\t\t\t\t\t\t\tSetting new password...\r\n\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t)}\r\n\r\n\t\t\t\t\t\t<p className='change-page'>\r\n\t\t\t\t\t\t\t<Link to='/login'> Login</Link> instead?\r\n\t\t\t\t\t\t</p>\r\n\r\n\t\t\t\t\t\t{error && <div className='error'>{error}</div>}\r\n\t\t\t\t\t</>\r\n\t\t\t\t)}\r\n\t\t\t</form>\r\n\t\t</div>\r\n\t)\r\n}\r\n","import { useLocation } from 'react-router-dom'\r\n\r\nexport const useQuery = queryName => {\r\n\tconst location = useLocation()\r\n\tconst query = new URLSearchParams(location.search).get(queryName)\r\n\treturn query\r\n}\r\n","import { useEffect, useState } from 'react'\nimport { projectAuth } from '../firebase/config'\nimport { useAuthContext } from './useAuthContext'\n\nexport const useLogout = () => {\n\tconst [isCancelled, setIsCancelled] = useState(false)\n\tconst [error, setError] = useState(null)\n\tconst [isPending, setIsPending] = useState(false)\n\tconst { dispatch } = useAuthContext()\n\n\tconst logout = async () => {\n\t\tsetError(null)\n\t\tsetIsPending(true)\n\n\t\ttry {\n\t\t\t// Sign the user out\n\t\t\tawait projectAuth.signOut()\n\n\t\t\t// Dispatch logout action\n\t\t\tdispatch({ type: 'LOGOUT' })\n\n\t\t\t// Update state\n\t\t\tif (!isCancelled) {\n\t\t\t\tsetIsPending(false)\n\t\t\t\tsetError(null)\n\t\t\t}\n\t\t} catch (err) {\n\t\t\tif (!isCancelled) {\n\t\t\t\tsetError(err.message)\n\t\t\t\tsetIsPending(false)\n\t\t\t}\n\t\t}\n\t}\n\n\tuseEffect(() => {\n\t\treturn () => setIsCancelled(true)\n\t}, [])\n\n\treturn { logout, error, isPending }\n}\n","import { NavLink } from 'react-router-dom'\r\nimport { useAuthContext } from '../../hooks/useAuthContext'\r\nimport { useCollection } from '../../hooks/useCollection'\r\nimport formatDistanceToNowStrict from 'date-fns/formatDistanceToNow'\r\n\r\n// Styles && Assets\r\nimport './ChatsList.scss'\r\n\r\n// Components\r\nimport AvatarWithStatus from '../AvatarWithStatus/AvatarWithStatus'\r\nimport React from 'react'\r\n\r\nexport default function ChatsList({ chats, inputRef }) {\r\n\tconst { user } = useAuthContext()\r\n\tconst { documents: users } = useCollection('users')\r\n\r\n\tconst replaceDistanceToNow = {\r\n\t\tabout: '',\r\n\t\tminute: 'min',\r\n\t\tminutes: 'min',\r\n\t\t'less than a minute': '1 min',\r\n\t}\r\n\r\n\tconst focusInput = () => {\r\n\t\tif (inputRef.current !== null) {\r\n\t\t\tinputRef.current.focus()\r\n\t\t}\r\n\t}\r\n\r\n\tconst handleSeen = chat => {\r\n\t\tlet res = false\r\n\r\n\t\tif (chat.messages && chat.messages[chat.messages.length - 1]) {\r\n\t\t\tchat.assignedUsers.forEach(u => {\r\n\t\t\t\tif (u.id === user.uid && u.lastRead !== chat.messages[chat.messages.length - 1].id) {\r\n\t\t\t\t\tres = true\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t}\r\n\r\n\t\treturn res\r\n\t}\r\n\r\n\treturn (\r\n\t\t<div className='chat-list custom-scrollbar'>\r\n\t\t\t{chats.length === 0 && <p>No chats yet!</p>}\r\n\t\t\t{chats.map(chat => (\r\n\t\t\t\t<NavLink\r\n\t\t\t\t\tto={`/u/${chat.id}`}\r\n\t\t\t\t\tkey={chat.id}\r\n\t\t\t\t\tclassName={`card ${handleSeen(chat) ? 'unread' : ''}`}\r\n\t\t\t\t\tonClick={() => focusInput()}>\r\n\t\t\t\t\t{chat.assignedUsers.map(\r\n\t\t\t\t\t\tu =>\r\n\t\t\t\t\t\t\tu.id !== user.uid && (\r\n\t\t\t\t\t\t\t\t<React.Fragment key={u.id}>\r\n\t\t\t\t\t\t\t\t\t<AvatarWithStatus userId={u.id} />\r\n\t\t\t\t\t\t\t\t\t<div className='chat-info'>\r\n\t\t\t\t\t\t\t\t\t\t<p className='display-name'>\r\n\t\t\t\t\t\t\t\t\t\t\t{u.nickname.substring(0, 18)}\r\n\t\t\t\t\t\t\t\t\t\t\t<span>{u.nickname.length >= 18 && '...'}</span>\r\n\t\t\t\t\t\t\t\t\t\t</p>\r\n\r\n\t\t\t\t\t\t\t\t\t\t<div className='last-chat'>\r\n\t\t\t\t\t\t\t\t\t\t\t<span className='last-message'>\r\n\t\t\t\t\t\t\t\t\t\t\t\t{chat.messages.length !== 0 && (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{chat &&\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tchat.messages[chat.messages.length - 1] &&\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tchat.messages[chat.messages.length - 1].createdBy === user.uid &&\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t'You: '}\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{chat.messages[chat.messages.length - 1].content &&\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tchat.messages[chat.messages.length - 1].fileType === undefined &&\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tchat.messages[chat.messages.length - 1].content.substring(0, 15)}\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{!chat.messages[chat.messages.length - 1].content &&\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tchat.messages[chat.messages.length - 1].fileType === 'image' &&\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t`sent a photo`}\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{!chat.messages[chat.messages.length - 1].content &&\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tchat.messages[chat.messages.length - 1].fileType === 'video' &&\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t`sent a video`}\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{chat.messages[chat.messages.length - 1].content &&\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tchat.messages[chat.messages.length - 1].content.length >= 15 &&\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t'...'}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</>\r\n\t\t\t\t\t\t\t\t\t\t\t\t)}\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t{chat.messages.length === 0 && 'No messages yet'}\r\n\t\t\t\t\t\t\t\t\t\t\t</span>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t{chat.messages.length !== 0 && (\r\n\t\t\t\t\t\t\t\t\t\t\t\t<>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<div className='dot'></div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<span className='comment-date'>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{formatDistanceToNowStrict(chat.messages[chat.messages.length - 1].createdAt.toDate(), {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\taddSuffix: false,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t}).replace(\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t/\\b(?:about|less than a minute|minute|minutes)\\b/gi,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tmatched => replaceDistanceToNow[matched]\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</>\r\n\t\t\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t</React.Fragment>\r\n\t\t\t\t\t\t\t)\r\n\t\t\t\t\t)}\r\n\t\t\t\t</NavLink>\r\n\t\t\t))}\r\n\t\t</div>\r\n\t)\r\n}\r\n","import { useEffect, useRef, useState } from 'react'\r\nimport { useCollection } from '../../hooks/useCollection'\r\nimport { useAuthContext } from '../../hooks/useAuthContext'\r\nimport { useLogout } from '../../hooks/useLogout'\r\nimport { Link } from 'react-router-dom'\r\n\r\n// Compontents\r\nimport ChatsList from './ChatsList'\r\n\r\n// Styles\r\nimport './Chats.scss'\r\n\r\nexport default function Chats({ currentChat, inputRef }) {\r\n\tconst { user } = useAuthContext()\r\n\tconst { documents: chats } = useCollection(\r\n\t\t'projects',\r\n\t\t['assignedUsersId', 'array-contains', user.uid],\r\n\t\t['updatedAt', 'desc']\r\n\t)\r\n\r\n\tconst [query, setQuery] = useState('')\r\n\r\n\tconst eyes = useRef([])\r\n\r\n\tuseEffect(() => {\r\n\t\tconst handleMouseMove = event => {\r\n\t\t\tif (eyes.current) {\r\n\t\t\t\teyes.current.forEach(eye => {\r\n\t\t\t\t\tif (eye) {\r\n\t\t\t\t\t\tlet x = eye.getBoundingClientRect().left + eye.clientWidth / 2\r\n\t\t\t\t\t\tlet y = eye.getBoundingClientRect().top + eye.clientHeight / 2\r\n\r\n\t\t\t\t\t\tlet radian = Math.atan2(event.pageX - x, event.pageY - y)\r\n\t\t\t\t\t\tlet rotation = radian * (180 / Math.PI) * -1\r\n\r\n\t\t\t\t\t\teye.style.transform = `rotate(${rotation}deg)`\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\twindow.addEventListener('mousemove', handleMouseMove)\r\n\t\treturn () => {\r\n\t\t\twindow.removeEventListener('mousemove', handleMouseMove)\r\n\t\t}\r\n\t}, [])\r\n\r\n\tconst handleSelect = async addUser => {\r\n\t\t// // Check whether the group(chats in firestore) exists, if not create\r\n\t\t// const combinedId = user.uid > addUser.id ? user.uid + addUser.id : addUser.id + user.uid\r\n\t\t// try {\r\n\t\t// \tconst res = await getDoc(doc(projectFirestore, 'projects', combinedId))\r\n\t\t// \tif (!res.exists() && user.uid !== addUser.id) {\r\n\t\t// \t\t// Create a chat in chats collection\r\n\t\t// \t\tawait setDoc(doc(projectFirestore, 'projects', combinedId), {\r\n\t\t// \t\t\tid: combinedId,\r\n\t\t// \t\t\tassignedUsers: [\r\n\t\t// \t\t\t\t{\r\n\t\t// \t\t\t\t\tid: user.uid,\r\n\t\t// \t\t\t\t\tdisplayName: user.displayName,\r\n\t\t// \t\t\t\t\tnickname: user.displayName,\r\n\t\t// \t\t\t\t\tphotoURL: user.photoURL,\r\n\t\t// \t\t\t\t},\r\n\t\t// \t\t\t\t{\r\n\t\t// \t\t\t\t\tid: addUser.id,\r\n\t\t// \t\t\t\t\tdisplayName: addUser.displayName,\r\n\t\t// \t\t\t\t\tnickname: addUser.displayName,\r\n\t\t// \t\t\t\t\tphotoURL: addUser.photoURL,\r\n\t\t// \t\t\t\t},\r\n\t\t// \t\t\t],\r\n\t\t// \t\t\tassignedUsersId: [user.uid, addUser.id],\r\n\t\t// \t\t\tchatEmoji: '1f44d',\r\n\t\t// \t\t\tmessages: [],\r\n\t\t// \t\t\tupdatedAt: timestamp.fromDate(new Date()),\r\n\t\t// \t\t\tcreatedAt: timestamp.fromDate(new Date()),\r\n\t\t// \t\t\tcustomThemes: [],\r\n\t\t// \t\t})\r\n\t\t// \t}\r\n\t\t// } catch (err) {}\r\n\t\t// setQuery('')\r\n\t}\r\n\r\n\tconst filterChats = chat => {\r\n\t\tlet result = false\r\n\t\t// chat.displayName.toLowerCase().trim().replace(/\\s+/g, '').includes(query.toLowerCase())\r\n\r\n\t\tchat.assignedUsers.forEach(u => {\r\n\t\t\tif (u.id !== user.uid) {\r\n\t\t\t\tif (\r\n\t\t\t\t\tu.displayName.toLowerCase().trim().replace(/\\s+/g, '').includes(query.toLowerCase()) ||\r\n\t\t\t\t\tu.nickname.toLowerCase().trim().replace(/\\s+/g, '').includes(query.toLowerCase())\r\n\t\t\t\t) {\r\n\t\t\t\t\tresult = true\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t})\r\n\r\n\t\treturn result\r\n\t}\r\n\r\n\treturn (\r\n\t\t<div className='user-list'>\r\n\t\t\t{/* <div className=\"blur\"></div> */}\r\n\t\t\t<div className='search'>\r\n\t\t\t\t<h2>Chats</h2>\r\n\t\t\t\t<div>\r\n\t\t\t\t\t<div className='search-form'>\r\n\t\t\t\t\t\t<label>\r\n\t\t\t\t\t\t\t<i className='fa-solid fa-magnifying-glass'></i>\r\n\t\t\t\t\t\t\t<input type='text' placeholder='Find a user' onChange={e => setQuery(e.target.value)} value={query} />\r\n\t\t\t\t\t\t</label>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t{query !== '' && (\r\n\t\t\t\t\t\t<>\r\n\t\t\t\t\t\t\t<div className='add-users'>\r\n\t\t\t\t\t\t\t\t{chats &&\r\n\t\t\t\t\t\t\t\t\tchats\r\n\t\t\t\t\t\t\t\t\t\t.filter(chat => filterChats(chat))\r\n\t\t\t\t\t\t\t\t\t\t.map(chat =>\r\n\t\t\t\t\t\t\t\t\t\t\tchat.assignedUsers.map(\r\n\t\t\t\t\t\t\t\t\t\t\t\tu =>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tu.id !== user.uid && (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Link to={`/u/${chat.id}`} key={u.id} className='user-chat' onClick={() => setQuery('')}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<img src={u.photoURL} alt='' />\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div className='user-chat-info'>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span>{u.displayName}</span>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</Link>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</>\r\n\t\t\t\t\t)}\r\n\t\t\t\t\t<div className='chats'>\r\n\t\t\t\t\t\t{query === '' && chats && <ChatsList chats={chats} currentChat={currentChat} inputRef={inputRef} />}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\r\n\t\t\t<div className='nom-nom'>\r\n\t\t\t\t<div className='nom-nom__eyes'>\r\n\t\t\t\t\t<div\r\n\t\t\t\t\t\tclassName='eye'\r\n\t\t\t\t\t\tref={e => {\r\n\t\t\t\t\t\t\teyes.current[0] = e\r\n\t\t\t\t\t\t}}>\r\n\t\t\t\t\t\t<div className='pupil'></div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div\r\n\t\t\t\t\t\tclassName='eye'\r\n\t\t\t\t\t\tref={e => {\r\n\t\t\t\t\t\t\teyes.current[1] = e\r\n\t\t\t\t\t\t}}>\r\n\t\t\t\t\t\t<div className='pupil'></div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t)\r\n}\r\n","import React, { useEffect } from 'react'\r\nimport { useState } from 'react'\r\nimport { Link, NavLink, useLocation } from 'react-router-dom'\r\nimport { useAuthContext } from '../../hooks/useAuthContext'\r\nimport { useCollection } from '../../hooks/useCollection'\r\nimport { useFirestore } from '../../hooks/useFirestore'\r\nimport { DragDropContext, Draggable, Droppable } from 'react-beautiful-dnd'\r\nimport { useDocument } from '../../hooks/useDocument'\r\n\r\n// Components\r\nimport Avatar from '../Avatar/Avatar'\r\nimport Modal from '../Modal/Modal'\r\n\r\n// Styles\r\nimport './ToolBar.scss'\r\nimport AvatarWithStatus from '../AvatarWithStatus/AvatarWithStatus'\r\nimport ProfilePreview from '../ProfilePreview/ProfilePreview'\r\n\r\nconst ToolBar = () => {\r\n\tconst location = useLocation()\r\n\r\n\tconst { user } = useAuthContext()\r\n\tconst { documents: chats } = useCollection(\r\n\t\t'projects',\r\n\t\t['assignedUsersId', 'array-contains', user.uid],\r\n\t\t['updatedAt', 'desc']\r\n\t)\r\n\tconst { documents: users } = useCollection('users')\r\n\tconst { updateDocument } = useFirestore('users')\r\n\tconst { document: userDoc } = useDocument('users', user.uid)\r\n\r\n\tconst [latestChat, setLatestChat] = useState()\r\n\tconst [currentPath, setCurrentPath] = useState('')\r\n\tconst [favs, setFavs] = useState([])\r\n\tconst [showFavs, setShowFavs] = useState(false)\r\n\tconst [searchValue, setSearchValue] = useState('')\r\n\tconst [favsCopy, setFavsCopy] = useState(favs)\r\n\tconst [showProfile, setShowProfile] = useState(false)\r\n\r\n\tuseEffect(() => {\r\n\t\tif (chats && chats !== null && chats.length !== 0) {\r\n\t\t\tif (userDoc && userDoc.pinned) {\r\n\t\t\t\tsetFavs(userDoc.pinned)\r\n\t\t\t} else {\r\n\t\t\t\tsetFavs([null, null, null, null])\r\n\t\t\t}\r\n\r\n\t\t\tsetLatestChat(chats[0])\r\n\t\t} else {\r\n\t\t\tsetLatestChat('')\r\n\t\t}\r\n\t}, [chats, userDoc])\r\n\r\n\tuseEffect(() => {\r\n\t\tsetCurrentPath(location.pathname)\r\n\t}, [location])\r\n\r\n\tuseEffect(() => {\r\n\t\tif (userDoc && userDoc.pinned !== null) {\r\n\t\t\tsetFavs(userDoc.pinned)\r\n\t\t}\r\n\t}, [userDoc])\r\n\r\n\tconst handleOnDragEnd = async result => {\r\n\t\tif (!result.destination) return\r\n\t\tconst items = Array.from(favs)\r\n\t\tconst [reorderedItem] = items.splice(result.source.index, 1)\r\n\t\titems.splice(result.destination.index, 0, reorderedItem)\r\n\r\n\t\tsetFavs(items)\r\n\t\tawait updateDocument(user.uid, {\r\n\t\t\tpinned: items,\r\n\t\t})\r\n\t}\r\n\r\n\tconst handleOnDragEndCopy = result => {\r\n\t\tif (!result.destination) return\r\n\r\n\t\tif (result.source.droppableId === result.destination.droppableId && result.source.droppableId === 'manage-favs') {\r\n\t\t\tconst items = Array.from(favsCopy)\r\n\t\t\tconst [reorderedItem] = items.splice(result.source.index, 1)\r\n\t\t\titems.splice(result.destination.index, 0, reorderedItem)\r\n\t\t\tsetFavsCopy(items)\r\n\t\t}\r\n\r\n\t\tif (result.destination.droppableId === 'empty-slots') {\r\n\t\t\tconst favs = Array.from(favsCopy)\r\n\t\t\tconst items = Array.from(chats.filter(chat => !filterChats(chat)))\r\n\r\n\t\t\tconst chatToAdd = items[result.source.index]\r\n\t\t\tlet userToAdd\r\n\t\t\tlet index\r\n\r\n\t\t\tif (!chatToAdd.isGroup) {\r\n\t\t\t\tchatToAdd.assignedUsers.forEach(u => {\r\n\t\t\t\t\tif (u.id !== user.uid) {\r\n\t\t\t\t\t\tuserToAdd = {\r\n\t\t\t\t\t\t\tid: chatToAdd.id,\r\n\t\t\t\t\t\t\tuid: u.id,\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t}\r\n\r\n\t\t\tfavs.forEach(item => {\r\n\t\t\t\tif (item === null) {\r\n\t\t\t\t\tindex = favsCopy.indexOf(item)\r\n\t\t\t\t}\r\n\t\t\t})\r\n\r\n\t\t\tfavs.splice(index, 1, userToAdd)\r\n\r\n\t\t\tsetFavsCopy(favs)\r\n\t\t}\r\n\t}\r\n\r\n\tconst handleRemoveFav = fav => {\r\n\t\tconst items = Array.from(favsCopy)\r\n\t\t// const [reorderedItem] = items.splice(favs.indexOf(fav), 1)\r\n\t\titems.splice(favsCopy.indexOf(fav), 1)\r\n\t\titems.push(null)\r\n\r\n\t\tsetFavsCopy(items)\r\n\t}\r\n\r\n\tconst filterChats = chat => {\r\n\t\tlet result = false\r\n\t\tif (favsCopy) {\r\n\t\t\tfavsCopy.forEach(fav => {\r\n\t\t\t\tif (fav !== null) {\r\n\t\t\t\t\tif (fav.id === chat.id) {\r\n\t\t\t\t\t\tresult = true\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t}\r\n\t\treturn result\r\n\t}\r\n\r\n\tconst addFav = chat => {\r\n\t\tconst items = Array.from(favsCopy)\r\n\t\tlet index\r\n\t\tlet userToAdd\r\n\r\n\t\tif (!chat.isGroup) {\r\n\t\t\tchat.assignedUsers.forEach(u => {\r\n\t\t\t\tif (u.id !== user.uid) {\r\n\t\t\t\t\tuserToAdd = {\r\n\t\t\t\t\t\tid: chat.id,\r\n\t\t\t\t\t\tuid: u.id,\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t}\r\n\r\n\t\titems.forEach(item => {\r\n\t\t\tif (item === null) {\r\n\t\t\t\tindex = favsCopy.indexOf(item)\r\n\t\t\t}\r\n\t\t})\r\n\r\n\t\titems.splice(index, 1, userToAdd)\r\n\t\tsetFavsCopy(items)\r\n\t}\r\n\r\n\tconst getDoc = id => {\r\n\t\tlet res = null\r\n\r\n\t\tif (users) {\r\n\t\t\tres = users.filter(doc => {\r\n\t\t\t\tif (doc.id === id) {\r\n\t\t\t\t\treturn true\r\n\t\t\t\t}\r\n\t\t\t\treturn false\r\n\t\t\t})\r\n\t\t}\r\n\r\n\t\treturn res[0]\r\n\t}\r\n\r\n\treturn (\r\n\t\tuserDoc && (\r\n\t\t\t<div className='tool-bar'>\r\n\t\t\t\t<nav className='tool-bar__pages'>\r\n\t\t\t\t\t<NavLink to={`/u/${latestChat && latestChat.id}`} className={currentPath.includes('/u/') ? 'active' : ''}>\r\n\t\t\t\t\t\t<i className='fa-solid fa-comment'></i>\r\n\t\t\t\t\t</NavLink>\r\n\t\t\t\t\t<NavLink to='/'>\r\n\t\t\t\t\t\t<i className='fa-solid fa-house'></i>\r\n\t\t\t\t\t</NavLink>\r\n\t\t\t\t\t<NavLink to='/friends'>\r\n\t\t\t\t\t\t<i className='fa-solid fa-address-book'></i>\r\n\t\t\t\t\t</NavLink>\r\n\r\n\t\t\t\t\t<NavLink\r\n\t\t\t\t\t\tto='/settings/account-details'\r\n\t\t\t\t\t\tclassName={`${\r\n\t\t\t\t\t\t\t[\r\n\t\t\t\t\t\t\t\t'/settings/account-details',\r\n\t\t\t\t\t\t\t\t'/settings/profile',\r\n\t\t\t\t\t\t\t\t'/settings/theme',\r\n\t\t\t\t\t\t\t\t'/settings',\r\n\t\t\t\t\t\t\t\t'/settings/',\r\n\t\t\t\t\t\t\t\t'/settings/become-cool',\r\n\t\t\t\t\t\t\t\t'/settings/privacy-and-security',\r\n\t\t\t\t\t\t\t].includes(location.pathname)\r\n\t\t\t\t\t\t\t\t? 'active'\r\n\t\t\t\t\t\t\t\t: ''\r\n\t\t\t\t\t\t}`}>\r\n\t\t\t\t\t\t<i className='fa-solid fa-gear'></i>\r\n\t\t\t\t\t</NavLink>\r\n\t\t\t\t</nav>\r\n\r\n\t\t\t\t<div className='separator-no-text'></div>\r\n\r\n\t\t\t\t<DragDropContext onDragEnd={handleOnDragEnd}>\r\n\t\t\t\t\t<Droppable droppableId='favourites'>\r\n\t\t\t\t\t\t{provided => (\r\n\t\t\t\t\t\t\t<div className='tool-bar__favourites' {...provided.droppableProps} ref={provided.innerRef}>\r\n\t\t\t\t\t\t\t\t{favs &&\r\n\t\t\t\t\t\t\t\t\tfavs.map(\r\n\t\t\t\t\t\t\t\t\t\t(f, index) =>\r\n\t\t\t\t\t\t\t\t\t\t\tf !== null && (\r\n\t\t\t\t\t\t\t\t\t\t\t\t<Draggable key={f.id} draggableId={f.id} index={index}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t{provided => (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Link\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tto={`/u/${f.id}`}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tdraggable='true'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{...provided.draggableProps}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{...provided.dragHandleProps}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tref={provided.innerRef}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Avatar src={getDoc(f.uid) ? getDoc(f.uid).photoURL : ''} />\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</Link>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t\t\t\t\t</Draggable>\r\n\t\t\t\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t{provided.placeholder}\r\n\t\t\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\t\t\tclassName='add-favourite'\r\n\t\t\t\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\t\t\t\tsetShowFavs(true)\r\n\t\t\t\t\t\t\t\t\t\tsetFavsCopy(favs)\r\n\t\t\t\t\t\t\t\t\t}}>\r\n\t\t\t\t\t\t\t\t\t<i className='fa-regular fa-star'></i>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t</Droppable>\r\n\t\t\t\t</DragDropContext>\r\n\r\n\t\t\t\t<div className='separator-no-text'></div>\r\n\r\n\t\t\t\t<Modal show={showFavs} setShow={() => setShowFavs(false)}>\r\n\t\t\t\t\t<div className='manage-favs'>\r\n\t\t\t\t\t\t<DragDropContext onDragEnd={handleOnDragEndCopy}>\r\n\t\t\t\t\t\t\t<Droppable droppableId='manage-favs' direction='horizontal' type='manage-favs'>\r\n\t\t\t\t\t\t\t\t{provided => (\r\n\t\t\t\t\t\t\t\t\t<div className='manage-favs__current-favs' {...provided.droppableProps} ref={provided.innerRef}>\r\n\t\t\t\t\t\t\t\t\t\t{favsCopy &&\r\n\t\t\t\t\t\t\t\t\t\t\tfavsCopy.map(\r\n\t\t\t\t\t\t\t\t\t\t\t\t(f, index) =>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tf !== null && (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Draggable key={f.id} draggableId={f.id} index={index} type='FAVS-LIST'>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{provided => (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclassName='fav'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{...provided.draggableProps}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{...provided.dragHandleProps}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tdraggable='true'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tref={provided.innerRef}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Avatar src={getDoc(f.uid) ? getDoc(f.uid).photoURL : ''} />\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclassName='fav__remove'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\thandleRemoveFav(f)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<i className='fa-solid fa-xmark'></i>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</Draggable>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\t\t\t\t)}\r\n\r\n\t\t\t\t\t\t\t\t\t\t{provided.placeholder}\r\n\r\n\t\t\t\t\t\t\t\t\t\t{favsCopy && favsCopy.includes(null) && (\r\n\t\t\t\t\t\t\t\t\t\t\t<Droppable droppableId='empty-slots' direction='horizontal'>\r\n\t\t\t\t\t\t\t\t\t\t\t\t{provided => (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<div className='flex-row' {...provided.droppableProps} ref={provided.innerRef}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{favsCopy.map(\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t(f, index) =>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tf === null && (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<React.Fragment key={index}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div className='fav fav--empty'>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<i className='fa-regular fa-star'></i>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{provided.placeholder}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</React.Fragment>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t\t\t\t</Droppable>\r\n\t\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t</Droppable>\r\n\r\n\t\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t\t<input\r\n\t\t\t\t\t\t\t\t\ttype='text'\r\n\t\t\t\t\t\t\t\t\tplaceholder='Find a user'\r\n\t\t\t\t\t\t\t\t\tvalue={searchValue}\r\n\t\t\t\t\t\t\t\t\tonChange={e => setSearchValue(e.target.value)}\r\n\t\t\t\t\t\t\t\t\tclassName='mb1'\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t<Droppable droppableId='chats-list' isDropDisabled={true}>\r\n\t\t\t\t\t\t\t\t\t{provided => (\r\n\t\t\t\t\t\t\t\t\t\t<ul\r\n\t\t\t\t\t\t\t\t\t\t\tclassName='manage-favs__chats-list custom-scrollbar'\r\n\t\t\t\t\t\t\t\t\t\t\t{...provided.droppableProps}\r\n\t\t\t\t\t\t\t\t\t\t\tref={provided.innerRef}>\r\n\t\t\t\t\t\t\t\t\t\t\t{chats &&\r\n\t\t\t\t\t\t\t\t\t\t\t\tchats\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t.filter(chat => !filterChats(chat))\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t.map((chat, index) => (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<React.Fragment key={chat.id}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{/* Code for groups */}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{/* {chat.isGroup &&\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tchat.groupName\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t.toLowerCase()\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t.trim()\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t.replace(/\\s+/g, '')\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t.includes(searchValue.toLowerCase()) && (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<li key={chat.id}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Avatar src={chat.photoURL} />\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<p>{chat.displayName}</p>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</li>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t)} */}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{!chat.isGroup &&\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tchat.assignedUsers.map(\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tu =>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tu.id !== user.uid &&\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tgetDoc(u.id) !== null &&\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tgetDoc(u.id)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t.displayName.toLowerCase()\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t.trim()\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t.replace(/\\s+/g, '')\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t.includes(searchValue.toLowerCase()) && (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Draggable key={u.id} draggableId={u.id} index={index}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{(provided, snapshot) => (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<li\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tkey={chat.id}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclassName={`${snapshot.isDragging ? 'dragged' : ''} ${\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tsnapshot.draggingOver === 'empty-slots' ? 'hover-over-slot' : ''\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}`}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tonClick={() => addFav(chat)}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tstyle={{ width: '10px !important' }}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{...provided.draggableProps}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tref={provided.innerRef}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div className='flex-row'>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{!snapshot.isDragging && (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Avatar src={getDoc(u.id) ? getDoc(u.id).photoURL : ''} />\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{!snapshot.isDragging && (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<p>{getDoc(u.id) ? getDoc(u.id).displayName : ''}</p>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div className='handle' {...provided.dragHandleProps}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{!snapshot.isDragging && <i className='fa-solid fa-grip-vertical'></i>}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{snapshot.isDragging && (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Avatar src={getDoc(u.id) ? getDoc(u.id).photoURL : ''} />\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</li>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</Draggable>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</React.Fragment>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t))}\r\n\t\t\t\t\t\t\t\t\t\t\t{provided.placeholder}\r\n\t\t\t\t\t\t\t\t\t\t</ul>\r\n\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t</Droppable>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</DragDropContext>\r\n\r\n\t\t\t\t\t\t<div className='btn-group'>\r\n\t\t\t\t\t\t\t<div className='btn btn--secondary' onClick={() => setShowFavs(false)}>\r\n\t\t\t\t\t\t\t\tcancel\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\t\tclassName='btn'\r\n\t\t\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\t\t\tupdateDocument(user.uid, {\r\n\t\t\t\t\t\t\t\t\t\tpinned: favsCopy,\r\n\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\tsetShowFavs(false)\r\n\t\t\t\t\t\t\t\t}}>\r\n\t\t\t\t\t\t\t\tfinish\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</Modal>\r\n\r\n\t\t\t\t<div className='tool-bar__profile-menu'>\r\n\t\t\t\t\t<div\r\n\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\tsetShowProfile(true)\r\n\t\t\t\t\t\t}}>\r\n\t\t\t\t\t\t<AvatarWithStatus userId={userDoc.id} linkToProfile={false} noTooltip={true} />\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t<ProfilePreview show={showProfile} setShow={() => setShowProfile(false)} userId={userDoc.id} />\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t)\r\n\t)\r\n}\r\n\r\nexport default ToolBar\r\n","export default __webpack_public_path__ + \"static/media/premium-account.5a5ada39.png\";","import React, { useState } from 'react'\r\nimport { Link, useParams } from 'react-router-dom'\r\nimport { useAuthContext } from '../../hooks/useAuthContext'\r\nimport { useDocument } from '../../hooks/useDocument'\r\nimport { useFirestore } from '../../hooks/useFirestore'\r\nimport { useCollection } from '../../hooks/useCollection'\r\nimport { timestamp } from '../../firebase/config'\r\nimport { useDates } from '../../hooks/useDates'\r\nimport { v4 as uuid } from 'uuid'\r\nimport ReactCountryFlag from 'react-country-flag'\r\n\r\n// Styles && Assets\r\nimport './Profile.scss'\r\nimport premiumIcon from '../../assets/premium-account.png'\r\nimport classicAccIcon from '../../assets/logo-default.png'\r\n\r\n// Components\r\nimport AvatarWithStatus from '../../components/AvatarWithStatus/AvatarWithStatus'\r\nimport Tooltip from '../../components/Tooltip/Tooltip'\r\nimport randomColor from 'randomcolor'\r\nimport Avatar from '../../components/Avatar/Avatar'\r\nimport Modal from '../../components/Modal/Modal'\r\nimport OutsideClickHandler from 'react-outside-click-handler'\r\nimport EmojiPicker, { EmojiStyle, Theme } from 'emoji-picker-react'\r\n\r\nexport default function Profile() {\r\n\tconst randColor = randomColor()\r\n\tconst uniqueId = uuid()\r\n\r\n\tconst { id } = useParams()\r\n\tconst { user } = useAuthContext()\r\n\tconst { error, document: userDoc } = useDocument('users', id)\r\n\tconst { documents } = useCollection('users')\r\n\tconst { updateDocument } = useFirestore('users')\r\n\tconst { formatDate } = useDates()\r\n\tconst { documents: chats } = useCollection('projects')\r\n\r\n\tconst [confirmDelete, setConfirmDelete] = useState(null)\r\n\tconst [comment, setComment] = useState('')\r\n\tconst [showEmojiPicker, setShowEmojiPicker] = useState(false)\r\n\tconst [showInputControls, setShowInputControls] = useState(false)\r\n\r\n\tconst getDoc = id => {\r\n\t\tlet res = null\r\n\t\tif (documents) {\r\n\t\t\tres = documents.filter(doc => {\r\n\t\t\t\tif (doc.id === id) {\r\n\t\t\t\t\treturn true\r\n\t\t\t\t}\r\n\t\t\t\treturn false\r\n\t\t\t})[0]\r\n\t\t}\r\n\r\n\t\treturn res\r\n\t}\r\n\r\n\tconst addComment = async () => {\r\n\t\tif (comment.trim() === '') return\r\n\r\n\t\tif (userDoc.profileComments) {\r\n\t\t\tawait updateDocument(id, {\r\n\t\t\t\tprofileComments: [\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tid: uniqueId,\r\n\t\t\t\t\t\tcontent: comment,\r\n\t\t\t\t\t\tcreatedBy: user.uid,\r\n\t\t\t\t\t\tcreatedAt: timestamp.fromDate(new Date()),\r\n\t\t\t\t\t},\r\n\t\t\t\t\t...userDoc.profileComments,\r\n\t\t\t\t],\r\n\t\t\t})\r\n\t\t} else {\r\n\t\t\tawait updateDocument(id, {\r\n\t\t\t\tprofileComments: [\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tid: uniqueId,\r\n\t\t\t\t\t\tcontent: comment,\r\n\t\t\t\t\t\tcreatedBy: user.uid,\r\n\t\t\t\t\t\tcreatedAt: timestamp.fromDate(new Date()),\r\n\t\t\t\t\t},\r\n\t\t\t\t],\r\n\t\t\t})\r\n\t\t}\r\n\r\n\t\tsetComment('')\r\n\t}\r\n\r\n\tconst deleteComment = async comment => {\r\n\t\tawait updateDocument(id, {\r\n\t\t\tprofileComments: [\r\n\t\t\t\t...userDoc.profileComments.filter(comm => {\r\n\t\t\t\t\treturn comment !== comm\r\n\t\t\t\t}),\r\n\t\t\t],\r\n\t\t})\r\n\r\n\t\tsetConfirmDelete(null)\r\n\t}\r\n\r\n\tconst handleEmojis = e => {\r\n\t\tsetComment(comment => comment + e.emoji)\r\n\t}\r\n\r\n\tconst getChatId = id => {\r\n\t\tlet res = ''\r\n\r\n\t\tif (chats) {\r\n\t\t\tchats.filter(chat => {\r\n\t\t\t\tif (\r\n\t\t\t\t\t!chat.isGroup &&\r\n\t\t\t\t\t(chat.assignedUsersId[0] === id || chat.assignedUsersId[0] === user.uid) &&\r\n\t\t\t\t\t(chat.assignedUsersId[1] === id || chat.assignedUsersId[1] === user.uid)\r\n\t\t\t\t) {\r\n\t\t\t\t\tres = chat.id\r\n\t\t\t\t\treturn true\r\n\t\t\t\t} else {\r\n\t\t\t\t\treturn false\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t}\r\n\r\n\t\treturn res\r\n\t}\r\n\r\n\tif (error !== null) {\r\n\t\treturn <div className='error'>{error}</div>\r\n\t}\r\n\r\n\tif (userDoc) {\r\n\t\treturn (\r\n\t\t\t<div className='profile'>\r\n\t\t\t\t<div className='wrapper flex-column'>\r\n\t\t\t\t\t<div\r\n\t\t\t\t\t\tclassName='banner'\r\n\t\t\t\t\t\tstyle={userDoc.banner ? { background: userDoc.banner } : { background: randColor }}></div>\r\n\r\n\t\t\t\t\t<div className='profile__header'>\r\n\t\t\t\t\t\t<div className='flex-row'>\r\n\t\t\t\t\t\t\t<AvatarWithStatus userId={userDoc.id} />\r\n\r\n\t\t\t\t\t\t\t<div className='flex-column'>\r\n\t\t\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t\t\t<h3 className='name'>{userDoc.displayName}</h3>\r\n\t\t\t\t\t\t\t\t\t{userDoc.bio && <p className='bio'>{userDoc.bio}</p>}\r\n\t\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t\t<div className='badges'>\r\n\t\t\t\t\t\t\t\t\t{userDoc.createdAt && (\r\n\t\t\t\t\t\t\t\t\t\t<div className='badges__badge'>\r\n\t\t\t\t\t\t\t\t\t\t\t<p>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<span>Joined</span> - {userDoc.createdAt}\r\n\t\t\t\t\t\t\t\t\t\t\t</p>\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t)}\r\n\r\n\t\t\t\t\t\t\t\t\t{userDoc.pronouns && (\r\n\t\t\t\t\t\t\t\t\t\t<div className='badges__badge'>\r\n\t\t\t\t\t\t\t\t\t\t\t<p>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<span>Pronouns</span> - {userDoc.pronouns}\r\n\t\t\t\t\t\t\t\t\t\t\t</p>\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t)}\r\n\r\n\t\t\t\t\t\t\t\t\t{userDoc.country && (\r\n\t\t\t\t\t\t\t\t\t\t<div className='badges__badge'>\r\n\t\t\t\t\t\t\t\t\t\t\t<p className='country'>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<ReactCountryFlag countryCode={`${userDoc.country.code}`} svg />\r\n\t\t\t\t\t\t\t\t\t\t\t\t{userDoc.country.name}\r\n\t\t\t\t\t\t\t\t\t\t\t</p>\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t<div className='flex-column'>\r\n\t\t\t\t\t\t\t{userDoc.premium && (\r\n\t\t\t\t\t\t\t\t<div className='account-status account-status--premium'>\r\n\t\t\t\t\t\t\t\t\t<img src={premiumIcon} alt='Icon for premium account' />\r\n\t\t\t\t\t\t\t\t\t<span>Plenvy Pro</span>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t{!userDoc.premium && (\r\n\t\t\t\t\t\t\t\t<div className='account-status account-status--classic'>\r\n\t\t\t\t\t\t\t\t\t<img src={classicAccIcon} alt='Icon for classic account' />\r\n\t\t\t\t\t\t\t\t\t<span>Plenvy Classic</span>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t<div className='btn-group'>\r\n\t\t\t\t\t\t\t\t{id === user.uid && (\r\n\t\t\t\t\t\t\t\t\t<Link to='/settings/profile'>\r\n\t\t\t\t\t\t\t\t\t\t<button className='action-btn btn'>edit profile</button>\r\n\t\t\t\t\t\t\t\t\t</Link>\r\n\t\t\t\t\t\t\t\t)}\r\n\r\n\t\t\t\t\t\t\t\t{id !== user.uid && (\r\n\t\t\t\t\t\t\t\t\t<>\r\n\t\t\t\t\t\t\t\t\t\t{/* // ! Show When User ISN'T Friend */}\r\n\t\t\t\t\t\t\t\t\t\t{/* <button className='action-btn btn'>add friend</button> */}\r\n\r\n\t\t\t\t\t\t\t\t\t\t{/* // ! Show When User IS Friend */}\r\n\t\t\t\t\t\t\t\t\t\t<Link to={`/u/${getChatId(userDoc.id)}`}>\r\n\t\t\t\t\t\t\t\t\t\t\t<button className='action-btn btn'>send message</button>\r\n\t\t\t\t\t\t\t\t\t\t</Link>\r\n\t\t\t\t\t\t\t\t\t</>\r\n\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t<div className='separator'></div>\r\n\t\t\t\t\t<h3>someday there will be something</h3>\r\n\r\n\t\t\t\t\t<div className='profile__comments custom-scrollbar'>\r\n\t\t\t\t\t\t<div className='separator'></div>\r\n\t\t\t\t\t\t<div className='comment-input'>\r\n\t\t\t\t\t\t\t<Avatar src={userDoc.photoURL} />\r\n\r\n\t\t\t\t\t\t\t<input\r\n\t\t\t\t\t\t\t\ttype='text'\r\n\t\t\t\t\t\t\t\tplaceholder='Add a comment'\r\n\t\t\t\t\t\t\t\tvalue={comment}\r\n\t\t\t\t\t\t\t\tonChange={e => setComment(e.target.value)}\r\n\t\t\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\t\t\tsetShowInputControls(true)\r\n\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t/>\r\n\r\n\t\t\t\t\t\t\t{showInputControls && (\r\n\t\t\t\t\t\t\t\t<div className='input-controls'>\r\n\t\t\t\t\t\t\t\t\t<i className='fa-regular fa-face-smile' onClick={() => setShowEmojiPicker(true)}>\r\n\t\t\t\t\t\t\t\t\t\t{showEmojiPicker && (\r\n\t\t\t\t\t\t\t\t\t\t\t<Tooltip pos='right' align='start'>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<OutsideClickHandler\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tonOutsideClick={() => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tsetShowEmojiPicker(false)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t}}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<EmojiPicker\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tclassName='emoji-picker'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tonEmojiClick={e => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\thandleEmojis(e)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ttheme={Theme.DARK}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tpreviewConfig={{\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tdefaultCaption: '',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tdefaultEmoji: null,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t// lazyLoadEmojis={true}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\temojiStyle={EmojiStyle.NATIVE}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</OutsideClickHandler>\r\n\t\t\t\t\t\t\t\t\t\t\t</Tooltip>\r\n\t\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t\t</i>\r\n\r\n\t\t\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\t\t\tclassName='btn cancel-btn'\r\n\t\t\t\t\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\t\t\t\t\tsetShowInputControls(false)\r\n\t\t\t\t\t\t\t\t\t\t}}>\r\n\t\t\t\t\t\t\t\t\t\tcancel\r\n\t\t\t\t\t\t\t\t\t</button>\r\n\r\n\t\t\t\t\t\t\t\t\t{comment.trim().length === 0 && (\r\n\t\t\t\t\t\t\t\t\t\t<button className='btn' disabled>\r\n\t\t\t\t\t\t\t\t\t\t\tcomment\r\n\t\t\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t\t\t)}\r\n\r\n\t\t\t\t\t\t\t\t\t{comment.trim().length > 0 && (\r\n\t\t\t\t\t\t\t\t\t\t<button className='btn' onClick={() => addComment()}>\r\n\t\t\t\t\t\t\t\t\t\t\tcomment\r\n\t\t\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t<div className='comments-container'>\r\n\t\t\t\t\t\t\t{userDoc.profileComments &&\r\n\t\t\t\t\t\t\t\tuserDoc.profileComments.map(\r\n\t\t\t\t\t\t\t\t\tcomment =>\r\n\t\t\t\t\t\t\t\t\t\tgetDoc(comment.createdBy) !== null && (\r\n\t\t\t\t\t\t\t\t\t\t\t<div className='comments-container__comment' key={comment.id}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<Avatar src={getDoc(comment.createdBy).photoURL} />\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t<div className='flex-column'>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<div className='flex-row'>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span>{getDoc(comment.createdBy).displayName}</span>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span>{formatDate(comment.createdAt)}</span>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<p>{comment.content}</p>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t{(id === user.uid || comment.createdBy === user.uid) && (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<i\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tclassName='fa-solid fa-trash-can delete-comment'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tonClick={() => setConfirmDelete(comment)}></i>\r\n\t\t\t\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\t)}\r\n\r\n\t\t\t\t\t\t\t<Modal show={confirmDelete !== null} setShow={() => setConfirmDelete(null)}>\r\n\t\t\t\t\t\t\t\t<div className='flex-column'>\r\n\t\t\t\t\t\t\t\t\t<h3 className='mt1'>Delete comment</h3>\r\n\r\n\t\t\t\t\t\t\t\t\t<p className='mb3'>Are you sure you want to delete this comment?</p>\r\n\r\n\t\t\t\t\t\t\t\t\t<div className='btn-group'>\r\n\t\t\t\t\t\t\t\t\t\t<button className='btn btn--secondary' onClick={() => setConfirmDelete(null)}>\r\n\t\t\t\t\t\t\t\t\t\t\tcancel\r\n\t\t\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\t\t\t\tclassName='btn'\r\n\t\t\t\t\t\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\t\t\t\t\t\tdeleteComment(confirmDelete)\r\n\t\t\t\t\t\t\t\t\t\t\t}}>\r\n\t\t\t\t\t\t\t\t\t\t\tdelete\r\n\t\t\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t</Modal>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t)\r\n\t}\r\n\treturn null\r\n}\r\n","// Styles\r\nimport './Loader.scss'\r\n\r\nexport default function Loader() {\r\n\treturn (\r\n\t\t<div className='loader'>\r\n\t\t\t<span></span>\r\n\t\t</div>\r\n\t)\r\n}\r\n","import { useState } from 'react'\r\nimport { useFirestore } from '../../../../../hooks/useFirestore'\r\nimport { useAuthContext } from '../../../../../hooks/useAuthContext'\r\nimport { updateProfile } from 'firebase/auth'\r\nimport { toast, ToastContainer } from 'react-toastify'\r\n\r\n// Components\r\nimport Modal from '../../../../../components/Modal/Modal'\r\nimport Loader from '../../../../../components/Loader/Loader'\r\n\r\nconst Username = () => {\r\n\tconst { user } = useAuthContext()\r\n\tconst { updateDocument } = useFirestore('users')\r\n\r\n\tconst [error, setError] = useState('')\r\n\tconst [isPending, setIsPending] = useState(false)\r\n\r\n\tconst [username, setUsername] = useState('')\r\n\tconst [show, setShow] = useState(false)\r\n\r\n\tconst notify = message =>\r\n\t\ttoast.success(message, {\r\n\t\t\tposition: 'bottom-right',\r\n\t\t\tautoClose: 5000,\r\n\t\t\thideProgressBar: false,\r\n\t\t\tcloseOnClick: true,\r\n\t\t\tpauseOnHover: true,\r\n\t\t\tdraggable: true,\r\n\t\t\tprogress: undefined,\r\n\t\t\ttheme: 'dark',\r\n\t\t})\r\n\r\n\tconst updateUsername = async () => {\r\n\t\tsetError(null)\r\n\t\tif (username.length > 3) {\r\n\t\t\tsetIsPending(true)\r\n\r\n\t\t\ttry {\r\n\t\t\t\tawait updateProfile(user, {\r\n\t\t\t\t\tdisplayName: username,\r\n\t\t\t\t})\r\n\t\t\t\tawait updateDocument(user.uid, {\r\n\t\t\t\t\tdisplayName: username,\r\n\t\t\t\t})\r\n\r\n\t\t\t\tsetIsPending(false)\r\n\t\t\t\tsetError(null)\r\n\t\t\t\tsetShow(false)\r\n\t\t\t\tsetUsername('')\r\n\t\t\t\tnotify('Successfully set a new username')\r\n\t\t\t} catch (error) {\r\n\t\t\t\tsetError(error.message)\r\n\t\t\t\tconsole.log(error.message)\r\n\t\t\t\tsetIsPending(false)\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tsetError('Username must be at least 3 characters long')\r\n\t\t}\r\n\t}\r\n\r\n\treturn (\r\n\t\t<div className='account-details__details-field'>\r\n\t\t\t<ToastContainer />\r\n\t\t\t<h3>username</h3>\r\n\t\t\t<p>{user.displayName}</p>\r\n\t\t\t{/* <i className='fa-solid fa-pencil' onClick={() => setShow(true)}>\r\n\t\t\t\t\t\t\t<Tooltip>Edit</Tooltip>\r\n\t\t\t\t\t\t</i> */}\r\n\t\t\t<button className='btn btn--secondary' onClick={() => setShow(true)}>\r\n\t\t\t\tedit\r\n\t\t\t</button>\r\n\t\t\t<Modal\r\n\t\t\t\tshow={show}\r\n\t\t\t\tsetShow={() => setShow(false)}\r\n\t\t\t\tonClose={() => {\r\n\t\t\t\t\tsetIsPending(false)\r\n\t\t\t\t\tsetError(null)\r\n\t\t\t\t\tsetShow(false)\r\n\t\t\t\t\tsetUsername('')\r\n\t\t\t\t}}>\r\n\t\t\t\t<h3>Change your username</h3>\r\n\t\t\t\t<p>Enter a new, always cool username</p>\r\n\r\n\t\t\t\t<input type='text' placeholder='Username' value={username} onChange={e => setUsername(e.target.value)} />\r\n\r\n\t\t\t\t{isPending && <Loader />}\r\n\t\t\t\t{error && <div className='error'>{error}</div>}\r\n\t\t\t\t<div className='btn-group'>\r\n\t\t\t\t\t<button className='btn btn--secondary' onClick={() => setShow(false)}>\r\n\t\t\t\t\t\tcancel\r\n\t\t\t\t\t</button>\r\n\t\t\t\t\t<button className='btn' onClick={() => updateUsername()}>\r\n\t\t\t\t\t\tupdate\r\n\t\t\t\t\t</button>\r\n\t\t\t\t</div>\r\n\t\t\t</Modal>\r\n\t\t</div>\r\n\t)\r\n}\r\n\r\nexport default Username\r\n","import { useState } from 'react'\r\nimport { useAuthContext } from '../../../../../hooks/useAuthContext'\r\nimport { toast, ToastContainer } from 'react-toastify'\r\nimport { projectAuth } from '../../../../../firebase/config'\r\n\r\n// Components\r\nimport Modal from '../../../../../components/Modal/Modal'\r\nimport Loader from '../../../../../components/Loader/Loader'\r\n\r\nconst Email = () => {\r\n\tconst { user } = useAuthContext()\r\n\r\n\tconst [error, setError] = useState('')\r\n\tconst [isPending, setIsPending] = useState(false)\r\n\r\n\tconst [email, setEmail] = useState('')\r\n\tconst [show, setShow] = useState(false)\r\n\tconst [currentPassword, setCurrentPassword] = useState('')\r\n\r\n\tconst notify = message =>\r\n\t\ttoast.success(message, {\r\n\t\t\tposition: 'bottom-right',\r\n\t\t\tautoClose: 5000,\r\n\t\t\thideProgressBar: false,\r\n\t\t\tcloseOnClick: true,\r\n\t\t\tpauseOnHover: true,\r\n\t\t\tdraggable: true,\r\n\t\t\tprogress: undefined,\r\n\t\t\ttheme: 'dark',\r\n\t\t})\r\n\r\n\tconst updateEmail = async () => {\r\n\t\tconst regex = /^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\\.[a-zA-Z0-9-]+)*$/\r\n\r\n\t\tsetError(null)\r\n\r\n\t\tif (!email.match(regex)) {\r\n\t\t\treturn setError('Invalid email address')\r\n\t\t}\r\n\t\tif (currentPassword === '') {\r\n\t\t\treturn setError('Enter your password')\r\n\t\t}\r\n\r\n\t\tsetIsPending(true)\r\n\r\n\t\tprojectAuth\r\n\t\t\t.signInWithEmailAndPassword(user.email, currentPassword)\r\n\t\t\t.then(userCredential => {\r\n\t\t\t\tuserCredential.user\r\n\t\t\t\t\t.updateEmail(email)\r\n\t\t\t\t\t.then(() => {\r\n\t\t\t\t\t\tsetIsPending(false)\r\n\t\t\t\t\t\tsetError(null)\r\n\t\t\t\t\t\tsetShow(false)\r\n\t\t\t\t\t\tsetEmail('')\r\n\t\t\t\t\t\tnotify('Successfully updated email address')\r\n\t\t\t\t\t})\r\n\t\t\t\t\t.catch(error => {\r\n\t\t\t\t\t\tconsole.log(error.message)\r\n\t\t\t\t\t\tsetError(error.message)\r\n\t\t\t\t\t\tsetIsPending(false)\r\n\t\t\t\t\t})\r\n\t\t\t})\r\n\t\t\t.catch(error => {\r\n\t\t\t\tconsole.log(error.message)\r\n\t\t\t\tsetError(error.message)\r\n\t\t\t\tsetIsPending(false)\r\n\t\t\t})\r\n\t}\r\n\r\n\treturn (\r\n\t\t<div className='account-details__details-field'>\r\n\t\t\t<ToastContainer />\r\n\t\t\t<h3>email</h3>\r\n\t\t\t<p>{user.email}</p>\r\n\t\t\t<button className='btn btn--secondary' onClick={() => setShow(true)}>\r\n\t\t\t\tedit\r\n\t\t\t</button>\r\n\t\t\t<Modal\r\n\t\t\t\tshow={show}\r\n\t\t\t\tsetShow={() => setShow(false)}\r\n\t\t\t\tonClose={() => {\r\n\t\t\t\t\tsetIsPending(false)\r\n\t\t\t\t\tsetError(null)\r\n\t\t\t\t\tsetShow(false)\r\n\t\t\t\t\tsetEmail('')\r\n\t\t\t\t}}>\r\n\t\t\t\t<h3 className='mb05'>Change your email address</h3>\r\n\t\t\t\t<p>Enter a new email address</p>\r\n\r\n\t\t\t\t<label>\r\n\t\t\t\t\t<input type='email' placeholder='Email' value={email} onChange={e => setEmail(e.target.value)} />\r\n\t\t\t\t</label>\r\n\t\t\t\t<label>\r\n\t\t\t\t\t<input\r\n\t\t\t\t\t\ttype='password'\r\n\t\t\t\t\t\tplaceholder='Password'\r\n\t\t\t\t\t\tvalue={currentPassword}\r\n\t\t\t\t\t\tonChange={e => setCurrentPassword(e.target.value)}\r\n\t\t\t\t\t/>\r\n\t\t\t\t</label>\r\n\r\n\t\t\t\t{isPending && <Loader />}\r\n\t\t\t\t{error && <div className='error'>{error}</div>}\r\n\t\t\t\t<div className='btn-group'>\r\n\t\t\t\t\t<button className='btn btn--secondary' onClick={() => setShow(false)}>\r\n\t\t\t\t\t\tcancel\r\n\t\t\t\t\t</button>\r\n\t\t\t\t\t<button className='btn' onClick={() => updateEmail()}>\r\n\t\t\t\t\t\tupdate\r\n\t\t\t\t\t</button>\r\n\t\t\t\t</div>\r\n\t\t\t</Modal>\r\n\t\t</div>\r\n\t)\r\n}\r\n\r\nexport default Email\r\n","import { useState } from 'react'\r\nimport { useAuthContext } from '../../../../../hooks/useAuthContext'\r\nimport { toast, ToastContainer } from 'react-toastify'\r\nimport { linkWithCredential, PhoneAuthProvider, updatePhoneNumber } from 'firebase/auth'\r\nimport { projectAuth } from '../../../../../firebase/config'\r\nimport { useLogin } from '../../../../../hooks/useLogin'\r\n\r\n// Styles\r\nimport 'react-phone-input-2/lib/bootstrap.css'\r\n\r\n// Components\r\nimport Loader from '../../../../../components/Loader/Loader'\r\nimport Modal from '../../../../../components/Modal/Modal'\r\nimport PhoneInput from 'react-phone-input-2'\r\n\r\nconst PhoneNumber = () => {\r\n\tconst { user } = useAuthContext()\r\n\tconst { setUpRecaptcha } = useLogin()\r\n\r\n\tconst [error, setError] = useState('')\r\n\tconst [isPending, setIsPending] = useState(false)\r\n\r\n\tconst [phoneNumber, setPhoneNumber] = useState('')\r\n\tconst [show, setShow] = useState(false)\r\n\tconst [confirmUnlink, setConfirmUnlink] = useState(false)\r\n\r\n\tconst [showOTP, setShowOTP] = useState(false)\r\n\tconst [captchaResponse, setCaptchaResponse] = useState('')\r\n\tconst [OTPCode, setOTPCode] = useState('')\r\n\r\n\tconst notify = message =>\r\n\t\ttoast.success(message, {\r\n\t\t\tposition: 'bottom-right',\r\n\t\t\tautoClose: 5000,\r\n\t\t\thideProgressBar: false,\r\n\t\t\tcloseOnClick: true,\r\n\t\t\tpauseOnHover: true,\r\n\t\t\tdraggable: true,\r\n\t\t\tprogress: undefined,\r\n\t\t\ttheme: 'dark',\r\n\t\t})\r\n\r\n\tconst unlinkPhoneNumber = () => {\r\n\t\tconst provider = new PhoneAuthProvider(projectAuth)\r\n\r\n\t\tuser.unlink(provider.providerId)\r\n\t\tnotify('Successfully unlinked phone number')\r\n\t}\r\n\r\n\tconst handleOTPInput = e => {\r\n\t\tconst limit = 6\r\n\t\tsetOTPCode(e.target.value.slice(0, limit))\r\n\t}\r\n\r\n\tconst sendOTP = async () => {\r\n\t\tconsole.log(`${phoneNumber}`)\r\n\t\tsetError(null)\r\n\t\tif (phoneNumber === '' || phoneNumber === undefined || phoneNumber === null) {\r\n\t\t\tsetError('Please enter a valid Phone Number!')\r\n\t\t\treturn\r\n\t\t}\r\n\r\n\t\ttry {\r\n\t\t\tconst response = await setUpRecaptcha(`+${phoneNumber}`)\r\n\r\n\t\t\tsetCaptchaResponse(response)\r\n\t\t\tsetShowOTP(true)\r\n\t\t} catch (err) {\r\n\t\t\tsetError(err.message)\r\n\t\t\tconsole.log(err.message)\r\n\t\t}\r\n\t}\r\n\r\n\tconst verifyOTP = async () => {\r\n\t\tif (OTPCode === '' || OTPCode === null) return\r\n\r\n\t\ttry {\r\n\t\t\tsetError(null)\r\n\t\t\tsetIsPending(true)\r\n\r\n\t\t\tconst authCredential = PhoneAuthProvider.credential(captchaResponse, OTPCode)\r\n\r\n\t\t\tif (user.phoneNumber === null || user.phoneNumber === undefined) {\r\n\t\t\t\tawait linkWithCredential(user, authCredential)\r\n\t\t\t} else {\r\n\t\t\t\tawait updatePhoneNumber(user, authCredential)\r\n\t\t\t}\r\n\r\n\t\t\tsetIsPending(false)\r\n\t\t\tsetShow(false)\r\n\t\t\tsetShowOTP(false)\r\n\t\t\tsetPhoneNumber('')\r\n\t\t\tsetOTPCode('')\r\n\t\t\tsetCaptchaResponse('')\r\n\t\t\tnotify('Successfully changed phone number')\r\n\t\t} catch (err) {\r\n\t\t\tconsole.log(err.message)\r\n\t\t\tsetError(err.message)\r\n\t\t\tsetIsPending(false)\r\n\t\t}\r\n\t}\r\n\r\n\treturn (\r\n\t\t<div className='account-details__details-field'>\r\n\t\t\t<ToastContainer />\r\n\t\t\t<h3>phone</h3>\r\n\t\t\t<p>{user.phoneNumber ? user.phoneNumber : \"You haven't added a phone number yet\"}</p>\r\n\r\n\t\t\t<div className='flex-row'>\r\n\t\t\t\t{/* <i className='fa-solid fa-pencil' onClick={() => setShow(true)}>\r\n                <Tooltip>Edit</Tooltip>\r\n            </i> */}\r\n\t\t\t\t{user.phoneNumber && (\r\n\t\t\t\t\t<button className='btn' onClick={() => setConfirmUnlink(true)}>\r\n\t\t\t\t\t\tremove\r\n\t\t\t\t\t</button>\r\n\t\t\t\t)}\r\n\t\t\t\t<button className='btn btn--secondary' onClick={() => setShow(true)}>\r\n\t\t\t\t\t{user.phoneNumber ? 'edit' : 'add'}\r\n\t\t\t\t</button>\r\n\t\t\t</div>\r\n\r\n\t\t\t<Modal show={confirmUnlink} setShow={() => setConfirmUnlink(false)}>\r\n\t\t\t\t<h3 className='mb05'>Remove phone number</h3>\r\n\t\t\t\t<p>Are you sure you want to remove your phone number from this account?</p>\r\n\r\n\t\t\t\t{/* // !! Require password for remove */}\r\n\r\n\t\t\t\t<div className='btn-group'>\r\n\t\t\t\t\t<button className='btn btn--secondary' onClick={() => setConfirmUnlink(false)}>\r\n\t\t\t\t\t\tcancel\r\n\t\t\t\t\t</button>\r\n\t\t\t\t\t<button className='btn' onClick={() => unlinkPhoneNumber()}>\r\n\t\t\t\t\t\tremove\r\n\t\t\t\t\t</button>\r\n\t\t\t\t</div>\r\n\t\t\t</Modal>\r\n\r\n\t\t\t<Modal\r\n\t\t\t\tshow={show}\r\n\t\t\t\tsetShow={() => setShow(false)}\r\n\t\t\t\tonClose={() => {\r\n\t\t\t\t\tsetIsPending(false)\r\n\t\t\t\t\tsetShow(false)\r\n\t\t\t\t\tsetShowOTP(false)\r\n\t\t\t\t\tsetPhoneNumber('')\r\n\t\t\t\t\tsetOTPCode('')\r\n\t\t\t\t\tsetCaptchaResponse('')\r\n\t\t\t\t}}>\r\n\t\t\t\t{!showOTP && (\r\n\t\t\t\t\t<>\r\n\t\t\t\t\t\t<h3 className='mb05'>Enter a phone number</h3>\r\n\t\t\t\t\t\t<p>You will recive a message containing a verification code.</p>\r\n\r\n\t\t\t\t\t\t<label>\r\n\t\t\t\t\t\t\t<p>Your new phone number</p>\r\n\t\t\t\t\t\t\t<PhoneInput\r\n\t\t\t\t\t\t\t\tcountry={'pl'}\r\n\t\t\t\t\t\t\t\tvalue={phoneNumber}\r\n\t\t\t\t\t\t\t\tonChange={setPhoneNumber}\r\n\t\t\t\t\t\t\t\tenableSearch={true}\r\n\t\t\t\t\t\t\t\tdropdownClass='custom-scrollbar'\r\n\t\t\t\t\t\t\t\tcopyNumbersOnly={false}\r\n\t\t\t\t\t\t\t\tsearchPlaceholder='Search for countries'\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t</label>\r\n\t\t\t\t\t\t{isPending && <Loader />}\r\n\t\t\t\t\t\t{error && <div className='error'>{error}</div>}\r\n\t\t\t\t\t\t<div id='recaptcha-container' />\r\n\r\n\t\t\t\t\t\t<div className='btn-group'>\r\n\t\t\t\t\t\t\t<button className='btn btn--secondary' onClick={() => setShow(false)}>\r\n\t\t\t\t\t\t\t\tcancel\r\n\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t<button className='btn' onClick={() => sendOTP()}>\r\n\t\t\t\t\t\t\t\tSend code\r\n\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</>\r\n\t\t\t\t)}\r\n\r\n\t\t\t\t{showOTP && (\r\n\t\t\t\t\t<>\r\n\t\t\t\t\t\t<h3 className='mb05'>OTP Verification</h3>\r\n\t\t\t\t\t\t<p>\r\n\t\t\t\t\t\t\tEnter the OTP sent to <span style={{ fontWeight: 'bold' }}>+{phoneNumber}</span>\r\n\t\t\t\t\t\t</p>\r\n\r\n\t\t\t\t\t\t<label className='otp-code'>\r\n\t\t\t\t\t\t\t<input type='number' value={OTPCode} onChange={e => handleOTPInput(e)} />\r\n\t\t\t\t\t\t\t{/* <input type='text' maxLength='1' />\r\n                        <input type='text' maxLength='1' />\r\n                        <input type='text' maxLength='1' />\r\n                        <input type='text' maxLength='1' />\r\n                        <input type='text' maxLength='1' /> */}\r\n\t\t\t\t\t\t</label>\r\n\t\t\t\t\t\t{error && <div className='error'>{error}</div>}\r\n\r\n\t\t\t\t\t\t<div className='btn-group'>\r\n\t\t\t\t\t\t\t<button className='btn btn--secondary' onClick={() => setShowOTP(false)}>\r\n\t\t\t\t\t\t\t\tgo back\r\n\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t<button className='btn' onClick={() => verifyOTP()}>\r\n\t\t\t\t\t\t\t\tChange number\r\n\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</>\r\n\t\t\t\t)}\r\n\t\t\t</Modal>\r\n\t\t</div>\r\n\t)\r\n}\r\n\r\nexport default PhoneNumber\r\n","import { useState } from 'react'\r\nimport { useAuthContext } from '../../../../../hooks/useAuthContext'\r\nimport { projectAuth } from '../../../../../firebase/config'\r\nimport { useLogout } from '../../../../../hooks/useLogout'\r\n\r\n// Components\r\nimport Modal from '../../../../../components/Modal/Modal'\r\nimport Loader from '../../../../../components/Loader/Loader'\r\n\r\nconst Password = () => {\r\n\tconst { user } = useAuthContext()\r\n\tconst { logout } = useLogout()\r\n\r\n\tconst [error, setError] = useState('')\r\n\tconst [isPending, setIsPending] = useState(false)\r\n\tconst [show, setShow] = useState(false)\r\n\r\n\tconst [currentPassword, setCurrentPassword] = useState('')\r\n\tconst [newPassword, setNewPassword] = useState('')\r\n\tconst [confirmNewPassword, setConfirmNewPassword] = useState('')\r\n\r\n\tconst updatePassword = () => {\r\n\t\tsetError(null)\r\n\r\n\t\tif (currentPassword === '') {\r\n\t\t\treturn setError('Enter a password')\r\n\t\t}\r\n\t\tif (newPassword === '' || confirmNewPassword === '') {\r\n\t\t\treturn setError('Enter a new password')\r\n\t\t}\r\n\t\tif (newPassword !== confirmNewPassword) {\r\n\t\t\treturn setError('Passwords must match')\r\n\t\t}\r\n\r\n\t\tsetIsPending(true)\r\n\r\n\t\tprojectAuth\r\n\t\t\t.signInWithEmailAndPassword(user.email, currentPassword)\r\n\t\t\t.then(userCredential => {\r\n\t\t\t\tuserCredential.user\r\n\t\t\t\t\t.updatePassword(newPassword)\r\n\t\t\t\t\t.then(() => {\r\n\t\t\t\t\t\tsetIsPending(false)\r\n\t\t\t\t\t\tsetError(null)\r\n\t\t\t\t\t\tsetShow(false)\r\n\t\t\t\t\t\tsetCurrentPassword('')\r\n\t\t\t\t\t\tsetNewPassword('')\r\n\t\t\t\t\t\tsetConfirmNewPassword('')\r\n\t\t\t\t\t\tlogout()\r\n\t\t\t\t\t})\r\n\t\t\t\t\t.catch(error => {\r\n\t\t\t\t\t\tconsole.log(error.message)\r\n\t\t\t\t\t\tsetError(error.message)\r\n\t\t\t\t\t\tsetIsPending(false)\r\n\t\t\t\t\t})\r\n\t\t\t})\r\n\t\t\t.catch(error => {\r\n\t\t\t\tconsole.log(error.message)\r\n\t\t\t\tsetError('Enter a correct password')\r\n\t\t\t\tsetIsPending(false)\r\n\t\t\t})\r\n\t}\r\n\r\n\treturn (\r\n\t\t<div className='account-details__details-field'>\r\n\t\t\t<h3>password</h3>\r\n\t\t\t<p>***************</p>\r\n\r\n\t\t\t<button className='btn btn--secondary' onClick={() => setShow(true)}>\r\n\t\t\t\tedit\r\n\t\t\t</button>\r\n\t\t\t<Modal\r\n\t\t\t\tshow={show}\r\n\t\t\t\tsetShow={() => setShow(false)}\r\n\t\t\t\tonClose={() => {\r\n\t\t\t\t\tsetIsPending(false)\r\n\t\t\t\t\tsetError(null)\r\n\t\t\t\t\tsetShow(false)\r\n\t\t\t\t\tsetCurrentPassword('')\r\n\t\t\t\t\tsetNewPassword('')\r\n\t\t\t\t\tsetConfirmNewPassword('')\r\n\t\t\t\t}}>\r\n\t\t\t\t<h3 className='mb05'>Change password</h3>\r\n\t\t\t\t<p>Enter your current password and a new password. Also remember that your name isn't a good password...</p>\r\n\r\n\t\t\t\t<label>\r\n\t\t\t\t\t<input\r\n\t\t\t\t\t\ttype='password'\r\n\t\t\t\t\t\tplaceholder='Current password'\r\n\t\t\t\t\t\tvalue={currentPassword}\r\n\t\t\t\t\t\tonChange={e => setCurrentPassword(e.target.value)}\r\n\t\t\t\t\t/>\r\n\t\t\t\t</label>\r\n\t\t\t\t<label>\r\n\t\t\t\t\t<input\r\n\t\t\t\t\t\ttype='password'\r\n\t\t\t\t\t\tplaceholder='New password'\r\n\t\t\t\t\t\tvalue={newPassword}\r\n\t\t\t\t\t\tonChange={e => setNewPassword(e.target.value)}\r\n\t\t\t\t\t/>\r\n\t\t\t\t</label>\r\n\t\t\t\t<label>\r\n\t\t\t\t\t<input\r\n\t\t\t\t\t\ttype='password'\r\n\t\t\t\t\t\tplaceholder='Confirm new password'\r\n\t\t\t\t\t\tvalue={confirmNewPassword}\r\n\t\t\t\t\t\tonChange={e => setConfirmNewPassword(e.target.value)}\r\n\t\t\t\t\t/>\r\n\t\t\t\t</label>\r\n\r\n\t\t\t\t{isPending && <Loader />}\r\n\t\t\t\t{error && <div className='error'>{error}</div>}\r\n\t\t\t\t<div className='btn-group'>\r\n\t\t\t\t\t<button className='btn btn--secondary' onClick={() => setShow(false)}>\r\n\t\t\t\t\t\tcancel\r\n\t\t\t\t\t</button>\r\n\t\t\t\t\t<button className='btn' onClick={() => updatePassword()}>\r\n\t\t\t\t\t\tupdate\r\n\t\t\t\t\t</button>\r\n\t\t\t\t</div>\r\n\t\t\t</Modal>\r\n\t\t</div>\r\n\t)\r\n}\r\n\r\nexport default Password\r\n","import { useEffect, useState } from 'react'\r\nimport { useAuthContext } from '../../../../../hooks/useAuthContext'\r\n\r\n// Components\r\nimport Loader from '../../../../../components/Loader/Loader'\r\nimport Modal from '../../../../../components/Modal/Modal'\r\nimport { deleteUser } from 'firebase/auth'\r\nimport { projectAuth } from '../../../../../firebase/config'\r\n\r\nconst DeleteAccount = () => {\r\n\tconst { user } = useAuthContext()\r\n\r\n\tconst [error, setError] = useState(null)\r\n\tconst [isPending, setIsPending] = useState(null)\r\n\r\n\tconst [show, setShow] = useState(false)\r\n\tconst [confirm, setConfirm] = useState('')\r\n\tconst [startCountdown, setStartCountdown] = useState(false)\r\n\tconst [timeToDelete, setTimeToDelete] = useState(10)\r\n\tconst [credential, setCredential] = useState(null)\r\n\r\n\tuseEffect(() => {\r\n\t\tif (startCountdown === true) {\r\n\t\t\tfinalCountdown()\r\n\t\t}\r\n\t}, [startCountdown])\r\n\r\n\tconst checkPassword = () => {\r\n\t\tif (isPasswordProvider()) {\r\n\t\t\tif (confirm === '') return setError('You must enter a valid password')\r\n\r\n\t\t\tprojectAuth\r\n\t\t\t\t.signInWithEmailAndPassword(user.email, confirm)\r\n\t\t\t\t.then(userCredential => {\r\n\t\t\t\t\tsetStartCountdown(true)\r\n\t\t\t\t\tsetCredential(userCredential)\r\n\t\t\t\t})\r\n\t\t\t\t.catch(error => {\r\n\t\t\t\t\tconsole.log(error.message)\r\n\t\t\t\t\tsetError('The password you entered is invalid')\r\n\t\t\t\t})\r\n\t\t}\r\n\t\tsetStartCountdown(true)\r\n\t}\r\n\r\n\tconst finalCountdown = () => {\r\n\t\tlet redirectCountdown = setInterval(() => {\r\n\t\t\tif (timeToDelete < 0) {\r\n\t\t\t\tclearInterval(redirectCountdown)\r\n\t\t\t} else {\r\n\t\t\t\tsetTimeToDelete(prevTimeToRedirect => prevTimeToRedirect - 1)\r\n\t\t\t}\r\n\t\t}, 1000)\r\n\t\tsetTimeout(() => {\r\n\t\t\thandleDeleteUser()\r\n\t\t}, 10000)\r\n\t}\r\n\r\n\tconst handleDeleteUser = () => {\r\n\t\tsetError(null)\r\n\r\n\t\tdeleteUser(user)\r\n\t\t\t.then(() => {\r\n\t\t\t\tsetIsPending(false)\r\n\t\t\t\tsetError(null)\r\n\t\t\t\tsetShow(false)\r\n\t\t\t})\r\n\t\t\t.catch(error => {\r\n\t\t\t\tconsole.log(error.message)\r\n\t\t\t\tsetError(error.message)\r\n\t\t\t\tsetIsPending(false)\r\n\t\t\t})\r\n\t}\r\n\r\n\tconst isPasswordProvider = () => {\r\n\t\tlet res = false\r\n\r\n\t\tuser.providerData.forEach(provider => {\r\n\t\t\tif (provider.providerId === 'password') {\r\n\t\t\t\tres = true\r\n\t\t\t}\r\n\t\t})\r\n\r\n\t\treturn res\r\n\t}\r\n\r\n\treturn (\r\n\t\t<div className='account-details__details-delete-account'>\r\n\t\t\t<button className='btn' onClick={() => setShow(true)}>\r\n\t\t\t\tDelete Account\r\n\t\t\t</button>\r\n\r\n\t\t\t<Modal\r\n\t\t\t\tshow={show}\r\n\t\t\t\tsetShow={() => setShow(false)}\r\n\t\t\t\tonClose={() => {\r\n\t\t\t\t\tsetIsPending(false)\r\n\t\t\t\t\tsetError(null)\r\n\t\t\t\t\tsetShow(false)\r\n\t\t\t\t\tsetConfirm('')\r\n\t\t\t\t\tsetStartCountdown(false)\r\n\t\t\t\t\tsetTimeToDelete(10)\r\n\t\t\t\t}}>\r\n\t\t\t\t<div className='modal__content-padding flex-column align-center'>\r\n\t\t\t\t\t{startCountdown && (\r\n\t\t\t\t\t\t<div className='countdown'>\r\n\t\t\t\t\t\t\t<h3>Deleting account in</h3>\r\n\t\t\t\t\t\t\t<div>{timeToDelete}</div>\r\n\r\n\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\tclassName='btn'\r\n\t\t\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\t\t\tsetShow(false)\r\n\t\t\t\t\t\t\t\t}}>\r\n\t\t\t\t\t\t\t\tcancel\r\n\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t)}\r\n\t\t\t\t\t{!startCountdown && (\r\n\t\t\t\t\t\t<>\r\n\t\t\t\t\t\t\t<i className='fa-solid fa-trash-can'></i>\r\n\r\n\t\t\t\t\t\t\t<h3>Delete Account?</h3>\r\n\t\t\t\t\t\t\t<p className='mb0'>You'll permanently lose your:</p>\r\n\r\n\t\t\t\t\t\t\t<ul>\r\n\t\t\t\t\t\t\t\t<li>\r\n\t\t\t\t\t\t\t\t\t<i className='fa-solid fa-xmark'></i>\r\n\t\t\t\t\t\t\t\t\t<span>Profile</span>\r\n\t\t\t\t\t\t\t\t</li>\r\n\t\t\t\t\t\t\t\t<li>\r\n\t\t\t\t\t\t\t\t\t<i className='fa-solid fa-xmark'></i>\r\n\t\t\t\t\t\t\t\t\t<span>Messages</span>\r\n\t\t\t\t\t\t\t\t</li>\r\n\t\t\t\t\t\t\t\t<li>\r\n\t\t\t\t\t\t\t\t\t<i className='fa-solid fa-xmark'></i>\r\n\t\t\t\t\t\t\t\t\t<span>Personal data</span>\r\n\t\t\t\t\t\t\t\t</li>\r\n\t\t\t\t\t\t\t</ul>\r\n\r\n\t\t\t\t\t\t\t{isPasswordProvider() && (\r\n\t\t\t\t\t\t\t\t<label>\r\n\t\t\t\t\t\t\t\t\t<p>Enter your password to confirm</p>\r\n\t\t\t\t\t\t\t\t\t<input\r\n\t\t\t\t\t\t\t\t\t\ttype='password'\r\n\t\t\t\t\t\t\t\t\t\tvalue={confirm}\r\n\t\t\t\t\t\t\t\t\t\tonChange={e => setConfirm(e.target.value)}\r\n\t\t\t\t\t\t\t\t\t\tplaceholder='Aa...'\r\n\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t</label>\r\n\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t{isPending && <Loader />}\r\n\t\t\t\t\t\t\t{error && <div className='error'>{error}</div>}\r\n\t\t\t\t\t\t</>\r\n\t\t\t\t\t)}\r\n\t\t\t\t</div>\r\n\r\n\t\t\t\t{!startCountdown && (\r\n\t\t\t\t\t<div className='btn-group'>\r\n\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\tclassName='btn btn--secondary'\r\n\t\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\t\tsetShow(false)\r\n\t\t\t\t\t\t\t}}>\r\n\t\t\t\t\t\t\tcancel\r\n\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\tclassName='btn'\r\n\t\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\t\tcheckPassword()\r\n\t\t\t\t\t\t\t}}>\r\n\t\t\t\t\t\t\tconfirm\r\n\t\t\t\t\t\t</button>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t)}\r\n\t\t\t</Modal>\r\n\t\t</div>\r\n\t)\r\n}\r\n\r\nexport default DeleteAccount\r\n","import { useState } from 'react'\r\nimport { useAuthContext } from '../../../../hooks/useAuthContext'\r\nimport { useDocument } from '../../../../hooks/useDocument'\r\n\r\n// Styles && Assets\r\nimport './AccountDetails.scss'\r\n\r\n// Components\r\nimport Loader from '../../../../components/Loader/Loader'\r\nimport Username from './fields/Username'\r\nimport Email from './fields/Email'\r\nimport PhoneNumber from './fields/PhoneNumber'\r\nimport Password from './fields/Password'\r\nimport DeleteAccount from './fields/DeleteAccount'\r\n\r\nconst AccountDetails = () => {\r\n\tconst { user } = useAuthContext()\r\n\tconst { document: userDoc, error: docError } = useDocument('users', user.uid)\r\n\r\n\tconst isPasswordProvider = () => {\r\n\t\tlet res = false\r\n\r\n\t\tuser.providerData.forEach(provider => {\r\n\t\t\tif (provider.providerId === 'password') {\r\n\t\t\t\tres = true\r\n\t\t\t}\r\n\t\t})\r\n\r\n\t\treturn res\r\n\t}\r\n\r\n\tif (docError) {\r\n\t\treturn <div className='error'>{docError}</div>\r\n\t}\r\n\tif (userDoc && user)\r\n\t\treturn (\r\n\t\t\t<div className='account-details'>\r\n\t\t\t\t<h2 className='setting-title'>account details</h2>\r\n\t\t\t\t<div className='account-details__details'>\r\n\t\t\t\t\t<Username />\r\n\t\t\t\t\t<div className='separator'></div>\r\n\r\n\t\t\t\t\t{isPasswordProvider() && (\r\n\t\t\t\t\t\t<>\r\n\t\t\t\t\t\t\t<Email />\r\n\t\t\t\t\t\t\t<div className='separator'></div>\r\n\t\t\t\t\t\t</>\r\n\t\t\t\t\t)}\r\n\r\n\t\t\t\t\t<PhoneNumber />\r\n\t\t\t\t\t<div className='separator'></div>\r\n\r\n\t\t\t\t\t{isPasswordProvider() && (\r\n\t\t\t\t\t\t<>\r\n\t\t\t\t\t\t\t<Password />\r\n\t\t\t\t\t\t\t<div className='separator'></div>\r\n\t\t\t\t\t\t</>\r\n\t\t\t\t\t)}\r\n\t\t\t\t</div>\r\n\t\t\t\t<DeleteAccount />\r\n\t\t\t</div>\r\n\t\t)\r\n\r\n\tif (!userDoc && user) return <Loader />\r\n}\r\n\r\nexport default AccountDetails\r\n","export const createImage = url =>\r\n\tnew Promise((resolve, reject) => {\r\n\t\tconst image = new Image()\r\n\t\timage.addEventListener('load', () => resolve(image))\r\n\t\timage.addEventListener('error', error => reject(error))\r\n\t\timage.setAttribute('crossOrigin', 'anonymous')\r\n\t\timage.src = url\r\n\t})\r\n\r\nexport function getRadianAngle(degreeValue) {\r\n\treturn (degreeValue * Math.PI) / 180\r\n}\r\n\r\nexport function rotateSize(width, height, rotation) {\r\n\tconst rotRad = getRadianAngle(rotation)\r\n\r\n\treturn {\r\n\t\twidth: Math.abs(Math.cos(rotRad) * width) + Math.abs(Math.sin(rotRad) * height),\r\n\t\theight: Math.abs(Math.sin(rotRad) * width) + Math.abs(Math.cos(rotRad) * height),\r\n\t}\r\n}\r\n\r\nexport default async function getCroppedImg(\r\n\timageSrc,\r\n\tpixelCrop,\r\n\trotation = 0,\r\n\tflip = { horizontal: false, vertical: false }\r\n) {\r\n\tconst image = await createImage(imageSrc)\r\n\tconst canvas = document.createElement('canvas')\r\n\tconst ctx = canvas.getContext('2d')\r\n\r\n\tif (!ctx) {\r\n\t\treturn null\r\n\t}\r\n\r\n\tconst rotRad = getRadianAngle(rotation)\r\n\r\n\tconst { width: bBoxWidth, height: bBoxHeight } = rotateSize(image.width, image.height, rotation)\r\n\r\n\t// set canvas size to match the bounding box\r\n\tcanvas.width = bBoxWidth\r\n\tcanvas.height = bBoxHeight\r\n\r\n\tctx.translate(bBoxWidth / 2, bBoxHeight / 2)\r\n\tctx.rotate(rotRad)\r\n\tctx.scale(flip.horizontal ? -1 : 1, flip.vertical ? -1 : 1)\r\n\tctx.translate(-image.width / 2, -image.height / 2)\r\n\r\n\tctx.drawImage(image, 0, 0)\r\n\r\n\tconst data = ctx.getImageData(pixelCrop.x, pixelCrop.y, pixelCrop.width, pixelCrop.height)\r\n\r\n\tcanvas.width = pixelCrop.width\r\n\tcanvas.height = pixelCrop.height\r\n\r\n\tctx.putImageData(data, 0, 0)\r\n\r\n\treturn new Promise((resolve, reject) => {\r\n\t\tcanvas.toBlob(file => {\r\n\t\t\tconsole.log('file-from-crop', file)\r\n\t\t\t// resolve(URL.createObjectURL(file))\r\n\t\t\tresolve(file)\r\n\t\t}, 'image/jpeg')\r\n\t})\r\n}\r\n","import { useDropzone } from 'react-dropzone'\r\nimport { useAuthContext } from '../../../../../hooks/useAuthContext'\r\nimport { useFirestore } from '../../../../../hooks/useFirestore'\r\nimport { useCallback, useEffect, useReducer, useState } from 'react'\r\nimport { deleteObject, getDownloadURL, getStorage, list, ref, uploadBytes } from 'firebase/storage'\r\nimport { toast } from 'react-toastify'\r\nimport { projectStorage } from '../../../../../firebase/config'\r\nimport { updateProfile } from 'firebase/auth'\r\nimport getCroppedImg from '../CropImg'\r\n\r\n// Components\r\nimport Modal from '../../../../../components/Modal/Modal'\r\nimport Cropper from 'react-easy-crop'\r\n\r\nconst AvatarField = ({ setAvatarState, userDoc, setShowAvatarModal, showAvatarModal }) => {\r\n\tconst { user } = useAuthContext()\r\n\r\n\tconst { updateDocument } = useFirestore('users')\r\n\tconst { acceptedFiles, getRootProps, getInputProps, isDragAccept, isDragReject, open } = useDropzone({\r\n\t\tnoClick: true,\r\n\t\tmultiple: false,\r\n\t\taccept: {\r\n\t\t\t'image/*': [],\r\n\t\t},\r\n\t\tonDrop: acceptedFiles => {\r\n\t\t\tsetFiles(\r\n\t\t\t\tObject.assign(acceptedFiles[0], {\r\n\t\t\t\t\tpreview: URL.createObjectURL(acceptedFiles[0]),\r\n\t\t\t\t})\r\n\t\t\t)\r\n\t\t},\r\n\t})\r\n\r\n\tconst [error, setError] = useState(null)\r\n\tconst [isPending, setIsPending] = useState(false)\r\n\r\n\tconst [files, setFiles] = useState(null)\r\n\r\n\tconst [crop, setCrop] = useState({ x: 0, y: 0 })\r\n\tconst [zoom, setZoom] = useState(1)\r\n\tconst [croppedAreaPixels, setCroppedAreaPixels] = useState(null)\r\n\tconst [croppedImage, setCroppedImage] = useState(null)\r\n\r\n\tconst onCropComplete = useCallback((croppedArea, croppedAreaPixels) => {\r\n\t\tsetCroppedAreaPixels(croppedAreaPixels)\r\n\t}, [])\r\n\r\n\tconst showCroppedImage = useCallback(async () => {\r\n\t\ttry {\r\n\t\t\tconst croppedImage = await getCroppedImg(files.preview, croppedAreaPixels, 0)\r\n\t\t\tsetCroppedImage(croppedImage)\r\n\t\t\tupdateAvatar(croppedImage, true)\r\n\t\t} catch (e) {\r\n\t\t\tconsole.error(e)\r\n\t\t}\r\n\t}, [croppedAreaPixels, files])\r\n\r\n\tconst Undo = ({ onUndo, closeToast }) => {\r\n\t\tconst handleClick = () => {\r\n\t\t\tonUndo()\r\n\t\t\tcloseToast()\r\n\t\t}\r\n\r\n\t\treturn (\r\n\t\t\t<div className='reset-toast'>\r\n\t\t\t\tAvatar Deleted <button onClick={handleClick}>UNDO</button>\r\n\t\t\t</div>\r\n\t\t)\r\n\t}\r\n\r\n\tconst deletePhotoURLFromStorage = () => {\r\n\t\tconst storageRef = ref(projectStorage, `thumbnails/${user.uid}/`)\r\n\r\n\t\tlist(storageRef)\r\n\t\t\t.then(res => {\r\n\t\t\t\tconst deleteRef = ref(projectStorage, res.items[0].fullPath)\r\n\t\t\t\tdeleteObject(deleteRef)\r\n\t\t\t})\r\n\t\t\t.catch(error => {\r\n\t\t\t\tsetError(error.message)\r\n\t\t\t\tconsole.log(error.message)\r\n\t\t\t})\r\n\t}\r\n\r\n\tconst removePhotoURLs = async () => {\r\n\t\tsetError(null)\r\n\t\tsetIsPending(true)\r\n\r\n\t\ttry {\r\n\t\t\tawait updateProfile(user, {\r\n\t\t\t\tphotoURL: '',\r\n\t\t\t})\r\n\t\t\tawait updateDocument(user.uid, {\r\n\t\t\t\tphotoURL: '',\r\n\t\t\t})\r\n\t\t\tdeletePhotoURLFromStorage()\r\n\t\t\tsetIsPending(false)\r\n\t\t\tsetError(null)\r\n\t\t} catch (error) {\r\n\t\t\tsetError(error.message)\r\n\t\t\tconsole.log(error.message)\r\n\t\t\tsetIsPending(false)\r\n\t\t}\r\n\t}\r\n\r\n\tfunction reducer(state, action) {\r\n\t\tswitch (action.type) {\r\n\t\t\tcase 'QUEUE_FOR_REMOVAL':\r\n\t\t\t\treturn {\r\n\t\t\t\t\turl: state.url,\r\n\t\t\t\t\tremove: true,\r\n\t\t\t\t}\r\n\t\t\tcase 'CLEAN_COLLECTION':\r\n\t\t\t\tif (state.remove) {\r\n\t\t\t\t\tremovePhotoURLs()\r\n\t\t\t\t}\r\n\t\t\t\treturn {\r\n\t\t\t\t\turl: state.remove ? '' : state.url,\r\n\t\t\t\t\tremove: false,\r\n\t\t\t\t}\r\n\t\t\tcase 'UNDO':\r\n\t\t\t\treturn {\r\n\t\t\t\t\turl: state.url,\r\n\t\t\t\t\tremove: false,\r\n\t\t\t\t}\r\n\t\t\tdefault:\r\n\t\t\t\treturn state\r\n\t\t}\r\n\t}\r\n\r\n\tconst [state, dispatch] = useReducer(reducer, {\r\n\t\turl: null,\r\n\t\tremove: false,\r\n\t})\r\n\r\n\tuseEffect(() => {\r\n\t\tsetAvatarState(state)\r\n\t}, [state])\r\n\r\n\tconst handleRemoveAvatar = () => {\r\n\t\tdispatch({\r\n\t\t\ttype: 'QUEUE_FOR_REMOVAL',\r\n\t\t})\r\n\t\ttoast.info(<Undo onUndo={() => dispatch({ type: 'UNDO' })} />, {\r\n\t\t\tposition: 'bottom-right',\r\n\t\t\tautoClose: 15000,\r\n\t\t\thideProgressBar: false,\r\n\t\t\t// closeButton: false,\r\n\t\t\tcloseOnClick: false,\r\n\t\t\tpauseOnHover: true,\r\n\t\t\tdraggable: true,\r\n\t\t\tprogress: undefined,\r\n\t\t\ttheme: 'dark',\r\n\t\t\tonClose: () => dispatch({ type: 'CLEAN_COLLECTION' }),\r\n\t\t})\r\n\t}\r\n\r\n\tconst updateAvatar = async image => {\r\n\t\tconst storage = getStorage()\r\n\t\tconst uploadPath = `thumbnails/${user.uid}/${image.name}`\r\n\t\tconst storageRef = ref(storage, uploadPath)\r\n\r\n\t\tawait uploadBytes(storageRef, image)\r\n\t\t\t.then(snapshot => {\r\n\t\t\t\tgetDownloadURL(snapshot.ref).then(async downloadURL => {\r\n\t\t\t\t\ttry {\r\n\t\t\t\t\t\tawait updateDocument(user.uid, {\r\n\t\t\t\t\t\t\tphotoURL: downloadURL,\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t\tawait user.updateProfile({ photoURL: downloadURL })\r\n\r\n\t\t\t\t\t\tsetShowAvatarModal(false)\r\n\t\t\t\t\t\tsetFiles(null)\r\n\t\t\t\t\t\tsetCrop({ x: 0, y: 0 })\r\n\t\t\t\t\t\tsetZoom(1)\r\n\t\t\t\t\t\tsetCroppedAreaPixels(null)\r\n\t\t\t\t\t\tsetCroppedImage(null)\r\n\t\t\t\t\t\ttoast.success('Succesfully updated your avatar', {\r\n\t\t\t\t\t\t\tposition: 'bottom-right',\r\n\t\t\t\t\t\t\tautoClose: 5000,\r\n\t\t\t\t\t\t\thideProgressBar: false,\r\n\t\t\t\t\t\t\tcloseOnClick: true,\r\n\t\t\t\t\t\t\tpauseOnHover: true,\r\n\t\t\t\t\t\t\tdraggable: true,\r\n\t\t\t\t\t\t\tprogress: undefined,\r\n\t\t\t\t\t\t\ttheme: 'dark',\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t} catch (error) {\r\n\t\t\t\t\t\tconsole.log(error.message)\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t})\r\n\t\t\t.catch(error => {\r\n\t\t\t\tconsole.log(error.message)\r\n\t\t\t})\r\n\t}\r\n\r\n\treturn (\r\n\t\tuserDoc && (\r\n\t\t\t<div className='profile-settings__fields-field'>\r\n\t\t\t\t<h3 className='field-title'>avatar</h3>\r\n\r\n\t\t\t\t<div className='btn-group'>\r\n\t\t\t\t\t<>\r\n\t\t\t\t\t\t<button className='btn' onClick={() => setShowAvatarModal(true)}>\r\n\t\t\t\t\t\t\tchange avatar\r\n\t\t\t\t\t\t</button>\r\n\r\n\t\t\t\t\t\t<Modal show={showAvatarModal} setShow={() => setShowAvatarModal(false)}>\r\n\t\t\t\t\t\t\t{!files && (\r\n\t\t\t\t\t\t\t\t<section\r\n\t\t\t\t\t\t\t\t\t{...getRootProps({\r\n\t\t\t\t\t\t\t\t\t\tclassName: `dropzone-container ${isDragAccept ? 'accepted' : ''} ${isDragReject ? 'rejected' : ''}`,\r\n\t\t\t\t\t\t\t\t\t})}>\r\n\t\t\t\t\t\t\t\t\t<input {...getInputProps()} />\r\n\t\t\t\t\t\t\t\t\t<button className='btn' onClick={open}>\r\n\t\t\t\t\t\t\t\t\t\tUpload Image\r\n\t\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t\t\t<p>...or drag and drop image</p>\r\n\t\t\t\t\t\t\t\t</section>\r\n\t\t\t\t\t\t\t)}\r\n\r\n\t\t\t\t\t\t\t{files && console.log(files[0])}\r\n\t\t\t\t\t\t\t{files && (\r\n\t\t\t\t\t\t\t\t<div className='crop-container'>\r\n\t\t\t\t\t\t\t\t\t<div className='modal__content-padding'>\r\n\t\t\t\t\t\t\t\t\t\t<section>\r\n\t\t\t\t\t\t\t\t\t\t\t<h3>Edit Image</h3>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t<Cropper\r\n\t\t\t\t\t\t\t\t\t\t\t\timage={files.preview}\r\n\t\t\t\t\t\t\t\t\t\t\t\tcrop={crop}\r\n\t\t\t\t\t\t\t\t\t\t\t\tzoom={zoom}\r\n\t\t\t\t\t\t\t\t\t\t\t\taspect={1 / 1}\r\n\t\t\t\t\t\t\t\t\t\t\t\tcropShape='round'\r\n\t\t\t\t\t\t\t\t\t\t\t\tonCropChange={setCrop}\r\n\t\t\t\t\t\t\t\t\t\t\t\tonCropComplete={onCropComplete}\r\n\t\t\t\t\t\t\t\t\t\t\t\tonZoomChange={setZoom}\r\n\t\t\t\t\t\t\t\t\t\t\t\tmaxZoom={3}\r\n\t\t\t\t\t\t\t\t\t\t\t/>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t<div className='controls'>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<input\r\n\t\t\t\t\t\t\t\t\t\t\t\t\ttype='range'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tvalue={zoom}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tmin={1}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tmax={3}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tstep={0.01}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\taria-labelledby='Zoom'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tonChange={e => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tsetZoom(e.target.value)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tclassName='zoom-range'\r\n\t\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t</section>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t<div className='btn-group'>\r\n\t\t\t\t\t\t\t\t\t\t<button className='btn btn--secondary' onClick={() => updateAvatar(files)}>\r\n\t\t\t\t\t\t\t\t\t\t\tSkip\r\n\t\t\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t\t\t\t<div className='flex-row gap1'>\r\n\t\t\t\t\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\t\t\t\t\tclassName='btn btn--secondary'\r\n\t\t\t\t\t\t\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tsetFiles(null)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tsetCrop({ x: 0, y: 0 })\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tsetZoom(1)\r\n\t\t\t\t\t\t\t\t\t\t\t\t}}>\r\n\t\t\t\t\t\t\t\t\t\t\t\tCancel\r\n\t\t\t\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t\t\t\t\t<button className='btn' onClick={showCroppedImage}>\r\n\t\t\t\t\t\t\t\t\t\t\t\tApply\r\n\t\t\t\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t</Modal>\r\n\t\t\t\t\t</>\r\n\r\n\t\t\t\t\t{userDoc.photoURL && !state.remove && (\r\n\t\t\t\t\t\t<button className='btn btn--secondary' onClick={handleRemoveAvatar}>\r\n\t\t\t\t\t\t\tremove avatar\r\n\t\t\t\t\t\t</button>\r\n\r\n\t\t\t\t\t\t// notifyAvatar(() => (\r\n\t\t\t\t\t\t// \t<div className='reset-toast'>\r\n\t\t\t\t\t\t// \t\tRemoved avatar <span>reset</span>\r\n\t\t\t\t\t\t// \t</div>\r\n\t\t\t\t\t\t// ))\r\n\t\t\t\t\t)}\r\n\t\t\t\t</div>\r\n\t\t\t\t{error && <div className='error'>{error}</div>}\r\n\t\t\t</div>\r\n\t\t)\r\n\t)\r\n}\r\n\r\nexport default AvatarField\r\n","import { useFirestore } from '../../../../../hooks/useFirestore'\r\nimport { useState } from 'react'\r\nimport { useAuthContext } from '../../../../../hooks/useAuthContext'\r\nimport { toast } from 'react-toastify'\r\n\r\n// Components\r\nimport ColorPicker from '../../../../../components/ColorPicker/ColorPicker'\r\n\r\nexport default function BannerField({ setBannerColor, bannerColor }) {\r\n\tconst { user } = useAuthContext()\r\n\tconst { updateDocument } = useFirestore('users')\r\n\r\n\tconst [error, setError] = useState(null)\r\n\tconst [isPending, setIsPending] = useState(false)\r\n\r\n\tconst notify = message =>\r\n\t\ttoast.success(message, {\r\n\t\t\tposition: 'bottom-right',\r\n\t\t\tautoClose: 5000,\r\n\t\t\thideProgressBar: false,\r\n\t\t\tcloseOnClick: true,\r\n\t\t\tpauseOnHover: true,\r\n\t\t\tdraggable: true,\r\n\t\t\tprogress: undefined,\r\n\t\t\ttheme: 'dark',\r\n\t\t})\r\n\r\n\tconst updateBanner = async () => {\r\n\t\tsetError(null)\r\n\t\tsetIsPending(true)\r\n\r\n\t\ttry {\r\n\t\t\tawait updateDocument(user.uid, {\r\n\t\t\t\tbanner: `${bannerColor}`,\r\n\t\t\t})\r\n\r\n\t\t\tsetIsPending(false)\r\n\t\t\tsetError(null)\r\n\t\t\tnotify('Updated banner')\r\n\t\t} catch (error) {\r\n\t\t\tsetError(error.message)\r\n\t\t\tconsole.log(error.message)\r\n\t\t\tsetIsPending(false)\r\n\t\t}\r\n\t}\r\n\r\n\treturn (\r\n\t\t<div className='profile-settings__fields-field flex-row align-end gap1'>\r\n\t\t\t<div className='flex-column'>\r\n\t\t\t\t<h3 className='field-title'>banner color</h3>\r\n\r\n\t\t\t\t<ColorPicker\r\n\t\t\t\t\tvalue={bannerColor}\r\n\t\t\t\t\tsetValue={e => {\r\n\t\t\t\t\t\tsetBannerColor(e.target.value)\r\n\t\t\t\t\t}}\r\n\t\t\t\t\tclassName='mb0'\r\n\t\t\t\t/>\r\n\t\t\t</div>\r\n\r\n\t\t\t<button className='btn btn--secondary' onClick={() => updateBanner()}>\r\n\t\t\t\tUpdate Banner\r\n\t\t\t</button>\r\n\r\n\t\t\t{error && <div className='error'>{error}</div>}\r\n\t\t</div>\r\n\t)\r\n}\r\n","import { useState } from 'react'\r\nimport { toast } from 'react-toastify'\r\nimport { useAuthContext } from '../../../../../hooks/useAuthContext'\r\nimport { useFirestore } from '../../../../../hooks/useFirestore'\r\n\r\nexport default function AboutField({ about, setAbout }) {\r\n\tconst { user } = useAuthContext()\r\n\tconst { updateDocument } = useFirestore('users')\r\n\r\n\tconst [error, setError] = useState(null)\r\n\tconst [isPending, setIsPending] = useState(false)\r\n\r\n\tconst notify = message =>\r\n\t\ttoast.success(message, {\r\n\t\t\tposition: 'bottom-right',\r\n\t\t\tautoClose: 5000,\r\n\t\t\thideProgressBar: false,\r\n\t\t\tcloseOnClick: true,\r\n\t\t\tpauseOnHover: true,\r\n\t\t\tdraggable: true,\r\n\t\t\tprogress: undefined,\r\n\t\t\ttheme: 'dark',\r\n\t\t})\r\n\r\n\tconst updateBio = async () => {\r\n\t\tsetError(null)\r\n\r\n\t\tif (about.length < 71) {\r\n\t\t\ttry {\r\n\t\t\t\tawait updateDocument(user.uid, {\r\n\t\t\t\t\tbio: about,\r\n\t\t\t\t})\r\n\r\n\t\t\t\tsetIsPending(false)\r\n\t\t\t\tsetError(null)\r\n\t\t\t\tnotify('Updated about me')\r\n\t\t\t} catch (error) {\r\n\t\t\t\tsetError(error.message)\r\n\t\t\t\tconsole.log(error.message)\r\n\t\t\t\tsetIsPending(false)\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tsetError('About me must be less than 169 character long')\r\n\t\t}\r\n\t}\r\n\r\n\treturn (\r\n\t\t<div className='profile-settings__fields-field'>\r\n\t\t\t<h3 className='field-title'>about me</h3>\r\n\r\n\t\t\t<div className='textarea-container'>\r\n\t\t\t\t<textarea value={about} onChange={e => setAbout(e.target.value)}></textarea>\r\n\r\n\t\t\t\t<div className={`textarea-container__char-counter ${about.length > 70 ? 'limit' : ''}`}>\r\n\t\t\t\t\t{70 - about.length}\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t\t{error && <div className='error'>{error}</div>}\r\n\t\t\t<button className='btn btn--secondary text-capitalize' onClick={() => updateBio()}>\r\n\t\t\t\tupdate about me\r\n\t\t\t</button>\r\n\t\t</div>\r\n\t)\r\n}\r\n","import AvatarWithStatus from '../../../../components/AvatarWithStatus/AvatarWithStatus'\r\n\r\nexport default function Preview({ userDoc, avatarState, about, bannerColor, setShowAvatarModal }) {\r\n\treturn (\r\n\t\t<div className='profile-preview'>\r\n\t\t\t<div className='profile-preview__banner' style={{ backgroundColor: bannerColor }}></div>\r\n\t\t\t<div className='profile-preview__header'>\r\n\t\t\t\t<div\r\n\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\tsetShowAvatarModal(true)\r\n\t\t\t\t\t}}>\r\n\t\t\t\t\t<AvatarWithStatus userId={userDoc.id} src={avatarState && !avatarState.remove ? avatarState.url : ''} />\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\r\n\t\t\t<div className='profile-preview__info'>\r\n\t\t\t\t<h3 className='name'>{userDoc.displayName}</h3>\r\n\r\n\t\t\t\t<div className='cards'>\r\n\t\t\t\t\t<div className='cards__card'>\r\n\t\t\t\t\t\t{about && (\r\n\t\t\t\t\t\t\t<>\r\n\t\t\t\t\t\t\t\t<h4>About me</h4>\r\n\t\t\t\t\t\t\t\t<p className='bio'>{about}</p>\r\n\t\t\t\t\t\t\t</>\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t<div className='cards__card'>\r\n\t\t\t\t\t\t<h4>Member since</h4>\r\n\t\t\t\t\t\t<p>{userDoc.createdAt}</p>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t)\r\n}\r\n","import { useState } from 'react'\r\nimport { useAuthContext } from '../../../../hooks/useAuthContext'\r\nimport { useDocument } from '../../../../hooks/useDocument'\r\nimport { useEffect } from 'react'\r\n\r\n// Styles && Assets\r\nimport './Profile.scss'\r\n\r\n// Components\r\nimport { ToastContainer } from 'react-toastify'\r\nimport AvatarField from './fields/AvatarField'\r\nimport BannerField from './fields/BannerField'\r\nimport AboutField from './fields/AboutField'\r\nimport Loader from '../../../../components/Loader/Loader'\r\nimport Preview from './Preview'\r\n\r\nconst Profile = () => {\r\n\tconst { user } = useAuthContext()\r\n\tconst { document: userDoc } = useDocument('users', user.uid)\r\n\r\n\tconst [bannerColor, setBannerColor] = useState('#354167')\r\n\r\n\tconst [avatarState, setAvatarState] = useState({})\r\n\tconst [showAvatarModal, setShowAvatarModal] = useState(false)\r\n\r\n\tconst [about, setAbout] = useState('')\r\n\r\n\tuseEffect(() => {\r\n\t\tif (userDoc) {\r\n\t\t\tif (userDoc.banner) setBannerColor(userDoc.banner)\r\n\r\n\t\t\tif (userDoc.bio) setAbout(userDoc.bio)\r\n\t\t}\r\n\t}, [userDoc])\r\n\r\n\tif (!userDoc) return <Loader />\r\n\r\n\tif (userDoc)\r\n\t\treturn (\r\n\t\t\t<div className='profile-settings'>\r\n\t\t\t\t<ToastContainer />\r\n\t\t\t\t<h2 className='setting-title'>customize profile</h2>\r\n\r\n\t\t\t\t<div className='profile-settings__container'>\r\n\t\t\t\t\t<Preview\r\n\t\t\t\t\t\tuserDoc={userDoc}\r\n\t\t\t\t\t\tavatarState={avatarState}\r\n\t\t\t\t\t\tbannerColor={bannerColor}\r\n\t\t\t\t\t\tabout={about}\r\n\t\t\t\t\t\tsetShowAvatarModal={setShowAvatarModal}\r\n\t\t\t\t\t/>\r\n\r\n\t\t\t\t\t<div className='profile-settings__fields'>\r\n\t\t\t\t\t\t<BannerField setBannerColor={setBannerColor} bannerColor={bannerColor} />\r\n\r\n\t\t\t\t\t\t<AvatarField\r\n\t\t\t\t\t\t\tsetAvatarState={e => setAvatarState(e)}\r\n\t\t\t\t\t\t\tuserDoc={userDoc}\r\n\t\t\t\t\t\t\tsetShowAvatarModal={setShowAvatarModal}\r\n\t\t\t\t\t\t\tshowAvatarModal={showAvatarModal}\r\n\t\t\t\t\t\t/>\r\n\r\n\t\t\t\t\t\t<AboutField about={about} setAbout={setAbout} />\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t)\r\n}\r\n\r\nexport default Profile\r\n","import React from 'react'\r\n\r\nconst Theme = () => {\r\n\treturn <div>Do I even want to spend time on that?</div>\r\n}\r\n\r\nexport default Theme\r\n","import React from 'react'\r\n\r\nconst Premium = () => {\r\n\treturn (\r\n\t\t<div>\r\n\t\t\t<a href='https://buycoffee.to/mhada' target='_blank' rel='noreferrer'>\r\n\t\t\t\t<img\r\n\t\t\t\t\tsrc='https://buycoffee.to/btn/buycoffeeto-btn-primary.svg'\r\n\t\t\t\t\tstyle={{ width: '170px' }}\r\n\t\t\t\t\talt='Postaw mi kaw na buycoffee.to'\r\n\t\t\t\t/>\r\n\t\t\t</a>\r\n\t\t</div>\r\n\t)\r\n}\r\n\r\nexport default Premium\r\n","import React from 'react'\r\n\r\nconst PrivacyAndSecurity = () => {\r\n\treturn <div>I guarantee that it's safe</div>\r\n}\r\n\r\nexport default PrivacyAndSecurity\r\n","import { Link, NavLink, Route, Routes } from 'react-router-dom'\r\nimport { useAuthContext } from '../../hooks/useAuthContext'\r\nimport { useLogout } from '../../hooks/useLogout'\r\nimport { useState } from 'react'\r\n\r\n// Styles && Assets\r\nimport './Settings.scss'\r\nimport premiumIcon from '../../assets/premium-account.png'\r\n\r\n// Components\r\nimport AvatarWithStatus from '../../components/AvatarWithStatus/AvatarWithStatus'\r\nimport Modal from '../../components/Modal/Modal'\r\nimport Loader from '../../components/Loader/Loader'\r\nimport AccountDetails from './subpages/AccountDetails/AccountDetails'\r\nimport Profile from './subpages/Profile/Profile'\r\nimport Theme from './subpages/Theme/Theme'\r\nimport Premium from './subpages/Premium/Premium'\r\nimport PrivacyAndSecurity from './subpages/PrivacyAndSecurity/PrivacyAndSecurity'\r\n\r\nexport default function Settings() {\r\n\tconst { user } = useAuthContext()\r\n\tconst { logout, error, isPending } = useLogout()\r\n\r\n\tconst [confirmLogout, setConfirmLogout] = useState(false)\r\n\treturn (\r\n\t\t<div className='settings'>\r\n\t\t\t<div className='wrapper'>\r\n\t\t\t\t<aside className='settings__sidebar'>\r\n\t\t\t\t\t<Link to={`/profile/${user.uid}`} className='settings__sidebar-user'>\r\n\t\t\t\t\t\t<AvatarWithStatus userId={user.uid} />\r\n\t\t\t\t\t\t<div className='flex-column'>\r\n\t\t\t\t\t\t\t<h3>{user.displayName}</h3>\r\n\t\t\t\t\t\t\t<p>{user.email && user.email}</p>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</Link>\r\n\r\n\t\t\t\t\t<div className='custom-scrollbar flex-column gap05'>\r\n\t\t\t\t\t\t<NavLink to='/settings/account-details' className='settings__sidebar-link'>\r\n\t\t\t\t\t\t\t<i className='fa-solid fa-circle-user'></i>\r\n\t\t\t\t\t\t\t<span>account details</span>\r\n\t\t\t\t\t\t</NavLink>\r\n\t\t\t\t\t\t<NavLink to='/settings/profile' className='settings__sidebar-link'>\r\n\t\t\t\t\t\t\t<i className='fa-solid fa-address-card'></i>\r\n\t\t\t\t\t\t\t<span>profile</span>\r\n\t\t\t\t\t\t</NavLink>\r\n\t\t\t\t\t\t<NavLink to='/settings/theme' className='settings__sidebar-link'>\r\n\t\t\t\t\t\t\t<i className='fa-solid fa-paintbrush'></i>\r\n\t\t\t\t\t\t\t<span>theme</span>\r\n\t\t\t\t\t\t</NavLink>\r\n\t\t\t\t\t\t<NavLink to='/settings/become-cool' className='settings__sidebar-link'>\r\n\t\t\t\t\t\t\t<img src={premiumIcon} alt='Icon for premium account' />\r\n\t\t\t\t\t\t\t<span>plenvy pro</span>\r\n\t\t\t\t\t\t</NavLink>\r\n\t\t\t\t\t\t<NavLink to='/settings/privacy-and-security' className='settings__sidebar-link'>\r\n\t\t\t\t\t\t\t<i className='fa-solid fa-shield-halved'></i>\r\n\t\t\t\t\t\t\t<span>privacy & security</span>\r\n\t\t\t\t\t\t</NavLink>\r\n\r\n\t\t\t\t\t\t<div className='settings__sidebar-link logout' onClick={() => setConfirmLogout(true)}>\r\n\t\t\t\t\t\t\t<span>log out</span>\r\n\t\t\t\t\t\t\t<i className='fa-solid fa-arrow-right-from-bracket'></i>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t<Modal show={confirmLogout} setShow={() => setConfirmLogout(false)}>\r\n\t\t\t\t\t\t{!isPending && <i className='fa-regular fa-hand mb05'></i>}\r\n\r\n\t\t\t\t\t\t{isPending && <Loader />}\r\n\r\n\t\t\t\t\t\t<h3 className='mb05'>Come back soon!</h3>\r\n\t\t\t\t\t\t<p>Are you sure you want to Log Out?</p>\r\n\r\n\t\t\t\t\t\t<div className='btn-group'>\r\n\t\t\t\t\t\t\t<button className='btn btn--secondary' onClick={() => setConfirmLogout(false)}>\r\n\t\t\t\t\t\t\t\tcancel\r\n\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t<button className='btn' onClick={() => logout()}>\r\n\t\t\t\t\t\t\t\tlogout\r\n\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t{error && <div className='error'>{error}</div>}\r\n\t\t\t\t\t</Modal>\r\n\t\t\t\t</aside>\r\n\r\n\t\t\t\t<div className='settings__content custom-scrollbar'>\r\n\t\t\t\t\t<Routes>\r\n\t\t\t\t\t\t<Route path='account-details' element={<AccountDetails />} />\r\n\t\t\t\t\t\t<Route path='profile' element={<Profile />} />\r\n\t\t\t\t\t\t<Route path='theme' element={<Theme />} />\r\n\t\t\t\t\t\t<Route path='become-cool' element={<Premium />} />\r\n\t\t\t\t\t\t<Route path='privacy-and-security' element={<PrivacyAndSecurity />} />\r\n\t\t\t\t\t</Routes>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t)\r\n}\r\n","import { useEffect, useRef, useState } from 'react'\r\nimport { BrowserRouter, Route, Redirect, Routes, Navigate } from 'react-router-dom'\r\nimport { useAuthContext } from './hooks/useAuthContext'\r\nimport { GlobalStyles } from './theme/GlobalStyles'\r\nimport { useCollection } from './hooks/useCollection'\r\nimport styled, { ThemeProvider } from 'styled-components'\r\n\r\n// Styles\r\nimport './App.scss'\r\nimport 'react-toastify/dist/ReactToastify.css'\r\n\r\n// Components && Pages\r\nimport Dashboard from './pages/dashboard/Dashboard'\r\nimport Chat from './pages/chat/Chat'\r\nimport Login from './pages/login/Login'\r\nimport Signup from './pages/signup/Signup'\r\nimport PrivacyPolicy from './pages/privacyPolicy/privacyPolicy'\r\nimport ResetPassword from './pages/resetPassword/ResetPassword'\r\nimport SetNewPassword from './pages/resetPassword/SetNewPassword'\r\nimport Chats from './components/Chats/Chats'\r\nimport ToolBar from './components/ToolBar/ToolBar'\r\nimport Profile from './pages/profile/Profile'\r\nimport Settings from './pages/settings/Settings'\r\n\r\n\r\nfunction App() {\r\n\tconst inputRef = useRef(null)\r\n\r\n\tconst { user, authIsReady } = useAuthContext()\r\n\tconst { documents: themes } = useCollection('themes')\r\n\r\n\tconst [currentChat, setCurrentChat] = useState(null)\r\n\tconst [theme, setTheme] = useState(themes)\r\n\r\n\tconst filterTheme = themeToSet => {\r\n\t\tlet filteredTheme\r\n\r\n\t\tif (themeToSet.isCustom === true) {\r\n\t\t\tif (currentChat.customThemes) {\r\n\t\t\t\tcurrentChat.customThemes.forEach(theme => {\r\n\t\t\t\t\tif (theme.id === themeToSet.name) filteredTheme = theme\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tif (themes) {\r\n\t\t\t\tthemes.forEach(theme => {\r\n\t\t\t\t\tif (theme.id === themeToSet.name) filteredTheme = theme\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn filteredTheme\r\n\t}\r\n\r\n\tuseEffect(() => {\r\n\t\tif (currentChat) {\r\n\t\t\tcurrentChat.theme\r\n\t\t\t\t? setTheme(filterTheme(currentChat.theme))\r\n\t\t\t\t: setTheme(filterTheme({ name: 'frosty', isCustom: false }))\r\n\t\t} else if (themes) {\r\n\t\t\tsetTheme(filterTheme({ name: 'frosty', isCustom: false }))\r\n\t\t}\r\n\t}, [themes, currentChat])\r\n\r\n\treturn (\r\n\t\tauthIsReady &&\r\n\t\ttheme && (\r\n\t\t\t<ThemeProvider theme={theme}>\r\n\t\t\t\t<GlobalStyles />\r\n\t\t\t\t<div className='App'>\r\n\t\t\t\t\t<BrowserRouter>\r\n\t\t\t\t\t\t{user && <ToolBar />}\r\n\t\t\t\t\t\t<Routes>\r\n\t\t\t\t\t\t\t<Route path='/' element={user ? <Dashboard /> : <Navigate to='/login' />} />\r\n\t\t\t\t\t\t\t<Route\r\n\t\t\t\t\t\t\t\tpath='/u/:id'\r\n\t\t\t\t\t\t\t\telement={\r\n\t\t\t\t\t\t\t\t\tuser ? (\r\n\t\t\t\t\t\t\t\t\t\t[\r\n\t\t\t\t\t\t\t\t\t\t\t<Chats currentChat={currentChat} inputRef={inputRef} key='chats' />,\r\n\t\t\t\t\t\t\t\t\t\t\t<Chat setCurrentChat={setCurrentChat} inputRef={inputRef} currentTheme={theme} key='chat' />,\r\n\t\t\t\t\t\t\t\t\t\t]\r\n\t\t\t\t\t\t\t\t\t) : (\r\n\t\t\t\t\t\t\t\t\t\t<Navigate to='/' />\r\n\t\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t<Route path='/profile/:id' element={user ? <Profile /> : <Navigate to='/' />} />\r\n\t\t\t\t\t\t\t<Route path='/settings/*' element={user ? <Settings /> : <Navigate to='/' />} />\r\n\t\t\t\t\t\t\t<Route path='/privacy-policy' element={<PrivacyPolicy />} />\r\n\t\t\t\t\t\t\t<Route path='/recover-password' element={<ResetPassword />} />\r\n\t\t\t\t\t\t\t<Route path='/login' element={user ? <Navigate to='/' /> : <Login />} />\r\n\t\t\t\t\t\t\t<Route path='/signup' element={user ? <Navigate to='/' /> : <Signup />} />\r\n\t\t\t\t\t\t\t<Route path='/set-new-password' element={<SetNewPassword />} />\r\n\t\t\t\t\t\t</Routes>\r\n\t\t\t\t\t</BrowserRouter>\r\n\t\t\t\t</div>\r\n\t\t\t</ThemeProvider>\r\n\t\t)\r\n\t)\r\n}\r\n\r\nexport default App\r\n","import React from 'react'\nimport ReactDOM from 'react-dom'\nimport './index.scss'\nimport App from './App'\nimport { AuthContextProvider } from './context/AuthContext'\n\nReactDOM.render(\n\t<React.StrictMode>\n\t\t<AuthContextProvider>\n\t\t\t<App />\n\t\t</AuthContextProvider>\n\t</React.StrictMode>,\n\tdocument.getElementById('root')\n)\n\t"],"sourceRoot":""}