{"version":3,"sources":["firebase/config.js","context/AuthContext.js","hooks/useAuthContext.js","theme/GlobalStyles.js","hooks/useCollection.js","pages/dashboard/Dashboard.js","hooks/useDocument.js","hooks/useFirestore.js","hooks/useDates.js","assets/logo-default.png","components/Avatar/Avatar.js","hooks/useEscapeKey.js","components/Modal/Modal.js","components/Tooltip/Tooltip.js","components/AvatarWithStatus/AvatarWithStatus.js","components/ProfilePreview/ProfilePreview.js","pages/chat/Messages/Message/Message.js","pages/chat/Messages/Messages.js","pages/chat/MessageField/MessageField.js","assets/british-person.jpg","components/ThemeCreator/ThemePreview.js","components/ThemeCreator/Field.js","components/ColorPicker/ColorPicker.js","components/ThemeCreator/ThemeCreator.js","components/ThemePicker/ThemePicker.js","pages/chat/ChatOptions/ChatOptions.js","pages/chat/Chat.js","hooks/useLogin.js","assets/logo-no-bg.png","pages/auth/AuthTemplate.js","components/Inputs/FieldContainer/FieldContainer.js","components/Inputs/Field/Field.js","assets/btn_google_dark_normal_ios.svg","components/GoogleButton/GoogleButton.js","components/GithubButton/GithubButton.js","assets/GitHub-Mark-Light-32px.png","pages/auth/login/Login.js","pages/auth/signup/Signup.js","hooks/useSignup.js","pages/privacyPolicy/privacyPolicy.js","assets/shrek-gif.gif","pages/auth/resetPassword/ResetPassword.js","pages/auth/resetPassword/SetNewPassword.js","hooks/useQuery.js","components/Chats/ChatsList.js","components/Pinned/Pinned.js","components/Chats/Chats.js","components/ToolBar/ToolBar.js","assets/premium-account.png","components/Loader/Loader.js","pages/profile/Profile.js","hooks/useLogout.js","pages/settings/subpages/AccountDetails/fields/Username.js","pages/settings/subpages/AccountDetails/fields/Email.js","pages/settings/subpages/AccountDetails/fields/PhoneNumber.js","pages/settings/subpages/AccountDetails/fields/Password.js","pages/settings/subpages/AccountDetails/fields/DeleteAccount.js","pages/settings/subpages/AccountDetails/AccountDetails.js","pages/settings/subpages/Profile/CropImg.js","pages/settings/subpages/Profile/fields/AvatarField.js","pages/settings/subpages/Profile/fields/BannerField.js","pages/settings/subpages/Profile/fields/AboutField.js","pages/settings/subpages/Profile/Preview.js","pages/settings/subpages/Profile/Profile.js","pages/settings/subpages/Theme/Theme.js","pages/settings/subpages/Premium/Premium.js","pages/settings/subpages/PrivacyAndSecurity/PrivacyAndSecurity.js","pages/settings/Settings.js","pages/friends/FriendsList.js","pages/friends/AddFriend.js","pages/friends/PendingInvites.js","pages/friends/Friends.js","components/Mobile/TabBar/TabBar.js","App.js","index.js"],"names":["firebase","initializeApp","apiKey","authDomain","projectId","storageBucket","messagingSenderId","appId","projectFirestore","firestore","projectAuth","auth","projectStorage","storage","projectGoogle","GoogleAuthProvider","projectGitHub","GithubAuthProvider","setCustomParameters","prompt","timestamp","Timestamp","AuthContext","createContext","authReducer","state","action","type","user","payload","authIsReady","AuthContextProvider","children","useReducer","dispatch","useEffect","unsub","onAuthStateChanged","Provider","value","useAuthContext","context","useContext","Error","adjustBrightness","col","amt","usePound","slice","R","parseInt","substring","G","B","toString","length","GlobalStyles","createGlobalStyle","theme","colors","bgDark","bgSecondary","inputBg","inputText","inputBorder","msgBg","messageColor","msgBorder","msgBgOwner","forEach","color","spreadColors","messageColorOwner","msgBorderOwner","textAccent","borderRadius","textPrimary","textLowContrast","buttonColor","useCollection","collection","_query","_orderBy","useState","documents","setDocuments","error","setError","query","useRef","current","orderBy","ref","where","unsubscribe","onSnapshot","snapshot","results","docs","doc","push","data","id","console","log","Dashboard","className","useDocument","document","setDocument","err","message","initialState","isPending","success","firestoreReducer","useFirestore","response","isCancelled","setIsCancelled","dispatchIfNotCancelled","addDocument","a","createdAt","fromDate","Date","add","addedDocument","deleteDocument","delete","updateDocument","updates","update","updatedDocument","useDates","dayOfMonth","dayOfWeek","month","year","hour","curDate","fullDate","today","toLocaleDateString","formatDate","date","toDate","getDay","getFullYear","getMonth","getDate","toLocaleTimeString","minute","dateToFormat","lastMonday","setDate","setHours","getTime","isCurrentWeek","dates","Avatar","src","appLogo","alt","KEY_EVENT_TYPE","Modal","show","setShow","onClose","disableOCH","button1","button2","handleClose","handleEscKey","useCallback","event","key","addEventListener","removeEventListener","useEscapeKey","onOutsideClick","disabled","onClick","Tooltip","pos","align","AvatarWithStatus","userId","linkToProfile","noTooltip","noStatus","users","setUser","filter","u","undefined","to","photoURL","status","ConditionalWrapper","condition","wrapper","ProfilePreview","disableTooltip","userDoc","handleStatus","uid","style","backgroundColor","banner","displayName","bio","map","Message","elements","i","chat","onMessageResponse","setMessageToDelete","showImage","setShowImage","showEmojis","setShowEmojis","showModal","setShowModal","emojiReactions","setEmojiReactions","showProfilePrev","setShowProfilePrev","showSendDate","value1","value2","date1","date2","Math","abs","showSendDate2","reactWithEmoji","e","indexOfMessage","messages","indexOf","otherUserReaction","rec","emojiToAdd","content","emoji","handleReactionNicknames","reaction","nickname","assignedUsers","deleteEmojiReaction","getDoc","res","getLocalUser","isTop","createdBy","isMiddle","isBottom","isSpecial","deleted","getElementById","scrollIntoView","block","setTimeout","classList","remove","scrollToResponse","image","fileType","target","showFullImage","controls","playsInline","onEmojiClick","Theme","DARK","previewConfig","defaultCaption","defaultEmoji","width","height","emojiStyle","EmojiStyle","NATIVE","viewBox","d","Number","lastRead","Fragment","Messages","setBottomDiv","otherUser","currentUser","messageToDelete","location","useLocation","bottomRef","scrollDownRef","scrollToBottom","deleteMessage","onScroll","winScroll","scrollTop","handleScrollDownBtn","FileSaver","saveAs","MessageField","messageResponse","bottomDiv","inputRef","uniqueId","uuid","newComment","setNewComment","imgUpload","setImgUpload","isAssignedUser","setIsAssignedUser","chatEmoji","fastEmoji","setFastEmoji","sendFastEmoji","setSendFastEmoji","seen","setSeen","fileInputRef","focus","assignedUsersId","sendMessage","commentToAdd","trim","updatedAt","isRead","sendImage","includes","split","storageRef","name","uploadBytes","then","getDownloadURL","downloadURL","handleImageUpload","imageFile","files","options","maxSizeMB","maxWidthOrHeight","useWebWorker","imageCompression","compressedFile","handleSubmit","preventDefault","fileThumbnail","setFileThumbnail","onSubmit","accept","onChange","URL","createObjectURL","handleFileChange","resetFileInput","maxLength","placeholder","onKeyDown","code","handleKey","handleEmojis","innerText","unified","size","ThemePreview","otherUserMessage","curUserMessage","textColors","inputColors","confirmCustomTheme","setConfirmCustomTheme","submitCustomTheme","editedTheme","setShowThemePicker","setShowThemeCreator","messageStyles","bg","text","border","messageOwnerStyles","backgroundImage","backgroundAttachment","backgroundPosition","backgroundSize","britImg","primary","accent","lowContrast","Field","title","ColorPicker","setValue","separator","ThemeCreator","setName","setBgDark","setBgSecondary","setBorderRadius","setCurUserMessage","setOtherUserMessage","setInputColors","btn","btnText","setTextColors","setButtonColor","themeToAdd","isCustom","customThemes","updateCustomThemes","index","newArr","required","updateMessageBg","c","random","min","max","ThemePicker","themes","setEditedTheme","setConfirmThemeDelete","confirmThemeDelete","changeTheme","removeCustomTheme","t","background","stopPropagation","editCustomTheme","ChatOptions","currentTheme","otherUserLocal","setShowChatOptions","defaultThemeDoc","showEmojiPicker","setShowEmojiPicker","showNicknameModal","setShowNicknameModal","showNicknameInput","setShowNicknameInput","newNickname","setNewNickname","showThemePicker","showThemeCreator","changeChatEmoji","maxWidth","handleNicknameInput","Chat","setCurrentChat","showChat","setShowChat","useParams","showChatOptions","setOtherUserLocal","currentUserLocal","setCurrentUserLocal","otherUserDoc","currentUserDoc","handleSeen","queryMd","useMediaQuery","prevValue","toggle","useLogin","navigate","useNavigate","setIsPending","isFinished","setIsFinished","login","email","password","signInWithEmailAndPassword","online","loginWithGoogle","signInWithPopup","loginWithGithub","sendPasswordReset","sendPasswordResetEmail","resetPassword","newPassword","confirmPasswordReset","setUpRecaptcha","number","provider","PhoneAuthProvider","recaptchaVerifier","RecaptchaVerifier","render","verifyPhoneNumber","verificationId","AuthTemplate","logo","version","transform","fill","FieldContainer","helpText","optional","containerClass","TextField","label","resetError","onLostFocus","inputClass","after","showPassword","setShowPassword","onBlur","GoogleButton","googleLogo","GithubButton","Login","setEmail","setPassword","username","formErrors","setFormErrors","existing","match","Signup","randColor","randomColor","signup","thumbnail","createUserWithEmailAndPassword","imgUrl","uploadPath","put","img","updateProfile","set","metadata","creationTime","toLocaleString","day","signInWithGoogle","signInWithGithub","additionalUserInfo","useSignup","setDisplayName","PrivacyPolicy","class","ResetPassword","timeToRedirect","setTimeToRedirect","countdown","redirectCountdown","setInterval","clearInterval","prevTimeToRedirect","ShrekGif","SetNewPassword","setNewPassword","oobCode","queryName","URLSearchParams","search","get","useQuery","ChatsList","chats","replaceDistanceToNow","about","minutes","formatDistanceToNowStrict","addSuffix","replace","matched","Pinned","orientation","favs","setFavs","showFavs","setShowFavs","searchValue","setSearchValue","favsCopy","setFavsCopy","pinned","filterChats","result","fav","handleOnDragEnd","destination","items","Array","from","splice","source","reorderedItem","onDragEnd","droppableId","direction","provided","droppableProps","innerRef","f","draggableId","draggable","draggableProps","dragHandleProps","userToAdd","chatToAdd","isGroup","item","handleRemoveFav","isDropDisabled","toLowerCase","isDragging","draggingOver","addFav","Chats","currentChat","setQuery","ToolBar","latestChat","setLatestChat","currentPath","setCurrentPath","showProfile","setShowProfile","invitesAmount","setInvitesAmount","pathname","friends","Loader","Profile","confirmDelete","setConfirmDelete","comment","setComment","showInputControls","setShowInputControls","inputError","setInputError","addComment","profileComments","deleteComment","comm","pronouns","country","countryCode","svg","premium","premiumIcon","some","accepted","getChatId","count","notInFriends","useLogout","logout","signOut","Username","setUsername","updateUsername","toast","position","autoClose","hideProgressBar","closeOnClick","pauseOnHover","progress","Email","currentPassword","setCurrentPassword","updateEmail","regex","userCredential","catch","PhoneNumber","phoneNumber","setPhoneNumber","confirmUnlink","setConfirmUnlink","showOTP","setShowOTP","captchaResponse","setCaptchaResponse","OTPCode","setOTPCode","notify","sendOTP","verifyOTP","authCredential","credential","linkWithCredential","updatePhoneNumber","unlink","providerId","unlinkPhoneNumber","enableSearch","dropdownClass","copyNumbersOnly","searchPlaceholder","fontWeight","handleOTPInput","Password","confirmNewPassword","setConfirmNewPassword","updatePassword","DeleteAccount","confirm","setConfirm","startCountdown","setStartCountdown","timeToDelete","setTimeToDelete","setCredential","finalCountdown","handleDeleteUser","deleteUser","isPasswordProvider","providerData","checkPassword","AccountDetails","docError","copyBtnText","setCopyBtnText","navigator","clipboard","writeText","createImage","url","Promise","resolve","reject","Image","setAttribute","getRadianAngle","degreeValue","PI","rotateSize","rotation","rotRad","cos","sin","getCroppedImg","imageSrc","pixelCrop","flip","horizontal","vertical","canvas","createElement","ctx","getContext","bBoxWidth","bBoxHeight","translate","rotate","scale","drawImage","getImageData","x","y","putImageData","toBlob","file","AvatarField","setAvatarState","setShowAvatarModal","showAvatarModal","useDropzone","noClick","multiple","onDrop","acceptedFiles","setFiles","Object","assign","preview","getRootProps","getInputProps","isDragAccept","isDragReject","open","crop","setCrop","zoom","setZoom","croppedAreaPixels","setCroppedAreaPixels","setCroppedImage","onCropComplete","croppedArea","showCroppedImage","croppedImage","updateAvatar","Undo","onUndo","closeToast","deletePhotoURLFromStorage","list","deleteRef","fullPath","deleteObject","removePhotoURLs","getStorage","aspect","cropShape","onCropChange","onZoomChange","maxZoom","step","info","BannerField","setBannerColor","bannerColor","updateBanner","AboutField","setAbout","updateBio","Preview","avatarState","Premium","href","rel","PrivacyAndSecurity","Settings","showPage","setShowPage","mediaQueryXL","path","element","FriendsList","setSearch","setFilter","filterUsers","flt","styleStatus","styled","before","AddFriend","userCode","setUserCode","addFriend","PendingInvites","handleSelect","addUser","combinedId","docToAdd","setDoc","acceptInvite","arrCopy","arrCopy2","index2","declineInvite","Friends","view","setView","TabBar","App","setTheme","filterTheme","themeToSet","filteredTheme","minWidth","ReactDOM","StrictMode"],"mappings":"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","file":"static/js/main.bfaeb2e0.chunk.js","sourcesContent":["import firebase from 'firebase/compat/app'\r\nimport 'firebase/compat/firestore'\r\nimport 'firebase/compat/auth'\r\nimport 'firebase/compat/storage'\r\n\r\nconst firebaseConfig = {\r\n\tapiKey: 'AIzaSyBMB6C-_B61S1wd1RYAr34jomKZpvq16eA',\r\n\tauthDomain: 'better-react-messenger.firebaseapp.com',\r\n\tprojectId: 'better-react-messenger',\r\n\tstorageBucket: 'better-react-messenger.appspot.com',\r\n\tmessagingSenderId: '381225253186',\r\n\tappId: '1:381225253186:web:43a9fb8cce6b202f31f0db',\r\n}\r\n\r\n// Firebase init\r\nfirebase.initializeApp(firebaseConfig)\r\n\r\n// Services init\r\nconst projectFirestore = firebase.firestore()\r\nconst projectAuth = firebase.auth()\r\nconst projectStorage = firebase.storage()\r\n\r\nconst projectGoogle = new firebase.auth.GoogleAuthProvider()\r\nconst projectGitHub = new firebase.auth.GithubAuthProvider()\r\n\r\nprojectGoogle.setCustomParameters({ prompt: 'select_account' })\r\n\r\n// Timestamp\r\nconst timestamp = firebase.firestore.Timestamp\r\n\r\nexport { projectFirestore, projectAuth, timestamp, projectStorage, projectGoogle, projectGitHub }\r\n","import { createContext, useReducer, useEffect } from 'react'\nimport { projectAuth } from '../firebase/config'\n\nexport const AuthContext = createContext()\n\nexport const authReducer = (state, action) => {\n\tswitch (action.type) {\n\t\tcase 'LOGIN':\n\t\t\treturn { ...state, user: action.payload }\n\t\tcase 'LOGOUT':\n\t\t\treturn { ...state, user: null }\n\t\tcase 'AUTH_IS_READY':\n\t\t\treturn { user: action.payload, authIsReady: true }\n\t\tdefault:\n\t\t\treturn state\n\t}\n}\n\nexport const AuthContextProvider = ({ children }) => {\n\tconst [state, dispatch] = useReducer(authReducer, {\n\t\tuser: null,\n\t\tauthIsReady: false,\n\t})\n\n\tuseEffect(() => {\n\t\tconst unsub = projectAuth.onAuthStateChanged(user => {\n\t\t\tdispatch({ type: 'AUTH_IS_READY', payload: user })\n\t\t\tunsub()\n\t\t})\n\t}, [])\n\n\treturn <AuthContext.Provider value={{ ...state, dispatch }}>{children}</AuthContext.Provider>\n}\n","import { AuthContext } from \"../context/AuthContext\"\nimport { useContext } from \"react\"\n\nexport const useAuthContext = () => {\n  const context = useContext(AuthContext)\n\n  if(!context) {\n    throw Error('useAuthContext must be used inside an AuthContextProvider')\n  }\n\n  return context\n}","import { createGlobalStyle } from 'styled-components'\r\n\r\nconst spreadColors = theme => {\r\n\tlet colors = null\r\n\ttheme.colors.msgBgOwner.forEach(color => {\r\n\t\tcolors === null ? (colors = `${color.value}`) : (colors = `${colors}, ${color.value}`)\r\n\t})\r\n\r\n\tif (theme.colors.msgBgOwner.length === 1) {\r\n\t\treturn colors\r\n\t} else {\r\n\t\treturn `linear-gradient(${colors})`\r\n\t}\r\n}\r\n\r\nfunction adjustBrightness(col, amt) {\r\n\tvar usePound = false\r\n\tif (col) {\r\n\t\tif (col[0] === '#') {\r\n\t\t\tcol = col.slice(1)\r\n\t\t\tusePound = true\r\n\t\t}\r\n\r\n\t\tvar R = parseInt(col.substring(0, 2), 16)\r\n\t\tvar G = parseInt(col.substring(2, 4), 16)\r\n\t\tvar B = parseInt(col.substring(4, 6), 16)\r\n\r\n\t\t// to make the colour less bright than the input\r\n\t\t// change the following three \"+\" symbols to \"-\"\r\n\t\tR = R + amt\r\n\t\tG = G + amt\r\n\t\tB = B + amt\r\n\r\n\t\tif (R > 255) R = 255\r\n\t\telse if (R < 0) R = 0\r\n\r\n\t\tif (G > 255) G = 255\r\n\t\telse if (G < 0) G = 0\r\n\r\n\t\tif (B > 255) B = 255\r\n\t\telse if (B < 0) B = 0\r\n\r\n\t\tvar RR = R.toString(16).length === 1 ? '0' + R.toString(16) : R.toString(16)\r\n\t\tvar GG = G.toString(16).length === 1 ? '0' + G.toString(16) : G.toString(16)\r\n\t\tvar BB = B.toString(16).length === 1 ? '0' + B.toString(16) : B.toString(16)\r\n\r\n\t\treturn (usePound ? '#' : '') + RR + GG + BB\r\n\t}\r\n}\r\n\r\nexport const GlobalStyles = createGlobalStyle`\r\n#root {\r\n    --bg-dark: ${({ theme }) => theme.colors.bgDark};\r\n    --bg-dark-lighten5: ${({ theme }) => adjustBrightness(theme.colors.bgDark, 5)};\r\n    --bg-dark-lighten7: ${({ theme }) => adjustBrightness(theme.colors.bgDark, 7)};\r\n    --bg-dark-lighten10: ${({ theme }) => adjustBrightness(theme.colors.bgDark, 10)};\r\n    --bg-dark-lighten15: ${({ theme }) => adjustBrightness(theme.colors.bgDark, 15)};\r\n    --bg-dark-lighten20: ${({ theme }) => adjustBrightness(theme.colors.bgDark, 20)};\r\n    --bg-dark-lighten25: ${({ theme }) => adjustBrightness(theme.colors.bgDark, 25)};\r\n    --bg-dark-lighten90: ${({ theme }) => adjustBrightness(theme.colors.bgDark, 90)};\r\n    --bg-dark-lighten120: ${({ theme }) => adjustBrightness(theme.colors.bgDark, 120)};\r\n\r\n    --bg-secondary: ${({ theme }) => theme.colors.bgSecondary};\r\n\t--bg-secondary-lighten5: ${({ theme }) => adjustBrightness(theme.colors.bgSecondary, 5)};\r\n\t--bg-secondary-lighten10: ${({ theme }) => adjustBrightness(theme.colors.bgSecondary, 10)};\r\n\t--bg-secondary-lighten15: ${({ theme }) => adjustBrightness(theme.colors.bgSecondary, 15)};\r\n\t--bg-secondary-lighten20: ${({ theme }) => adjustBrightness(theme.colors.bgSecondary, 20)};\r\n\t--bg-secondary-lighten50: ${({ theme }) => adjustBrightness(theme.colors.bgSecondary, 50)};\r\n\r\n    --input-bg: ${({ theme }) => theme.colors.inputBg};\r\n    --input-text: ${({ theme }) => theme.colors.inputText};\r\n\t--input-border: ${({ theme }) => theme.colors.inputBorder};\r\n\r\n    --message-bg: ${({ theme }) => theme.colors.msgBg};\r\n    --message-color: ${({ theme }) => theme.colors.messageColor};\r\n\t--message-border: ${({ theme }) => theme.colors.msgBorder};\r\n\t\r\n    --message-bg-owner: ${({ theme }) => spreadColors(theme)};\r\n    --message-color-owner: ${({ theme }) => theme.colors.messageColorOwner};\r\n\t--message-border-owner: ${({ theme }) => theme.colors.msgBorderOwner};\r\n\t\r\n    --text-accent: ${({ theme }) => theme.colors.textAccent};\r\n    --text-accent-darken25: ${({ theme }) => adjustBrightness(theme.colors.textAccent, -25)};\r\n    --text-accent-darken35: ${({ theme }) => adjustBrightness(theme.colors.textAccent, -55)};\r\n\r\n    --border-radius: ${({ theme }) => theme.borderRadius}px;\r\n    --border-color: ${({ theme }) => adjustBrightness(theme.colors.bgDark, 15)};\r\n\r\n    --text-primary:  ${({ theme }) => theme.colors.textPrimary};\r\n    --text-primary-darken20:  ${({ theme }) => adjustBrightness(theme.colors.textPrimary, -20)};\r\n    --text-primary-darken50:  ${({ theme }) => adjustBrightness(theme.colors.textPrimary, -50)};\r\n    --text-primary-darken100:  ${({ theme }) => adjustBrightness(theme.colors.textPrimary, -100)};\r\n\r\n    --text-heading: ${({ theme }) => adjustBrightness(theme.colors.textPrimary, 30)};\r\n    --text-low-contrast: ${({ theme }) => theme.colors.textLowContrast}; \r\n    --text-mid-contrast: ${({ theme }) => adjustBrightness(theme.colors.textLowContrast, 40)}; \r\n\t\r\n    --btn-text: ${({ theme }) => theme.colors.buttonColor};\r\n\r\n}\r\n`\r\n","import { useEffect, useState, useRef } from \"react\"\nimport { projectFirestore } from \"../firebase/config\"\n\nexport const useCollection = (collection, _query, _orderBy) => {\n  const [documents, setDocuments] = useState(null)\n  const [error, setError] = useState(null)\n\n  // if we don't use a ref --> infinite loop in useEffect\n  // _query is an array and is \"different\" on every function call\n  const query = useRef(_query).current\n  const orderBy = useRef(_orderBy).current\n\n  useEffect(() => {\n    let ref = projectFirestore.collection(collection)\n\n    if (query) {\n      ref = ref.where(...query)\n    }\n    if (orderBy) {\n      ref = ref.orderBy(...orderBy)\n    }\n\n    const unsubscribe = ref.onSnapshot(snapshot => {\n      let results = []\n      snapshot.docs.forEach(doc => {\n        results.push({...doc.data(), id: doc.id})\n      });\n      \n      // update state\n      setDocuments(results)\n      setError(null)\n    }, error => {\n      console.log(error)\n      setError('could not fetch the data')\n    })\n\n    // unsubscribe on unmount\n    return () => unsubscribe()\n\n  }, [collection, query, orderBy])\n\n  return { documents, error }\n}","// Styles\r\nimport './Dashboard.scss'\r\n\r\nexport default function Dashboard() {\r\n\treturn <div className='dashboard'></div>\r\n}\r\n","import { useEffect, useState } from 'react'\r\nimport { projectFirestore } from '../firebase/config'\r\n\r\nexport const useDocument = (collection, id) => {\r\n\tconst [document, setDocument] = useState(null)\r\n\tconst [error, setError] = useState(null)\r\n\r\n\t// Realtime data for document\r\n\tuseEffect(() => {\r\n\t\tif (id !== null) {\r\n\t\t\tconst ref = projectFirestore.collection(collection).doc(id)\r\n\r\n\t\t\tconst unsub = ref.onSnapshot(\r\n\t\t\t\tsnapshot => {\r\n\t\t\t\t\tif (snapshot.data()) {\r\n\t\t\t\t\t\tsetDocument({ ...snapshot.data(), id: snapshot.id })\r\n\t\t\t\t\t\tsetError(null)\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tsetError('No such document exists')\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\terr => {\r\n\t\t\t\t\tconsole.log(err.message)\r\n\t\t\t\t\tsetError('Failed to get document')\r\n\t\t\t\t}\r\n\t\t\t)\r\n\r\n\t\t\treturn () => unsub()\r\n\t\t}\r\n\t}, [collection, id])\r\n\r\n\treturn { document, error }\r\n}\r\n","import { useReducer, useEffect, useState } from 'react'\nimport { projectFirestore, timestamp } from '../firebase/config'\n\nlet initialState = {\n\tdocument: null,\n\tisPending: false,\n\terror: null,\n\tsuccess: null,\n}\n\nconst firestoreReducer = (state, action) => {\n\tswitch (action.type) {\n\t\tcase 'IS_PENDING':\n\t\t\treturn { isPending: true, document: null, success: false, error: null }\n\t\tcase 'ADDED_DOCUMENT':\n\t\t\treturn { isPending: false, document: action.payload, success: true, error: null }\n\t\tcase 'DELETED_DOCUMENT':\n\t\t\treturn { isPending: false, document: null, success: true, error: null }\n\t\tcase 'UPDATED_DOCUMENT':\n\t\t\treturn { isPending: false, document: action.payload, success: true, error: null }\n\t\tcase 'ERROR':\n\t\t\treturn { isPending: false, document: null, success: false, error: action.payload }\n\t\tdefault:\n\t\t\treturn state\n\t}\n}\n\nexport const useFirestore = collection => {\n\tconst [response, dispatch] = useReducer(firestoreReducer, initialState)\n\tconst [isCancelled, setIsCancelled] = useState(false)\n\n\t// Collection ref\n\tconst ref = projectFirestore.collection(collection)\n\n\t// Only dispatch is not cancelled\n\tconst dispatchIfNotCancelled = action => {\n\t\tif (!isCancelled) {\n\t\t\tdispatch(action)\n\t\t}\n\t}\n\n\t// Add a document\n\tconst addDocument = async doc => {\n\t\tdispatch({ type: 'IS_PENDING' })\n\n\t\ttry {\n\t\t\tconst createdAt = timestamp.fromDate(new Date())\n\n\t\t\tconst addedDocument = await ref.add({ ...doc, createdAt })\n\t\t\tdispatchIfNotCancelled({ type: 'ADDED_DOCUMENT', payload: addedDocument })\n\t\t} catch (err) {\n\t\t\tdispatchIfNotCancelled({ type: 'ERROR', payload: err.message })\n\t\t}\n\t}\n\n\t// Delete a document\n\tconst deleteDocument = async id => {\n\t\tdispatch({ type: 'IS_PENDING' })\n\n\t\ttry {\n\t\t\tawait ref.doc(id).delete()\n\t\t\tdispatchIfNotCancelled({ type: 'DELETED_DOCUMENT' })\n\t\t} catch (err) {\n\t\t\tdispatchIfNotCancelled({ type: 'ERROR', payload: 'could not delete' })\n\t\t}\n\t}\n\n\t// Update documents\n\n\tconst updateDocument = async (id, updates) => {\n\t\tdispatch({ type: 'IS_PENDING' })\n\n\t\ttry {\n\t\t\tconst updatedDocument = await ref.doc(id).update(updates)\n\n\t\t\tdispatchIfNotCancelled({ type: 'UPDATED_DOCUMENT', payload: updatedDocument })\n\t\t\treturn updatedDocument\n\t\t} catch (err) {\n\t\t\tdispatchIfNotCancelled({ type: 'ERROR', payload: err.message })\n\t\t\treturn null\n\t\t}\n\t}\n\n\tuseEffect(() => {\n\t\treturn () => setIsCancelled(true)\n\t}, [])\n\n\treturn { addDocument, deleteDocument, updateDocument, response }\n}\n","export const useDates = () => {\r\n\tlet today = new Date().toLocaleDateString()\r\n\tlet weekday = []\r\n\tlet dayOfMonth, dayOfWeek, month, year, hour, curDate, fullDate\r\n\r\n\tconst dates = dateToFormat => {\r\n\t\tconst date = dateToFormat.toDate()\r\n\t\tweekday = ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun']\r\n\t\tdayOfWeek = weekday[date.getDay()]\r\n\r\n\t\tyear = date.getFullYear()\r\n\r\n\t\tmonth = date.getMonth() + 1 < 10 ? '0' + date.getMonth() + 1 : date.getMonth() + 1\r\n\r\n\t\tdayOfMonth = date.getDate() < 10 ? '0' + date.getDate().toString() : date.getDate().toString()\r\n\r\n\t\tcurDate = `${dayOfMonth}/${month}/${year}`\r\n\t\thour = date.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })\r\n\r\n\t\tfullDate = `${dayOfMonth}.${month}.${year}, ${hour}`\r\n\r\n\t\treturn { dayOfWeek, year, month, dayOfMonth, curDate, hour, fullDate }\r\n\t}\r\n\r\n\tconst isCurrentWeek = dateToFormat => {\r\n\t\tlet lastMonday = new Date() // Creating new date object for today\r\n\t\tlastMonday.setDate(lastMonday.getDate() - (lastMonday.getDay() - 1)) // Setting date to last monday\r\n\t\tlastMonday.setHours(0, 0, 0, 0) // Setting Hour to 00:00:00:00\r\n\r\n\t\tconst res =\r\n\t\t\tlastMonday.getTime() <= dateToFormat.getTime() && dateToFormat.getTime() < lastMonday.getTime() + 604800000\r\n\r\n\t\treturn res\r\n\t}\r\n\r\n\tconst formatDate = createdAt => {\r\n\t\tconst date = createdAt.toDate()\r\n\r\n\t\tweekday = ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun']\r\n\t\tdayOfWeek = weekday[date.getDay()]\r\n\r\n\t\tyear = date.getFullYear()\r\n\r\n\t\tmonth = date.getMonth() + 1 < 10 ? `0${date.getMonth() + 1}` : date.getMonth() + 1\r\n\r\n\t\tdayOfMonth = date.getDate() < 10 ? '0' + date.getDate().toString() : date.getDate().toString()\r\n\r\n\t\tcurDate = `${dayOfMonth}/${month}/${year}`\r\n\t\thour = date.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })\r\n\r\n\t\tif (curDate === today) {\r\n\t\t\treturn hour\r\n\t\t} else if (isCurrentWeek(date)) {\r\n\t\t\treturn `${dayOfWeek}. ${hour}`\r\n\t\t} else {\r\n\t\t\treturn `${dayOfMonth}.${month}.${year}, ${hour}`\r\n\t\t}\r\n\t}\r\n\r\n\treturn { formatDate, dates, dayOfMonth, dayOfWeek, month, year, hour, curDate }\r\n}\r\n","export default __webpack_public_path__ + \"static/media/logo-default.9dacd6cd.png\";","// Styles && Assets\r\nimport './Avatar.scss'\r\nimport appLogo from '../../assets/logo-default.png'\r\n\r\nexport default function Avatar({ src }) {\r\n\treturn (\r\n\t\t<div className='avatar'>\r\n\t\t\t<img src={src ? src : appLogo} alt='' />\r\n\t\t</div>\r\n\t)\r\n}\r\n","import { useCallback, useEffect } from 'react'\r\n\r\nconst KEY_NAME_ESC = 'Escape'\r\nconst KEY_EVENT_TYPE = 'keyup'\r\n\r\nexport function useEscapeKey(handleClose) {\r\n\tconst handleEscKey = useCallback(\r\n\t\tevent => {\r\n\t\t\tif (event.key === KEY_NAME_ESC) {\r\n\t\t\t\thandleClose()\r\n\t\t\t}\r\n\t\t},\r\n\t\t[handleClose]\r\n\t)\r\n\r\n\tuseEffect(() => {\r\n\t\tdocument.addEventListener(KEY_EVENT_TYPE, handleEscKey, false)\r\n\r\n\t\treturn () => {\r\n\t\t\tdocument.removeEventListener(KEY_EVENT_TYPE, handleEscKey, false)\r\n\t\t}\r\n\t}, [handleEscKey])\r\n}\r\n","import { useEffect } from 'react'\r\nimport OutsideClickHandler from 'react-outside-click-handler'\r\nimport { useEscapeKey } from '../../hooks/useEscapeKey'\r\n\r\n// Styles\r\nimport './Modal.scss'\r\n\r\nexport default function Modal({ children, show, setShow, onClose, disableOCH, button1, button2 }) {\r\n\tuseEffect(() => {\r\n\t\tif (show === false && onClose) {\r\n\t\t\tonClose()\r\n\t\t}\r\n\t}, [show])\r\n\r\n\tconst hideModal = () => {\r\n\t\tsetShow()\r\n\t}\r\n\r\n\tuseEscapeKey(hideModal)\r\n\r\n\treturn (\r\n\t\tshow && (\r\n\t\t\t<div className='modal'>\r\n\t\t\t\t<OutsideClickHandler\r\n\t\t\t\t\tonOutsideClick={() => {\r\n\t\t\t\t\t\tsetShow()\r\n\t\t\t\t\t}}\r\n\t\t\t\t\tdisabled={disableOCH}>\r\n\t\t\t\t\t<div className='modal__content'>\r\n\t\t\t\t\t\t{children}\r\n\t\t\t\t\t\t<i className='fa-solid fa-xmark close-btn' onClick={() => setShow()}></i>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</OutsideClickHandler>\r\n\t\t\t</div>\r\n\t\t)\r\n\t)\r\n}\r\n","// Styles\r\nimport './Tooltip.scss'\r\n\r\nconst Tooltip = ({ children, pos, align, className }) => {\r\n\treturn (\r\n\t\t<div className={`tooltip ${pos ? pos : ''} ${align ? align : ''} ${className ? className : ''}`}>\r\n\t\t\t<div className='tooltip__content'>{children ? children : 'tooltip'}</div>\r\n\t\t</div>\r\n\t)\r\n}\r\n\r\nexport default Tooltip\r\n","import React, { useEffect, useState } from 'react'\r\nimport { useCollection } from '../../hooks/useCollection'\r\nimport { Link } from 'react-router-dom'\r\n\r\n// Styles\r\nimport './AvatarWithStatus.scss'\r\n\r\n// Components\r\nimport Avatar from '../Avatar/Avatar'\r\nimport Tooltip from '../Tooltip/Tooltip'\r\n\r\nconst AvatarWithStatus = ({ userId, linkToProfile, noTooltip, noStatus, src }) => {\r\n\tconst { documents: users } = useCollection('users')\r\n\r\n\tconst [user, setUser] = useState(null)\r\n\r\n\tuseEffect(() => {\r\n\t\tif (users && userId && userId !== null) {\r\n\t\t\tsetUser(\r\n\t\t\t\tusers.filter(u => {\r\n\t\t\t\t\treturn u.id === userId\r\n\t\t\t\t})[0]\r\n\t\t\t)\r\n\t\t}\r\n\t}, [userId, users])\r\n\r\n\tif (user && user !== undefined && user !== null) {\r\n\t\treturn (\r\n\t\t\t<div className='avatar-container'>\r\n\t\t\t\t{linkToProfile && (\r\n\t\t\t\t\t<Link to={`/profile/${user.id}`}>\r\n\t\t\t\t\t\t<Avatar src={src || src === '' ? src : user.photoURL} />\r\n\t\t\t\t\t</Link>\r\n\t\t\t\t)}\r\n\r\n\t\t\t\t{!linkToProfile && <Avatar src={src || src === '' ? src : user.photoURL} />}\r\n\r\n\t\t\t\t{user && user.status && !noStatus && (\r\n\t\t\t\t\t<span className={`status`}>\r\n\t\t\t\t\t\t<div className={`status__dot status__dot--${user.status}`}>\r\n\t\t\t\t\t\t\t{(!noTooltip || noTooltip === undefined) && <Tooltip>{user.status}</Tooltip>}\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</span>\r\n\t\t\t\t)}\r\n\t\t\t</div>\r\n\t\t)\r\n\t} else {\r\n\t\treturn null\r\n\t}\r\n}\r\n\r\nexport default AvatarWithStatus\r\n","import React from 'react'\r\nimport { useFirestore } from '../../hooks/useFirestore'\r\nimport { Link } from 'react-router-dom'\r\nimport { useDocument } from '../../hooks/useDocument'\r\nimport { useAuthContext } from '../../hooks/useAuthContext'\r\n\r\n// Styles\r\nimport './ProfilePreview.scss'\r\n\r\n// Components\r\nimport OutsideClickHandler from 'react-outside-click-handler'\r\nimport AvatarWithStatus from '../AvatarWithStatus/AvatarWithStatus'\r\nimport Tooltip from '../Tooltip/Tooltip'\r\n\r\nconst ConditionalWrapper = ({ condition, wrapper, children }) => (condition ? wrapper(children) : children)\r\n\r\nexport default function ProfilePreview({ show, setShow, userId, pos, align, disableTooltip }) {\r\n\tconst statuses = ['online', 'idle', 'do-not-disturb', 'invisible']\r\n\r\n\tconst { updateDocument } = useFirestore('users')\r\n\tconst { document: userDoc } = useDocument('users', userId)\r\n\tconst { user } = useAuthContext()\r\n\r\n\tconst handleStatus = async status => {\r\n\t\tawait updateDocument(user.uid, {\r\n\t\t\tstatus: status,\r\n\t\t})\r\n\t}\r\n\r\n\tif (show === true && setShow && userDoc) {\r\n\t\treturn (\r\n\t\t\t<ConditionalWrapper\r\n\t\t\t\tcondition={!disableTooltip}\r\n\t\t\t\twrapper={children => (\r\n\t\t\t\t\t<OutsideClickHandler onOutsideClick={() => setShow(false)}>\r\n\t\t\t\t\t\t<Tooltip pos={pos ? pos : 'top'} align={align ? align : 'end'} className='profile-preview-tooltip'>\r\n\t\t\t\t\t\t\t{children}\r\n\t\t\t\t\t\t</Tooltip>\r\n\t\t\t\t\t</OutsideClickHandler>\r\n\t\t\t\t)}>\r\n\t\t\t\t<div className='profile-preview'>\r\n\t\t\t\t\t<div className='profile-preview__banner' style={{ backgroundColor: userDoc.banner }}></div>\r\n\r\n\t\t\t\t\t<div className='profile-preview__header'>\r\n\t\t\t\t\t\t{userDoc && (\r\n\t\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\t\t\tsetShow(false)\r\n\t\t\t\t\t\t\t\t}}>\r\n\t\t\t\t\t\t\t\t<AvatarWithStatus userId={userDoc.id} linkToProfile={true} />\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t)}\r\n\r\n\t\t\t\t\t\t{userId === user.uid && (\r\n\t\t\t\t\t\t\t<Link\r\n\t\t\t\t\t\t\t\tto='/settings'\r\n\t\t\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\t\t\tsetShow(false)\r\n\t\t\t\t\t\t\t\t}}>\r\n\t\t\t\t\t\t\t\t<i className='fa-solid fa-gear'></i>\r\n\t\t\t\t\t\t\t</Link>\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t<div className='profile-preview__info'>\r\n\t\t\t\t\t\t<h3 className='name'>{userDoc.displayName}</h3>\r\n\r\n\t\t\t\t\t\t<div className='separator'></div>\r\n\r\n\t\t\t\t\t\t<div className='cards'>\r\n\t\t\t\t\t\t\t<div className='cards__card'>\r\n\t\t\t\t\t\t\t\t<h4>About me</h4>\r\n\t\t\t\t\t\t\t\t{userDoc.bio && <p className='bio'>{userDoc.bio}</p>}\r\n\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t<div className='cards__card'>\r\n\t\t\t\t\t\t\t\t<h4>Member since</h4>\r\n\t\t\t\t\t\t\t\t<p>{userDoc.createdAt}</p>\r\n\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t{userId === user.uid && (\r\n\t\t\t\t\t\t\t\t<>\r\n\t\t\t\t\t\t\t\t\t<div className='separator'></div>\r\n\t\t\t\t\t\t\t\t\t<div className='status-picker'>\r\n\t\t\t\t\t\t\t\t\t\t<div className='flex-row'>\r\n\t\t\t\t\t\t\t\t\t\t\t<div className={`status-dot status-dot--${userDoc.status}`}></div>\r\n\t\t\t\t\t\t\t\t\t\t\t<span>{userDoc.status === 'do-not-disturb' ? 'do not disturb' : userDoc.status}</span>\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t\t\t\t<i className='fa-solid fa-angle-right'></i>\r\n\r\n\t\t\t\t\t\t\t\t\t\t<div className='tooltip-container'>\r\n\t\t\t\t\t\t\t\t\t\t\t<Tooltip>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<div className='picker'>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t{statuses.map(status => (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclassName={`status ${status === userDoc.status ? 'status--current' : ''}`}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tonClick={() => handleStatus(status)}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tkey={status}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span className={`status-dot status-dot--${status}`}></span>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span className='status__name'>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{status === 'do-not-disturb' ? 'do not disturb' : status}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t))}\r\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t</Tooltip>\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t</>\r\n\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t</ConditionalWrapper>\r\n\t\t)\r\n\t} else {\r\n\t\treturn null\r\n\t}\r\n}\r\n","import React from 'react'\r\nimport { useState } from 'react'\r\nimport { useAuthContext } from '../../../../hooks/useAuthContext'\r\nimport { useFirestore } from '../../../../hooks/useFirestore'\r\nimport { useDates } from '../../../../hooks/useDates'\r\nimport { useCollection } from '../../../../hooks/useCollection'\r\n\r\n// Styles\r\nimport './Message.scss'\r\n\r\n// Components\r\nimport Avatar from '../../../../components/Avatar/Avatar'\r\nimport Modal from '../../../../components/Modal/Modal'\r\nimport Tooltip from '../../../../components/Tooltip/Tooltip'\r\nimport AvatarWithStatus from '../../../../components/AvatarWithStatus/AvatarWithStatus'\r\nimport ProfilePreview from '../../../../components/ProfilePreview/ProfilePreview'\r\nimport EmojiPicker, { EmojiStyle, Theme } from 'emoji-picker-react'\r\nimport OutsideClickHandler from 'react-outside-click-handler'\r\n\r\nexport default function Message({\r\n\tmessage,\r\n\telements,\r\n\ti,\r\n\tchat,\r\n\tonMessageResponse,\r\n\tsetMessageToDelete,\r\n\tshowImage,\r\n\tsetShowImage,\r\n}) {\r\n\tconst { user } = useAuthContext()\r\n\tconst { updateDocument } = useFirestore('projects')\r\n\tconst { formatDate } = useDates()\r\n\tconst { documents: users } = useCollection('users')\r\n\r\n\tconst [showEmojis, setShowEmojis] = useState(null)\r\n\tconst [showModal, setShowModal] = useState(false)\r\n\tconst [emojiReactions, setEmojiReactions] = useState([])\r\n\tconst [showProfilePrev, setShowProfilePrev] = useState(false)\r\n\r\n\tconst showSendDate = (elements, i) => {\r\n\t\tif (elements[i] && elements[i - 1]) {\r\n\t\t\tconst value1 = elements[i].createdAt.toDate().toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })\r\n\t\t\tconst value2 = elements[i - 1].createdAt.toDate().toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })\r\n\r\n\t\t\t// Get miliseconds of each message.createdAt\r\n\t\t\tconst date1 = new Date('01/01/2022 ' + value1 + ':00').getTime()\r\n\t\t\tconst date2 = new Date('01/01/2022 ' + value2 + ':00').getTime()\r\n\r\n\t\t\tconst minuteDiff = Math.abs(date1 - date2)\r\n\r\n\t\t\t// Check if difference between when message was created is greater than 15 minutes\r\n\t\t\tif (minuteDiff >= 900000) {\r\n\t\t\t\treturn true\r\n\t\t\t} else {\r\n\t\t\t\treturn false\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tconst showSendDate2 = (elements, i) => {\r\n\t\tif (elements[i + 1] && elements[i]) {\r\n\t\t\tconst value1 = elements[i + 1].createdAt.toDate().toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })\r\n\t\t\tconst value2 = elements[i].createdAt.toDate().toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })\r\n\r\n\t\t\t// Get miliseconds of each message.createdAt\r\n\t\t\tconst date1 = new Date('01/01/2022 ' + value1 + ':00').getTime()\r\n\t\t\tconst date2 = new Date('01/01/2022 ' + value2 + ':00').getTime()\r\n\r\n\t\t\tconst minuteDiff = Math.abs(date1 - date2)\r\n\r\n\t\t\t// Check if difference between when message was created is greater than 15 minutes\r\n\t\t\tif (minuteDiff >= 900000) {\r\n\t\t\t\treturn true\r\n\t\t\t} else {\r\n\t\t\t\treturn false\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tconst showFullImage = e => {\r\n\t\tif (showImage !== e.target.src) {\r\n\t\t\tsetShowImage(e.target.src)\r\n\t\t}\r\n\t}\r\n\r\n\tconst scrollToResponse = id => {\r\n\t\tconst ref = document.getElementById(id)\r\n\t\tref.scrollIntoView({ block: 'center' })\r\n\t\tsetTimeout(() => {\r\n\t\t\tref.classList.add('pop')\r\n\t\t\tsetTimeout(() => {\r\n\t\t\t\tref.classList.remove('pop')\r\n\t\t\t}, 800)\r\n\t\t}, 400)\r\n\t}\r\n\r\n\tconst reactWithEmoji = async (e, message) => {\r\n\t\tconst indexOfMessage = chat.messages.indexOf(message)\r\n\r\n\t\tlet otherUserReaction = null\r\n\r\n\t\tif (message.emojiReactions && message.emojiReactions.length > 0) {\r\n\t\t\tmessage.emojiReactions.forEach(rec => {\r\n\t\t\t\tif (rec !== null) {\r\n\t\t\t\t\tif (rec.id !== user.uid) {\r\n\t\t\t\t\t\totherUserReaction = rec\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t}\r\n\r\n\t\tconst emojiToAdd = {\r\n\t\t\tid: user.uid,\r\n\t\t\tcontent: e.emoji,\r\n\t\t}\r\n\r\n\t\tchat.messages[indexOfMessage] = {\r\n\t\t\t...chat.messages[indexOfMessage],\r\n\t\t\temojiReactions: [\r\n\t\t\t\totherUserReaction ? otherUserReaction : null,\r\n\t\t\t\t{\r\n\t\t\t\t\t...emojiToAdd,\r\n\t\t\t\t},\r\n\t\t\t],\r\n\t\t}\r\n\r\n\t\ttry {\r\n\t\t\tawait updateDocument(chat.id, {\r\n\t\t\t\tmessages: [...chat.messages],\r\n\t\t\t})\r\n\t\t} catch (error) {\r\n\t\t\tconsole.log(error)\r\n\t\t}\r\n\t}\r\n\r\n\tconst handleReactionNicknames = reaction => {\r\n\t\tlet nickname\r\n\t\tchat.assignedUsers.forEach(u => {\r\n\t\t\tif (u.id === reaction.id) {\r\n\t\t\t\tif (u.nickname !== '') {\r\n\t\t\t\t\tnickname = u.nickname\r\n\t\t\t\t} else {\r\n\t\t\t\t\tnickname = u.displayName\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t})\r\n\t\treturn nickname\r\n\t}\r\n\r\n\tconst deleteEmojiReaction = async (message, reaction) => {\r\n\t\tlet otherUserReaction = null\r\n\t\tif (reaction.id === user.uid) {\r\n\t\t\tif (message.emojiReactions.length > 0) {\r\n\t\t\t\tmessage.emojiReactions.forEach(rec => {\r\n\t\t\t\t\tif (rec !== null && rec.id !== user.uid) {\r\n\t\t\t\t\t\totherUserReaction = rec\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t}\r\n\r\n\t\t\tconst indexOfMessage = chat.messages.indexOf(message)\r\n\r\n\t\t\tchat.messages[indexOfMessage] = {\r\n\t\t\t\t...chat.messages[indexOfMessage],\r\n\t\t\t\temojiReactions: [otherUserReaction],\r\n\t\t\t}\r\n\r\n\t\t\ttry {\r\n\t\t\t\tawait updateDocument(chat.id, {\r\n\t\t\t\t\tmessages: [...chat.messages],\r\n\t\t\t\t})\r\n\t\t\t\tsetEmojiReactions([])\r\n\t\t\t\tsetShowModal(false)\r\n\t\t\t} catch (error) {\r\n\t\t\t\tconsole.log(error)\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tconst getDoc = id => {\r\n\t\tlet res = null\r\n\r\n\t\tif (users) {\r\n\t\t\tres = users.filter(doc => {\r\n\t\t\t\tif (doc.id === id) {\r\n\t\t\t\t\treturn true\r\n\t\t\t\t}\r\n\t\t\t\treturn false\r\n\t\t\t})[0]\r\n\t\t}\r\n\r\n\t\treturn res\r\n\t}\r\n\r\n\tconst getLocalUser = id => {\r\n\t\tlet res = null\r\n\r\n\t\tif (chat) {\r\n\t\t\tchat.assignedUsers.forEach(u => {\r\n\t\t\t\tif (u.id === id) {\r\n\t\t\t\t\tres = u\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t}\r\n\r\n\t\treturn res\r\n\t}\r\n\r\n\tconst isTop = () => {\r\n\t\tif (\r\n\t\t\telements[i + 1] &&\r\n\t\t\t(!elements[i - 1] ||\r\n\t\t\t\telements[i - 1].createdBy !== message.createdBy ||\r\n\t\t\t\telements[i + 1].response !== null ||\r\n\t\t\t\tshowSendDate(elements, i) ||\r\n\t\t\t\tmessage.response !== null) &&\r\n\t\t\telements[i + 1].createdBy === message.createdBy &&\r\n\t\t\telements[i + 1].response === null &&\r\n\t\t\t!showSendDate2(elements, i)\r\n\t\t) {\r\n\t\t\treturn true\r\n\t\t}\r\n\r\n\t\treturn false\r\n\t}\r\n\r\n\tconst isMiddle = () => {\r\n\t\tif (\r\n\t\t\telements[i - 1] &&\r\n\t\t\telements[i + 1] &&\r\n\t\t\t(elements[i - 1].createdBy === message.createdBy || elements[i - 1].response !== null) &&\r\n\t\t\telements[i + 1].createdBy === message.createdBy &&\r\n\t\t\telements[i + 1].response === null &&\r\n\t\t\t!showSendDate(elements, i) &&\r\n\t\t\t!showSendDate2(elements, i)\r\n\t\t) {\r\n\t\t\treturn true\r\n\t\t}\r\n\r\n\t\treturn false\r\n\t}\r\n\r\n\tconst isBottom = () => {\r\n\t\tif (\r\n\t\t\telements[i - 1] &&\r\n\t\t\telements[i - 1].createdBy === message.createdBy &&\r\n\t\t\tmessage.response === null &&\r\n\t\t\t((!elements[i + 1] && message.response === null) ||\r\n\t\t\t\t(elements[i + 1] &&\r\n\t\t\t\t\t(elements[i + 1].response !== null ||\r\n\t\t\t\t\t\telements[i + 1].createdBy !== message.createdBy ||\r\n\t\t\t\t\t\tshowSendDate2(elements, i)))) &&\r\n\t\t\t!showSendDate(elements, i)\r\n\t\t) {\r\n\t\t\treturn true\r\n\t\t}\r\n\r\n\t\treturn false\r\n\t}\r\n\r\n\tconst handleMessageStyle = () => {\r\n\t\tif (isTop()) {\r\n\t\t\tif (message.createdBy === user.uid) {\r\n\t\t\t\treturn 'group-top owner'\r\n\t\t\t} else {\r\n\t\t\t\treturn 'group-top'\r\n\t\t\t}\r\n\t\t} else if (isMiddle()) {\r\n\t\t\tif (message.createdBy === user.uid) {\r\n\t\t\t\treturn 'group-middle owner'\r\n\t\t\t} else {\r\n\t\t\t\treturn 'group-middle'\r\n\t\t\t}\r\n\t\t} else if (isBottom()) {\r\n\t\t\tif (message.createdBy === user.uid) {\r\n\t\t\t\treturn 'group-bottom owner'\r\n\t\t\t} else {\r\n\t\t\t\treturn 'group-bottom'\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tif (message.createdBy === user.uid) {\r\n\t\t\t\treturn 'owner'\r\n\t\t\t} else {\r\n\t\t\t\treturn ''\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\treturn (\r\n\t\t<>\r\n\t\t\t{message.isSpecial && <div className='messages__centered mt2 mb2'>{message.content}</div>}\r\n\t\t\t{!message.isSpecial && (\r\n\t\t\t\t<>\r\n\t\t\t\t\t{showSendDate(elements, i) && (\r\n\t\t\t\t\t\t<div className='messages__centered mb1 mt2'>{formatDate(message.createdAt)}</div>\r\n\t\t\t\t\t)}\r\n\t\t\t\t\t<li\r\n\t\t\t\t\t\tclassName={`${handleMessageStyle()} ${message.deleted ? 'deleted' : ''} ${\r\n\t\t\t\t\t\t\tmessage.emojiReactions ? 'emoji-response' : ''\r\n\t\t\t\t\t\t}`}\r\n\t\t\t\t\t\tid={message.id}>\r\n\t\t\t\t\t\t{message.createdBy !== user.uid && (isTop() || !(isMiddle() || isBottom())) && (\r\n\t\t\t\t\t\t\t<p className='message-author'>{getLocalUser(message.createdBy).nickname}</p>\r\n\t\t\t\t\t\t)}\r\n\r\n\t\t\t\t\t\t{message.response !== null && (\r\n\t\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\t\tonClick={() => scrollToResponse(chat.messages[message.response].id)}\r\n\t\t\t\t\t\t\t\tclassName={`response ${chat.messages[message.response].deleted ? 'deleted' : ''}`}>\r\n\t\t\t\t\t\t\t\t{message.createdBy !== user.uid && <div className='left-margin'></div>}\r\n\r\n\t\t\t\t\t\t\t\t{chat.messages[message.response].content && (\r\n\t\t\t\t\t\t\t\t\t<div className='response__message'>{chat.messages[message.response].content.substring(0, 55)}</div>\r\n\t\t\t\t\t\t\t\t)}\r\n\r\n\t\t\t\t\t\t\t\t<div className='response__img'>\r\n\t\t\t\t\t\t\t\t\t{chat.messages[message.response].image &&\r\n\t\t\t\t\t\t\t\t\t\t(chat.messages[message.response].fileType === 'image' ? (\r\n\t\t\t\t\t\t\t\t\t\t\t<img src={chat.messages[message.response].image} alt='' />\r\n\t\t\t\t\t\t\t\t\t\t) : (\r\n\t\t\t\t\t\t\t\t\t\t\t<video src={chat.messages[message.response].image}></video>\r\n\t\t\t\t\t\t\t\t\t\t))}\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t<div className='message-content'>\r\n\t\t\t\t\t\t\t{message.createdBy !== user.uid && (\r\n\t\t\t\t\t\t\t\t<div className='left-margin'>\r\n\t\t\t\t\t\t\t\t\t{!isMiddle() &&\r\n\t\t\t\t\t\t\t\t\t\t!(\r\n\t\t\t\t\t\t\t\t\t\t\t// top\r\n\t\t\t\t\t\t\t\t\t\t\tisTop()\r\n\t\t\t\t\t\t\t\t\t\t) && (\r\n\t\t\t\t\t\t\t\t\t\t\t<div className='cursor-pointer' onClick={() => setShowProfilePrev(message.id)}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<AvatarWithStatus userId={message.createdBy} noStatus={true} />\r\n\t\t\t\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<ProfilePreview\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tshow={showProfilePrev === message.id}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tsetShow={setShowProfilePrev}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tuserId={message.createdBy}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tpos='right'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\talign='end'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t<div className='message-content__text'>\r\n\t\t\t\t\t\t\t\t{message.content && <p>{message.content}</p>}\r\n\r\n\t\t\t\t\t\t\t\t{message.image && message.fileType === 'image' && (\r\n\t\t\t\t\t\t\t\t\t<div className='file-message' onClick={e => showFullImage(e)}>\r\n\t\t\t\t\t\t\t\t\t\t<img src={message.image} alt='' />\r\n\t\t\t\t\t\t\t\t\t\t<div className='file-message__preview'>\r\n\t\t\t\t\t\t\t\t\t\t\t<i className='fa-solid fa-up-right-and-down-left-from-center'></i>\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t)}\r\n\r\n\t\t\t\t\t\t\t\t{message.image && message.fileType === 'video' && (\r\n\t\t\t\t\t\t\t\t\t<div className='file-message'>\r\n\t\t\t\t\t\t\t\t\t\t<video src={message.image} controls playsInline />\r\n\t\t\t\t\t\t\t\t\t\t<div className='file-message__preview'>\r\n\t\t\t\t\t\t\t\t\t\t\t<i className='fa-solid fa-up-right-and-down-left-from-center'></i>\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t)}\r\n\r\n\t\t\t\t\t\t\t\t{message.emojiReactions && message.emojiReactions.length > 0 && (\r\n\t\t\t\t\t\t\t\t\t<>\r\n\t\t\t\t\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\t\t\t\t\tclassName='emoji-reactions'\r\n\t\t\t\t\t\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\t\t\t\t\t\tsetEmojiReactions(message.emojiReactions)\r\n\t\t\t\t\t\t\t\t\t\t\t\tsetShowModal(true)\r\n\t\t\t\t\t\t\t\t\t\t\t}}>\r\n\t\t\t\t\t\t\t\t\t\t\t{message.emojiReactions.map(reaction =>\r\n\t\t\t\t\t\t\t\t\t\t\t\treaction !== null ? (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<div key={reaction.id} className='emoji-reactions__reaction'>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span className='content'>{reaction.content}</span>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span className='display-name'>{handleReactionNicknames(reaction)}</span>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t) : null\r\n\t\t\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t\t\t\t<Modal show={showModal} setShow={() => setShowModal(false)} onClose={() => setEmojiReactions([])}>\r\n\t\t\t\t\t\t\t\t\t\t\t<div className='show-reactions'>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<h3>Reactions</h3>\r\n\t\t\t\t\t\t\t\t\t\t\t\t{emojiReactions.map(reaction =>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\treaction !== null ? (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclassName={`reaction ${reaction.id === user.uid ? 'cursor-pointer' : ''}`}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tdeleteEmojiReaction(message, reaction)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tkey={reaction.id}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div className='reaction__author'>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Avatar src={getDoc(reaction.id).photoURL} />\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<p>{getLocalUser(reaction.id).nickname}</p>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{reaction.id === user.uid && <p>Click to delete</p>}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span className='reaction__emoji'>{reaction.content}</span>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t) : null\r\n\t\t\t\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t</Modal>\r\n\t\t\t\t\t\t\t\t\t</>\r\n\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t{showEmojis === message && (\r\n\t\t\t\t\t\t\t\t<div className='react-with-emoji'>\r\n\t\t\t\t\t\t\t\t\t<OutsideClickHandler\r\n\t\t\t\t\t\t\t\t\t\tonOutsideClick={() => {\r\n\t\t\t\t\t\t\t\t\t\t\tsetShowEmojis(null)\r\n\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t\tdisabled={showEmojis === message ? false : true}>\r\n\t\t\t\t\t\t\t\t\t\t<EmojiPicker\r\n\t\t\t\t\t\t\t\t\t\t\tclassName='emoji-picker'\r\n\t\t\t\t\t\t\t\t\t\t\tonEmojiClick={e => {\r\n\t\t\t\t\t\t\t\t\t\t\t\treactWithEmoji(e, message)\r\n\t\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t\t\ttheme={Theme.DARK}\r\n\t\t\t\t\t\t\t\t\t\t\tpreviewConfig={{\r\n\t\t\t\t\t\t\t\t\t\t\t\tdefaultCaption: '',\r\n\t\t\t\t\t\t\t\t\t\t\t\tdefaultEmoji: null,\r\n\t\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t\t\twidth={300}\r\n\t\t\t\t\t\t\t\t\t\t\theight={400}\r\n\t\t\t\t\t\t\t\t\t\t\t// lazyLoadEmojis={true}\r\n\t\t\t\t\t\t\t\t\t\t\temojiStyle={EmojiStyle.NATIVE}\r\n\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t</OutsideClickHandler>\r\n\r\n\t\t\t\t\t\t\t\t\t<svg height='12' viewBox='0 0 25 12' width='25' data-darkreader-inline-fill=''>\r\n\t\t\t\t\t\t\t\t\t\t<path d='M24.553.103c-2.791.32-5.922 1.53-7.78 3.455l-9.62 7.023c-2.45 2.54-5.78 1.645-5.78-2.487V2.085C1.373 1.191.846.422.1.102h24.453z'></path>\r\n\t\t\t\t\t\t\t\t\t</svg>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t)}\r\n\r\n\t\t\t\t\t\t\t{!message.deleted && (\r\n\t\t\t\t\t\t\t\t<div className={`message-tools ${showEmojis === message ? 'visible' : ''}`}>\r\n\t\t\t\t\t\t\t\t\t<i\r\n\t\t\t\t\t\t\t\t\t\tclassName='fa-regular fa-face-smile'\r\n\t\t\t\t\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\t\t\t\t\tsetShowEmojis(message)\r\n\t\t\t\t\t\t\t\t\t\t}}>\r\n\t\t\t\t\t\t\t\t\t\t<Tooltip>React</Tooltip>\r\n\t\t\t\t\t\t\t\t\t</i>\r\n\r\n\t\t\t\t\t\t\t\t\t{user.uid === message.createdBy && (\r\n\t\t\t\t\t\t\t\t\t\t<i className='fa-solid fa-trash-can' onClick={() => setMessageToDelete(message)}>\r\n\t\t\t\t\t\t\t\t\t\t\t<Tooltip>Remove</Tooltip>\r\n\t\t\t\t\t\t\t\t\t\t</i>\r\n\t\t\t\t\t\t\t\t\t)}\r\n\r\n\t\t\t\t\t\t\t\t\t<i\r\n\t\t\t\t\t\t\t\t\t\tclassName='fa-solid fa-reply'\r\n\t\t\t\t\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\t\t\t\t\tonMessageResponse(Number(chat.messages.indexOf(message)))\r\n\t\t\t\t\t\t\t\t\t\t}}>\r\n\t\t\t\t\t\t\t\t\t\t<Tooltip>Reply</Tooltip>\r\n\t\t\t\t\t\t\t\t\t</i>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t)}\r\n\r\n\t\t\t\t\t\t\t<Tooltip\r\n\t\t\t\t\t\t\t\tpos='top'\r\n\t\t\t\t\t\t\t\talign='center'\r\n\t\t\t\t\t\t\t\tclassName={`message-createdAt ${showEmojis === message ? 'hidden' : ''}`}>\r\n\t\t\t\t\t\t\t\t<span>{formatDate(message.createdAt)}</span>\r\n\t\t\t\t\t\t\t</Tooltip>\r\n\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t<div className='seen'>\r\n\t\t\t\t\t\t\t{chat.assignedUsers.map(\r\n\t\t\t\t\t\t\t\tu =>\r\n\t\t\t\t\t\t\t\t\tu.lastRead === message.id &&\r\n\t\t\t\t\t\t\t\t\tu.id !== user.uid && (\r\n\t\t\t\t\t\t\t\t\t\t<React.Fragment key={u.id}>\r\n\t\t\t\t\t\t\t\t\t\t\t<Avatar src={getDoc(u.id) !== null ? getDoc(u.id).photoURL : ''} />\r\n\t\t\t\t\t\t\t\t\t\t</React.Fragment>\r\n\t\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</li>\r\n\t\t\t\t</>\r\n\t\t\t)}\r\n\t\t</>\r\n\t)\r\n}\r\n","import React, { useState, useEffect, useRef } from 'react'\r\nimport { useAuthContext } from '../../../hooks/useAuthContext'\r\nimport { useDates } from '../../../hooks/useDates'\r\nimport { useFirestore } from '../../../hooks/useFirestore'\r\nimport { useLocation } from 'react-router-dom'\r\nimport FileSaver from 'file-saver'\r\nimport Message from './Message/Message'\r\n\r\n// Styles && Assets\r\nimport './Messages.scss'\r\nimport Modal from '../../../components/Modal/Modal'\r\n\r\nconst Messages = ({ chat, onMessageResponse, setBottomDiv, otherUser, currentUser }) => {\r\n\tconst { user } = useAuthContext()\r\n\tconst { dates } = useDates()\r\n\tconst { updateDocument } = useFirestore('projects')\r\n\r\n\tconst [showImage, setShowImage] = useState('')\r\n\tconst [messageToDelete, setMessageToDelete] = useState(null)\r\n\tconst [showModal, setShowModal] = useState(false)\r\n\r\n\tconst location = useLocation()\r\n\tconst bottomRef = useRef()\r\n\tconst scrollDownRef = useRef()\r\n\r\n\tuseEffect(() => {\r\n\t\tsetBottomDiv(bottomRef)\r\n\t\tscrollToBottom()\r\n\t}, [])\r\n\r\n\tuseEffect(() => {\r\n\t\tsetBottomDiv(bottomRef)\r\n\t\tscrollToBottom()\r\n\t\tonMessageResponse(null)\r\n\t}, [location])\r\n\r\n\tuseEffect(() => {\r\n\t\tif (messageToDelete !== null) {\r\n\t\t\tsetShowModal(true)\r\n\t\t} else {\r\n\t\t\tsetShowModal(false)\r\n\t\t}\r\n\t}, [messageToDelete, showModal])\r\n\r\n\tconst deleteMessage = async message => {\r\n\t\tif (user.uid === message.createdBy) {\r\n\t\t\tchat.messages[chat.messages.indexOf(message)] = {\r\n\t\t\t\t...chat.messages[chat.messages.indexOf(message)],\r\n\t\t\t\tcontent: 'Message deleted',\r\n\t\t\t\temojiReactions: null,\r\n\t\t\t\tdeleted: true,\r\n\t\t\t}\r\n\r\n\t\t\ttry {\r\n\t\t\t\tawait updateDocument(chat.id, {\r\n\t\t\t\t\tmessages: [...chat.messages],\r\n\t\t\t\t})\r\n\t\t\t\tsetMessageToDelete(null)\r\n\t\t\t} catch (error) {\r\n\t\t\t\tconsole.log(error)\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tconst hideFullImage = () => {\r\n\t\tsetShowImage('')\r\n\t}\r\n\r\n\tconst downloadImage = () => {\r\n\t\tFileSaver.saveAs(showImage)\r\n\t}\r\n\r\n\tconst scrollToBottom = () => {\r\n\t\tif (bottomRef.current) {\r\n\t\t\tbottomRef.current.scrollIntoView({\r\n\t\t\t\tblock: 'end',\r\n\t\t\t})\r\n\t\t}\r\n\t}\r\n\r\n\tconst handleScrollDownBtn = e => {\r\n\t\tconst winScroll = e.target.scrollTop\r\n\r\n\t\tif (-winScroll <= 300) {\r\n\t\t\tscrollDownRef.current.classList.remove('active')\r\n\t\t}\r\n\r\n\t\tif (-winScroll >= 300) {\r\n\t\t\tscrollDownRef.current.classList.add('active')\r\n\t\t}\r\n\t}\r\n\r\n\treturn (\r\n\t\t<ul className='messages custom-scrollbar' id='messages' onScroll={e => handleScrollDownBtn(e)}>\r\n\t\t\t{showImage && (\r\n\t\t\t\t<div className='full-img'>\r\n\t\t\t\t\t<div className='full-img__background'>\r\n\t\t\t\t\t\t<div className='backdrop-blur'></div>\r\n\t\t\t\t\t\t<img src={showImage} alt='' className='' />\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div className='wrapper'>\r\n\t\t\t\t\t\t<img src={showImage} alt='' className='full-img__img' />\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t<div className='full-img__tools'>\r\n\t\t\t\t\t\t<div className='tool' onClick={() => downloadImage()}>\r\n\t\t\t\t\t\t\t<i className='fa-solid fa-download'></i>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<div className='tool' onClick={() => hideFullImage()}>\r\n\t\t\t\t\t\t\t<i className='fa-solid fa-xmark'></i>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t)}\r\n\t\t\t<div className='messages-wrapper'>\r\n\t\t\t\t<div className='messages__conversation-start'>\r\n\t\t\t\t\t<p>This is the start of your conversation with this user</p>\r\n\t\t\t\t\t<p>{dates(chat.createdAt).fullDate}</p>\r\n\t\t\t\t</div>\r\n\r\n\t\t\t\t{chat.messages.length > 0 &&\r\n\t\t\t\t\tchat.messages.map((message, i, elements) => (\r\n\t\t\t\t\t\t<Message\r\n\t\t\t\t\t\t\tkey={message.id}\r\n\t\t\t\t\t\t\tmessage={message}\r\n\t\t\t\t\t\t\telements={elements}\r\n\t\t\t\t\t\t\ti={i}\r\n\t\t\t\t\t\t\tchat={chat}\r\n\t\t\t\t\t\t\tonMessageResponse={onMessageResponse}\r\n\t\t\t\t\t\t\tsetMessageToDelete={setMessageToDelete}\r\n\t\t\t\t\t\t\tshowImage={showImage}\r\n\t\t\t\t\t\t\tsetShowImage={setShowImage}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t))}\r\n\t\t\t\t<div ref={bottomRef} className='bottom-ref'></div>\r\n\t\t\t</div>\r\n\t\t\t<div className='scroll-down' onClick={() => scrollToBottom()} ref={scrollDownRef}>\r\n\t\t\t\t<i className='fa-solid fa-arrow-down'></i>\r\n\t\t\t</div>\r\n\t\t\t{messageToDelete !== null && (\r\n\t\t\t\t<Modal\r\n\t\t\t\t\tshow={showModal}\r\n\t\t\t\t\tsetShow={() => setMessageToDelete(null)}\r\n\t\t\t\t\t// onClose={() => {}}\r\n\t\t\t\t>\r\n\t\t\t\t\t<div className='confirm-message-delete'>\r\n\t\t\t\t\t\t<h2>Delete message</h2>\r\n\t\t\t\t\t\t<p>Do you really want to delete this message?</p>\r\n\r\n\t\t\t\t\t\t<p>Message to delete: </p>\r\n\t\t\t\t\t\t<div className='message-to-delete custom-scrollbar'>\r\n\t\t\t\t\t\t\t{messageToDelete.content && <span>\"{messageToDelete.content}\"</span>}\r\n\t\t\t\t\t\t\t{messageToDelete.image && <img src={messageToDelete.image} alt='' />}\r\n\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t<div className='vertical-btns'>\r\n\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\tclassName='btn btn--secondary'\r\n\t\t\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\t\t\tsetMessageToDelete(null)\r\n\t\t\t\t\t\t\t\t}}>\r\n\t\t\t\t\t\t\t\tCancel\r\n\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t<button className='btn' onClick={() => deleteMessage(messageToDelete)}>\r\n\t\t\t\t\t\t\t\tDelete\r\n\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</Modal>\r\n\t\t\t)}\r\n\t\t</ul>\r\n\t)\r\n}\r\n\r\nexport default Messages\r\n","import React, { useEffect, useRef, useState } from 'react'\r\nimport { timestamp, projectStorage } from '../../../firebase/config'\r\nimport { useAuthContext } from '../../../hooks/useAuthContext'\r\nimport { useFirestore } from '../../../hooks/useFirestore'\r\nimport { v4 as uuid } from 'uuid'\r\nimport { getDownloadURL, ref, uploadBytes } from 'firebase/storage'\r\nimport { useCollection } from '../../../hooks/useCollection'\r\nimport EmojiPicker, { Emoji, EmojiStyle, Theme } from 'emoji-picker-react'\r\nimport OutsideClickHandler from 'react-outside-click-handler'\r\nimport imageCompression from 'browser-image-compression'\r\n// import Cryptr from 'cryptr'\r\n\r\n// Styles && Assets\r\nimport './MessageField.scss'\r\n\r\nconst MessageField = ({ chat, messageResponse, onMessageResponse, bottomDiv, inputRef, otherUser, currentUser }) => {\r\n\t// const cryptr = new Cryptr('myTotallySecretKey', { pbkdf2Iterations: 10000, saltLength: 10 })\r\n\r\n\tconst uniqueId = uuid()\r\n\r\n\tconst { updateDocument, response } = useFirestore('projects')\r\n\tconst { documents: users } = useCollection('users')\r\n\tconst { user } = useAuthContext()\r\n\r\n\tconst [newComment, setNewComment] = useState('')\r\n\tconst [imgUpload, setImgUpload] = useState(null)\r\n\tconst [isAssignedUser, setIsAssignedUser] = useState(false)\r\n\tconst [fastEmoji, setFastEmoji] = useState(chat.chatEmoji)\r\n\tconst [sendFastEmoji, setSendFastEmoji] = useState(false)\r\n\tconst [showEmojis, setShowEmojis] = useState(false)\r\n\tconst [seen, setSeen] = useState(false)\r\n\tconst fileInputRef = useRef(null)\r\n\r\n\tuseEffect(() => {\r\n\t\tinputRef.current.focus()\r\n\t}, [messageResponse])\r\n\r\n\tuseEffect(() => {\r\n\t\tchat.assignedUsersId.forEach(id => {\r\n\t\t\tif (id === user.uid) setIsAssignedUser(true)\r\n\t\t})\r\n\t}, [setIsAssignedUser, chat.assignedUsersId, user.uid])\r\n\r\n\tconst scrollToBottom = () => {\r\n\t\tbottomDiv.current.scrollIntoView({\r\n\t\t\tblock: 'end',\r\n\t\t})\r\n\t}\r\n\r\n\tconst sendMessage = async () => {\r\n\t\t// let encryptedMessage\r\n\t\t// encryptedMessage = cryptr.encrypt(sendFastEmoji ? fastEmoji : newComment)\r\n\r\n\t\tconst commentToAdd = {\r\n\t\t\tid: uniqueId,\r\n\t\t\tcontent: sendFastEmoji ? fastEmoji : newComment,\r\n\t\t\tcreatedAt: timestamp.fromDate(new Date()),\r\n\t\t\tcreatedBy: user.uid,\r\n\t\t\tresponse: messageResponse !== null ? messageResponse : null,\r\n\t\t}\r\n\r\n\t\tif (commentToAdd.content.trim() !== '' && newComment.length < 900 && isAssignedUser) {\r\n\t\t\tawait updateDocument(chat.id, {\r\n\t\t\t\tmessages: [...chat.messages, commentToAdd],\r\n\t\t\t\tupdatedAt: timestamp.fromDate(new Date()),\r\n\t\t\t})\r\n\t\t\tif (!response.error) {\r\n\t\t\t\tsetSeen(!seen)\r\n\t\t\t\tscrollToBottom()\r\n\t\t\t\tsetNewComment('')\r\n\t\t\t\tsetSendFastEmoji(false)\r\n\t\t\t\tonMessageResponse(null)\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tuseEffect(() => {\r\n\t\tif (document.messages && document.messages.length > 0) {\r\n\t\t\tupdateDocument(chat.id, {\r\n\t\t\t\tisRead: true,\r\n\t\t\t\tassignedUsers: [\r\n\t\t\t\t\totherUser,\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tid: currentUser.id,\r\n\t\t\t\t\t\tnickname: currentUser.nickname,\r\n\t\t\t\t\t\tlastRead: chat.messages[chat.messages.length - 1].id,\r\n\t\t\t\t\t},\r\n\t\t\t\t],\r\n\t\t\t})\r\n\t\t}\r\n\t}, [seen])\r\n\r\n\tconst sendImage = async () => {\r\n\t\tconst acceptedFileTypes = ['image', 'video']\r\n\r\n\t\tif (acceptedFileTypes.includes(imgUpload.type.split('/')[0])) {\r\n\t\t\tconst storageRef = ref(\r\n\t\t\t\tprojectStorage,\r\n\t\t\t\t`imgs/${chat.assignedUsersId[0] + chat.assignedUsersId[1]}/${uuid() + imgUpload.name}`\r\n\t\t\t)\r\n\t\t\tconst uploadTask = uploadBytes(storageRef, imgUpload)\r\n\r\n\t\t\tuploadTask.then(snapshot => {\r\n\t\t\t\tgetDownloadURL(snapshot.ref).then(async downloadURL => {\r\n\t\t\t\t\tconst commentToAdd = {\r\n\t\t\t\t\t\tid: uniqueId,\r\n\t\t\t\t\t\t// content: newComment,\r\n\t\t\t\t\t\tfileType: imgUpload.type.includes('image/') ? 'image' : 'video',\r\n\t\t\t\t\t\timage: downloadURL,\r\n\t\t\t\t\t\tcreatedAt: timestamp.fromDate(new Date()),\r\n\t\t\t\t\t\tcreatedBy: user.uid,\r\n\t\t\t\t\t\tresponse: messageResponse !== null ? messageResponse : null,\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif (isAssignedUser) {\r\n\t\t\t\t\t\tawait updateDocument(chat.id, {\r\n\t\t\t\t\t\t\tmessages: [...chat.messages, commentToAdd],\r\n\t\t\t\t\t\t\tupdatedAt: timestamp.fromDate(new Date()),\r\n\t\t\t\t\t\t\tisRead: false,\r\n\t\t\t\t\t\t})\r\n\r\n\t\t\t\t\t\tif (!response.error) {\r\n\t\t\t\t\t\t\tsetSeen(!seen)\r\n\t\t\t\t\t\t\tscrollToBottom()\r\n\t\t\t\t\t\t\tsetImgUpload(null)\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t})\r\n\t\t}\r\n\t}\r\n\r\n\tconst handleImageUpload = async e => {\r\n\t\tconst imageFile = e.target.files[0]\r\n\r\n\t\tconst options = {\r\n\t\t\tmaxSizeMB: 1,\r\n\t\t\tmaxWidthOrHeight: 1920,\r\n\t\t\tuseWebWorker: true,\r\n\t\t}\r\n\t\ttry {\r\n\t\t\tconst compressedFile = await imageCompression(imageFile, options)\r\n\t\t\tawait setImgUpload(compressedFile)\r\n\t\t} catch (error) {\r\n\t\t\tconsole.log(error)\r\n\t\t}\r\n\t}\r\n\r\n\tconst handleSubmit = e => {\r\n\t\te.preventDefault()\r\n\r\n\t\tif (imgUpload) {\r\n\t\t\tsendImage()\r\n\t\t} else {\r\n\t\t\tsendMessage()\r\n\t\t}\r\n\t}\r\n\r\n\tconst getDoc = id => {\r\n\t\tlet res = null\r\n\r\n\t\tif (users) {\r\n\t\t\tres = users.filter(doc => {\r\n\t\t\t\tif (doc.id === id) {\r\n\t\t\t\t\treturn true\r\n\t\t\t\t}\r\n\t\t\t\treturn false\r\n\t\t\t})[0]\r\n\t\t}\r\n\r\n\t\treturn res\r\n\t}\r\n\r\n\tconst handleKey = e => {\r\n\t\te.code === 'Enter' && handleSubmit(e)\r\n\t}\r\n\r\n\tconst [fileThumbnail, setFileThumbnail] = useState('')\r\n\r\n\tconst handleFileChange = e => {\r\n\t\thandleImageUpload(e)\r\n\t\tsetFileThumbnail(URL.createObjectURL(e.target.files[0]))\r\n\t}\r\n\r\n\tconst resetFileInput = e => {\r\n\t\te.preventDefault()\r\n\t\tfileInputRef.current.value = ''\r\n\t\tsetImgUpload(null)\r\n\t}\r\n\r\n\tconst handleEmojis = e => {\r\n\t\tsetNewComment(newComment => newComment + e.emoji)\r\n\t}\r\n\r\n\treturn (\r\n\t\tchat && (\r\n\t\t\t<form onSubmit={handleSubmit}>\r\n\t\t\t\t{messageResponse !== null && (\r\n\t\t\t\t\t<div className='response'>\r\n\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t<p className='response__to'>\r\n\t\t\t\t\t\t\t\tResponding to{' '}\r\n\t\t\t\t\t\t\t\t<span>\r\n\t\t\t\t\t\t\t\t\t{/* //! */}\r\n\t\t\t\t\t\t\t\t\t{getDoc(chat.messages[messageResponse].createdBy).displayName === user.displayName ? (\r\n\t\t\t\t\t\t\t\t\t\t'yourself'\r\n\t\t\t\t\t\t\t\t\t) : (\r\n\t\t\t\t\t\t\t\t\t\t<b>{chat.messages[messageResponse].displayName}</b>\r\n\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t</p>\r\n\t\t\t\t\t\t\t<p className='response__content'>\r\n\t\t\t\t\t\t\t\t{chat.messages[messageResponse].content && (\r\n\t\t\t\t\t\t\t\t\t<>\r\n\t\t\t\t\t\t\t\t\t\t{chat.messages[messageResponse].content.substring(0, 70)}\r\n\t\t\t\t\t\t\t\t\t\t{chat.messages[messageResponse].content.length > 70 ? <span>...</span> : ''}\r\n\t\t\t\t\t\t\t\t\t</>\r\n\t\t\t\t\t\t\t\t)}\r\n\r\n\t\t\t\t\t\t\t\t{chat.messages[messageResponse].image && chat.messages[messageResponse].fileType === 'image'\r\n\t\t\t\t\t\t\t\t\t? 'Image'\r\n\t\t\t\t\t\t\t\t\t: ''}\r\n\t\t\t\t\t\t\t\t{chat.messages[messageResponse].image && chat.messages[messageResponse].fileType === 'video'\r\n\t\t\t\t\t\t\t\t\t? 'Video'\r\n\t\t\t\t\t\t\t\t\t: ''}\r\n\t\t\t\t\t\t\t</p>\r\n\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t<div className='response__close-btn' onClick={() => onMessageResponse(null)}>\r\n\t\t\t\t\t\t\t<i className='fa-solid fa-xmark'></i>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t)}\r\n\r\n\t\t\t\t<div className='add-comment'>\r\n\t\t\t\t\t<label className='attach-image'>\r\n\t\t\t\t\t\t<input ref={fileInputRef} type='file' accept='video/*, image/*' onChange={e => handleFileChange(e)} />\r\n\t\t\t\t\t\t<i className='fa-regular fa-image'></i>\r\n\t\t\t\t\t</label>\r\n\r\n\t\t\t\t\t<div className='message-field'>\r\n\t\t\t\t\t\t<div className='column'>\r\n\t\t\t\t\t\t\t{imgUpload && (\r\n\t\t\t\t\t\t\t\t<div className='thumbnails'>\r\n\t\t\t\t\t\t\t\t\t<div className='file-thumbnail'>\r\n\t\t\t\t\t\t\t\t\t\t<img src={fileThumbnail} alt='' />\r\n\t\t\t\t\t\t\t\t\t\t<button className='remove-img' onClick={e => resetFileInput(e)}>\r\n\t\t\t\t\t\t\t\t\t\t\t<i className='fa-solid fa-xmark close-btn'></i>\r\n\t\t\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t<label>\r\n\t\t\t\t\t\t\t\t<input\r\n\t\t\t\t\t\t\t\t\tmaxLength='900'\r\n\t\t\t\t\t\t\t\t\tplaceholder='Aa'\r\n\t\t\t\t\t\t\t\t\tonChange={e => setNewComment(e.target.value)}\r\n\t\t\t\t\t\t\t\t\tvalue={newComment}\r\n\t\t\t\t\t\t\t\t\tonKeyDown={e => handleKey(e)}\r\n\t\t\t\t\t\t\t\t\tref={inputRef}\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t</label>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\tclassName='toggle-emoji-picker'\r\n\t\t\t\t\t\t\tonClick={e => {\r\n\t\t\t\t\t\t\t\te.preventDefault()\r\n\t\t\t\t\t\t\t\tsetShowEmojis(!showEmojis)\r\n\t\t\t\t\t\t\t}}>\r\n\t\t\t\t\t\t\t<i className='fa-regular fa-face-smile'></i>\r\n\t\t\t\t\t\t</button>\r\n\r\n\t\t\t\t\t\t{showEmojis && (\r\n\t\t\t\t\t\t\t<OutsideClickHandler\r\n\t\t\t\t\t\t\t\tonOutsideClick={() => {\r\n\t\t\t\t\t\t\t\t\tsetShowEmojis(false)\r\n\t\t\t\t\t\t\t\t}}>\r\n\t\t\t\t\t\t\t\t<EmojiPicker\r\n\t\t\t\t\t\t\t\t\tclassName='emoji-picker'\r\n\t\t\t\t\t\t\t\t\tonEmojiClick={e => {\r\n\t\t\t\t\t\t\t\t\t\thandleEmojis(e)\r\n\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\ttheme={Theme.DARK}\r\n\t\t\t\t\t\t\t\t\tpreviewConfig={{\r\n\t\t\t\t\t\t\t\t\t\tdefaultCaption: '',\r\n\t\t\t\t\t\t\t\t\t\tdefaultEmoji: null,\r\n\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t// lazyLoadEmojis={true}\r\n\t\t\t\t\t\t\t\t\temojiStyle={EmojiStyle.NATIVE}\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t</OutsideClickHandler>\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t{!imgUpload && newComment.trim() === '' && (\r\n\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\tclassName='input-tool'\r\n\t\t\t\t\t\t\tonClick={e => {\r\n\t\t\t\t\t\t\t\tsetFastEmoji(e.target.innerText)\r\n\t\t\t\t\t\t\t\tsetSendFastEmoji(true)\r\n\t\t\t\t\t\t\t\t// sendMessage()\r\n\t\t\t\t\t\t\t}}>\r\n\t\t\t\t\t\t\t{chat.chatEmoji && <Emoji unified={chat.chatEmoji} emojiStyle={EmojiStyle.NATIVE} size={33} />}\r\n\t\t\t\t\t\t</button>\r\n\t\t\t\t\t)}\r\n\r\n\t\t\t\t\t{(newComment.trim() !== '' || imgUpload) && (\r\n\t\t\t\t\t\t<button type='submit' className='input-tool'>\r\n\t\t\t\t\t\t\t<i className='fa-solid fa-paper-plane'></i>\r\n\t\t\t\t\t\t</button>\r\n\t\t\t\t\t)}\r\n\t\t\t\t</div>\r\n\t\t\t\t{newComment.length >= 900 && <p className='error'>Message can't be longer than 900 characters</p>}\r\n\t\t\t</form>\r\n\t\t)\r\n\t)\r\n}\r\n\r\nexport default MessageField\r\n","export default __webpack_public_path__ + \"static/media/british-person.a8ef58d2.jpg\";","// Components\r\nimport Avatar from '../Avatar/Avatar'\r\n\r\n// Styles && Assets\r\nimport britImg from '../../assets/british-person.jpg'\r\nimport Modal from '../Modal/Modal'\r\n\r\nconst ThemePreview = ({\r\n\totherUserMessage,\r\n\tcurUserMessage,\r\n\tbgDark,\r\n\tborderRadius,\r\n\ttextColors,\r\n\tinputColors,\r\n\tconfirmCustomTheme,\r\n\tsetConfirmCustomTheme,\r\n\tsubmitCustomTheme,\r\n\teditedTheme,\r\n\tsetShowThemePicker,\r\n\tsetShowThemeCreator,\r\n\tbuttonColor,\r\n\tname,\r\n}) => {\r\n\tconst spreadColors = () => {\r\n\t\tlet colors = null\r\n\r\n\t\tcurUserMessage.bg.forEach(color => {\r\n\t\t\tcolors === null ? (colors = `${color.value}`) : (colors = `${colors}, ${color.value}`)\r\n\t\t})\r\n\r\n\t\tif (curUserMessage.bg.length === 1) {\r\n\t\t\treturn `linear-gradient(${colors}, ${colors})`\r\n\t\t} else {\r\n\t\t\treturn `linear-gradient(${colors})`\r\n\t\t}\r\n\t}\r\n\r\n\tconst messageStyles = {\r\n\t\tbackgroundColor: otherUserMessage.bg,\r\n\t\tcolor: otherUserMessage.text,\r\n\t\tborder: `1px solid ${otherUserMessage.border}`,\r\n\t}\r\n\r\n\tconst messageOwnerStyles = {\r\n\t\tbackgroundImage: `${spreadColors()}`,\r\n\t\tbackgroundAttachment: 'fixed',\r\n\t\tbackgroundPosition: 'center 100%',\r\n\t\tbackgroundSize: 'auto 35%',\r\n\t\tborderRadius: '25px',\r\n\t\tborder: `1px solid ${curUserMessage.border}`,\r\n\t\tcolor: curUserMessage.text,\r\n\t}\r\n\r\n\treturn (\r\n\t\t<div className='theme-creator__preview'>\r\n\t\t\t<div className='chat-preview' style={{ backgroundColor: bgDark.value, borderRadius: `${borderRadius.value}px` }}>\r\n\t\t\t\t<div className='chat-preview__top-bar'>\r\n\t\t\t\t\t<div className='chat-preview__top-bar__user'>\r\n\t\t\t\t\t\t<Avatar src={britImg} />\r\n\t\t\t\t\t\t<span style={{ color: textColors.primary }}>John Doe</span>\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t<i className='fa-solid fa-ellipsis-vertical' style={{ color: textColors.accent }}></i>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div className='chat-preview__messages'>\r\n\t\t\t\t\t<div className='message owner' style={{ ...messageOwnerStyles, borderRadius: '25px 25px 5px 25px' }}>\r\n\t\t\t\t\t\tHello mate\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div className='message owner' style={{ ...messageOwnerStyles, borderRadius: '25px 5px 25px 25px' }}>\r\n\t\t\t\t\t\tit's tuesday init?\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t<div className='centered' style={{ color: textColors.lowContrast }}>\r\n\t\t\t\t\t\tSet quick emoji to \r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t<div className='message' style={{ ...messageStyles, borderRadius: '25px 25px 25px 5px' }}>\r\n\t\t\t\t\t\toh yes yes\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t<div className='message' style={{ ...messageStyles, borderRadius: '5px 25px 25px 5px' }}>\r\n\t\t\t\t\t\twhat a lovely weather we have today\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t<div className='message' style={{ ...messageStyles, borderRadius: '5px 25px 25px 25px' }}>\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t<br />\r\n\r\n\t\t\t\t\t<div className='message owner' style={{ ...messageOwnerStyles, borderRadius: '25px 25px 25px 25px' }}>\r\n\t\t\t\t\t\t*sips tea *\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div className='flex-row'>\r\n\t\t\t\t\t<i className='fa-regular fa-image' style={{ color: textColors.accent }}></i>\r\n\t\t\t\t\t<div\r\n\t\t\t\t\t\tclassName='chat-preview__input'\r\n\t\t\t\t\t\tstyle={{\r\n\t\t\t\t\t\t\tbackgroundColor: inputColors.bg,\r\n\t\t\t\t\t\t\tcolor: inputColors.text,\r\n\t\t\t\t\t\t\tborder: `1px solid ${inputColors.border}`,\r\n\t\t\t\t\t\t}}>\r\n\t\t\t\t\t\t<span>I love tea </span>\r\n\r\n\t\t\t\t\t\t<i className='fa-regular fa-face-smile' style={{ color: textColors.accent }}></i>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div className='chat-preview__quick-emoji'></div>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\r\n\t\t\t<Modal show={confirmCustomTheme} setShow={() => setConfirmCustomTheme(false)}>\r\n\t\t\t\t<h3>Are you sure you want to proceed?</h3>\r\n\t\t\t\t<div className='btn-group'>\r\n\t\t\t\t\t<div className='btn btn--secondary' onClick={() => setConfirmCustomTheme(false)}>\r\n\t\t\t\t\t\tgo back\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div className='btn' onClick={() => submitCustomTheme()}>\r\n\t\t\t\t\t\t{editedTheme !== null ? 'edit' : 'create'} theme\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t</Modal>\r\n\r\n\t\t\t<div className='btn-group'>\r\n\t\t\t\t<button\r\n\t\t\t\t\tclassName='btn btn--secondary'\r\n\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\tsetShowThemeCreator(false)\r\n\t\t\t\t\t\tsetShowThemePicker(true)\r\n\t\t\t\t\t}}\r\n\t\t\t\t\tstyle={{\r\n\t\t\t\t\t\tcolor: textColors.accent,\r\n\t\t\t\t\t\tborder: `1px solid ${textColors.accent}`,\r\n\t\t\t\t\t\tborderRadius: `${borderRadius.value}px`,\r\n\t\t\t\t\t}}>\r\n\t\t\t\t\tcancel\r\n\t\t\t\t</button>\r\n\r\n\t\t\t\t{name.length > 0 && (\r\n\t\t\t\t\t<button\r\n\t\t\t\t\t\ttype='submit'\r\n\t\t\t\t\t\tclassName='btn'\r\n\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\tsetConfirmCustomTheme(true)\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t\tstyle={{\r\n\t\t\t\t\t\t\tcolor: buttonColor.value,\r\n\t\t\t\t\t\t\tborderRadius: `${borderRadius.value}px`,\r\n\t\t\t\t\t\t\tborder: `1px solid ${textColors.accent}`,\r\n\t\t\t\t\t\t\tbackgroundColor: textColors.accent,\r\n\t\t\t\t\t\t}}>\r\n\t\t\t\t\t\t{editedTheme !== null ? 'edit' : 'create'}\r\n\t\t\t\t\t</button>\r\n\t\t\t\t)}\r\n\r\n\t\t\t\t{name.length <= 0 && (\r\n\t\t\t\t\t<button\r\n\t\t\t\t\t\tclassName='btn'\r\n\t\t\t\t\t\tdisabled\r\n\t\t\t\t\t\tstyle={{\r\n\t\t\t\t\t\t\tcolor: buttonColor.value,\r\n\t\t\t\t\t\t\tborderRadius: `${borderRadius.value}px`,\r\n\t\t\t\t\t\t\tborder: `1px solid ${textColors.accent}`,\r\n\t\t\t\t\t\t\tbackgroundColor: textColors.accent,\r\n\t\t\t\t\t\t}}>\r\n\t\t\t\t\t\t{editedTheme !== null ? 'edit' : 'create'}\r\n\t\t\t\t\t</button>\r\n\t\t\t\t)}\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t)\r\n}\r\n\r\nexport default ThemePreview\r\n","const Field = ({ title, setShow, show, children }) => {\r\n\treturn (\r\n\t\t<div className='field'>\r\n\t\t\t<p\r\n\t\t\t\tonClick={() => {\r\n\t\t\t\t\tsetShow()\r\n\t\t\t\t}}>\r\n\t\t\t\t<i className={`fa-solid fa-angle-right ${show ? 'active' : ''}`}></i>\r\n\t\t\t\t<span>{title}</span>\r\n\t\t\t</p>\r\n\r\n\t\t\t{show && children}\r\n\t\t</div>\r\n\t)\r\n}\r\n\r\nexport default Field\r\n","// Styles\r\nimport './ColorPicker.scss'\r\n\r\nconst ColorPicker = ({ value, setValue, separator, children }) => {\r\n\treturn (\r\n\t\t<>\r\n\t\t\t{separator && (\r\n\t\t\t\t<div className='separator'>\r\n\t\t\t\t\t<span>{separator}</span>\r\n\t\t\t\t</div>\r\n\t\t\t)}\r\n\t\t\t<div className='color-picker'>\r\n\t\t\t\t<input\r\n\t\t\t\t\ttype='text'\r\n\t\t\t\t\tclassName='color-picker__value'\r\n\t\t\t\t\tvalue={value}\r\n\t\t\t\t\tonChange={e => {\r\n\t\t\t\t\t\tsetValue(e)\r\n\t\t\t\t\t}}\r\n\t\t\t\t/>\r\n\t\t\t\t<input\r\n\t\t\t\t\ttype='color'\r\n\t\t\t\t\tvalue={value}\r\n\t\t\t\t\tonChange={e => {\r\n\t\t\t\t\t\tsetValue(e)\r\n\t\t\t\t\t}}\r\n\t\t\t\t/>\r\n\r\n\t\t\t\t{children}\r\n\t\t\t</div>\r\n\t\t</>\r\n\t)\r\n}\r\n\r\nexport default ColorPicker\r\n","import React, { useState } from 'react'\r\nimport { useFirestore } from '../../hooks/useFirestore'\r\n\r\n// Components\r\nimport ThemePreview from './ThemePreview'\r\nimport Field from './Field.js'\r\nimport ColorPicker from '../ColorPicker/ColorPicker'\r\n\r\n// Styles && Assets\r\nimport './ThemeCreator.scss'\r\n\r\nexport default function ThemeCreator({\r\n\tsetShowThemePicker,\r\n\tsetShowThemeCreator,\r\n\tchat,\r\n\teditedTheme,\r\n\tsetConfirmCustomTheme,\r\n\tconfirmCustomTheme,\r\n}) {\r\n\tconst { updateDocument } = useFirestore('projects')\r\n\r\n\tconst [name, setName] = useState(editedTheme ? editedTheme.name : '')\r\n\tconst [bgDark, setBgDark] = useState({\r\n\t\tshow: true,\r\n\t\tvalue: editedTheme ? editedTheme.colors.bgDark : '#121212',\r\n\t})\r\n\tconst [bgSecondary, setBgSecondary] = useState({\r\n\t\tshow: false,\r\n\t\tvalue: editedTheme ? editedTheme.colors.bgSecondary : '#1e1e1e',\r\n\t})\r\n\r\n\tconst [borderRadius, setBorderRadius] = useState({\r\n\t\tshow: false,\r\n\t\tvalue: editedTheme ? editedTheme.borderRadius : 8,\r\n\t})\r\n\tconst [curUserMessage, setCurUserMessage] = useState({\r\n\t\tshow: false,\r\n\t\tbg: editedTheme\r\n\t\t\t? editedTheme.colors.msgBgOwner\r\n\t\t\t: [\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tid: 0,\r\n\t\t\t\t\t\tvalue: '#643e7a',\r\n\t\t\t\t\t},\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tid: 1,\r\n\t\t\t\t\t\tvalue: '#643e7a',\r\n\t\t\t\t\t},\r\n\t\t\t  ],\r\n\t\ttext: editedTheme ? editedTheme.colors.messageColorOwner : '#cacaca',\r\n\t\tborder: editedTheme ? editedTheme.colors.msgBorderOwner : '#252525',\r\n\t})\r\n\r\n\tconst [otherUserMessage, setOtherUserMessage] = useState({\r\n\t\tshow: false,\r\n\t\tbg: editedTheme ? editedTheme.colors.msgBg : '#1e1e1e',\r\n\t\ttext: editedTheme ? editedTheme.colors.messageColor : '#cacaca',\r\n\t\tborder: editedTheme ? editedTheme.colors.msgBorder : '#252525',\r\n\t})\r\n\r\n\tconst [inputColors, setInputColors] = useState({\r\n\t\tshow: false,\r\n\t\tbg: editedTheme ? editedTheme.colors.inputBg : '#1e1e1e',\r\n\t\ttext: editedTheme ? editedTheme.colors.inputText : '#c4c4c4',\r\n\t\tborder: editedTheme ? editedTheme.colors.inputBorder : '#1e1e1e',\r\n\t})\r\n\r\n\tconst [textColors, setTextColors] = useState({\r\n\t\tshow: false,\r\n\t\tprimary: editedTheme ? editedTheme.colors.textPrimary : '#ffffff',\r\n\t\taccent: editedTheme ? editedTheme.colors.textAccent : '#643e7a',\r\n\t\tlowContrast: editedTheme ? editedTheme.colors.textLowContrast : '#646464',\r\n\t\tbtn: editedTheme ? editedTheme.colors.btnText : '#ffffff',\r\n\t})\r\n\tconst [buttonColor, setButtonColor] = useState({\r\n\t\tshow: false,\r\n\t\tvalue: editedTheme ? editedTheme.colors.buttonColor : '#ffffff',\r\n\t})\r\n\r\n\tconst updateMessageBg = (index, e) => {\r\n\t\tlet newArr = [...curUserMessage.bg]\r\n\t\tnewArr[index] = { value: e.target.value, id: index }\r\n\t\tsetCurUserMessage({ ...curUserMessage, bg: newArr })\r\n\t}\r\n\r\n\tconst submitCustomTheme = async () => {\r\n\t\t// setDoc(doc(projectFirestore, 'themes', 'green'), {\r\n\t\t// \tid: name,\r\n\t\t// \tname: name,\r\n\t\t// \tcolors: {\r\n\t\t// \t\tbgDark: bgDark.value,\r\n\t\t// \t\tbgSecondary: bgSecondary.value,\r\n\t\t// \t\tinputBg: inputColors.bg,\r\n\t\t// \t\tinputText: inputColors.text,\r\n\t\t// \t\ttextAccent: textColors.accent,\r\n\t\t// \t\ttextLowContrast: textColors.lowContrast,\r\n\t\t// \t\tmsgBg: otherUserMessage.bg,\r\n\t\t// \t\tmessageColor: otherUserMessage.text,\r\n\t\t// \t\tmsgBgOwner: curUserMessage.bg,\r\n\t\t// \t\tmessageColorOwner: curUserMessage.text,\r\n\t\t// \t},\r\n\t\t// \tborderRadius: borderRadius.value,\r\n\t\t// })\r\n\r\n\t\tconst themeToAdd = {\r\n\t\t\tid: `${name}`,\r\n\t\t\tname: `${name}`,\r\n\t\t\tcolors: {\r\n\t\t\t\tbgDark: `${bgDark.value}`,\r\n\t\t\t\tbgSecondary: `${bgSecondary.value}`,\r\n\t\t\t\tinputBg: `${inputColors.bg}`,\r\n\t\t\t\tinputText: `${inputColors.text}`,\r\n\t\t\t\tinputBorder: `${inputColors.border}`,\r\n\t\t\t\ttextPrimary: `${textColors.primary}`,\r\n\t\t\t\ttextAccent: `${textColors.accent}`,\r\n\t\t\t\ttextLowContrast: `${textColors.lowContrast}`,\r\n\t\t\t\tmsgBg: `${otherUserMessage.bg}`,\r\n\t\t\t\tmessageColor: `${otherUserMessage.text}`,\r\n\t\t\t\tmsgBgOwner: curUserMessage.bg,\r\n\t\t\t\tmessageColorOwner: `${curUserMessage.text}`,\r\n\t\t\t\tmsgBorderOwner: `${curUserMessage.border}`,\r\n\t\t\t\tmsgBorder: `${otherUserMessage.border}`,\r\n\t\t\t\tbuttonColor: `${buttonColor.value}`,\r\n\t\t\t},\r\n\t\t\tborderRadius: borderRadius.value,\r\n\t\t\tisCustom: true,\r\n\t\t}\r\n\t\tif (editedTheme === null) {\r\n\t\t\tawait updateDocument(chat.id, {\r\n\t\t\t\tcustomThemes: [...chat.customThemes, themeToAdd],\r\n\t\t\t})\r\n\t\t\tsetConfirmCustomTheme(false)\r\n\t\t\tsetShowThemeCreator(false)\r\n\t\t}\r\n\t\tif (editedTheme !== null) {\r\n\t\t\tawait updateDocument(chat.id, {\r\n\t\t\t\tcustomThemes: updateCustomThemes(editedTheme, themeToAdd),\r\n\t\t\t\ttheme: {\r\n\t\t\t\t\tisCustom: true,\r\n\t\t\t\t\tname: name,\r\n\t\t\t\t},\r\n\t\t\t})\r\n\t\t\tsetConfirmCustomTheme(false)\r\n\t\t\tsetShowThemeCreator(false)\r\n\t\t}\r\n\t}\r\n\r\n\tconst updateCustomThemes = (editedTheme, theme) => {\r\n\t\tconst index = chat.customThemes.indexOf(editedTheme)\r\n\t\tlet newArr = [...chat.customThemes]\r\n\r\n\t\tnewArr[index] = theme\r\n\r\n\t\treturn newArr\r\n\t}\r\n\r\n\treturn (\r\n\t\t<div className='theme-creator'>\r\n\t\t\t<form className='theme-creator__form custom-scrollbar'>\r\n\t\t\t\t<div className='field'>\r\n\t\t\t\t\t<p>Name your theme</p>\r\n\r\n\t\t\t\t\t<input type='text' placeholder='Aa' required value={name} onChange={e => setName(e.target.value)} />\r\n\t\t\t\t</div>\r\n\r\n\t\t\t\t<Field\r\n\t\t\t\t\ttitle={'Background color'}\r\n\t\t\t\t\tsetShow={() => setBgDark({ ...bgDark, show: !bgDark.show })}\r\n\t\t\t\t\tshow={bgDark.show}>\r\n\t\t\t\t\t<ColorPicker\r\n\t\t\t\t\t\tvalue={bgDark.value}\r\n\t\t\t\t\t\tsetValue={e => {\r\n\t\t\t\t\t\t\tsetBgDark({ ...bgDark, value: e.target.value })\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t/>\r\n\t\t\t\t</Field>\r\n\r\n\t\t\t\t<Field\r\n\t\t\t\t\ttitle={'Secondary background color'}\r\n\t\t\t\t\tsetShow={() => setBgSecondary({ ...bgSecondary, show: !bgSecondary.show })}\r\n\t\t\t\t\tshow={bgSecondary.show}>\r\n\t\t\t\t\t<ColorPicker\r\n\t\t\t\t\t\tvalue={bgSecondary.value}\r\n\t\t\t\t\t\tsetValue={e => {\r\n\t\t\t\t\t\t\tsetBgSecondary({ ...bgSecondary, value: e.target.value })\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t/>\r\n\t\t\t\t</Field>\r\n\r\n\t\t\t\t<Field\r\n\t\t\t\t\ttitle={'Input colors'}\r\n\t\t\t\t\tsetShow={() => setInputColors({ ...inputColors, show: !inputColors.show })}\r\n\t\t\t\t\tshow={inputColors.show}>\r\n\t\t\t\t\t<ColorPicker\r\n\t\t\t\t\t\tvalue={inputColors.bg}\r\n\t\t\t\t\t\tsetValue={e => {\r\n\t\t\t\t\t\t\tsetInputColors({ ...inputColors, bg: e.target.value })\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t\tseparator={'background'}\r\n\t\t\t\t\t/>\r\n\t\t\t\t\t<ColorPicker\r\n\t\t\t\t\t\tvalue={inputColors.text}\r\n\t\t\t\t\t\tsetValue={e => {\r\n\t\t\t\t\t\t\tsetInputColors({ ...inputColors, text: e.target.value })\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t\tseparator={'text'}\r\n\t\t\t\t\t/>\r\n\t\t\t\t\t<ColorPicker\r\n\t\t\t\t\t\tvalue={inputColors.border}\r\n\t\t\t\t\t\tsetValue={e => {\r\n\t\t\t\t\t\t\tsetInputColors({ ...inputColors, border: e.target.value })\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t\tseparator={'border'}\r\n\t\t\t\t\t/>\r\n\t\t\t\t</Field>\r\n\r\n\t\t\t\t<Field\r\n\t\t\t\t\ttitle={'Button color'}\r\n\t\t\t\t\tsetShow={() => setButtonColor({ ...buttonColor, show: !buttonColor.show })}\r\n\t\t\t\t\tshow={buttonColor.show}>\r\n\t\t\t\t\t<ColorPicker\r\n\t\t\t\t\t\tvalue={buttonColor.value}\r\n\t\t\t\t\t\tsetValue={e => {\r\n\t\t\t\t\t\t\tsetButtonColor({ ...buttonColor, value: e.target.value })\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t/>\r\n\t\t\t\t</Field>\r\n\r\n\t\t\t\t<Field\r\n\t\t\t\t\ttitle={'Text colors'}\r\n\t\t\t\t\tsetShow={() => setTextColors({ ...textColors, show: !textColors.show })}\r\n\t\t\t\t\tshow={textColors.show}>\r\n\t\t\t\t\t<ColorPicker\r\n\t\t\t\t\t\tvalue={textColors.primary}\r\n\t\t\t\t\t\tsetValue={e => {\r\n\t\t\t\t\t\t\tsetTextColors({ ...textColors, primary: e.target.value })\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t\tseparator={'primary'}\r\n\t\t\t\t\t/>\r\n\t\t\t\t\t<ColorPicker\r\n\t\t\t\t\t\tvalue={textColors.accent}\r\n\t\t\t\t\t\tsetValue={e => {\r\n\t\t\t\t\t\t\tsetTextColors({ ...textColors, accent: e.target.value })\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t\tseparator={'accent'}\r\n\t\t\t\t\t/>\r\n\t\t\t\t\t<ColorPicker\r\n\t\t\t\t\t\tvalue={textColors.lowContrast}\r\n\t\t\t\t\t\tsetValue={e => {\r\n\t\t\t\t\t\t\tsetTextColors({ ...textColors, lowContrast: e.target.value })\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t\tseparator={'low contrast'}\r\n\t\t\t\t\t/>\r\n\t\t\t\t</Field>\r\n\r\n\t\t\t\t<Field\r\n\t\t\t\t\ttitle={'Other user messages'}\r\n\t\t\t\t\tsetShow={() => setOtherUserMessage({ ...otherUserMessage, show: !otherUserMessage.show })}\r\n\t\t\t\t\tshow={otherUserMessage.show}>\r\n\t\t\t\t\t<ColorPicker\r\n\t\t\t\t\t\tvalue={otherUserMessage.bg}\r\n\t\t\t\t\t\tsetValue={e => {\r\n\t\t\t\t\t\t\tsetOtherUserMessage({ ...otherUserMessage, bg: e.target.value })\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t\tseparator={'background'}\r\n\t\t\t\t\t/>\r\n\t\t\t\t\t<ColorPicker\r\n\t\t\t\t\t\tvalue={otherUserMessage.text}\r\n\t\t\t\t\t\tsetValue={e => {\r\n\t\t\t\t\t\t\tsetOtherUserMessage({ ...otherUserMessage, text: e.target.value })\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t\tseparator={'text'}\r\n\t\t\t\t\t/>\r\n\t\t\t\t\t<ColorPicker\r\n\t\t\t\t\t\tvalue={otherUserMessage.border}\r\n\t\t\t\t\t\tsetValue={e => {\r\n\t\t\t\t\t\t\tsetOtherUserMessage({ ...otherUserMessage, border: e.target.value })\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t\tseparator={'border'}\r\n\t\t\t\t\t/>\r\n\t\t\t\t</Field>\r\n\r\n\t\t\t\t<Field\r\n\t\t\t\t\ttitle={'Current user messages'}\r\n\t\t\t\t\tsetShow={() => setCurUserMessage({ ...curUserMessage, show: !curUserMessage.show })}\r\n\t\t\t\t\tshow={curUserMessage.show}>\r\n\t\t\t\t\t<div className='separator'>\r\n\t\t\t\t\t\t<span>background</span>\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t<div className='colors-list custom-scrollbar'>\r\n\t\t\t\t\t\t{curUserMessage.bg.map((color, index) => (\r\n\t\t\t\t\t\t\t<React.Fragment key={color.id}>\r\n\t\t\t\t\t\t\t\t<ColorPicker\r\n\t\t\t\t\t\t\t\t\tvalue={color.value}\r\n\t\t\t\t\t\t\t\t\tsetValue={e => {\r\n\t\t\t\t\t\t\t\t\t\tupdateMessageBg(index, e)\r\n\t\t\t\t\t\t\t\t\t}}>\r\n\t\t\t\t\t\t\t\t\t<i\r\n\t\t\t\t\t\t\t\t\t\tclassName='fa-solid fa-xmark remove-color'\r\n\t\t\t\t\t\t\t\t\t\tonClick={() =>\r\n\t\t\t\t\t\t\t\t\t\t\tsetCurUserMessage({ ...curUserMessage, bg: curUserMessage.bg.filter(c => c !== color) })\r\n\t\t\t\t\t\t\t\t\t\t}></i>\r\n\t\t\t\t\t\t\t\t</ColorPicker>\r\n\t\t\t\t\t\t\t</React.Fragment>\r\n\t\t\t\t\t\t))}\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t<div\r\n\t\t\t\t\t\tclassName='add-color'\r\n\t\t\t\t\t\tonClick={() =>\r\n\t\t\t\t\t\t\tsetCurUserMessage({\r\n\t\t\t\t\t\t\t\t...curUserMessage,\r\n\t\t\t\t\t\t\t\tbg: [...curUserMessage.bg, { value: '#643e7a', id: Math.random(0, 100) * 100 }],\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t}>\r\n\t\t\t\t\t\t<i className='fa-solid fa-plus'></i>\r\n\t\t\t\t\t\t<span>add another color</span>\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t<ColorPicker\r\n\t\t\t\t\t\tvalue={curUserMessage.text}\r\n\t\t\t\t\t\tsetValue={e => {\r\n\t\t\t\t\t\t\tsetCurUserMessage({ ...curUserMessage, text: e.target.value })\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t\tseparator={'text'}\r\n\t\t\t\t\t/>\r\n\r\n\t\t\t\t\t<ColorPicker\r\n\t\t\t\t\t\tvalue={curUserMessage.border}\r\n\t\t\t\t\t\tsetValue={e => {\r\n\t\t\t\t\t\t\tsetCurUserMessage({ ...curUserMessage, border: e.target.value })\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t\tseparator={'border'}\r\n\t\t\t\t\t/>\r\n\t\t\t\t</Field>\r\n\r\n\t\t\t\t<Field\r\n\t\t\t\t\ttitle={'Border radius'}\r\n\t\t\t\t\tsetShow={() => setBorderRadius({ ...borderRadius, show: !borderRadius.show })}\r\n\t\t\t\t\tshow={borderRadius.show}>\r\n\t\t\t\t\t<div className='flex-row'>\r\n\t\t\t\t\t\t<input\r\n\t\t\t\t\t\t\ttype='range'\r\n\t\t\t\t\t\t\tvalue={borderRadius.value}\r\n\t\t\t\t\t\t\tonChange={e => setBorderRadius({ ...borderRadius, value: e.target.value })}\r\n\t\t\t\t\t\t\tmin='0'\r\n\t\t\t\t\t\t\tmax='25'\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t<span>{borderRadius.value}px</span>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</Field>\r\n\t\t\t</form>\r\n\r\n\t\t\t<ThemePreview\r\n\t\t\t\totherUserMessage={otherUserMessage}\r\n\t\t\t\tcurUserMessage={curUserMessage}\r\n\t\t\t\tbgDark={bgDark}\r\n\t\t\t\tborderRadius={borderRadius}\r\n\t\t\t\ttextColors={textColors}\r\n\t\t\t\tinputColors={inputColors}\r\n\t\t\t\tconfirmCustomTheme={confirmCustomTheme}\r\n\t\t\t\tsetConfirmCustomTheme={setConfirmCustomTheme}\r\n\t\t\t\tsubmitCustomTheme={submitCustomTheme}\r\n\t\t\t\teditedTheme={editedTheme}\r\n\t\t\t\tsetShowThemeCreator={setShowThemeCreator}\r\n\t\t\t\tsetShowThemePicker={setShowThemePicker}\r\n\t\t\t\tname={name}\r\n\t\t\t\tbuttonColor={buttonColor}\r\n\t\t\t/>\r\n\t\t</div>\r\n\t)\r\n}\r\n","import { useFirestore } from '../../hooks/useFirestore'\r\nimport Modal from '../Modal/Modal'\r\n\r\n// Styles\r\nimport './ThemePicker.scss'\r\n\r\nconst ThemePicker = ({\r\n\tthemes,\r\n\tchat,\r\n\tsetShowThemeCreator,\r\n\tsetEditedTheme,\r\n\tsetConfirmThemeDelete,\r\n\tconfirmThemeDelete,\r\n}) => {\r\n\tconst { updateDocument } = useFirestore('projects')\r\n\r\n\tconst changeTheme = async theme => {\r\n\t\ttry {\r\n\t\t\tawait updateDocument(chat.id, {\r\n\t\t\t\ttheme: {\r\n\t\t\t\t\tname: theme.id,\r\n\t\t\t\t\tisCustom: theme.isCustom ? theme.isCustom : false,\r\n\t\t\t\t},\r\n\t\t\t})\r\n\t\t} catch (err) {\r\n\t\t\tconsole.log(err)\r\n\t\t}\r\n\t}\r\n\r\n\tconst spreadColors = theme => {\r\n\t\tlet colors = null\r\n\r\n\t\ttheme.colors.msgBgOwner.forEach(color => {\r\n\t\t\tcolors === null ? (colors = `${color.value}`) : (colors = `${colors}, ${color.value}`)\r\n\t\t})\r\n\r\n\t\tif (theme.colors.msgBgOwner.length === 1) {\r\n\t\t\treturn `linear-gradient(${colors}, ${colors})`\r\n\t\t} else {\r\n\t\t\treturn `linear-gradient(${colors})`\r\n\t\t}\r\n\t}\r\n\r\n\tconst removeCustomTheme = async theme => {\r\n\t\ttry {\r\n\t\t\tif (chat.theme && chat.theme.name === theme.id) {\r\n\t\t\t\tchangeTheme({ id: 'frosty', isCustom: false })\r\n\t\t\t}\r\n\t\t\tawait updateDocument(chat.id, {\r\n\t\t\t\tcustomThemes: [...chat.customThemes.filter(t => t !== theme)],\r\n\t\t\t})\r\n\t\t\tsetConfirmThemeDelete(null)\r\n\t\t} catch (err) {\r\n\t\t\tconsole.log(err)\r\n\t\t}\r\n\t}\r\n\r\n\tconst editCustomTheme = theme => {\r\n\t\tsetShowThemeCreator(true)\r\n\t\tsetEditedTheme(theme)\r\n\t}\r\n\r\n\treturn (\r\n\t\t<div className='theme-picker'>\r\n\t\t\t<div className='theme-picker__themes'>\r\n\t\t\t\t{themes &&\r\n\t\t\t\t\tchat &&\r\n\t\t\t\t\tthemes.map(theme => (\r\n\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\tclassName={`theme-picker__themes__theme ${\r\n\t\t\t\t\t\t\t\tchat.theme && theme.id === chat.theme.name && !theme.isCustom ? 'current' : ''\r\n\t\t\t\t\t\t\t}`}\r\n\t\t\t\t\t\t\tkey={theme.id}\r\n\t\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\t\tchangeTheme(theme)\r\n\t\t\t\t\t\t\t}}>\r\n\t\t\t\t\t\t\t<i\r\n\t\t\t\t\t\t\t\tclassName='fa-solid fa-check theme-tick'\r\n\t\t\t\t\t\t\t\tstyle={{\r\n\t\t\t\t\t\t\t\t\tbackgroundImage: spreadColors(theme),\r\n\t\t\t\t\t\t\t\t}}></i>\r\n\r\n\t\t\t\t\t\t\t<div className='theme-bg' style={{ background: spreadColors(theme) }}></div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t))}\r\n\t\t\t</div>\r\n\t\t\t<div className='separator'>\r\n\t\t\t\t<span>create your own theme</span>\r\n\t\t\t</div>\r\n\r\n\t\t\t<div className='theme-picker__themes'>\r\n\t\t\t\t{chat.customThemes.length > 0 &&\r\n\t\t\t\t\tchat.customThemes.map(theme => (\r\n\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\tkey={theme.id}\r\n\t\t\t\t\t\t\tclassName={`theme-picker__themes__theme ${\r\n\t\t\t\t\t\t\t\tchat.theme && theme.id === chat.theme.name && theme.isCustom === chat.theme.isCustom ? 'current' : ''\r\n\t\t\t\t\t\t\t}`}\r\n\t\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\t\tchangeTheme(theme)\r\n\t\t\t\t\t\t\t}}>\r\n\t\t\t\t\t\t\t<i\r\n\t\t\t\t\t\t\t\tclassName='fa-solid fa-check theme-tick'\r\n\t\t\t\t\t\t\t\tstyle={{\r\n\t\t\t\t\t\t\t\t\tbackgroundImage: `${spreadColors(theme)}`,\r\n\t\t\t\t\t\t\t\t}}></i>\r\n\t\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\t\tclassName='theme-bg'\r\n\t\t\t\t\t\t\t\tstyle={{\r\n\t\t\t\t\t\t\t\t\tbackground: spreadColors(theme),\r\n\t\t\t\t\t\t\t\t}}>\r\n\t\t\t\t\t\t\t\t<div className='theme-tools'>\r\n\t\t\t\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\t\t\t\tclassName='theme-tools__edit'\r\n\t\t\t\t\t\t\t\t\t\tonClick={e => {\r\n\t\t\t\t\t\t\t\t\t\t\te.stopPropagation()\r\n\t\t\t\t\t\t\t\t\t\t\teditCustomTheme(theme)\r\n\t\t\t\t\t\t\t\t\t\t}}>\r\n\t\t\t\t\t\t\t\t\t\t<i className='fa-solid fa-pen'></i>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\t\t\t\tclassName='theme-tools__remove'\r\n\t\t\t\t\t\t\t\t\t\tonClick={e => {\r\n\t\t\t\t\t\t\t\t\t\t\te.stopPropagation()\r\n\t\t\t\t\t\t\t\t\t\t\t// removeCustomTheme(theme)\r\n\t\t\t\t\t\t\t\t\t\t\tsetConfirmThemeDelete(theme)\r\n\t\t\t\t\t\t\t\t\t\t}}>\r\n\t\t\t\t\t\t\t\t\t\t<i className='fa-solid fa-trash-can'></i>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t))}\r\n\r\n\t\t\t\t{chat.customThemes.length < 3 && (\r\n\t\t\t\t\t<button\r\n\t\t\t\t\t\tclassName='create-theme'\r\n\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\tsetShowThemeCreator(true)\r\n\t\t\t\t\t\t\t// setShowThemePicker(false)\r\n\t\t\t\t\t\t}}>\r\n\t\t\t\t\t\t<i className='fa-solid fa-plus'></i>\r\n\t\t\t\t\t</button>\r\n\t\t\t\t)}\r\n\r\n\t\t\t\t<Modal show={confirmThemeDelete !== null} setShow={() => setConfirmThemeDelete(null)}>\r\n\t\t\t\t\t<h3>Are you sure you want to proceed?</h3>\r\n\t\t\t\t\t<div className='btn-group'>\r\n\t\t\t\t\t\t<div className='btn btn--50 btn--secondary' onClick={() => setConfirmThemeDelete(null)}>\r\n\t\t\t\t\t\t\tgo back\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<div className='btn btn--50' onClick={() => removeCustomTheme(confirmThemeDelete)}>\r\n\t\t\t\t\t\t\tdelete theme\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</Modal>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t)\r\n}\r\n\r\nexport default ThemePicker\r\n","import { useEffect, useState } from 'react'\r\nimport { useFirestore } from '../../../hooks/useFirestore'\r\nimport { timestamp } from '../../../firebase/config'\r\nimport { useCollection } from '../../../hooks/useCollection'\r\nimport { v4 as uuid } from 'uuid'\r\nimport { useDocument } from '../../../hooks/useDocument'\r\n\r\n// Components\r\nimport OutsideClickHandler from 'react-outside-click-handler'\r\nimport EmojiPicker, { EmojiStyle, Theme } from 'emoji-picker-react'\r\nimport Modal from '../../../components/Modal/Modal'\r\nimport Avatar from '../../../components/Avatar/Avatar'\r\nimport ThemeCreator from '../../../components/ThemeCreator/ThemeCreator'\r\nimport ThemePicker from '../../../components/ThemePicker/ThemePicker'\r\n\r\n// Styles && Assets\r\nimport './ChatOptions.scss'\r\nimport AvatarWithStatus from '../../../components/AvatarWithStatus/AvatarWithStatus'\r\nimport MediaQuery from 'react-responsive'\r\n\r\nexport default function ChatOptions({\r\n\tonMessageResponse,\r\n\totherUser,\r\n\tchat,\r\n\tcurrentTheme,\r\n\totherUserLocal,\r\n\tsetShowChatOptions,\r\n}) {\r\n\tconst uniqueId = uuid()\r\n\r\n\tconst { updateDocument, response } = useFirestore('projects')\r\n\tconst { documents: themes } = useCollection('themes')\r\n\tconst { document: defaultThemeDoc } = useDocument('themes', 'frosty')\r\n\tconst { documents: users } = useCollection('users')\r\n\r\n\tconst [showEmojiPicker, setShowEmojiPicker] = useState(false)\r\n\tconst [showNicknameModal, setShowNicknameModal] = useState(false)\r\n\tconst [showNicknameInput, setShowNicknameInput] = useState(null)\r\n\tconst [newNickname, setNewNickname] = useState('')\r\n\tconst [showThemePicker, setShowThemePicker] = useState(false)\r\n\tconst [showThemeCreator, setShowThemeCreator] = useState(false)\r\n\tconst [editedTheme, setEditedTheme] = useState(defaultThemeDoc)\r\n\tconst [confirmCustomTheme, setConfirmCustomTheme] = useState(false)\r\n\tconst [confirmThemeDelete, setConfirmThemeDelete] = useState(null)\r\n\r\n\tuseEffect(() => {\r\n\t\tsetShowThemeCreator(false)\r\n\t\tsetShowNicknameModal(false)\r\n\t}, [chat.id])\r\n\r\n\tconst sendMessage = async content => {\r\n\t\tconst commentToAdd = {\r\n\t\t\tid: uniqueId,\r\n\t\t\tcontent: content,\r\n\t\t\tcreatedAt: timestamp.fromDate(new Date()),\r\n\t\t\tisSpecial: true,\r\n\t\t}\r\n\r\n\t\tawait updateDocument(chat.id, {\r\n\t\t\tmessages: [...chat.messages, commentToAdd],\r\n\t\t})\r\n\t\tif (!response.error) {\r\n\t\t\tonMessageResponse(null)\r\n\t\t}\r\n\t}\r\n\r\n\tconst changeChatEmoji = async e => {\r\n\t\tawait updateDocument(chat.id, {\r\n\t\t\tchatEmoji: e.unified,\r\n\t\t})\r\n\t\tif (!response.error) {\r\n\t\t\tsendMessage(`Set quick emoji to ${e.emoji}`)\r\n\t\t}\r\n\t}\r\n\r\n\tconst handleNicknameInput = u => {\r\n\t\tsetShowNicknameInput(u.id)\r\n\t}\r\n\r\n\tconst changeNickname = user => {\r\n\t\tif (newNickname.trim() !== '' && newNickname.trim().length < 80) {\r\n\t\t\tchat.assignedUsers.forEach(u => {\r\n\t\t\t\tif (u.id !== user.id) {\r\n\t\t\t\t\tupdateDocument(chat.id, {\r\n\t\t\t\t\t\tassignedUsers: [\r\n\t\t\t\t\t\t\tu,\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\tid: user.id,\r\n\t\t\t\t\t\t\t\tnickname: newNickname.trim(),\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t],\r\n\t\t\t\t\t})\r\n\t\t\t\t\tsetShowNicknameModal(false)\r\n\t\t\t\t}\r\n\t\t\t\tif (u.id === user.id) {\r\n\t\t\t\t\tsendMessage(`Set nickname of user ${getDoc(u.id).displayName} to ${newNickname.trim()}`, newNickname.trim())\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t}\r\n\t}\r\n\r\n\tconst spreadColors = theme => {\r\n\t\tlet colors = null\r\n\r\n\t\ttheme.colors.msgBgOwner.forEach(color => {\r\n\t\t\tcolors === null ? (colors = `${color.value}`) : (colors = `${colors}, ${color.value}`)\r\n\t\t})\r\n\r\n\t\tif (theme.colors.msgBgOwner.length === 1) {\r\n\t\t\treturn colors\r\n\t\t} else {\r\n\t\t\treturn `linear-gradient(${colors})`\r\n\t\t}\r\n\t}\r\n\r\n\tconst getDoc = id => {\r\n\t\tlet res = null\r\n\r\n\t\tif (users) {\r\n\t\t\tres = users.filter(doc => {\r\n\t\t\t\tif (doc.id === id) {\r\n\t\t\t\t\treturn true\r\n\t\t\t\t}\r\n\t\t\t\treturn false\r\n\t\t\t})[0]\r\n\t\t}\r\n\r\n\t\treturn res\r\n\t}\r\n\r\n\treturn (\r\n\t\t<aside className='chat-options'>\r\n\t\t\t<MediaQuery maxWidth={768}>\r\n\t\t\t\t<i className='fa-solid fa-arrow-left close-chat-options' onClick={() => setShowChatOptions(false)}></i>\r\n\t\t\t</MediaQuery>\r\n\r\n\t\t\t{otherUser && <AvatarWithStatus userId={otherUser.id} linkToProfile={true} />}\r\n\t\t\t<h3>{otherUserLocal.nickname}</h3>\r\n\r\n\t\t\t<div\r\n\t\t\t\tclassName='option'\r\n\t\t\t\tonClick={() => {\r\n\t\t\t\t\tsetShowThemePicker(true)\r\n\t\t\t\t}}>\r\n\t\t\t\t<div className='option__name'>Change theme</div>\r\n\t\t\t\t<div className='option__icon' style={{ background: spreadColors(currentTheme) }}></div>\r\n\t\t\t</div>\r\n\r\n\t\t\t<div\r\n\t\t\t\tclassName='option'\r\n\t\t\t\tonClick={() => {\r\n\t\t\t\t\tsetShowEmojiPicker(true)\r\n\t\t\t\t}}>\r\n\t\t\t\t<div className='option__name'>Change emoji icon</div>\r\n\t\t\t\t<div className='option__icon'>\r\n\t\t\t\t\t<i className='fa-solid fa-thumbs-up'></i>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\r\n\t\t\t<div\r\n\t\t\t\tclassName='option'\r\n\t\t\t\tonClick={() => {\r\n\t\t\t\t\tsetShowNicknameModal(true)\r\n\t\t\t\t}}>\r\n\t\t\t\t<div className='option__name'>Edit nicknames</div>\r\n\t\t\t\t<div className='option__icon'>Aa</div>\r\n\t\t\t</div>\r\n\r\n\t\t\t{themes && (showThemePicker || showThemeCreator) && (\r\n\t\t\t\t<>\r\n\t\t\t\t\t<Modal\r\n\t\t\t\t\t\tshow={showThemePicker}\r\n\t\t\t\t\t\tsetShow={() => setShowThemePicker(false)}\r\n\t\t\t\t\t\tonClose={() => setConfirmThemeDelete(null)}\r\n\t\t\t\t\t\tdisableOCH={showThemeCreator}>\r\n\t\t\t\t\t\t<ThemePicker\r\n\t\t\t\t\t\t\tthemes={themes}\r\n\t\t\t\t\t\t\tchat={chat}\r\n\t\t\t\t\t\t\tsetShowThemeCreator={setShowThemeCreator}\r\n\t\t\t\t\t\t\tsetEditedTheme={setEditedTheme}\r\n\t\t\t\t\t\t\tsetConfirmThemeDelete={setConfirmThemeDelete}\r\n\t\t\t\t\t\t\tconfirmThemeDelete={confirmThemeDelete}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</Modal>\r\n\t\t\t\t\t<Modal\r\n\t\t\t\t\t\tshow={showThemeCreator}\r\n\t\t\t\t\t\tsetShow={() => setShowThemeCreator(false)}\r\n\t\t\t\t\t\tonClose={() => {\r\n\t\t\t\t\t\t\tsetEditedTheme(null)\r\n\t\t\t\t\t\t\tsetConfirmCustomTheme(false)\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t\tdisableOCH={confirmCustomTheme}>\r\n\t\t\t\t\t\t<ThemeCreator\r\n\t\t\t\t\t\t\tsetShowThemePicker={setShowThemePicker}\r\n\t\t\t\t\t\t\tsetShowThemeCreator={setShowThemeCreator}\r\n\t\t\t\t\t\t\tchat={chat}\r\n\t\t\t\t\t\t\teditedTheme={editedTheme}\r\n\t\t\t\t\t\t\tsetConfirmCustomTheme={setConfirmCustomTheme}\r\n\t\t\t\t\t\t\tconfirmCustomTheme={confirmCustomTheme}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</Modal>\r\n\t\t\t\t</>\r\n\t\t\t)}\r\n\r\n\t\t\t{showEmojiPicker && (\r\n\t\t\t\t<OutsideClickHandler\r\n\t\t\t\t\tonOutsideClick={() => {\r\n\t\t\t\t\t\tsetShowEmojiPicker(false)\r\n\t\t\t\t\t}}>\r\n\t\t\t\t\t<EmojiPicker\r\n\t\t\t\t\t\tclassName='emoji-picker'\r\n\t\t\t\t\t\tonEmojiClick={e => {\r\n\t\t\t\t\t\t\tchangeChatEmoji(e)\r\n\t\t\t\t\t\t\tsetShowEmojiPicker(false)\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t\ttheme={Theme.DARK}\r\n\t\t\t\t\t\tpreviewConfig={{\r\n\t\t\t\t\t\t\tdefaultCaption: '',\r\n\t\t\t\t\t\t\tdefaultEmoji: null,\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t// lazyLoadEmojis={true}\r\n\t\t\t\t\t\temojiStyle={EmojiStyle.NATIVE}\r\n\t\t\t\t\t/>\r\n\t\t\t\t</OutsideClickHandler>\r\n\t\t\t)}\r\n\r\n\t\t\t<Modal\r\n\t\t\t\tshow={showNicknameModal}\r\n\t\t\t\tsetShow={() => setShowNicknameModal(false)}\r\n\t\t\t\tonClose={() => {\r\n\t\t\t\t\tsetNewNickname('')\r\n\t\t\t\t\tsetShowNicknameInput(null)\r\n\t\t\t\t}}>\r\n\t\t\t\t{chat.assignedUsers.map(u => (\r\n\t\t\t\t\t// <OutsideClickHandler onOutsideClick={() => setShowNicknameInput(null)}>\r\n\t\t\t\t\t<div\r\n\t\t\t\t\t\tkey={u.id}\r\n\t\t\t\t\t\tclassName='user'\r\n\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\tsetNewNickname(' ')\r\n\t\t\t\t\t\t\thandleNicknameInput(u)\r\n\t\t\t\t\t\t}}>\r\n\t\t\t\t\t\t<div className='author'>\r\n\t\t\t\t\t\t\t<Avatar src={getDoc(u.id) !== null ? getDoc(u.id).photoURL : ''} />\r\n\t\t\t\t\t\t\t{showNicknameInput !== u.id && (\r\n\t\t\t\t\t\t\t\t<div className='flex-column'>\r\n\t\t\t\t\t\t\t\t\t<p className='user__display-name'>{u.nickname}</p>\r\n\t\t\t\t\t\t\t\t\t<p>Set nickname</p>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t{showNicknameInput === u.id && (\r\n\t\t\t\t\t\t\t\t<input\r\n\t\t\t\t\t\t\t\t\ttype='text'\r\n\t\t\t\t\t\t\t\t\tplaceholder={u.nickname}\r\n\t\t\t\t\t\t\t\t\tvalue={newNickname}\r\n\t\t\t\t\t\t\t\t\tonChange={e => {\r\n\t\t\t\t\t\t\t\t\t\tsetNewNickname(e.target.value)\r\n\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t{showNicknameInput !== u.id && <i className='fa-solid fa-pen-to-square'></i>}\r\n\t\t\t\t\t\t{showNicknameInput === u.id && (\r\n\t\t\t\t\t\t\t<i\r\n\t\t\t\t\t\t\t\tclassName='fa-solid fa-check'\r\n\t\t\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\t\t\tchangeNickname(u)\r\n\t\t\t\t\t\t\t\t}}></i>\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t// </OutsideClickHandler>\r\n\t\t\t\t))}\r\n\t\t\t</Modal>\r\n\t\t</aside>\r\n\t)\r\n}\r\n","import { useEffect, useState } from 'react'\r\nimport { useParams } from 'react-router-dom'\r\nimport { useDocument } from '../../hooks/useDocument'\r\nimport { useAuthContext } from '../../hooks/useAuthContext'\r\nimport { useFirestore } from '../../hooks/useFirestore'\r\n\r\n// Styles && Assets\r\nimport './Chat.scss'\r\n\r\n// Components\r\nimport Messages from './Messages/Messages'\r\nimport MessageField from './MessageField/MessageField'\r\nimport Avatar from '../../components/Avatar/Avatar'\r\nimport ChatOptions from './ChatOptions/ChatOptions'\r\nimport { useMediaQuery } from 'react-responsive'\r\nimport MediaQuery from 'react-responsive'\r\n\r\nexport default function Chat({ setCurrentChat, inputRef, currentTheme, showChat, setShowChat }) {\r\n\tconst { user } = useAuthContext()\r\n\tconst { id } = useParams()\r\n\tconst { error, document } = useDocument('projects', id)\r\n\tconst { updateDocument } = useFirestore('projects')\r\n\r\n\tconst [isAssignedUser, setIsAssignedUser] = useState(false)\r\n\tconst [messageResponse, onMessageResponse] = useState(null)\r\n\tconst [bottomDiv, setBottomDiv] = useState(null)\r\n\tconst [showChatOptions, setShowChatOptions] = useState(false)\r\n\r\n\tconst [otherUserLocal, setOtherUserLocal] = useState(null)\r\n\tconst [currentUserLocal, setCurrentUserLocal] = useState(null)\r\n\r\n\tconst { document: otherUserDoc } = useDocument('users', otherUserLocal ? otherUserLocal.id : null)\r\n\tconst { document: currentUserDoc } = useDocument('users', currentUserLocal ? currentUserLocal.id : null)\r\n\r\n\tuseEffect(() => {\r\n\t\tif (document !== null) {\r\n\t\t\tdocument.assignedUsers.forEach(u => {\r\n\t\t\t\tif (u.id !== user.uid) {\r\n\t\t\t\t\tsetOtherUserLocal({ ...u })\r\n\t\t\t\t}\r\n\t\t\t})\r\n\r\n\t\t\tdocument.assignedUsers.forEach(u => {\r\n\t\t\t\tif (u.id === user.uid) {\r\n\t\t\t\t\tsetCurrentUserLocal({ ...u })\r\n\t\t\t\t\tsetIsAssignedUser(true)\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t}\r\n\r\n\t\tsetCurrentChat(document)\r\n\t}, [id, document])\r\n\r\n\tconst handleSeen = async () => {\r\n\t\tif (document.messages && document.messages.length > 0) {\r\n\t\t\tawait updateDocument(document.id, {\r\n\t\t\t\tisRead: true,\r\n\t\t\t\tassignedUsers: [\r\n\t\t\t\t\totherUserLocal,\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tid: currentUserDoc.id,\r\n\t\t\t\t\t\tnickname: currentUserLocal.nickname,\r\n\t\t\t\t\t\tlastRead: document.messages[document.messages.length - 1].id,\r\n\t\t\t\t\t},\r\n\t\t\t\t],\r\n\t\t\t})\r\n\t\t}\r\n\t}\r\n\tconst queryMd = useMediaQuery({ query: '(max-width: 768px)' })\r\n\r\n\tif (error) {\r\n\t\treturn <div className='error'>{error}</div>\r\n\t}\r\n\r\n\tif (!document) {\r\n\t\treturn <div className='loading'>Loading...</div>\r\n\t}\r\n\r\n\treturn (\r\n\t\tisAssignedUser &&\r\n\t\totherUserDoc &&\r\n\t\tcurrentUserDoc &&\r\n\t\t(queryMd ? showChat : true) && (\r\n\t\t\t<div className={`chat ${showChat ? 'active' : ''}`}>\r\n\t\t\t\t<div className='vertical-container'>\r\n\t\t\t\t\t<div className='chat__top-bar'>\r\n\t\t\t\t\t\t<div className='flex-row'>\r\n\t\t\t\t\t\t\t<MediaQuery maxWidth={768}>\r\n\t\t\t\t\t\t\t\t<i className='fa-solid fa-arrow-left close-chat' onClick={() => setShowChat(false)}></i>\r\n\t\t\t\t\t\t\t</MediaQuery>\r\n\r\n\t\t\t\t\t\t\t<Avatar src={otherUserDoc.photoURL} />\r\n\t\t\t\t\t\t\t<div className='vertical-container'>\r\n\t\t\t\t\t\t\t\t<h3>{otherUserLocal.nickname}</h3>\r\n\t\t\t\t\t\t\t\t{<p className='isActive'>{currentUserDoc.status ? currentUserDoc.status : ''}</p>}\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\tclassName='top-bar-options'\r\n\t\t\t\t\t\t\tonClick={e => {\r\n\t\t\t\t\t\t\t\tsetShowChatOptions(prevValue => !prevValue)\r\n\t\t\t\t\t\t\t\te.target.classList.toggle('active')\r\n\t\t\t\t\t\t\t}}>\r\n\t\t\t\t\t\t\t<i className='fa-solid fa-ellipsis-vertical'></i>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t<div\r\n\t\t\t\t\t\tclassName='chat__comments'\r\n\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\thandleSeen()\r\n\t\t\t\t\t\t}}>\r\n\t\t\t\t\t\t<Messages\r\n\t\t\t\t\t\t\tchat={document}\r\n\t\t\t\t\t\t\tonMessageResponse={onMessageResponse}\r\n\t\t\t\t\t\t\tsetBottomDiv={setBottomDiv}\r\n\t\t\t\t\t\t\totherUser={otherUserDoc}\r\n\t\t\t\t\t\t\tcurrentUser={currentUserDoc}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t<MessageField\r\n\t\t\t\t\t\t\tchat={document}\r\n\t\t\t\t\t\t\tmessageResponse={messageResponse}\r\n\t\t\t\t\t\t\tonMessageResponse={onMessageResponse}\r\n\t\t\t\t\t\t\tbottomDiv={bottomDiv}\r\n\t\t\t\t\t\t\tinputRef={inputRef}\r\n\t\t\t\t\t\t\thandleSeen={handleSeen}\r\n\t\t\t\t\t\t\totherUser={otherUserDoc}\r\n\t\t\t\t\t\t\tcurrentUser={currentUserDoc}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\r\n\t\t\t\t{showChatOptions && (\r\n\t\t\t\t\t<ChatOptions\r\n\t\t\t\t\t\tonMessageResponse={onMessageResponse}\r\n\t\t\t\t\t\totherUser={otherUserDoc}\r\n\t\t\t\t\t\tchat={document}\r\n\t\t\t\t\t\tcurrentTheme={currentTheme}\r\n\t\t\t\t\t\totherUserLocal={otherUserLocal}\r\n\t\t\t\t\t\tsetShowChatOptions={setShowChatOptions}\r\n\t\t\t\t\t/>\r\n\t\t\t\t)}\r\n\t\t\t</div>\r\n\t\t)\r\n\t)\r\n}\r\n","import { PhoneAuthProvider, RecaptchaVerifier } from 'firebase/auth'\r\nimport { useState, useEffect } from 'react'\r\nimport { useNavigate } from 'react-router-dom'\r\nimport { projectAuth, projectFirestore, projectGitHub, projectGoogle } from '../firebase/config'\r\nimport { useAuthContext } from './useAuthContext'\r\n\r\nexport const useLogin = () => {\r\n\tconst navigate = useNavigate()\r\n\r\n\tconst { dispatch } = useAuthContext()\r\n\r\n\tconst [isCancelled, setIsCancelled] = useState(false)\r\n\tconst [error, setError] = useState(null)\r\n\tconst [isPending, setIsPending] = useState(false)\r\n\tconst [isFinished, setIsFinished] = useState(false)\r\n\r\n\tconst login = async (email, password) => {\r\n\t\tsetError(null)\r\n\t\tsetIsPending(true)\r\n\r\n\t\ttry {\r\n\t\t\t// Login\r\n\t\t\tconst res = await projectAuth.signInWithEmailAndPassword(email, password)\r\n\r\n\t\t\t// Update online status\r\n\r\n\t\t\tawait projectFirestore.collection('users').doc(res.user.uid).update({\r\n\t\t\t\tonline: true,\r\n\t\t\t})\r\n\r\n\t\t\t// Dispatch login action\r\n\t\t\tdispatch({ type: 'LOGIN', payload: res.user })\r\n\r\n\t\t\t// Update state\r\n\t\t\tif (!isCancelled) {\r\n\t\t\t\tsetIsPending(false)\r\n\t\t\t\tsetError(null)\r\n\t\t\t}\r\n\t\t} catch (err) {\r\n\t\t\tif (!isCancelled) {\r\n\t\t\t\tsetError(err.message)\r\n\t\t\t\tsetIsPending(false)\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tconst loginWithGoogle = async () => {\r\n\t\tsetError(null)\r\n\t\tsetIsPending(true)\r\n\r\n\t\ttry {\r\n\t\t\t// Login\r\n\t\t\tconst res = await projectAuth.signInWithPopup(projectGoogle)\r\n\r\n\t\t\t// Update online status\r\n\r\n\t\t\tawait projectFirestore.collection('users').doc(res.user.uid).update({\r\n\t\t\t\tonline: true,\r\n\t\t\t})\r\n\r\n\t\t\t// Dispatch login action\r\n\t\t\tdispatch({ type: 'LOGIN', payload: res.user })\r\n\r\n\t\t\t// Update state\r\n\t\t\tif (!isCancelled) {\r\n\t\t\t\tsetIsPending(false)\r\n\t\t\t\tsetError(null)\r\n\t\t\t}\r\n\t\t} catch (err) {\r\n\t\t\tif (!isCancelled) {\r\n\t\t\t\tsetError(err.message)\r\n\t\t\t\tsetIsPending(false)\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tconst loginWithGithub = async () => {\r\n\t\tsetError(null)\r\n\t\tsetIsPending(true)\r\n\r\n\t\ttry {\r\n\t\t\t// Login\r\n\t\t\tconst res = await projectAuth.signInWithPopup(projectGitHub)\r\n\t\t\t// Update online status\r\n\r\n\t\t\tawait projectFirestore.collection('users').doc(res.user.uid).update({\r\n\t\t\t\tonline: true,\r\n\t\t\t})\r\n\r\n\t\t\t// Dispatch login action\r\n\t\t\tdispatch({ type: 'LOGIN', payload: res.user })\r\n\r\n\t\t\t// Update state\r\n\t\t\tif (!isCancelled) {\r\n\t\t\t\tsetIsPending(false)\r\n\t\t\t\tsetError(null)\r\n\t\t\t}\r\n\t\t} catch (err) {\r\n\t\t\tif (!isCancelled) {\r\n\t\t\t\tsetError(err.message)\r\n\t\t\t\tsetIsPending(false)\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tconst sendPasswordReset = async email => {\r\n\t\tsetError(null)\r\n\t\tsetIsPending(true)\r\n\t\tsetIsFinished(false)\r\n\r\n\t\ttry {\r\n\t\t\tawait projectAuth.sendPasswordResetEmail(email)\r\n\t\t\tif (!isCancelled) {\r\n\t\t\t\tsetIsPending(false)\r\n\t\t\t\tsetError(null)\r\n\t\t\t\tsetIsFinished(true)\r\n\r\n\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\tnavigate('/login')\r\n\t\t\t\t}, 15000)\r\n\t\t\t}\r\n\t\t} catch (err) {\r\n\t\t\tif (!isCancelled) {\r\n\t\t\t\tsetError(err.message)\r\n\t\t\t\tsetIsPending(false)\r\n\t\t\t\tsetIsFinished(false)\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tconst resetPassword = async (code, newPassword) => {\r\n\t\tsetError(null)\r\n\t\tsetIsPending(true)\r\n\t\tsetIsFinished(false)\r\n\r\n\t\ttry {\r\n\t\t\tawait projectAuth.confirmPasswordReset(code, newPassword)\r\n\r\n\t\t\tif (!isCancelled) {\r\n\t\t\t\tsetIsPending(false)\r\n\t\t\t\tsetError(null)\r\n\t\t\t\tsetIsFinished(true)\r\n\r\n\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\tnavigate('/login')\r\n\t\t\t\t}, 1000)\r\n\t\t\t}\r\n\t\t} catch (err) {\r\n\t\t\tif (!isCancelled) {\r\n\t\t\t\tsetError(err.message)\r\n\t\t\t\tsetIsPending(false)\r\n\t\t\t\tsetIsFinished(false)\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tconst setUpRecaptcha = async number => {\r\n\t\t// user.unlink(provider.providerId)\r\n\r\n\t\tconst provider = new PhoneAuthProvider(projectAuth)\r\n\t\tconst recaptchaVerifier = new RecaptchaVerifier('recaptcha-container', {}, projectAuth)\r\n\r\n\t\trecaptchaVerifier.render()\r\n\r\n\t\tconst verificationId = await provider.verifyPhoneNumber(number, recaptchaVerifier)\r\n\r\n\t\treturn verificationId\r\n\r\n\t\t// const credential = PhoneAuthProvider.credential(verificationId, OTPCode)\r\n\t\t// return signInWithPhoneNumber(projectAuth, number, recaptchaVerifier)\r\n\t}\r\n\r\n\tuseEffect(() => {\r\n\t\treturn () => setIsCancelled(true)\r\n\t}, [])\r\n\r\n\treturn {\r\n\t\tlogin,\r\n\t\tloginWithGoogle,\r\n\t\tloginWithGithub,\r\n\t\tsendPasswordReset,\r\n\t\tresetPassword,\r\n\t\tsetUpRecaptcha,\r\n\t\tisPending,\r\n\t\terror,\r\n\t\tisFinished,\r\n\t}\r\n}\r\n","export default __webpack_public_path__ + \"static/media/logo-no-bg.bc52095c.png\";","// Styles & assets\r\nimport './AuthTemplate.scss'\r\nimport logo from '../../assets/logo-no-bg.png'\r\n\r\nconst AuthTemplate = ({ children }) => {\r\n\treturn (\r\n\t\t<div className='auth'>\r\n\t\t\t<div className='wrapper'>\r\n\t\t\t\t<div className='auth__logo'>\r\n\t\t\t\t\t<img src={logo} alt='someapp logo' />\r\n\t\t\t\t\t<h1>Someapp</h1>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div className='auth__background-canvas'>\r\n\t\t\t\t\t<div className='auth__background-canvas-container'>\r\n\t\t\t\t\t\t<svg id='visual' viewBox='0 0 1920 1080' version='1.1' className='one'>\r\n\t\t\t\t\t\t\t<g transform='translate(1920, 0)'>\r\n\t\t\t\t\t\t\t\t<path\r\n\t\t\t\t\t\t\t\t\td='M0 756C-87 722 -174.1 688.1 -272.9 658.7C-371.6 629.4 -482.1 604.7 -534.6 534.6C-587.1 464.4 -581.6 348.9 -608.8 252.2C-636.1 155.5 -696 77.8 -756 0L0 0Z'\r\n\t\t\t\t\t\t\t\t\tfill='#1d1f20'></path>\r\n\t\t\t\t\t\t\t</g>\r\n\t\t\t\t\t\t</svg>\r\n\t\t\t\t\t\t<svg id='visual' viewBox='0 0 1920 1080' version='1.1' className='two'>\r\n\t\t\t\t\t\t\t<g transform='translate(0, 1080)'>\r\n\t\t\t\t\t\t\t\t<path\r\n\t\t\t\t\t\t\t\t\td='M0 -756C92.7 -731.4 185.5 -706.7 279.4 -674.4C373.2 -642.1 468.2 -602.2 534.6 -534.6C600.9 -466.9 638.6 -371.5 670.7 -277.8C702.9 -184.1 729.4 -92.1 756 0L0 0Z'\r\n\t\t\t\t\t\t\t\t\tfill='#1d1f20'></path>\r\n\t\t\t\t\t\t\t</g>\r\n\t\t\t\t\t\t</svg>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\r\n\t\t\t\t<div className='auth__form'>{children}</div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t)\r\n}\r\n\r\nexport default AuthTemplate\r\n","// Styles\r\nimport './FieldContainer.scss'\r\n\r\nconst FieldContainer = ({ children, error, title, helpText, optional, containerClass }) => {\r\n\treturn (\r\n\t\t<div className={`field ${containerClass ? containerClass : ''}`}>\r\n\t\t\t{title && (\r\n\t\t\t\t<p className='field__title'>\r\n\t\t\t\t\t{title}\r\n\t\t\t\t\t{optional && <span className='input-field__optional'> - Optional</span>}\r\n\t\t\t\t</p>\r\n\t\t\t)}\r\n\r\n\t\t\t{children}\r\n\r\n\t\t\t{helpText && !error && <p className='field__help-text'>{helpText}</p>}\r\n\t\t\t{error && <p className='field__error'>{error}</p>}\r\n\t\t</div>\r\n\t)\r\n}\r\n\r\nexport default FieldContainer\r\n","import { useState } from 'react'\r\n\r\n// Styles\r\nimport '../InputStyles.scss'\r\n\r\n// Components\r\nimport FieldContainer from '../FieldContainer/FieldContainer'\r\n\r\nconst TextField = ({\r\n\tvalue,\r\n\tsetValue,\r\n\tlabel,\r\n\tplaceholder,\r\n\ttitle,\r\n\thelpText,\r\n\terror,\r\n\tresetError,\r\n\tonLostFocus,\r\n\ttype,\r\n\toptional,\r\n\tonClick,\r\n\tcontainerClass,\r\n\tinputClass,\r\n\tafter,\r\n}) => {\r\n\tconst [showPassword, setShowPassword] = useState(false)\r\n\r\n\tif ((value, setValue)) {\r\n\t\treturn (\r\n\t\t\t<FieldContainer\r\n\t\t\t\terror={error}\r\n\t\t\t\ttitle={title}\r\n\t\t\t\thelpText={helpText}\r\n\t\t\t\toptional={optional}\r\n\t\t\t\tcontainerClass={containerClass}>\r\n\t\t\t\t<div\r\n\t\t\t\t\tclassName={`input-field ${error ? 'field-error' : ''}`}\r\n\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\tif (onClick) onClick()\r\n\t\t\t\t\t}}>\r\n\t\t\t\t\t{label && (\r\n\t\t\t\t\t\t<div className={`input-field__label ${value.trim().length > 0 ? 'active' : ''}`}>\r\n\t\t\t\t\t\t\t{label}\r\n\t\t\t\t\t\t\t{optional && <span className='input-field__optional'> - Optional</span>}\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t)}\r\n\r\n\t\t\t\t\t<input\r\n\t\t\t\t\t\ttype={showPassword ? 'text' : type}\r\n\t\t\t\t\t\tclassName={inputClass ? inputClass : ''}\r\n\t\t\t\t\t\tvalue={value}\r\n\t\t\t\t\t\tonChange={e => setValue(e.target.value)}\r\n\t\t\t\t\t\tplaceholder={placeholder && !label ? placeholder : ''}\r\n\t\t\t\t\t\tonBlur={() => {\r\n\t\t\t\t\t\t\tif (resetError) resetError()\r\n\t\t\t\t\t\t\tif (onLostFocus) onLostFocus()\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t/>\r\n\r\n\t\t\t\t\t{!error && after && <div className='input-field__icon input-field__icon--after'>{after}</div>}\r\n\r\n\t\t\t\t\t{error && type !== 'password' && (\r\n\t\t\t\t\t\t<i className='fa-solid fa-circle-exclamation  input-field__icon input-field__icon--error'></i>\r\n\t\t\t\t\t)}\r\n\r\n\t\t\t\t\t{type === 'password' && (\r\n\t\t\t\t\t\t<>\r\n\t\t\t\t\t\t\t{showPassword && (\r\n\t\t\t\t\t\t\t\t<i\r\n\t\t\t\t\t\t\t\t\tclassName='fa-regular fa-eye input-field__icon input-field__icon--password'\r\n\t\t\t\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\t\t\t\tsetShowPassword(false)\r\n\t\t\t\t\t\t\t\t\t}}></i>\r\n\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t{!showPassword && (\r\n\t\t\t\t\t\t\t\t<i\r\n\t\t\t\t\t\t\t\t\tclassName='fa-regular fa-eye-slash input-field__icon input-field__icon--password'\r\n\t\t\t\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\t\t\t\tsetShowPassword(true)\r\n\t\t\t\t\t\t\t\t\t}}></i>\r\n\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t</>\r\n\t\t\t\t\t)}\r\n\t\t\t\t</div>\r\n\t\t\t</FieldContainer>\r\n\t\t)\r\n\t}\r\n}\r\n\r\nexport default TextField\r\n","export default __webpack_public_path__ + \"static/media/btn_google_dark_normal_ios.9fe90a17.svg\";","import { useLogin } from '../../hooks/useLogin'\r\n\r\n// Styles && Assets\r\nimport './GoogleButton.scss'\r\nimport googleLogo from '../../assets/btn_google_dark_normal_ios.svg'\r\n\r\nconst GoogleButton = () => {\r\n\tconst { loginWithGoogle, isPending, error } = useLogin()\r\n\r\n\tconst handleSubmitWithGoogle = () => {\r\n\t\tloginWithGoogle()\r\n\t}\r\n\r\n\treturn (\r\n\t\t<>\r\n\t\t\t<button className='google-btn' onClick={() => handleSubmitWithGoogle()}>\r\n\t\t\t\t<img src={googleLogo} alt='google logo' />\r\n\t\t\t\t{!isPending && <span>Sign in with google</span>}\r\n\t\t\t\t{isPending && <span>Signing in with google</span>}\r\n\t\t\t</button>\r\n\t\t\t{error && <div className='error'>{error}</div>}\r\n\t\t</>\r\n\t)\r\n}\r\n\r\nexport default GoogleButton\r\n","import { useLogin } from '../../hooks/useLogin'\r\n\r\n// Styles && Assets\r\nimport './GithubButton.scss'\r\nimport githubLogo from '../../assets/GitHub-Mark-Light-32px.png'\r\n\r\nconst GithubButton = () => {\r\n\tconst { loginWithGithub, isPending, error } = useLogin()\r\n\r\n\tconst handleSubmitWithGithub = () => {\r\n\t\tloginWithGithub()\r\n\t}\r\n\r\n\treturn (\r\n\t\t<>\r\n\t\t\t<button className='github-btn' onClick={() => handleSubmitWithGithub()}>\r\n\t\t\t\t<img src={githubLogo} alt='github logo' />\r\n\t\t\t\t{!isPending && <span>Sign in with GitHub</span>}\r\n\t\t\t\t{isPending && <span>Signing in with GitHub</span>}\r\n\t\t\t</button>\r\n\t\t\t{error && <div className='error'>{error}</div>}\r\n\t\t</>\r\n\t)\r\n}\r\n\r\nexport default GithubButton\r\n","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyRpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNS1jMDIxIDc5LjE1NDkxMSwgMjAxMy8xMC8yOS0xMTo0NzoxNiAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6RERCMUIwOUY4NkNFMTFFM0FBNTJFRTMzNTJEMUJDNDYiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6RERCMUIwOUU4NkNFMTFFM0FBNTJFRTMzNTJEMUJDNDYiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNiAoTWFjaW50b3NoKSI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkU1MTc4QTJBOTlBMDExRTI5QTE1QkMxMDQ2QTg5MDREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOkU1MTc4QTJCOTlBMDExRTI5QTE1QkMxMDQ2QTg5MDREIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+jUqS1wAAApVJREFUeNq0l89rE1EQx3e3gVJoSPzZeNEWPKgHoa0HBak0iHiy/4C3WvDmoZ56qJ7txVsPQu8qlqqHIhRKJZceesmhioQEfxTEtsoSpdJg1u/ABJ7Pmc1m8zLwgWTmzcw3L+/te+tHUeQltONgCkyCi2AEDHLsJ6iBMlgHL8FeoqokoA2j4CloRMmtwTmj7erHBXPgCWhG6a3JNXKdCiDl1cidVbXZkJoXQRi5t5BrxwoY71FzU8S4JuAIqFkJ2+BFSlEh525b/hr3+k/AklDkNsf6wTT4yv46KIMNpsy+iMdMc47HNWxbsgVcUn7FmLAzzoFAWDsBx+wVP6bUpp5ewI+DOeUx0Wd9D8F70BTGNjkWtqnhmT1JQAHcUgZd8Lo3rQb1LAT8eJVUfgGvHQigGp+V2Z0iAUUl8QH47kAA1XioxIo+bRN8OG8F/oBjwv+Z1nJgX5jpdzQDw0LCjsPmrcW7I/iHScCAEDj03FtD8A0EyuChHgg4KTlJQF3wZ7WELppnBX+dBFSVpJsOBWi1qiRgSwnOgoyD5hmuJdkWCVhTgnTvW3AgYIFrSbZGh0UW/Io5Vp+DQoK7o80pztWMemZbgxeNwCNwDbw1fIfgGZjhU6xPaJgBV8BdsMw5cbZoHsenwYFxkZzl83xTSKTiviCAfCsJLysH3POfC8m8NegyGAGfLP/VmGmfSChgXroR0RSWjEFv2J/nG84cuKFMf4sTCZqXuJd4KaXFVjEG3+tw4eXbNK/YC9oXXs3O8NY8y99L4BXY5cvLY/Bb2VZ58EOJVcB18DHJq9lRsKr8inyKGVjlmh29mtHs3AHfuhCwy1vXT/Nu2GKQt+UHsGdctyX6eQyNvc+5sfX9Dl7Pe2J/BRgAl2CpwmrsHR0AAAAASUVORK5CYII=\"","import { useState } from 'react'\r\nimport { useLogin } from '../../../hooks/useLogin'\r\nimport { Link } from 'react-router-dom'\r\n\r\n// Components\r\nimport AuthTemplate from '../AuthTemplate'\r\nimport Field from '../../../components/Inputs/Field/Field'\r\nimport GoogleButton from '../../../components/GoogleButton/GoogleButton'\r\nimport GithubButton from '../../../components/GithubButton/GithubButton'\r\n\r\nexport default function Login() {\r\n\tconst [email, setEmail] = useState('')\r\n\tconst [password, setPassword] = useState('')\r\n\tconst { login, isPending, error } = useLogin()\r\n\r\n\tconst handleSubmit = () => {\r\n\t\t// Validation\r\n\r\n\t\tif (!email.match(/^[a-zA-Z0-9.!#$%&*+/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\\.[a-zA-Z0-9-]+)*$/)) {\r\n\t\t\tsetFormErrors(existing => ({\r\n\t\t\t\t...existing,\r\n\t\t\t\temail: 'Enter a valid email',\r\n\t\t\t}))\r\n\t\t\treturn\r\n\t\t}\r\n\t\tif (password.trim().length < 6) {\r\n\t\t\tsetFormErrors(existing => ({\r\n\t\t\t\t...existing,\r\n\t\t\t\tpassword: 'Password must be at least 6 characters long',\r\n\t\t\t}))\r\n\t\t\treturn\r\n\t\t}\r\n\r\n\t\tlogin(email, password)\r\n\t}\r\n\r\n\tconst [formErrors, setFormErrors] = useState({\r\n\t\tusername: '',\r\n\t\temail: '',\r\n\t\tpassword: '',\r\n\t})\r\n\r\n\treturn (\r\n\t\t<AuthTemplate>\r\n\t\t\t<div className='auth__form-title'>\r\n\t\t\t\t<h2>Welcome back!</h2>\r\n\r\n\t\t\t\t<p className='auth__change-page'>\r\n\t\t\t\t\tDon't have an account? <Link to='/signup'>Sign up</Link>\r\n\t\t\t\t</p>\r\n\t\t\t</div>\r\n\r\n\t\t\t<Field\r\n\t\t\t\ttype='email'\r\n\t\t\t\tvalue={email}\r\n\t\t\t\tsetValue={setEmail}\r\n\t\t\t\tlabel='Email'\r\n\t\t\t\terror={formErrors.email}\r\n\t\t\t\tresetError={() =>\r\n\t\t\t\t\tsetFormErrors(existing => ({\r\n\t\t\t\t\t\t...existing,\r\n\t\t\t\t\t\temail: '',\r\n\t\t\t\t\t}))\r\n\t\t\t\t}\r\n\t\t\t\tonLostFocus={() => {\r\n\t\t\t\t\tif (email !== '' && !email.match(/^[a-zA-Z0-9.!#$%&*+/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\\.[a-zA-Z0-9-]+)*$/)) {\r\n\t\t\t\t\t\tsetFormErrors(existing => ({\r\n\t\t\t\t\t\t\t...existing,\r\n\t\t\t\t\t\t\temail: 'Please enter a valid email address',\r\n\t\t\t\t\t\t}))\r\n\t\t\t\t\t}\r\n\t\t\t\t}}\r\n\t\t\t\thelpText='Eg. icecream@gmail.com'\r\n\t\t\t/>\r\n\r\n\t\t\t<Field\r\n\t\t\t\ttype='password'\r\n\t\t\t\tvalue={password}\r\n\t\t\t\tsetValue={setPassword}\r\n\t\t\t\tlabel='Password'\r\n\t\t\t\terror={formErrors.password}\r\n\t\t\t\tresetError={() =>\r\n\t\t\t\t\tsetFormErrors(existing => ({\r\n\t\t\t\t\t\t...existing,\r\n\t\t\t\t\t\tpassword: '',\r\n\t\t\t\t\t}))\r\n\t\t\t\t}\r\n\t\t\t\tonLostFocus={() => {\r\n\t\t\t\t\tif (password !== '' && password.trim().length < 6) {\r\n\t\t\t\t\t\tsetFormErrors(existing => ({\r\n\t\t\t\t\t\t\t...existing,\r\n\t\t\t\t\t\t\tpassword: 'Password must be at least 6 characters long',\r\n\t\t\t\t\t\t}))\r\n\t\t\t\t\t}\r\n\t\t\t\t}}\r\n\t\t\t/>\r\n\r\n\t\t\t<Link to={'/recover-password'} className='auth__form-reset-password'>\r\n\t\t\t\tForgot password?\r\n\t\t\t</Link>\r\n\r\n\t\t\t{!isPending && (\r\n\t\t\t\t<button className='btn' onClick={() => handleSubmit()}>\r\n\t\t\t\t\tLogin\r\n\t\t\t\t</button>\r\n\t\t\t)}\r\n\t\t\t{isPending && (\r\n\t\t\t\t<button className='btn' disabled>\r\n\t\t\t\t\tLoading\r\n\t\t\t\t</button>\r\n\t\t\t)}\r\n\r\n\t\t\t<div className='separator mt2 mb2'>\r\n\t\t\t\t<span>or</span>\r\n\t\t\t</div>\r\n\r\n\t\t\t<GoogleButton />\r\n\t\t\t<GithubButton />\r\n\r\n\t\t\t{error && <div className='error'>{error}</div>}\r\n\t\t</AuthTemplate>\r\n\t)\r\n}\r\n","import { useState } from 'react'\r\nimport { useSignup } from '../../../hooks/useSignup'\r\nimport { Link } from 'react-router-dom'\r\n\r\n// Components\r\nimport AuthTemplate from '../AuthTemplate'\r\nimport Field from '../../../components/Inputs/Field/Field'\r\nimport GoogleButton from '../../../components/GoogleButton/GoogleButton'\r\nimport GithubButton from '../../../components/GithubButton/GithubButton'\r\n\r\nexport default function Signup() {\r\n\tconst { signup, isPending, error } = useSignup()\r\n\r\n\tconst [email, setEmail] = useState('')\r\n\tconst [password, setPassword] = useState('')\r\n\tconst [displayName, setDisplayName] = useState('')\r\n\r\n\t// const [thumbnail, setThumbnail] = useState(null)\r\n\t// const [thumbnailError, setThumbnailError] = useState(null)\r\n\r\n\tconst [formErrors, setFormErrors] = useState({\r\n\t\tdisplayName: '',\r\n\t\temail: '',\r\n\t\tpassword: '',\r\n\t})\r\n\r\n\tconst handleSubmit = () => {\r\n\t\t// Validation\r\n\r\n\t\tif (!email.match(/^[a-zA-Z0-9.!#$%&*+/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\\.[a-zA-Z0-9-]+)*$/)) {\r\n\t\t\tsetFormErrors(existing => ({\r\n\t\t\t\t...existing,\r\n\t\t\t\temail: 'Enter a valid email',\r\n\t\t\t}))\r\n\t\t\treturn\r\n\t\t}\r\n\t\tif (password.trim().length < 6) {\r\n\t\t\tsetFormErrors(existing => ({\r\n\t\t\t\t...existing,\r\n\t\t\t\tpassword: 'Password must be at least 6 characters long',\r\n\t\t\t}))\r\n\t\t\treturn\r\n\t\t}\r\n\t\tif (displayName.trim().length < 3) {\r\n\t\t\tsetFormErrors(existing => ({\r\n\t\t\t\t...existing,\r\n\t\t\t\tdisplayName: 'Username must be at least 3 characters long',\r\n\t\t\t}))\r\n\t\t\treturn\r\n\t\t}\r\n\r\n\t\tsignup(email, password, displayName, '')\r\n\t}\r\n\r\n\t// const handleFileChange = e => {\r\n\t// \tsetThumbnail(null)\r\n\t// \tlet selected = e.target.files[0]\r\n\r\n\t// \tif (!selected) {\r\n\t// \t\tsetThumbnailError('Please select a file')\r\n\t// \t\treturn\r\n\t// \t}\r\n\t// \tif (!selected.type.includes('image')) {\r\n\t// \t\tsetThumbnailError('Selected file must be an image')\r\n\t// \t\treturn\r\n\t// \t}\r\n\t// \tif (!selected.size > 100000) {\r\n\t// \t\tsetThumbnailError('Image file size must be less than 100kb')\r\n\t// \t\treturn\r\n\t// \t}\r\n\r\n\t// \tsetThumbnailError(null)\r\n\t// \tsetThumbnail(selected)\r\n\t// }\r\n\r\n\treturn (\r\n\t\t<AuthTemplate>\r\n\t\t\t<div className='auth__form-title'>\r\n\t\t\t\t<h2>\r\n\t\t\t\t\tCreate an account<span style={{ color: 'var(--text-accent)' }}>.</span>\r\n\t\t\t\t</h2>\r\n\r\n\t\t\t\t<p className='auth__change-page'>\r\n\t\t\t\t\tAlready a member? <Link to='/login'>Log in</Link>\r\n\t\t\t\t</p>\r\n\t\t\t</div>\r\n\r\n\t\t\t<Field\r\n\t\t\t\ttype='email'\r\n\t\t\t\tvalue={email}\r\n\t\t\t\tsetValue={setEmail}\r\n\t\t\t\tlabel='Email'\r\n\t\t\t\terror={formErrors.email}\r\n\t\t\t\tresetError={() =>\r\n\t\t\t\t\tsetFormErrors(existing => ({\r\n\t\t\t\t\t\t...existing,\r\n\t\t\t\t\t\temail: '',\r\n\t\t\t\t\t}))\r\n\t\t\t\t}\r\n\t\t\t\tonLostFocus={() => {\r\n\t\t\t\t\tif (email !== '' && !email.match(/^[a-zA-Z0-9.!#$%&*+/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\\.[a-zA-Z0-9-]+)*$/)) {\r\n\t\t\t\t\t\tsetFormErrors(existing => ({\r\n\t\t\t\t\t\t\t...existing,\r\n\t\t\t\t\t\t\temail: 'Please enter a valid email address',\r\n\t\t\t\t\t\t}))\r\n\t\t\t\t\t}\r\n\t\t\t\t}}\r\n\t\t\t\thelpText='Eg. icecream@gmail.com'\r\n\t\t\t/>\r\n\r\n\t\t\t<Field\r\n\t\t\t\ttype='text'\r\n\t\t\t\tvalue={displayName}\r\n\t\t\t\tsetValue={setDisplayName}\r\n\t\t\t\tlabel='Username'\r\n\t\t\t\terror={formErrors.displayName}\r\n\t\t\t\tresetError={() =>\r\n\t\t\t\t\tsetFormErrors(existing => ({\r\n\t\t\t\t\t\t...existing,\r\n\t\t\t\t\t\tdisplayName: '',\r\n\t\t\t\t\t}))\r\n\t\t\t\t}\r\n\t\t\t\tonLostFocus={() => {\r\n\t\t\t\t\tif (displayName !== '' && displayName.trim().length < 3) {\r\n\t\t\t\t\t\tsetFormErrors(existing => ({\r\n\t\t\t\t\t\t\t...existing,\r\n\t\t\t\t\t\t\tdisplayName: 'Username must be at least 3 characters long',\r\n\t\t\t\t\t\t}))\r\n\t\t\t\t\t}\r\n\t\t\t\t}}\r\n\t\t\t/>\r\n\r\n\t\t\t<Field\r\n\t\t\t\ttype='password'\r\n\t\t\t\tvalue={password}\r\n\t\t\t\tsetValue={setPassword}\r\n\t\t\t\tlabel='Password'\r\n\t\t\t\terror={formErrors.password}\r\n\t\t\t\tresetError={() =>\r\n\t\t\t\t\tsetFormErrors(existing => ({\r\n\t\t\t\t\t\t...existing,\r\n\t\t\t\t\t\tpassword: '',\r\n\t\t\t\t\t}))\r\n\t\t\t\t}\r\n\t\t\t\tonLostFocus={() => {\r\n\t\t\t\t\tif (password !== '' && password.trim().length < 6) {\r\n\t\t\t\t\t\tsetFormErrors(existing => ({\r\n\t\t\t\t\t\t\t...existing,\r\n\t\t\t\t\t\t\tpassword: 'Password must be at least 6 characters long',\r\n\t\t\t\t\t\t}))\r\n\t\t\t\t\t}\r\n\t\t\t\t}}\r\n\t\t\t/>\r\n\r\n\t\t\t{/* <label>\r\n\t\t\t\t\t\t\t<span>Profile thumbnail:</span>\r\n\t\t\t\t\t\t\t<input type='file' required onChange={handleFileChange} />\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t{thumbnailError && <div className='error'>{thumbnailError}</div>}\r\n\t\t\t\t\t\t</label> */}\r\n\r\n\t\t\t{!isPending && (\r\n\t\t\t\t<button className='btn' onClick={() => handleSubmit()}>\r\n\t\t\t\t\tCreate account\r\n\t\t\t\t</button>\r\n\t\t\t)}\r\n\t\t\t{isPending && (\r\n\t\t\t\t<button className='btn' disabled>\r\n\t\t\t\t\tLoading\r\n\t\t\t\t</button>\r\n\t\t\t)}\r\n\r\n\t\t\t<div className='separator mt2 mb2'>\r\n\t\t\t\t<span>or</span>\r\n\t\t\t</div>\r\n\r\n\t\t\t<GoogleButton />\r\n\r\n\t\t\t<GithubButton />\r\n\r\n\t\t\t{error && <div className='error'>{error}</div>}\r\n\t\t</AuthTemplate>\r\n\t)\r\n}\r\n","import { useState, useEffect } from 'react'\r\nimport { projectAuth, projectFirestore, projectStorage, projectGoogle, projectGitHub } from '../firebase/config'\r\nimport { useAuthContext } from './useAuthContext'\r\nimport randomColor from 'randomcolor'\r\n\r\nexport const useSignup = () => {\r\n\tconst [isCancelled, setIsCancelled] = useState(false)\r\n\tconst [error, setError] = useState(null)\r\n\tconst [isPending, setIsPending] = useState(false)\r\n\tconst { dispatch } = useAuthContext()\r\n\r\n\tconst randColor = randomColor()\r\n\r\n\tconst signup = async (email, password, displayName, thumbnail) => {\r\n\t\tsetError(null)\r\n\t\tsetIsPending(true)\r\n\r\n\t\ttry {\r\n\t\t\t// Signup\r\n\t\t\tconst res = await projectAuth.createUserWithEmailAndPassword(email, password)\r\n\r\n\t\t\tif (!res) {\r\n\t\t\t\tthrow new Error('Could not complete signup')\r\n\t\t\t}\r\n\t\t\tlet imgUrl = ''\r\n\r\n\t\t\tif (thumbnail) {\r\n\t\t\t\t// Upload thumbnail\r\n\t\t\t\tconst uploadPath = `thumbnails/${res.user.uid}/${thumbnail.name}`\r\n\t\t\t\tconst img = await projectStorage.ref(uploadPath).put(thumbnail)\r\n\t\t\t\timgUrl = await img.ref.getDownloadURL()\r\n\t\t\t}\r\n\r\n\t\t\t// Add display name to user\r\n\t\t\tawait res.user.updateProfile({ displayName, photoURL: imgUrl })\r\n\r\n\t\t\t// Create a user document\r\n\t\t\tawait projectFirestore\r\n\t\t\t\t.collection('users')\r\n\t\t\t\t.doc(res.user.uid)\r\n\t\t\t\t.set({\r\n\t\t\t\t\tonline: true,\r\n\t\t\t\t\tdisplayName: displayName,\r\n\t\t\t\t\tphotoURL: imgUrl,\r\n\t\t\t\t\tcreatedAt: `${new Date(res.user.metadata.creationTime).toLocaleString('default', {\r\n\t\t\t\t\t\tday: '2-digit',\r\n\t\t\t\t\t\tmonth: 'short',\r\n\t\t\t\t\t\tyear: 'numeric',\r\n\t\t\t\t\t})}`,\r\n\t\t\t\t\tstatus: 'invisible',\r\n\t\t\t\t\tbanner: `${randColor}`,\r\n\t\t\t\t})\r\n\r\n\t\t\t// Dispatch login action\r\n\t\t\tdispatch({ type: 'LOGIN', payload: res.user })\r\n\r\n\t\t\tif (!isCancelled) {\r\n\t\t\t\tsetIsPending(false)\r\n\t\t\t\tsetError(null)\r\n\t\t\t}\r\n\t\t} catch (err) {\r\n\t\t\tif (!isCancelled) {\r\n\t\t\t\tsetError(err.message)\r\n\t\t\t\tsetIsPending(false)\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tconst signInWithGoogle = async () => {\r\n\t\tsetError(null)\r\n\t\tsetIsPending(true)\r\n\r\n\t\ttry {\r\n\t\t\t// Signup\r\n\t\t\tconst res = await projectAuth.signInWithPopup(projectGoogle)\r\n\r\n\t\t\tif (!res) {\r\n\t\t\t\tthrow new Error('Could not complete signup')\r\n\t\t\t}\r\n\r\n\t\t\t// Add display name to user\r\n\t\t\tawait res.user.updateProfile({ displayName: res.user.displayName, photoURL: res.user.photoURL })\r\n\r\n\t\t\t// Create a user document\r\n\t\t\tawait projectFirestore.collection('users').doc(res.user.uid).set({\r\n\t\t\t\tonline: true,\r\n\t\t\t\tdisplayName: res.user.displayName,\r\n\t\t\t\tphotoURL: res.user.photoURL,\r\n\t\t\t})\r\n\r\n\t\t\t// Dispatch login action\r\n\t\t\tdispatch({ type: 'LOGIN', payload: res.user })\r\n\r\n\t\t\tif (!isCancelled) {\r\n\t\t\t\tsetIsPending(false)\r\n\t\t\t\tsetError(null)\r\n\t\t\t}\r\n\t\t} catch (err) {\r\n\t\t\tif (!isCancelled) {\r\n\t\t\t\tsetError(err.message)\r\n\t\t\t\tsetIsPending(false)\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tconst signInWithGithub = async () => {\r\n\t\tsetError(null)\r\n\t\tsetIsPending(true)\r\n\r\n\t\ttry {\r\n\t\t\t// Signup\r\n\t\t\tconst res = await projectAuth.signInWithPopup(projectGitHub)\r\n\r\n\t\t\tif (!res) {\r\n\t\t\t\tthrow new Error('Could not complete signup')\r\n\t\t\t}\r\n\r\n\t\t\t// Add display name to user\r\n\t\t\tawait res.user.updateProfile({ displayName: res.additionalUserInfo.username, photoURL: res.user.photoURL })\r\n\r\n\t\t\t// Create a user document\r\n\t\t\tawait projectFirestore.collection('users').doc(res.user.uid).set({\r\n\t\t\t\tonline: true,\r\n\t\t\t\tdisplayName: res.user.displayName,\r\n\t\t\t\tphotoURL: res.user.photoURL,\r\n\t\t\t})\r\n\r\n\t\t\t// Dispatch login action\r\n\t\t\tdispatch({ type: 'LOGIN', payload: res.user })\r\n\r\n\t\t\tif (!isCancelled) {\r\n\t\t\t\tsetIsPending(false)\r\n\t\t\t\tsetError(null)\r\n\t\t\t}\r\n\t\t} catch (err) {\r\n\t\t\tif (!isCancelled) {\r\n\t\t\t\tsetError(err.message)\r\n\t\t\t\tsetIsPending(false)\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tuseEffect(() => {\r\n\t\treturn () => setIsCancelled(true)\r\n\t}, [])\r\n\r\n\treturn { signup, signInWithGoogle, signInWithGithub, error, isPending }\r\n}\r\n","export default function PrivacyPolicy() {\r\n\treturn (\r\n\t\t<>\r\n\t\t\t<div class='privacy-section'>\r\n\t\t\t\t<h3>Zbieranie danych</h3>\r\n\t\t\t\t<p>Kiedy zbieramy Twoje dane? Twj email oraz haso zapisywane s podczas rejestracji na naszej stronie.</p>\r\n\t\t\t</div>\r\n\r\n\t\t\t<div class='privacy-section'>\r\n\t\t\t\t<h3>Cele przetwarzania danych</h3>\r\n\r\n\t\t\t\t<p>\r\n\t\t\t\t\tTwoje dane zebrane podczas rejestracji przetwarzane s jedynie w celu umoliwienia korzystania ze strony. Nie\r\n\t\t\t\t\tudostpniamy ich nikomu, nie sprzedajemy ich. Rejestracja jest dobrowolna.\r\n\t\t\t\t</p>\r\n\t\t\t</div>\r\n\t\t\t<div class='privacy-section'>\r\n\t\t\t\t<h3>Bezpieczestwo danych</h3>\r\n\r\n\t\t\t\t<p>\r\n\t\t\t\t\tTwoje dane s automatycznie szyfrowane przez usug firebase od google. Nikt nie ma dostpu do twoich danych.\r\n\t\t\t\t</p>\r\n\t\t\t</div>\r\n\t\t\t<div class='privacy-section'>\r\n\t\t\t\t<h3>Usuwanie danych</h3>\r\n\r\n\t\t\t\t<p>\r\n\t\t\t\t\tJeli zrezygnujesz z uywania naszej aplikacji w kadym momencie moesz usun konto oraz swoje dane\r\n\t\t\t\t\t{'(settings => account details => delete account)'}.\r\n\t\t\t\t</p>\r\n\t\t\t</div>\r\n\r\n\t\t\t<div class='privacy-section'>\r\n\t\t\t\t<h3>Pozostae informacje</h3>\r\n\r\n\t\t\t\t<p>\r\n\t\t\t\t\t<span>W razie jakichkolwiek pyta, prosimy o kontakt na adresie mailowym: matkowsky808@gmail.com</span>\r\n\t\t\t\t</p>\r\n\t\t\t</div>\r\n\t\t</>\r\n\t)\r\n}\r\n","export default __webpack_public_path__ + \"static/media/shrek-gif.df094210.gif\";","import { useEffect, useState } from 'react'\r\nimport { useLogin } from '../../../hooks/useLogin'\r\nimport { Link } from 'react-router-dom'\r\n\r\n// Styles & assets\r\nimport ShrekGif from '../../../assets/shrek-gif.gif'\r\n\r\n// Components\r\nimport Field from '../../../components/Inputs/Field/Field'\r\nimport AuthTemplate from '../AuthTemplate'\r\n\r\nexport default function ResetPassword() {\r\n\tconst { sendPasswordReset, isPending, error, isFinished } = useLogin()\r\n\r\n\tconst [email, setEmail] = useState('')\r\n\tconst [timeToRedirect, setTimeToRedirect] = useState(15)\r\n\r\n\tconst [formErrors, setFormErrors] = useState({\r\n\t\temail: '',\r\n\t})\r\n\r\n\tconst handlePasswordReset = () => {\r\n\t\tif (!email.match(/^[a-zA-Z0-9.!#$%&*+/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\\.[a-zA-Z0-9-]+)*$/)) {\r\n\t\t\tsetFormErrors(existing => ({\r\n\t\t\t\t...existing,\r\n\t\t\t\temail: 'Enter a valid email',\r\n\t\t\t}))\r\n\t\t\treturn\r\n\t\t}\r\n\r\n\t\tsendPasswordReset(email)\r\n\t}\r\n\r\n\tuseEffect(() => {\r\n\t\tif (isFinished === true) {\r\n\t\t\tcountdown()\r\n\t\t}\r\n\t}, [isFinished])\r\n\r\n\tconst countdown = () => {\r\n\t\tlet redirectCountdown = setInterval(() => {\r\n\t\t\tif (timeToRedirect <= 0) {\r\n\t\t\t\tclearInterval(redirectCountdown)\r\n\t\t\t} else {\r\n\t\t\t\tsetTimeToRedirect(prevTimeToRedirect => prevTimeToRedirect - 1)\r\n\t\t\t}\r\n\t\t}, 1000)\r\n\t}\r\n\r\n\treturn (\r\n\t\t<AuthTemplate>\r\n\t\t\t{isFinished && (\r\n\t\t\t\t<div className='text-center auth__form-email-sent'>\r\n\t\t\t\t\t<img src={ShrekGif} alt='shrek' />\r\n\r\n\t\t\t\t\t<div className='auth__form-title'>\r\n\t\t\t\t\t\t<h2>Check your email</h2>\r\n\t\t\t\t\t\t<p>A password reset email has been sent to your email address</p>\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t<p className='auth__change-page'>\r\n\t\t\t\t\t\tGo back to <Link to='/login'>Login</Link>\r\n\t\t\t\t\t</p>\r\n\r\n\t\t\t\t\t<p className='redirect'>Redirecting in {timeToRedirect} s</p>\r\n\t\t\t\t</div>\r\n\t\t\t)}\r\n\r\n\t\t\t{!isFinished && (\r\n\t\t\t\t<>\r\n\t\t\t\t\t<div className='auth__form-title'>\r\n\t\t\t\t\t\t<h2>Forgot password?</h2>\r\n\t\t\t\t\t\t<p>Enter your email below to recieve password reset instructions</p>\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t<Field\r\n\t\t\t\t\t\ttype='email'\r\n\t\t\t\t\t\tvalue={email}\r\n\t\t\t\t\t\tsetValue={setEmail}\r\n\t\t\t\t\t\tlabel='Email'\r\n\t\t\t\t\t\terror={formErrors.email}\r\n\t\t\t\t\t\tresetError={() =>\r\n\t\t\t\t\t\t\tsetFormErrors(existing => ({\r\n\t\t\t\t\t\t\t\t...existing,\r\n\t\t\t\t\t\t\t\temail: '',\r\n\t\t\t\t\t\t\t}))\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tonLostFocus={() => {\r\n\t\t\t\t\t\t\tif (\r\n\t\t\t\t\t\t\t\temail !== '' &&\r\n\t\t\t\t\t\t\t\t!email.match(/^[a-zA-Z0-9.!#$%&*+/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\\.[a-zA-Z0-9-]+)*$/)\r\n\t\t\t\t\t\t\t) {\r\n\t\t\t\t\t\t\t\tsetFormErrors(existing => ({\r\n\t\t\t\t\t\t\t\t\t...existing,\r\n\t\t\t\t\t\t\t\t\temail: 'Please enter a valid email address',\r\n\t\t\t\t\t\t\t\t}))\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t\thelpText='Eg. icecream@gmail.com'\r\n\t\t\t\t\t/>\r\n\r\n\t\t\t\t\t{!isPending && (\r\n\t\t\t\t\t\t<button className='btn forgot-password' onClick={() => handlePasswordReset()}>\r\n\t\t\t\t\t\t\tSend reset link\r\n\t\t\t\t\t\t</button>\r\n\t\t\t\t\t)}\r\n\t\t\t\t\t{isPending && (\r\n\t\t\t\t\t\t<button className='btn forgot-password' disabled>\r\n\t\t\t\t\t\t\tSending email...\r\n\t\t\t\t\t\t</button>\r\n\t\t\t\t\t)}\r\n\r\n\t\t\t\t\t<p className='auth__change-page'>\r\n\t\t\t\t\t\tNo longer have Alzheimer? <Link to='/login'>Login</Link>\r\n\t\t\t\t\t</p>\r\n\r\n\t\t\t\t\t{error && <div className='error'>{error}</div>}\r\n\t\t\t\t</>\r\n\t\t\t)}\r\n\t\t</AuthTemplate>\r\n\t)\r\n}\r\n","import { useState } from 'react'\r\nimport { useLogin } from '../../../hooks/useLogin'\r\nimport { Link } from 'react-router-dom'\r\nimport { useQuery } from '../../../hooks/useQuery'\r\n\r\n// Styles & assets\r\nimport ShrekGif from '../../../assets/shrek-gif.gif'\r\n\r\n// Components\r\nimport AuthTemplate from '../AuthTemplate'\r\nimport Field from '../../../components/Inputs/Field/Field'\r\n\r\nexport default function SetNewPassword() {\r\n\tconst { resetPassword, isPending, error, isFinished } = useLogin()\r\n\r\n\tconst [newPassword, setNewPassword] = useState('')\r\n\r\n\tconst oobCode = useQuery('oobCode')\r\n\r\n\tconst handleSubmit = async () => {\r\n\t\tif (newPassword.trim().length < 6) {\r\n\t\t\tsetFormErrors(existing => ({\r\n\t\t\t\t...existing,\r\n\t\t\t\tpassword: 'Password must be at least 6 characters long',\r\n\t\t\t}))\r\n\t\t\treturn\r\n\t\t}\r\n\r\n\t\tawait resetPassword(oobCode, newPassword)\r\n\t}\r\n\r\n\tconst [formErrors, setFormErrors] = useState({\r\n\t\tpassword: '',\r\n\t})\r\n\r\n\treturn (\r\n\t\t<AuthTemplate>\r\n\t\t\t{isFinished && (\r\n\t\t\t\t<div className='auth__form-email-sent'>\r\n\t\t\t\t\t<img src={ShrekGif} alt='' />\r\n\t\t\t\t\t<div className='auth__form-title'>\r\n\t\t\t\t\t\t<h2>Password set successfully</h2>\r\n\t\t\t\t\t\t<p>You can now log in with your new password</p>\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t<Link to='/login'>\r\n\t\t\t\t\t\t<button className='btn'>Back to Login</button>\r\n\t\t\t\t\t</Link>\r\n\r\n\t\t\t\t\t<p className='auth__change-page'>\r\n\t\t\t\t\t\tNow log in and remember your password. <Link to='/login'> Login</Link>\r\n\t\t\t\t\t</p>\r\n\t\t\t\t</div>\r\n\t\t\t)}\r\n\r\n\t\t\t{!isFinished && (\r\n\t\t\t\t<>\r\n\t\t\t\t\t<div className='auth__form-title'>\r\n\t\t\t\t\t\t<h2>Set a new password</h2>\r\n\t\t\t\t\t\t<p>Enter a password that you will remember this time...</p>\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t<Field\r\n\t\t\t\t\t\ttype='password'\r\n\t\t\t\t\t\tvalue={newPassword}\r\n\t\t\t\t\t\tsetValue={setNewPassword}\r\n\t\t\t\t\t\tlabel='New Password'\r\n\t\t\t\t\t\terror={formErrors.password}\r\n\t\t\t\t\t\tresetError={() =>\r\n\t\t\t\t\t\t\tsetFormErrors(existing => ({\r\n\t\t\t\t\t\t\t\t...existing,\r\n\t\t\t\t\t\t\t\tpassword: '',\r\n\t\t\t\t\t\t\t}))\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tonLostFocus={() => {\r\n\t\t\t\t\t\t\tif (newPassword !== '' && newPassword.trim().length < 6) {\r\n\t\t\t\t\t\t\t\tsetFormErrors(existing => ({\r\n\t\t\t\t\t\t\t\t\t...existing,\r\n\t\t\t\t\t\t\t\t\tpassword: 'Password must be at least 6 characters long',\r\n\t\t\t\t\t\t\t\t}))\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t/>\r\n\r\n\t\t\t\t\t{!isPending && (\r\n\t\t\t\t\t\t<button className='btn mb1' onClick={() => handleSubmit()}>\r\n\t\t\t\t\t\t\tReset password\r\n\t\t\t\t\t\t</button>\r\n\t\t\t\t\t)}\r\n\t\t\t\t\t{isPending && (\r\n\t\t\t\t\t\t<button className='btn mb1' disabled>\r\n\t\t\t\t\t\t\tSetting new password...\r\n\t\t\t\t\t\t</button>\r\n\t\t\t\t\t)}\r\n\r\n\t\t\t\t\t<p className='auth__change-page'>\r\n\t\t\t\t\t\t<Link to='/login'>Login</Link> instead?\r\n\t\t\t\t\t</p>\r\n\r\n\t\t\t\t\t{error && <div className='error'>{error}</div>}\r\n\t\t\t\t</>\r\n\t\t\t)}\r\n\t\t</AuthTemplate>\r\n\t)\r\n}\r\n","import { useLocation } from 'react-router-dom'\r\n\r\nexport const useQuery = queryName => {\r\n\tconst location = useLocation()\r\n\tconst query = new URLSearchParams(location.search).get(queryName)\r\n\treturn query\r\n}\r\n","import React from 'react'\r\nimport { NavLink } from 'react-router-dom'\r\nimport { useAuthContext } from '../../hooks/useAuthContext'\r\nimport formatDistanceToNowStrict from 'date-fns/formatDistanceToNow'\r\n\r\n// Styles && Assets\r\nimport './ChatsList.scss'\r\n\r\n// Components\r\nimport AvatarWithStatus from '../AvatarWithStatus/AvatarWithStatus'\r\n\r\nexport default function ChatsList({ chats, inputRef, setShowChat }) {\r\n\tconst { user } = useAuthContext()\r\n\r\n\tconst replaceDistanceToNow = {\r\n\t\tabout: '',\r\n\t\tminute: 'min',\r\n\t\tminutes: 'min',\r\n\t\t'less than a minute': '1 min',\r\n\t}\r\n\r\n\tconst focusInput = () => {\r\n\t\tif (inputRef.current !== null) {\r\n\t\t\tinputRef.current.focus()\r\n\t\t}\r\n\t}\r\n\r\n\tconst handleSeen = chat => {\r\n\t\tlet res = false\r\n\r\n\t\tif (chat.messages && chat.messages[chat.messages.length - 1]) {\r\n\t\t\tchat.assignedUsers.forEach(u => {\r\n\t\t\t\tif (u.id === user.uid && u.lastRead !== chat.messages[chat.messages.length - 1].id) {\r\n\t\t\t\t\tres = true\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t}\r\n\r\n\t\treturn res\r\n\t}\r\n\r\n\treturn (\r\n\t\t<div className='chats__list custom-scrollbar'>\r\n\t\t\t{chats.length === 0 && <p>No chats yet!</p>}\r\n\t\t\t{chats.map(chat => (\r\n\t\t\t\t<NavLink\r\n\t\t\t\t\tto={`/u/${chat.id}`}\r\n\t\t\t\t\tkey={chat.id}\r\n\t\t\t\t\tclassName={`chats__list-chat ${handleSeen(chat) ? 'unread' : ''}`}\r\n\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\tfocusInput()\r\n\t\t\t\t\t\tsetShowChat(true)\r\n\t\t\t\t\t}}>\r\n\t\t\t\t\t{chat.assignedUsers.map(\r\n\t\t\t\t\t\tu =>\r\n\t\t\t\t\t\t\tu.id !== user.uid && (\r\n\t\t\t\t\t\t\t\t<React.Fragment key={u.id}>\r\n\t\t\t\t\t\t\t\t\t<AvatarWithStatus userId={u.id} />\r\n\t\t\t\t\t\t\t\t\t<div className='flex-column justify-center'>\r\n\t\t\t\t\t\t\t\t\t\t<p className='display-name'>\r\n\t\t\t\t\t\t\t\t\t\t\t{u.nickname.substring(0, 18)}\r\n\t\t\t\t\t\t\t\t\t\t\t<span>{u.nickname.length >= 18 && '...'}</span>\r\n\t\t\t\t\t\t\t\t\t\t</p>\r\n\r\n\t\t\t\t\t\t\t\t\t\t<div className='last-chat'>\r\n\t\t\t\t\t\t\t\t\t\t\t<span className='last-message text-clip'>\r\n\t\t\t\t\t\t\t\t\t\t\t\t{chat.messages.length !== 0 && (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{chat &&\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tchat.messages[chat.messages.length - 1] &&\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tchat.messages[chat.messages.length - 1].createdBy === user.uid &&\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t'You: '}\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{chat.messages[chat.messages.length - 1].content &&\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tchat.messages[chat.messages.length - 1].fileType === undefined &&\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tchat.messages[chat.messages.length - 1].content.substring(0, 15)}\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{!chat.messages[chat.messages.length - 1].content &&\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tchat.messages[chat.messages.length - 1].fileType === 'image' &&\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t`sent a photo`}\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{!chat.messages[chat.messages.length - 1].content &&\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tchat.messages[chat.messages.length - 1].fileType === 'video' &&\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t`sent a video`}\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{chat.messages[chat.messages.length - 1].content &&\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tchat.messages[chat.messages.length - 1].content.length >= 15 &&\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t'...'}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</>\r\n\t\t\t\t\t\t\t\t\t\t\t\t)}\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t{chat.messages.length === 0 && 'No messages yet'}\r\n\t\t\t\t\t\t\t\t\t\t\t</span>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t{chat.messages.length !== 0 && (\r\n\t\t\t\t\t\t\t\t\t\t\t\t<>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<div className='dot'></div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<span className='comment-date'>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{formatDistanceToNowStrict(chat.messages[chat.messages.length - 1].createdAt.toDate(), {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\taddSuffix: false,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t}).replace(\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t/\\b(?:about|less than a minute|minute|minutes)\\b/gi,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tmatched => replaceDistanceToNow[matched]\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</>\r\n\t\t\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t</React.Fragment>\r\n\t\t\t\t\t\t\t)\r\n\t\t\t\t\t)}\r\n\t\t\t\t</NavLink>\r\n\t\t\t))}\r\n\t\t</div>\r\n\t)\r\n}\r\n","import React, { useEffect, useState } from 'react'\r\nimport { useFirestore } from '../../hooks/useFirestore'\r\nimport { useDocument } from '../../hooks/useDocument'\r\nimport { useCollection } from '../../hooks/useCollection'\r\nimport { useAuthContext } from '../../hooks/useAuthContext'\r\n\r\n// Styles\r\nimport './Pinned.scss'\r\n\r\n// Components\r\nimport { DragDropContext, Draggable, Droppable } from 'react-beautiful-dnd'\r\nimport { Link } from 'react-router-dom'\r\nimport Modal from '../Modal/Modal'\r\nimport Avatar from '../Avatar/Avatar'\r\n\r\nconst Pinned = ({ orientation }) => {\r\n\tconst { user } = useAuthContext()\r\n\tconst { documents: chats } = useCollection(\r\n\t\t'projects',\r\n\t\t['assignedUsersId', 'array-contains', user.uid],\r\n\t\t['updatedAt', 'desc']\r\n\t)\r\n\tconst { updateDocument } = useFirestore('users')\r\n\tconst { documents: users } = useCollection('users')\r\n\tconst { document: userDoc } = useDocument('users', user.uid)\r\n\r\n\tconst [favs, setFavs] = useState([])\r\n\tconst [showFavs, setShowFavs] = useState(false)\r\n\tconst [searchValue, setSearchValue] = useState('')\r\n\tconst [favsCopy, setFavsCopy] = useState(favs)\r\n\r\n\tuseEffect(() => {\r\n\t\tif (chats && chats !== null && chats.length !== 0) {\r\n\t\t\tif (userDoc && userDoc.pinned) {\r\n\t\t\t\tsetFavs(userDoc.pinned)\r\n\t\t\t} else {\r\n\t\t\t\tsetFavs([null, null, null, null])\r\n\t\t\t}\r\n\t\t}\r\n\t}, [chats, userDoc])\r\n\r\n\tuseEffect(() => {\r\n\t\tif (userDoc && userDoc.pinned !== null) {\r\n\t\t\tsetFavs(userDoc.pinned)\r\n\t\t}\r\n\t}, [userDoc])\r\n\r\n\tconst getDoc = id => {\r\n\t\tlet res = null\r\n\r\n\t\tif (users) {\r\n\t\t\tres = users.filter(doc => {\r\n\t\t\t\tif (doc.id === id) {\r\n\t\t\t\t\treturn true\r\n\t\t\t\t}\r\n\t\t\t\treturn false\r\n\t\t\t})[0]\r\n\t\t}\r\n\r\n\t\treturn res\r\n\t}\r\n\r\n\tconst filterChats = chat => {\r\n\t\tlet result = false\r\n\t\tif (favsCopy) {\r\n\t\t\tfavsCopy.forEach(fav => {\r\n\t\t\t\tif (fav !== null) {\r\n\t\t\t\t\tif (fav.id === chat.id) {\r\n\t\t\t\t\t\tresult = true\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t}\r\n\t\treturn result\r\n\t}\r\n\r\n\tconst handleOnDragEnd = async result => {\r\n\t\tif (!result.destination) return\r\n\t\tconst items = Array.from(favs)\r\n\t\tconst [reorderedItem] = items.splice(result.source.index, 1)\r\n\t\titems.splice(result.destination.index, 0, reorderedItem)\r\n\r\n\t\tsetFavs(items)\r\n\t\tawait updateDocument(user.uid, {\r\n\t\t\tpinned: items,\r\n\t\t})\r\n\t}\r\n\r\n\tconst handleOnDragEndCopy = result => {\r\n\t\tif (!result.destination) return\r\n\r\n\t\tif (result.source.droppableId === result.destination.droppableId && result.source.droppableId === 'manage-favs') {\r\n\t\t\tconst items = Array.from(favsCopy)\r\n\t\t\tconst [reorderedItem] = items.splice(result.source.index, 1)\r\n\t\t\titems.splice(result.destination.index, 0, reorderedItem)\r\n\t\t\tsetFavsCopy(items)\r\n\t\t}\r\n\r\n\t\tif (result.destination.droppableId === 'empty-slots') {\r\n\t\t\tconst favs = Array.from(favsCopy)\r\n\t\t\tconst items = Array.from(chats.filter(chat => !filterChats(chat)))\r\n\r\n\t\t\tconst chatToAdd = items[result.source.index]\r\n\t\t\tlet userToAdd\r\n\t\t\tlet index\r\n\r\n\t\t\tif (!chatToAdd.isGroup) {\r\n\t\t\t\tchatToAdd.assignedUsers.forEach(u => {\r\n\t\t\t\t\tif (u.id !== user.uid) {\r\n\t\t\t\t\t\tuserToAdd = {\r\n\t\t\t\t\t\t\tid: chatToAdd.id,\r\n\t\t\t\t\t\t\tuid: u.id,\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t}\r\n\r\n\t\t\tfavs.forEach(item => {\r\n\t\t\t\tif (item === null) {\r\n\t\t\t\t\tindex = favsCopy.indexOf(item)\r\n\t\t\t\t}\r\n\t\t\t})\r\n\r\n\t\t\tfavs.splice(index, 1, userToAdd)\r\n\r\n\t\t\tsetFavsCopy(favs)\r\n\t\t}\r\n\t}\r\n\r\n\tconst handleRemoveFav = fav => {\r\n\t\tconst items = Array.from(favsCopy)\r\n\t\t// const [reorderedItem] = items.splice(favs.indexOf(fav), 1)\r\n\t\titems.splice(favsCopy.indexOf(fav), 1)\r\n\t\titems.push(null)\r\n\r\n\t\tsetFavsCopy(items)\r\n\t}\r\n\r\n\tconst addFav = chat => {\r\n\t\tconst items = Array.from(favsCopy)\r\n\t\tlet index\r\n\t\tlet userToAdd\r\n\r\n\t\tif (!chat.isGroup) {\r\n\t\t\tchat.assignedUsers.forEach(u => {\r\n\t\t\t\tif (u.id !== user.uid) {\r\n\t\t\t\t\tuserToAdd = {\r\n\t\t\t\t\t\tid: chat.id,\r\n\t\t\t\t\t\tuid: u.id,\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t}\r\n\r\n\t\titems.forEach(item => {\r\n\t\t\tif (item === null) {\r\n\t\t\t\tindex = favsCopy.indexOf(item)\r\n\t\t\t}\r\n\t\t})\r\n\r\n\t\titems.splice(index, 1, userToAdd)\r\n\t\tsetFavsCopy(items)\r\n\t}\r\n\r\n\treturn (\r\n\t\t<>\r\n\t\t\t<DragDropContext onDragEnd={handleOnDragEnd}>\r\n\t\t\t\t<Droppable droppableId='favourites' direction={orientation === 'horizontal' ? 'horizontal' : 'vertical'}>\r\n\t\t\t\t\t{provided => (\r\n\t\t\t\t\t\t<div className={`pinned ${orientation}`} {...provided.droppableProps} ref={provided.innerRef}>\r\n\t\t\t\t\t\t\t{favs &&\r\n\t\t\t\t\t\t\t\tfavs.map(\r\n\t\t\t\t\t\t\t\t\t(f, index) =>\r\n\t\t\t\t\t\t\t\t\t\tf !== null && (\r\n\t\t\t\t\t\t\t\t\t\t\t<Draggable key={f.id} draggableId={f.id} index={index}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t{provided => (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Link\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tto={`/u/${f.id}`}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tdraggable='true'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{...provided.draggableProps}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{...provided.dragHandleProps}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tref={provided.innerRef}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Avatar src={getDoc(f.uid) ? getDoc(f.uid).photoURL : ''} />\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</Link>\r\n\t\t\t\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t\t\t\t</Draggable>\r\n\t\t\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t{provided.placeholder}\r\n\t\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\t\tclassName='pinned__add'\r\n\t\t\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\t\t\tsetShowFavs(true)\r\n\t\t\t\t\t\t\t\t\tsetFavsCopy(favs)\r\n\t\t\t\t\t\t\t\t}}>\r\n\t\t\t\t\t\t\t\t<i className='fa-regular fa-star'></i>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t)}\r\n\t\t\t\t</Droppable>\r\n\t\t\t</DragDropContext>\r\n\r\n\t\t\t<Modal show={showFavs} setShow={() => setShowFavs(false)}>\r\n\t\t\t\t<div className='pinned__modal'>\r\n\t\t\t\t\t<DragDropContext onDragEnd={handleOnDragEndCopy}>\r\n\t\t\t\t\t\t<Droppable droppableId='manage-favs' direction='horizontal' type='manage-favs'>\r\n\t\t\t\t\t\t\t{provided => (\r\n\t\t\t\t\t\t\t\t<div className='pinned__modal-current-favs' {...provided.droppableProps} ref={provided.innerRef}>\r\n\t\t\t\t\t\t\t\t\t{favsCopy &&\r\n\t\t\t\t\t\t\t\t\t\tfavsCopy.map(\r\n\t\t\t\t\t\t\t\t\t\t\t(f, index) =>\r\n\t\t\t\t\t\t\t\t\t\t\t\tf !== null && (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Draggable key={f.id} draggableId={f.id} index={index} type='FAVS-LIST'>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{provided => (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclassName='fav'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{...provided.draggableProps}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{...provided.dragHandleProps}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tdraggable='true'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tref={provided.innerRef}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Avatar src={getDoc(f.uid) ? getDoc(f.uid).photoURL : ''} />\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclassName='fav__remove'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\thandleRemoveFav(f)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<i className='fa-solid fa-xmark'></i>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</Draggable>\r\n\t\t\t\t\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\t\t\t)}\r\n\r\n\t\t\t\t\t\t\t\t\t{provided.placeholder}\r\n\r\n\t\t\t\t\t\t\t\t\t{favsCopy && favsCopy.includes(null) && (\r\n\t\t\t\t\t\t\t\t\t\t<Droppable droppableId='empty-slots' direction='horizontal'>\r\n\t\t\t\t\t\t\t\t\t\t\t{provided => (\r\n\t\t\t\t\t\t\t\t\t\t\t\t<div className='flex-row' {...provided.droppableProps} ref={provided.innerRef}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t{favsCopy.map(\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t(f, index) =>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tf === null && (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<React.Fragment key={index}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div className='fav fav--empty'>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<i className='fa-regular fa-star'></i>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{provided.placeholder}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</React.Fragment>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t\t\t</Droppable>\r\n\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t</Droppable>\r\n\r\n\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t<input\r\n\t\t\t\t\t\t\t\ttype='text'\r\n\t\t\t\t\t\t\t\tplaceholder='Find a user'\r\n\t\t\t\t\t\t\t\tvalue={searchValue}\r\n\t\t\t\t\t\t\t\tonChange={e => setSearchValue(e.target.value)}\r\n\t\t\t\t\t\t\t\tclassName='mb1'\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t<Droppable droppableId='chats-list' isDropDisabled={true}>\r\n\t\t\t\t\t\t\t\t{provided => (\r\n\t\t\t\t\t\t\t\t\t<ul\r\n\t\t\t\t\t\t\t\t\t\tclassName='pinned__modal-chats-list custom-scrollbar'\r\n\t\t\t\t\t\t\t\t\t\t{...provided.droppableProps}\r\n\t\t\t\t\t\t\t\t\t\tref={provided.innerRef}>\r\n\t\t\t\t\t\t\t\t\t\t{chats &&\r\n\t\t\t\t\t\t\t\t\t\t\tchats\r\n\t\t\t\t\t\t\t\t\t\t\t\t.filter(chat => !filterChats(chat))\r\n\t\t\t\t\t\t\t\t\t\t\t\t.map((chat, index) => (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<React.Fragment key={chat.id}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{/* Code for groups */}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{/* {chat.isGroup &&\r\n                                                    chat.groupName\r\n                                                        .toLowerCase()\r\n                                                        .trim()\r\n                                                        .replace(/\\s+/g, '')\r\n                                                        .includes(searchValue.toLowerCase()) && (\r\n                                                        <li key={chat.id}>\r\n                                                            <Avatar src={chat.photoURL} />\r\n                                                            <p>{chat.displayName}</p>\r\n                                                        </li>\r\n                                                    )} */}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{!chat.isGroup &&\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tchat.assignedUsers.map(\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tu =>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tu.id !== user.uid &&\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tgetDoc(u.id) !== null &&\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tgetDoc(u.id)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t.displayName.toLowerCase()\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t.trim()\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t.replace(/\\s+/g, '')\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t.includes(searchValue.toLowerCase()) && (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Draggable key={u.id} draggableId={u.id} index={index}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{(provided, snapshot) => (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<li\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tkey={chat.id}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclassName={`${snapshot.isDragging ? 'dragged' : ''} ${\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tsnapshot.draggingOver === 'empty-slots' ? 'hover-over-slot' : ''\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}`}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tonClick={() => addFav(chat)}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tstyle={{ width: '10px !important' }}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{...provided.draggableProps}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tref={provided.innerRef}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div className='flex-row'>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{!snapshot.isDragging && (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Avatar src={getDoc(u.id) ? getDoc(u.id).photoURL : ''} />\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{!snapshot.isDragging && (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<p>{getDoc(u.id) ? getDoc(u.id).displayName : ''}</p>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div className='handle' {...provided.dragHandleProps}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{!snapshot.isDragging && <i className='fa-solid fa-grip-vertical'></i>}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{snapshot.isDragging && (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Avatar src={getDoc(u.id) ? getDoc(u.id).photoURL : ''} />\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</li>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</Draggable>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</React.Fragment>\r\n\t\t\t\t\t\t\t\t\t\t\t\t))}\r\n\t\t\t\t\t\t\t\t\t\t{provided.placeholder}\r\n\t\t\t\t\t\t\t\t\t</ul>\r\n\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t</Droppable>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</DragDropContext>\r\n\r\n\t\t\t\t\t<div className='btn-group'>\r\n\t\t\t\t\t\t<div className='btn btn--secondary' onClick={() => setShowFavs(false)}>\r\n\t\t\t\t\t\t\tcancel\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\tclassName='btn'\r\n\t\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\t\tupdateDocument(user.uid, {\r\n\t\t\t\t\t\t\t\t\tpinned: favsCopy,\r\n\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\tsetShowFavs(false)\r\n\t\t\t\t\t\t\t}}>\r\n\t\t\t\t\t\t\tfinish\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t</Modal>\r\n\t\t</>\r\n\t)\r\n}\r\n\r\nexport default Pinned\r\n","import React, { useState } from 'react'\r\nimport { useCollection } from '../../hooks/useCollection'\r\nimport { useAuthContext } from '../../hooks/useAuthContext'\r\nimport { Link } from 'react-router-dom'\r\n\r\n// Styles\r\nimport './Chats.scss'\r\n\r\n// Compontents\r\nimport ChatsList from './ChatsList'\r\nimport Avatar from '../Avatar/Avatar'\r\nimport AvatarWithStatus from '../AvatarWithStatus/AvatarWithStatus'\r\nimport MediaQuery from 'react-responsive'\r\nimport Pinned from '../Pinned/Pinned'\r\n\r\nexport default function Chats({ currentChat, inputRef, setShowChat }) {\r\n\tconst { user } = useAuthContext()\r\n\tconst { documents: users } = useCollection('users')\r\n\tconst { documents: chats } = useCollection(\r\n\t\t'projects',\r\n\t\t['assignedUsersId', 'array-contains', user.uid],\r\n\t\t['updatedAt', 'desc']\r\n\t)\r\n\r\n\tconst [query, setQuery] = useState('')\r\n\r\n\tconst getDoc = id => {\r\n\t\tlet res = null\r\n\r\n\t\tif (users) {\r\n\t\t\tres = users.filter(doc => {\r\n\t\t\t\tif (doc.id === id) {\r\n\t\t\t\t\treturn true\r\n\t\t\t\t}\r\n\t\t\t\treturn false\r\n\t\t\t})[0]\r\n\t\t}\r\n\r\n\t\treturn res\r\n\t}\r\n\r\n\tconst filterChats = chat => {\r\n\t\tlet result = false\r\n\t\t// chat.displayName.toLowerCase().trim().replace(/\\s+/g, '').includes(query.toLowerCase())\r\n\r\n\t\tchat.assignedUsers.forEach(u => {\r\n\t\t\tif (u.id !== user.uid) {\r\n\t\t\t\tif (\r\n\t\t\t\t\tgetDoc(u.id).displayName.toLowerCase().trim().replace(/\\s+/g, '').includes(query.toLowerCase()) ||\r\n\t\t\t\t\t(u.nickname && u.nickname.toLowerCase().trim().replace(/\\s+/g, '').includes(query.toLowerCase()))\r\n\t\t\t\t) {\r\n\t\t\t\t\tresult = true\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t})\r\n\r\n\t\treturn result\r\n\t}\r\n\r\n\treturn (\r\n\t\t<div className='chats'>\r\n\t\t\t<div className='page-title'>\r\n\t\t\t\t<h2>Chats</h2>\r\n\t\t\t\t<MediaQuery maxWidth={768}>\r\n\t\t\t\t\t<Link to={`/profile/${user.uid}`}>\r\n\t\t\t\t\t\t<AvatarWithStatus userId={user.uid} linkToProfile={false} noTooltip={true} />\r\n\t\t\t\t\t</Link>\r\n\t\t\t\t</MediaQuery>\r\n\t\t\t</div>\r\n\r\n\t\t\t<MediaQuery maxWidth={768}>\r\n\t\t\t\t<Pinned orientation='horizontal' />\r\n\t\t\t</MediaQuery>\r\n\r\n\t\t\t<label className='chats__search-bar'>\r\n\t\t\t\t<i className='fa-solid fa-magnifying-glass'></i>\r\n\t\t\t\t<input type='text' placeholder='Find a user' onChange={e => setQuery(e.target.value)} value={query} />\r\n\t\t\t</label>\r\n\r\n\t\t\t{query !== '' && (\r\n\t\t\t\t<>\r\n\t\t\t\t\t<div className='chats__filtered'>\r\n\t\t\t\t\t\t{chats &&\r\n\t\t\t\t\t\t\tchats\r\n\t\t\t\t\t\t\t\t.filter(chat => filterChats(chat))\r\n\t\t\t\t\t\t\t\t.map(chat =>\r\n\t\t\t\t\t\t\t\t\tchat.assignedUsers.map(\r\n\t\t\t\t\t\t\t\t\t\tu =>\r\n\t\t\t\t\t\t\t\t\t\t\tu.id !== user.uid && (\r\n\t\t\t\t\t\t\t\t\t\t\t\t<Link\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tto={`/u/${chat.id}`}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tkey={u.id}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tclassName='chats__filtered-user'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tsetQuery('')\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t}}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Avatar src={getDoc(u.id).photoURL} />\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<span>{getDoc(u.id).displayName}</span>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</Link>\r\n\t\t\t\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</>\r\n\t\t\t)}\r\n\r\n\t\t\t{query === '' && chats && (\r\n\t\t\t\t<ChatsList chats={chats} currentChat={currentChat} inputRef={inputRef} setShowChat={setShowChat} />\r\n\t\t\t)}\r\n\t\t</div>\r\n\t)\r\n}\r\n","import React, { useEffect } from 'react'\r\nimport { useState } from 'react'\r\nimport { NavLink, useLocation } from 'react-router-dom'\r\nimport { useAuthContext } from '../../hooks/useAuthContext'\r\nimport { useCollection } from '../../hooks/useCollection'\r\nimport { useDocument } from '../../hooks/useDocument'\r\n\r\n// Styles\r\nimport './ToolBar.scss'\r\nimport AvatarWithStatus from '../AvatarWithStatus/AvatarWithStatus'\r\nimport ProfilePreview from '../ProfilePreview/ProfilePreview'\r\nimport Pinned from '../Pinned/Pinned'\r\n\r\nconst ToolBar = () => {\r\n\tconst location = useLocation()\r\n\r\n\tconst { user } = useAuthContext()\r\n\tconst { documents: chats } = useCollection(\r\n\t\t'projects',\r\n\t\t['assignedUsersId', 'array-contains', user.uid],\r\n\t\t['updatedAt', 'desc']\r\n\t)\r\n\tconst { document: userDoc } = useDocument('users', user.uid)\r\n\r\n\tconst [latestChat, setLatestChat] = useState()\r\n\tconst [currentPath, setCurrentPath] = useState('')\r\n\tconst [showProfile, setShowProfile] = useState(false)\r\n\tconst [invitesAmount, setInvitesAmount] = useState(0)\r\n\r\n\tuseEffect(() => {\r\n\t\tif (chats && chats !== null && chats.length !== 0) {\r\n\t\t\tsetLatestChat(chats[0])\r\n\t\t} else {\r\n\t\t\tsetLatestChat('')\r\n\t\t}\r\n\t}, [chats, userDoc])\r\n\r\n\tuseEffect(() => {\r\n\t\tsetCurrentPath(location.pathname)\r\n\t}, [location])\r\n\r\n\tuseEffect(() => {\r\n\t\tif (userDoc && userDoc.friends) {\r\n\t\t\tsetInvitesAmount(\r\n\t\t\t\tuserDoc.friends.filter(f => {\r\n\t\t\t\t\tif (f.isPending) return true\r\n\t\t\t\t\treturn false\r\n\t\t\t\t}).length\r\n\t\t\t)\r\n\t\t}\r\n\t}, [userDoc])\r\n\r\n\treturn (\r\n\t\tuserDoc && (\r\n\t\t\t<div className='tool-bar'>\r\n\t\t\t\t<nav className='tool-bar__pages'>\r\n\t\t\t\t\t<NavLink to={`/u/${latestChat && latestChat.id}`} className={currentPath.includes('/u/') ? 'active' : ''}>\r\n\t\t\t\t\t\t<i className='fa-solid fa-comment'></i>\r\n\t\t\t\t\t</NavLink>\r\n\t\t\t\t\t<NavLink to='/'>\r\n\t\t\t\t\t\t<i className='fa-solid fa-house'></i>\r\n\t\t\t\t\t</NavLink>\r\n\t\t\t\t\t<NavLink to='/friends' className='friends'>\r\n\t\t\t\t\t\t<i className='fa-solid fa-address-book'></i>\r\n\t\t\t\t\t\t{invitesAmount > 0 && (\r\n\t\t\t\t\t\t\t<div className='pending-indicator'>\r\n\t\t\t\t\t\t\t\t<p>{invitesAmount}</p>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t</NavLink>\r\n\r\n\t\t\t\t\t<NavLink\r\n\t\t\t\t\t\tto='/settings/account-details'\r\n\t\t\t\t\t\tclassName={`${\r\n\t\t\t\t\t\t\t[\r\n\t\t\t\t\t\t\t\t'/settings/account-details',\r\n\t\t\t\t\t\t\t\t'/settings/profile',\r\n\t\t\t\t\t\t\t\t'/settings/theme',\r\n\t\t\t\t\t\t\t\t'/settings',\r\n\t\t\t\t\t\t\t\t'/settings/',\r\n\t\t\t\t\t\t\t\t'/settings/become-cool',\r\n\t\t\t\t\t\t\t\t'/settings/privacy-and-security',\r\n\t\t\t\t\t\t\t].includes(location.pathname)\r\n\t\t\t\t\t\t\t\t? 'active'\r\n\t\t\t\t\t\t\t\t: ''\r\n\t\t\t\t\t\t}`}>\r\n\t\t\t\t\t\t<i className='fa-solid fa-gear'></i>\r\n\t\t\t\t\t</NavLink>\r\n\t\t\t\t</nav>\r\n\r\n\t\t\t\t<div className='separator-no-text'></div>\r\n\r\n\t\t\t\t<Pinned orientation='vertical' />\r\n\r\n\t\t\t\t<div className='separator-no-text'></div>\r\n\r\n\t\t\t\t<div className='tool-bar__profile-menu'>\r\n\t\t\t\t\t<div\r\n\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\tsetShowProfile(true)\r\n\t\t\t\t\t\t}}>\r\n\t\t\t\t\t\t<AvatarWithStatus userId={userDoc.id} linkToProfile={false} noTooltip={true} />\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t<ProfilePreview show={showProfile} setShow={() => setShowProfile(false)} userId={userDoc.id} />\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t)\r\n\t)\r\n}\r\n\r\nexport default ToolBar\r\n","export default __webpack_public_path__ + \"static/media/premium-account.5a5ada39.png\";","// Styles\r\nimport './Loader.scss'\r\n\r\nexport default function Loader() {\r\n\treturn (\r\n\t\t<div className='loader'>\r\n\t\t\t<span></span>\r\n\t\t</div>\r\n\t)\r\n}\r\n","import React, { useState } from 'react'\r\nimport { Link, useParams } from 'react-router-dom'\r\nimport { useAuthContext } from '../../hooks/useAuthContext'\r\nimport { useDocument } from '../../hooks/useDocument'\r\nimport { useFirestore } from '../../hooks/useFirestore'\r\nimport { useCollection } from '../../hooks/useCollection'\r\nimport { timestamp } from '../../firebase/config'\r\nimport { useDates } from '../../hooks/useDates'\r\nimport { v4 as uuid } from 'uuid'\r\nimport ReactCountryFlag from 'react-country-flag'\r\n\r\n// Styles && Assets\r\nimport './Profile.scss'\r\nimport premiumIcon from '../../assets/premium-account.png'\r\nimport classicAccIcon from '../../assets/logo-default.png'\r\n\r\n// Components\r\nimport AvatarWithStatus from '../../components/AvatarWithStatus/AvatarWithStatus'\r\nimport Tooltip from '../../components/Tooltip/Tooltip'\r\nimport randomColor from 'randomcolor'\r\nimport Avatar from '../../components/Avatar/Avatar'\r\nimport Modal from '../../components/Modal/Modal'\r\nimport OutsideClickHandler from 'react-outside-click-handler'\r\nimport EmojiPicker, { EmojiStyle, Theme } from 'emoji-picker-react'\r\nimport Field from '../../components/Inputs/Field/Field'\r\nimport Loader from '../../components/Loader/Loader'\r\n\r\nexport default function Profile() {\r\n\tconst randColor = randomColor()\r\n\tconst uniqueId = uuid()\r\n\r\n\tconst { id } = useParams()\r\n\tconst { user } = useAuthContext()\r\n\tconst { error, document: userDoc } = useDocument('users', id)\r\n\tconst { document: currentUserDoc } = useDocument('users', user.uid)\r\n\tconst { documents: chats } = useCollection('projects')\r\n\tconst { documents } = useCollection('users')\r\n\tconst { updateDocument } = useFirestore('users')\r\n\tconst { formatDate } = useDates()\r\n\r\n\tconst [confirmDelete, setConfirmDelete] = useState(null)\r\n\tconst [comment, setComment] = useState('')\r\n\tconst [showEmojiPicker, setShowEmojiPicker] = useState(false)\r\n\tconst [showInputControls, setShowInputControls] = useState(false)\r\n\tconst [inputError, setInputError] = useState('')\r\n\r\n\tconst getDoc = id => {\r\n\t\tlet res = null\r\n\t\tif (documents) {\r\n\t\t\tres = documents.filter(doc => {\r\n\t\t\t\tif (doc.id === id) {\r\n\t\t\t\t\treturn true\r\n\t\t\t\t}\r\n\t\t\t\treturn false\r\n\t\t\t})[0]\r\n\t\t}\r\n\r\n\t\treturn res\r\n\t}\r\n\r\n\tconst addComment = async () => {\r\n\t\tif (comment.trim() === '') return\r\n\r\n\t\tif (userDoc.profileComments) {\r\n\t\t\tawait updateDocument(id, {\r\n\t\t\t\tprofileComments: [\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tid: uniqueId,\r\n\t\t\t\t\t\tcontent: comment,\r\n\t\t\t\t\t\tcreatedBy: user.uid,\r\n\t\t\t\t\t\tcreatedAt: timestamp.fromDate(new Date()),\r\n\t\t\t\t\t},\r\n\t\t\t\t\t...userDoc.profileComments,\r\n\t\t\t\t],\r\n\t\t\t})\r\n\t\t\tsetShowInputControls(false)\r\n\t\t\tsetComment('')\r\n\t\t} else {\r\n\t\t\tawait updateDocument(id, {\r\n\t\t\t\tprofileComments: [\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tid: uniqueId,\r\n\t\t\t\t\t\tcontent: comment,\r\n\t\t\t\t\t\tcreatedBy: user.uid,\r\n\t\t\t\t\t\tcreatedAt: timestamp.fromDate(new Date()),\r\n\t\t\t\t\t},\r\n\t\t\t\t],\r\n\t\t\t})\r\n\t\t\tsetShowInputControls(false)\r\n\t\t\tsetComment('')\r\n\t\t}\r\n\r\n\t\tsetComment('')\r\n\t}\r\n\r\n\tconst deleteComment = async comment => {\r\n\t\tawait updateDocument(id, {\r\n\t\t\tprofileComments: [\r\n\t\t\t\t...userDoc.profileComments.filter(comm => {\r\n\t\t\t\t\treturn comment !== comm\r\n\t\t\t\t}),\r\n\t\t\t],\r\n\t\t})\r\n\r\n\t\tsetConfirmDelete(null)\r\n\t}\r\n\r\n\tconst handleEmojis = e => {\r\n\t\tsetComment(comment => comment + e.emoji)\r\n\t}\r\n\r\n\tconst getChatId = id => {\r\n\t\tlet res = ''\r\n\r\n\t\tif (chats) {\r\n\t\t\tchats.filter(chat => {\r\n\t\t\t\tif (\r\n\t\t\t\t\t!chat.isGroup &&\r\n\t\t\t\t\t(chat.assignedUsersId[0] === id || chat.assignedUsersId[0] === user.uid) &&\r\n\t\t\t\t\t(chat.assignedUsersId[1] === id || chat.assignedUsersId[1] === user.uid)\r\n\t\t\t\t) {\r\n\t\t\t\t\tres = chat.id\r\n\t\t\t\t\treturn true\r\n\t\t\t\t} else {\r\n\t\t\t\t\treturn false\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t}\r\n\r\n\t\treturn res\r\n\t}\r\n\r\n\tconst notInFriends = () => {\r\n\t\tif (!currentUserDoc.friends) return true\r\n\r\n\t\tlet count = 0\r\n\r\n\t\tcurrentUserDoc.friends.forEach(f => {\r\n\t\t\tif (f.id !== userDoc.id) {\r\n\t\t\t\tcount += 1\r\n\t\t\t}\r\n\t\t})\r\n\r\n\t\treturn currentUserDoc.friends.length === count ? true : false\r\n\t}\r\n\r\n\tif (error !== null) {\r\n\t\treturn <div className='error'>{error}</div>\r\n\t}\r\n\r\n\tif (!userDoc) {\r\n\t\treturn <Loader />\r\n\t}\r\n\r\n\tif (userDoc) {\r\n\t\treturn (\r\n\t\t\t<div className='profile custom-scrollbar'>\r\n\t\t\t\t<div className='wrapper flex-column'>\r\n\t\t\t\t\t<div\r\n\t\t\t\t\t\tclassName='banner'\r\n\t\t\t\t\t\tstyle={userDoc.banner ? { background: userDoc.banner } : { background: randColor }}></div>\r\n\r\n\t\t\t\t\t<div className='profile__header'>\r\n\t\t\t\t\t\t<div className='profile__header-user'>\r\n\t\t\t\t\t\t\t<AvatarWithStatus userId={userDoc.id} />\r\n\t\t\t\t\t\t\t<div className='flex-column'>\r\n\t\t\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t\t\t<h3 className='name'>{userDoc.displayName}</h3>\r\n\t\t\t\t\t\t\t\t\t{userDoc.bio && <p className='bio'>{userDoc.bio}</p>}\r\n\t\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t\t<div className='badges'>\r\n\t\t\t\t\t\t\t\t\t{userDoc.createdAt && (\r\n\t\t\t\t\t\t\t\t\t\t<div className='badges__badge'>\r\n\t\t\t\t\t\t\t\t\t\t\t<p>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<span>Joined</span> - {userDoc.createdAt}\r\n\t\t\t\t\t\t\t\t\t\t\t</p>\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t)}\r\n\r\n\t\t\t\t\t\t\t\t\t{userDoc.pronouns && (\r\n\t\t\t\t\t\t\t\t\t\t<div className='badges__badge'>\r\n\t\t\t\t\t\t\t\t\t\t\t<p>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<span>Pronouns</span> - {userDoc.pronouns}\r\n\t\t\t\t\t\t\t\t\t\t\t</p>\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t)}\r\n\r\n\t\t\t\t\t\t\t\t\t{userDoc.country && (\r\n\t\t\t\t\t\t\t\t\t\t<div className='badges__badge'>\r\n\t\t\t\t\t\t\t\t\t\t\t<p className='country'>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<ReactCountryFlag countryCode={`${userDoc.country.code}`} svg />\r\n\t\t\t\t\t\t\t\t\t\t\t\t{userDoc.country.name}\r\n\t\t\t\t\t\t\t\t\t\t\t</p>\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t<div className='profile__header-additional'>\r\n\t\t\t\t\t\t\t\t{userDoc.premium && (\r\n\t\t\t\t\t\t\t\t\t<div className='premium'>\r\n\t\t\t\t\t\t\t\t\t\t<img src={premiumIcon} alt='Icon for premium account' />\r\n\t\t\t\t\t\t\t\t\t\t<span>Premium</span>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t)}\r\n\r\n\t\t\t\t\t\t\t\t<div className='btn-group'>\r\n\t\t\t\t\t\t\t\t\t{id === user.uid && (\r\n\t\t\t\t\t\t\t\t\t\t<Link to='/settings/profile'>\r\n\t\t\t\t\t\t\t\t\t\t\t<button className='action-btn btn'>edit profile</button>\r\n\t\t\t\t\t\t\t\t\t\t</Link>\r\n\t\t\t\t\t\t\t\t\t)}\r\n\r\n\t\t\t\t\t\t\t\t\t{id !== user.uid && (\r\n\t\t\t\t\t\t\t\t\t\t<>\r\n\t\t\t\t\t\t\t\t\t\t\t{currentUserDoc && currentUserDoc.friends && (\r\n\t\t\t\t\t\t\t\t\t\t\t\t<>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t{currentUserDoc.friends.some(f => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tif (f.id === userDoc.id && f.accepted === true && f.isPending === false) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\treturn true\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\treturn false\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t}) && (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Link to={`/u/${getChatId(userDoc.id)}`}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<button className='action-btn btn'>send message</button>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</Link>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t)}\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t{currentUserDoc.friends.some(f => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tif (f.id === userDoc.id && f.accepted === false && f.isPending === false) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\treturn true\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\treturn false\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t}) && (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Link to={`/friends`}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<button className='action-btn btn'>invite sent</button>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</Link>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t\t\t\t\t</>\r\n\t\t\t\t\t\t\t\t\t\t\t)}\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t{currentUserDoc && notInFriends() && <button className='action-btn btn'>invite friend</button>}\r\n\t\t\t\t\t\t\t\t\t\t</>\r\n\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t<div className='separator mt1'></div>\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t<p className='mb2'>will finish someday</p>\r\n\r\n\t\t\t\t\t<div className='profile__comments'>\r\n\t\t\t\t\t\t{/* <div className='separator'></div> */}\r\n\t\t\t\t\t\t<div className='comment-input'>\r\n\t\t\t\t\t\t\t<Field\r\n\t\t\t\t\t\t\t\ttype='text'\r\n\t\t\t\t\t\t\t\tvalue={comment}\r\n\t\t\t\t\t\t\t\tsetValue={setComment}\r\n\t\t\t\t\t\t\t\tlabel='Add a comment'\r\n\t\t\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\t\t\tsetShowInputControls(true)\r\n\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\terror={inputError}\r\n\t\t\t\t\t\t\t\tresetError={() => setInputError('')}\r\n\t\t\t\t\t\t\t\tonLostFocus={() => {\r\n\t\t\t\t\t\t\t\t\tif (comment === '') {\r\n\t\t\t\t\t\t\t\t\t\tsetInputError('Please enter a comment')\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t/>\r\n\r\n\t\t\t\t\t\t\t{showInputControls && (\r\n\t\t\t\t\t\t\t\t<div className='input-controls'>\r\n\t\t\t\t\t\t\t\t\t<i className='fa-regular fa-face-smile' onClick={() => setShowEmojiPicker(true)}>\r\n\t\t\t\t\t\t\t\t\t\t{showEmojiPicker && (\r\n\t\t\t\t\t\t\t\t\t\t\t<Tooltip pos='right' align='start'>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<OutsideClickHandler\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tonOutsideClick={() => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tsetShowEmojiPicker(false)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t}}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<EmojiPicker\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tclassName='emoji-picker'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tonEmojiClick={e => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\thandleEmojis(e)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ttheme={Theme.DARK}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tpreviewConfig={{\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tdefaultCaption: '',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tdefaultEmoji: null,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t// lazyLoadEmojis={true}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\temojiStyle={EmojiStyle.NATIVE}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</OutsideClickHandler>\r\n\t\t\t\t\t\t\t\t\t\t\t</Tooltip>\r\n\t\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t\t</i>\r\n\r\n\t\t\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\t\t\tclassName='btn cancel-btn'\r\n\t\t\t\t\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\t\t\t\t\tsetShowInputControls(false)\r\n\t\t\t\t\t\t\t\t\t\t\tsetComment('')\r\n\t\t\t\t\t\t\t\t\t\t}}>\r\n\t\t\t\t\t\t\t\t\t\tcancel\r\n\t\t\t\t\t\t\t\t\t</button>\r\n\r\n\t\t\t\t\t\t\t\t\t{comment.trim().length === 0 && (\r\n\t\t\t\t\t\t\t\t\t\t<button className='btn' disabled>\r\n\t\t\t\t\t\t\t\t\t\t\tcomment\r\n\t\t\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t\t\t)}\r\n\r\n\t\t\t\t\t\t\t\t\t{comment.trim().length > 0 && (\r\n\t\t\t\t\t\t\t\t\t\t<button className='btn' onClick={() => addComment()}>\r\n\t\t\t\t\t\t\t\t\t\t\tcomment\r\n\t\t\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t<div className='comments-container custom-scrollbar'>\r\n\t\t\t\t\t\t\t{userDoc.profileComments &&\r\n\t\t\t\t\t\t\t\tuserDoc.profileComments.map(\r\n\t\t\t\t\t\t\t\t\tcomment =>\r\n\t\t\t\t\t\t\t\t\t\tgetDoc(comment.createdBy) !== null && (\r\n\t\t\t\t\t\t\t\t\t\t\t<div className='comments-container__comment' key={comment.id}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<Avatar src={getDoc(comment.createdBy) && getDoc(comment.createdBy).photoURL} />\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t<div className='flex-column'>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<div className='flex-row'>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span>{getDoc(comment.createdBy) && getDoc(comment.createdBy).displayName}</span>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span>{formatDate(comment.createdAt)}</span>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<p>{comment.content}</p>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t{(id === user.uid || comment.createdBy === user.uid) && (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<i\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tclassName='fa-solid fa-trash-can delete-comment'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tonClick={() => setConfirmDelete(comment)}></i>\r\n\t\t\t\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\t)}\r\n\r\n\t\t\t\t\t\t\t<Modal show={confirmDelete !== null} setShow={() => setConfirmDelete(null)}>\r\n\t\t\t\t\t\t\t\t<div className='flex-column'>\r\n\t\t\t\t\t\t\t\t\t<h3 className='mt1'>Delete comment</h3>\r\n\r\n\t\t\t\t\t\t\t\t\t<p className='mb3'>Are you sure you want to delete this comment?</p>\r\n\r\n\t\t\t\t\t\t\t\t\t<div className='btn-group'>\r\n\t\t\t\t\t\t\t\t\t\t<button className='btn btn--secondary' onClick={() => setConfirmDelete(null)}>\r\n\t\t\t\t\t\t\t\t\t\t\tcancel\r\n\t\t\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\t\t\t\tclassName='btn'\r\n\t\t\t\t\t\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\t\t\t\t\t\tdeleteComment(confirmDelete)\r\n\t\t\t\t\t\t\t\t\t\t\t}}>\r\n\t\t\t\t\t\t\t\t\t\t\tdelete\r\n\t\t\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t</Modal>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t)\r\n\t}\r\n}\r\n","import { useEffect, useState } from 'react'\nimport { projectAuth } from '../firebase/config'\nimport { useAuthContext } from './useAuthContext'\n\nexport const useLogout = () => {\n\tconst [isCancelled, setIsCancelled] = useState(false)\n\tconst [error, setError] = useState(null)\n\tconst [isPending, setIsPending] = useState(false)\n\tconst { dispatch } = useAuthContext()\n\n\tconst logout = async () => {\n\t\tsetError(null)\n\t\tsetIsPending(true)\n\n\t\ttry {\n\t\t\t// Sign the user out\n\t\t\tawait projectAuth.signOut()\n\n\t\t\t// Dispatch logout action\n\t\t\tdispatch({ type: 'LOGOUT' })\n\n\t\t\t// Update state\n\t\t\tif (!isCancelled) {\n\t\t\t\tsetIsPending(false)\n\t\t\t\tsetError(null)\n\t\t\t}\n\t\t} catch (err) {\n\t\t\tif (!isCancelled) {\n\t\t\t\tsetError(err.message)\n\t\t\t\tsetIsPending(false)\n\t\t\t}\n\t\t}\n\t}\n\n\tuseEffect(() => {\n\t\treturn () => setIsCancelled(true)\n\t}, [])\n\n\treturn { logout, error, isPending }\n}\n","import { useState } from 'react'\r\nimport { useFirestore } from '../../../../../hooks/useFirestore'\r\nimport { useAuthContext } from '../../../../../hooks/useAuthContext'\r\nimport { updateProfile } from 'firebase/auth'\r\nimport { toast, ToastContainer } from 'react-toastify'\r\n\r\n// Components\r\nimport Modal from '../../../../../components/Modal/Modal'\r\nimport Loader from '../../../../../components/Loader/Loader'\r\n\r\nconst Username = () => {\r\n\tconst { user } = useAuthContext()\r\n\tconst { updateDocument } = useFirestore('users')\r\n\r\n\tconst [error, setError] = useState('')\r\n\tconst [isPending, setIsPending] = useState(false)\r\n\r\n\tconst [username, setUsername] = useState('')\r\n\tconst [show, setShow] = useState(false)\r\n\r\n\tconst notify = message =>\r\n\t\ttoast.success(message, {\r\n\t\t\tposition: 'bottom-right',\r\n\t\t\tautoClose: 5000,\r\n\t\t\thideProgressBar: false,\r\n\t\t\tcloseOnClick: true,\r\n\t\t\tpauseOnHover: true,\r\n\t\t\tdraggable: true,\r\n\t\t\tprogress: undefined,\r\n\t\t\ttheme: 'dark',\r\n\t\t})\r\n\r\n\tconst updateUsername = async () => {\r\n\t\tsetError(null)\r\n\t\tif (username.length > 3) {\r\n\t\t\tsetIsPending(true)\r\n\r\n\t\t\ttry {\r\n\t\t\t\tawait updateProfile(user, {\r\n\t\t\t\t\tdisplayName: username,\r\n\t\t\t\t})\r\n\t\t\t\tawait updateDocument(user.uid, {\r\n\t\t\t\t\tdisplayName: username,\r\n\t\t\t\t})\r\n\r\n\t\t\t\tsetIsPending(false)\r\n\t\t\t\tsetError(null)\r\n\t\t\t\tsetShow(false)\r\n\t\t\t\tsetUsername('')\r\n\t\t\t\tnotify('Successfully set a new username')\r\n\t\t\t} catch (error) {\r\n\t\t\t\tsetError(error.message)\r\n\t\t\t\tconsole.log(error.message)\r\n\t\t\t\tsetIsPending(false)\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tsetError('Username must be at least 3 characters long')\r\n\t\t}\r\n\t}\r\n\r\n\treturn (\r\n\t\t<div className='account-details__details-field'>\r\n\t\t\t<ToastContainer />\r\n\t\t\t<h3>username</h3>\r\n\t\t\t<p>{user.displayName}</p>\r\n\t\t\t{/* <i className='fa-solid fa-pencil' onClick={() => setShow(true)}>\r\n\t\t\t\t\t\t\t<Tooltip>Edit</Tooltip>\r\n\t\t\t\t\t\t</i> */}\r\n\t\t\t<button className='btn btn--secondary' onClick={() => setShow(true)}>\r\n\t\t\t\tedit\r\n\t\t\t</button>\r\n\t\t\t<Modal\r\n\t\t\t\tshow={show}\r\n\t\t\t\tsetShow={() => setShow(false)}\r\n\t\t\t\tonClose={() => {\r\n\t\t\t\t\tsetIsPending(false)\r\n\t\t\t\t\tsetError(null)\r\n\t\t\t\t\tsetShow(false)\r\n\t\t\t\t\tsetUsername('')\r\n\t\t\t\t}}>\r\n\t\t\t\t<h3>Change your username</h3>\r\n\t\t\t\t<p>Enter a new, always cool username</p>\r\n\r\n\t\t\t\t<input type='text' placeholder='Username' value={username} onChange={e => setUsername(e.target.value)} />\r\n\r\n\t\t\t\t{isPending && <Loader />}\r\n\t\t\t\t{error && <div className='error'>{error}</div>}\r\n\t\t\t\t<div className='btn-group'>\r\n\t\t\t\t\t<button className='btn btn--secondary' onClick={() => setShow(false)}>\r\n\t\t\t\t\t\tcancel\r\n\t\t\t\t\t</button>\r\n\t\t\t\t\t<button className='btn' onClick={() => updateUsername()}>\r\n\t\t\t\t\t\tupdate\r\n\t\t\t\t\t</button>\r\n\t\t\t\t</div>\r\n\t\t\t</Modal>\r\n\t\t</div>\r\n\t)\r\n}\r\n\r\nexport default Username\r\n","import { useState } from 'react'\r\nimport { useAuthContext } from '../../../../../hooks/useAuthContext'\r\nimport { toast, ToastContainer } from 'react-toastify'\r\nimport { projectAuth } from '../../../../../firebase/config'\r\n\r\n// Components\r\nimport Modal from '../../../../../components/Modal/Modal'\r\nimport Loader from '../../../../../components/Loader/Loader'\r\n\r\nconst Email = () => {\r\n\tconst { user } = useAuthContext()\r\n\r\n\tconst [error, setError] = useState('')\r\n\tconst [isPending, setIsPending] = useState(false)\r\n\r\n\tconst [email, setEmail] = useState('')\r\n\tconst [show, setShow] = useState(false)\r\n\tconst [currentPassword, setCurrentPassword] = useState('')\r\n\r\n\tconst notify = message =>\r\n\t\ttoast.success(message, {\r\n\t\t\tposition: 'bottom-right',\r\n\t\t\tautoClose: 5000,\r\n\t\t\thideProgressBar: false,\r\n\t\t\tcloseOnClick: true,\r\n\t\t\tpauseOnHover: true,\r\n\t\t\tdraggable: true,\r\n\t\t\tprogress: undefined,\r\n\t\t\ttheme: 'dark',\r\n\t\t})\r\n\r\n\tconst updateEmail = async () => {\r\n\t\tconst regex = /^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\\.[a-zA-Z0-9-]+)*$/\r\n\r\n\t\tsetError(null)\r\n\r\n\t\tif (!email.match(regex)) {\r\n\t\t\treturn setError('Invalid email address')\r\n\t\t}\r\n\t\tif (currentPassword === '') {\r\n\t\t\treturn setError('Enter your password')\r\n\t\t}\r\n\r\n\t\tsetIsPending(true)\r\n\r\n\t\tprojectAuth\r\n\t\t\t.signInWithEmailAndPassword(user.email, currentPassword)\r\n\t\t\t.then(userCredential => {\r\n\t\t\t\tuserCredential.user\r\n\t\t\t\t\t.updateEmail(email)\r\n\t\t\t\t\t.then(() => {\r\n\t\t\t\t\t\tsetIsPending(false)\r\n\t\t\t\t\t\tsetError(null)\r\n\t\t\t\t\t\tsetShow(false)\r\n\t\t\t\t\t\tsetEmail('')\r\n\t\t\t\t\t\tnotify('Successfully updated email address')\r\n\t\t\t\t\t})\r\n\t\t\t\t\t.catch(error => {\r\n\t\t\t\t\t\tconsole.log(error.message)\r\n\t\t\t\t\t\tsetError(error.message)\r\n\t\t\t\t\t\tsetIsPending(false)\r\n\t\t\t\t\t})\r\n\t\t\t})\r\n\t\t\t.catch(error => {\r\n\t\t\t\tconsole.log(error.message)\r\n\t\t\t\tsetError(error.message)\r\n\t\t\t\tsetIsPending(false)\r\n\t\t\t})\r\n\t}\r\n\r\n\treturn (\r\n\t\t<div className='account-details__details-field'>\r\n\t\t\t<ToastContainer />\r\n\t\t\t<h3>email</h3>\r\n\t\t\t<p>{user.email}</p>\r\n\t\t\t<button className='btn btn--secondary' onClick={() => setShow(true)}>\r\n\t\t\t\tedit\r\n\t\t\t</button>\r\n\t\t\t<Modal\r\n\t\t\t\tshow={show}\r\n\t\t\t\tsetShow={() => setShow(false)}\r\n\t\t\t\tonClose={() => {\r\n\t\t\t\t\tsetIsPending(false)\r\n\t\t\t\t\tsetError(null)\r\n\t\t\t\t\tsetShow(false)\r\n\t\t\t\t\tsetEmail('')\r\n\t\t\t\t}}>\r\n\t\t\t\t<h3 className='mb05'>Change your email address</h3>\r\n\t\t\t\t<p>Enter a new email address</p>\r\n\r\n\t\t\t\t<label>\r\n\t\t\t\t\t<input type='email' placeholder='Email' value={email} onChange={e => setEmail(e.target.value)} />\r\n\t\t\t\t</label>\r\n\t\t\t\t<label>\r\n\t\t\t\t\t<input\r\n\t\t\t\t\t\ttype='password'\r\n\t\t\t\t\t\tplaceholder='Password'\r\n\t\t\t\t\t\tvalue={currentPassword}\r\n\t\t\t\t\t\tonChange={e => setCurrentPassword(e.target.value)}\r\n\t\t\t\t\t/>\r\n\t\t\t\t</label>\r\n\r\n\t\t\t\t{isPending && <Loader />}\r\n\t\t\t\t{error && <div className='error'>{error}</div>}\r\n\t\t\t\t<div className='btn-group'>\r\n\t\t\t\t\t<button className='btn btn--secondary' onClick={() => setShow(false)}>\r\n\t\t\t\t\t\tcancel\r\n\t\t\t\t\t</button>\r\n\t\t\t\t\t<button className='btn' onClick={() => updateEmail()}>\r\n\t\t\t\t\t\tupdate\r\n\t\t\t\t\t</button>\r\n\t\t\t\t</div>\r\n\t\t\t</Modal>\r\n\t\t</div>\r\n\t)\r\n}\r\n\r\nexport default Email\r\n","import { useState } from 'react'\r\nimport { useAuthContext } from '../../../../../hooks/useAuthContext'\r\nimport { toast, ToastContainer } from 'react-toastify'\r\nimport { linkWithCredential, PhoneAuthProvider, updatePhoneNumber } from 'firebase/auth'\r\nimport { projectAuth } from '../../../../../firebase/config'\r\nimport { useLogin } from '../../../../../hooks/useLogin'\r\n\r\n// Styles\r\nimport 'react-phone-input-2/lib/bootstrap.css'\r\n\r\n// Components\r\nimport Loader from '../../../../../components/Loader/Loader'\r\nimport Modal from '../../../../../components/Modal/Modal'\r\nimport PhoneInput from 'react-phone-input-2'\r\n\r\nconst PhoneNumber = () => {\r\n\tconst { user } = useAuthContext()\r\n\tconst { setUpRecaptcha } = useLogin()\r\n\r\n\tconst [error, setError] = useState('')\r\n\tconst [isPending, setIsPending] = useState(false)\r\n\r\n\tconst [phoneNumber, setPhoneNumber] = useState('')\r\n\tconst [show, setShow] = useState(false)\r\n\tconst [confirmUnlink, setConfirmUnlink] = useState(false)\r\n\r\n\tconst [showOTP, setShowOTP] = useState(false)\r\n\tconst [captchaResponse, setCaptchaResponse] = useState('')\r\n\tconst [OTPCode, setOTPCode] = useState('')\r\n\r\n\tconst notify = message =>\r\n\t\ttoast.success(message, {\r\n\t\t\tposition: 'bottom-right',\r\n\t\t\tautoClose: 5000,\r\n\t\t\thideProgressBar: false,\r\n\t\t\tcloseOnClick: true,\r\n\t\t\tpauseOnHover: true,\r\n\t\t\tdraggable: true,\r\n\t\t\tprogress: undefined,\r\n\t\t\ttheme: 'dark',\r\n\t\t})\r\n\r\n\tconst unlinkPhoneNumber = () => {\r\n\t\tconst provider = new PhoneAuthProvider(projectAuth)\r\n\r\n\t\tuser.unlink(provider.providerId)\r\n\t\tnotify('Successfully unlinked phone number')\r\n\t}\r\n\r\n\tconst handleOTPInput = e => {\r\n\t\tconst limit = 6\r\n\t\tsetOTPCode(e.target.value.slice(0, limit))\r\n\t}\r\n\r\n\tconst sendOTP = async () => {\r\n\t\tconsole.log(`${phoneNumber}`)\r\n\t\tsetError(null)\r\n\t\tif (phoneNumber === '' || phoneNumber === undefined || phoneNumber === null) {\r\n\t\t\tsetError('Please enter a valid Phone Number!')\r\n\t\t\treturn\r\n\t\t}\r\n\r\n\t\ttry {\r\n\t\t\tconst response = await setUpRecaptcha(`+${phoneNumber}`)\r\n\r\n\t\t\tsetCaptchaResponse(response)\r\n\t\t\tsetShowOTP(true)\r\n\t\t} catch (err) {\r\n\t\t\tsetError(err.message)\r\n\t\t\tconsole.log(err.message)\r\n\t\t}\r\n\t}\r\n\r\n\tconst verifyOTP = async () => {\r\n\t\tif (OTPCode === '' || OTPCode === null) return\r\n\r\n\t\ttry {\r\n\t\t\tsetError(null)\r\n\t\t\tsetIsPending(true)\r\n\r\n\t\t\tconst authCredential = PhoneAuthProvider.credential(captchaResponse, OTPCode)\r\n\r\n\t\t\tif (user.phoneNumber === null || user.phoneNumber === undefined) {\r\n\t\t\t\tawait linkWithCredential(user, authCredential)\r\n\t\t\t} else {\r\n\t\t\t\tawait updatePhoneNumber(user, authCredential)\r\n\t\t\t}\r\n\r\n\t\t\tsetIsPending(false)\r\n\t\t\tsetShow(false)\r\n\t\t\tsetShowOTP(false)\r\n\t\t\tsetPhoneNumber('')\r\n\t\t\tsetOTPCode('')\r\n\t\t\tsetCaptchaResponse('')\r\n\t\t\tnotify('Successfully changed phone number')\r\n\t\t} catch (err) {\r\n\t\t\tconsole.log(err.message)\r\n\t\t\tsetError(err.message)\r\n\t\t\tsetIsPending(false)\r\n\t\t}\r\n\t}\r\n\r\n\treturn (\r\n\t\t<div className='account-details__details-field'>\r\n\t\t\t<ToastContainer />\r\n\t\t\t<h3>phone</h3>\r\n\t\t\t<p>{user.phoneNumber ? user.phoneNumber : \"You haven't added a phone number yet\"}</p>\r\n\r\n\t\t\t<div className='flex-row'>\r\n\t\t\t\t{/* <i className='fa-solid fa-pencil' onClick={() => setShow(true)}>\r\n                <Tooltip>Edit</Tooltip>\r\n            </i> */}\r\n\t\t\t\t{user.phoneNumber && (\r\n\t\t\t\t\t<button className='btn' onClick={() => setConfirmUnlink(true)}>\r\n\t\t\t\t\t\tremove\r\n\t\t\t\t\t</button>\r\n\t\t\t\t)}\r\n\t\t\t\t<button className='btn btn--secondary' onClick={() => setShow(true)}>\r\n\t\t\t\t\t{user.phoneNumber ? 'edit' : 'add'}\r\n\t\t\t\t</button>\r\n\t\t\t</div>\r\n\r\n\t\t\t<Modal show={confirmUnlink} setShow={() => setConfirmUnlink(false)}>\r\n\t\t\t\t<h3 className='mb05'>Remove phone number</h3>\r\n\t\t\t\t<p>Are you sure you want to remove your phone number from this account?</p>\r\n\r\n\t\t\t\t{/* // !! Require password for remove */}\r\n\r\n\t\t\t\t<div className='btn-group'>\r\n\t\t\t\t\t<button className='btn btn--secondary' onClick={() => setConfirmUnlink(false)}>\r\n\t\t\t\t\t\tcancel\r\n\t\t\t\t\t</button>\r\n\t\t\t\t\t<button className='btn' onClick={() => unlinkPhoneNumber()}>\r\n\t\t\t\t\t\tremove\r\n\t\t\t\t\t</button>\r\n\t\t\t\t</div>\r\n\t\t\t</Modal>\r\n\r\n\t\t\t<Modal\r\n\t\t\t\tshow={show}\r\n\t\t\t\tsetShow={() => setShow(false)}\r\n\t\t\t\tonClose={() => {\r\n\t\t\t\t\tsetIsPending(false)\r\n\t\t\t\t\tsetShow(false)\r\n\t\t\t\t\tsetShowOTP(false)\r\n\t\t\t\t\tsetPhoneNumber('')\r\n\t\t\t\t\tsetOTPCode('')\r\n\t\t\t\t\tsetCaptchaResponse('')\r\n\t\t\t\t}}>\r\n\t\t\t\t{!showOTP && (\r\n\t\t\t\t\t<>\r\n\t\t\t\t\t\t<h3 className='mb05'>Enter a phone number</h3>\r\n\t\t\t\t\t\t<p>You will recive a message containing a verification code.</p>\r\n\r\n\t\t\t\t\t\t<label>\r\n\t\t\t\t\t\t\t<p>Your new phone number</p>\r\n\t\t\t\t\t\t\t<PhoneInput\r\n\t\t\t\t\t\t\t\tcountry={'pl'}\r\n\t\t\t\t\t\t\t\tvalue={phoneNumber}\r\n\t\t\t\t\t\t\t\tonChange={setPhoneNumber}\r\n\t\t\t\t\t\t\t\tenableSearch={true}\r\n\t\t\t\t\t\t\t\tdropdownClass='custom-scrollbar'\r\n\t\t\t\t\t\t\t\tcopyNumbersOnly={false}\r\n\t\t\t\t\t\t\t\tsearchPlaceholder='Search for countries'\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t</label>\r\n\t\t\t\t\t\t{isPending && <Loader />}\r\n\t\t\t\t\t\t{error && <div className='error'>{error}</div>}\r\n\t\t\t\t\t\t<div id='recaptcha-container' />\r\n\r\n\t\t\t\t\t\t<div className='btn-group'>\r\n\t\t\t\t\t\t\t<button className='btn btn--secondary' onClick={() => setShow(false)}>\r\n\t\t\t\t\t\t\t\tcancel\r\n\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t<button className='btn' onClick={() => sendOTP()}>\r\n\t\t\t\t\t\t\t\tSend code\r\n\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</>\r\n\t\t\t\t)}\r\n\r\n\t\t\t\t{showOTP && (\r\n\t\t\t\t\t<>\r\n\t\t\t\t\t\t<h3 className='mb05'>OTP Verification</h3>\r\n\t\t\t\t\t\t<p>\r\n\t\t\t\t\t\t\tEnter the OTP sent to <span style={{ fontWeight: 'bold' }}>+{phoneNumber}</span>\r\n\t\t\t\t\t\t</p>\r\n\r\n\t\t\t\t\t\t<label className='otp-code'>\r\n\t\t\t\t\t\t\t<input type='number' value={OTPCode} onChange={e => handleOTPInput(e)} />\r\n\t\t\t\t\t\t\t{/* <input type='text' maxLength='1' />\r\n                        <input type='text' maxLength='1' />\r\n                        <input type='text' maxLength='1' />\r\n                        <input type='text' maxLength='1' />\r\n                        <input type='text' maxLength='1' /> */}\r\n\t\t\t\t\t\t</label>\r\n\t\t\t\t\t\t{error && <div className='error'>{error}</div>}\r\n\r\n\t\t\t\t\t\t<div className='btn-group'>\r\n\t\t\t\t\t\t\t<button className='btn btn--secondary' onClick={() => setShowOTP(false)}>\r\n\t\t\t\t\t\t\t\tgo back\r\n\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t<button className='btn' onClick={() => verifyOTP()}>\r\n\t\t\t\t\t\t\t\tChange number\r\n\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</>\r\n\t\t\t\t)}\r\n\t\t\t</Modal>\r\n\t\t</div>\r\n\t)\r\n}\r\n\r\nexport default PhoneNumber\r\n","import { useState } from 'react'\r\nimport { useAuthContext } from '../../../../../hooks/useAuthContext'\r\nimport { projectAuth } from '../../../../../firebase/config'\r\nimport { useLogout } from '../../../../../hooks/useLogout'\r\n\r\n// Components\r\nimport Modal from '../../../../../components/Modal/Modal'\r\nimport Loader from '../../../../../components/Loader/Loader'\r\n\r\nconst Password = () => {\r\n\tconst { user } = useAuthContext()\r\n\tconst { logout } = useLogout()\r\n\r\n\tconst [error, setError] = useState('')\r\n\tconst [isPending, setIsPending] = useState(false)\r\n\tconst [show, setShow] = useState(false)\r\n\r\n\tconst [currentPassword, setCurrentPassword] = useState('')\r\n\tconst [newPassword, setNewPassword] = useState('')\r\n\tconst [confirmNewPassword, setConfirmNewPassword] = useState('')\r\n\r\n\tconst updatePassword = () => {\r\n\t\tsetError(null)\r\n\r\n\t\tif (currentPassword === '') {\r\n\t\t\treturn setError('Enter a password')\r\n\t\t}\r\n\t\tif (newPassword === '' || confirmNewPassword === '') {\r\n\t\t\treturn setError('Enter a new password')\r\n\t\t}\r\n\t\tif (newPassword !== confirmNewPassword) {\r\n\t\t\treturn setError('Passwords must match')\r\n\t\t}\r\n\r\n\t\tsetIsPending(true)\r\n\r\n\t\tprojectAuth\r\n\t\t\t.signInWithEmailAndPassword(user.email, currentPassword)\r\n\t\t\t.then(userCredential => {\r\n\t\t\t\tuserCredential.user\r\n\t\t\t\t\t.updatePassword(newPassword)\r\n\t\t\t\t\t.then(() => {\r\n\t\t\t\t\t\tsetIsPending(false)\r\n\t\t\t\t\t\tsetError(null)\r\n\t\t\t\t\t\tsetShow(false)\r\n\t\t\t\t\t\tsetCurrentPassword('')\r\n\t\t\t\t\t\tsetNewPassword('')\r\n\t\t\t\t\t\tsetConfirmNewPassword('')\r\n\t\t\t\t\t\tlogout()\r\n\t\t\t\t\t})\r\n\t\t\t\t\t.catch(error => {\r\n\t\t\t\t\t\tconsole.log(error.message)\r\n\t\t\t\t\t\tsetError(error.message)\r\n\t\t\t\t\t\tsetIsPending(false)\r\n\t\t\t\t\t})\r\n\t\t\t})\r\n\t\t\t.catch(error => {\r\n\t\t\t\tconsole.log(error.message)\r\n\t\t\t\tsetError('Enter a correct password')\r\n\t\t\t\tsetIsPending(false)\r\n\t\t\t})\r\n\t}\r\n\r\n\treturn (\r\n\t\t<div className='account-details__details-field'>\r\n\t\t\t<h3>password</h3>\r\n\t\t\t<p>***************</p>\r\n\r\n\t\t\t<button className='btn btn--secondary' onClick={() => setShow(true)}>\r\n\t\t\t\tedit\r\n\t\t\t</button>\r\n\t\t\t<Modal\r\n\t\t\t\tshow={show}\r\n\t\t\t\tsetShow={() => setShow(false)}\r\n\t\t\t\tonClose={() => {\r\n\t\t\t\t\tsetIsPending(false)\r\n\t\t\t\t\tsetError(null)\r\n\t\t\t\t\tsetShow(false)\r\n\t\t\t\t\tsetCurrentPassword('')\r\n\t\t\t\t\tsetNewPassword('')\r\n\t\t\t\t\tsetConfirmNewPassword('')\r\n\t\t\t\t}}>\r\n\t\t\t\t<h3 className='mb05'>Change password</h3>\r\n\t\t\t\t<p>Enter your current password and a new password. Also remember that your name isn't a good password...</p>\r\n\r\n\t\t\t\t<label>\r\n\t\t\t\t\t<input\r\n\t\t\t\t\t\ttype='password'\r\n\t\t\t\t\t\tplaceholder='Current password'\r\n\t\t\t\t\t\tvalue={currentPassword}\r\n\t\t\t\t\t\tonChange={e => setCurrentPassword(e.target.value)}\r\n\t\t\t\t\t/>\r\n\t\t\t\t</label>\r\n\t\t\t\t<label>\r\n\t\t\t\t\t<input\r\n\t\t\t\t\t\ttype='password'\r\n\t\t\t\t\t\tplaceholder='New password'\r\n\t\t\t\t\t\tvalue={newPassword}\r\n\t\t\t\t\t\tonChange={e => setNewPassword(e.target.value)}\r\n\t\t\t\t\t/>\r\n\t\t\t\t</label>\r\n\t\t\t\t<label>\r\n\t\t\t\t\t<input\r\n\t\t\t\t\t\ttype='password'\r\n\t\t\t\t\t\tplaceholder='Confirm new password'\r\n\t\t\t\t\t\tvalue={confirmNewPassword}\r\n\t\t\t\t\t\tonChange={e => setConfirmNewPassword(e.target.value)}\r\n\t\t\t\t\t/>\r\n\t\t\t\t</label>\r\n\r\n\t\t\t\t{isPending && <Loader />}\r\n\t\t\t\t{error && <div className='error'>{error}</div>}\r\n\t\t\t\t<div className='btn-group'>\r\n\t\t\t\t\t<button className='btn btn--secondary' onClick={() => setShow(false)}>\r\n\t\t\t\t\t\tcancel\r\n\t\t\t\t\t</button>\r\n\t\t\t\t\t<button className='btn' onClick={() => updatePassword()}>\r\n\t\t\t\t\t\tupdate\r\n\t\t\t\t\t</button>\r\n\t\t\t\t</div>\r\n\t\t\t</Modal>\r\n\t\t</div>\r\n\t)\r\n}\r\n\r\nexport default Password\r\n","import { useEffect, useState } from 'react'\r\nimport { useAuthContext } from '../../../../../hooks/useAuthContext'\r\n\r\n// Components\r\nimport Loader from '../../../../../components/Loader/Loader'\r\nimport Modal from '../../../../../components/Modal/Modal'\r\nimport { deleteUser } from 'firebase/auth'\r\nimport { projectAuth } from '../../../../../firebase/config'\r\n\r\nconst DeleteAccount = () => {\r\n\tconst { user } = useAuthContext()\r\n\r\n\tconst [error, setError] = useState(null)\r\n\tconst [isPending, setIsPending] = useState(null)\r\n\r\n\tconst [show, setShow] = useState(false)\r\n\tconst [confirm, setConfirm] = useState('')\r\n\tconst [startCountdown, setStartCountdown] = useState(false)\r\n\tconst [timeToDelete, setTimeToDelete] = useState(10)\r\n\tconst [credential, setCredential] = useState(null)\r\n\r\n\tuseEffect(() => {\r\n\t\tif (startCountdown === true) {\r\n\t\t\tfinalCountdown()\r\n\t\t}\r\n\t}, [startCountdown])\r\n\r\n\tconst checkPassword = () => {\r\n\t\tif (isPasswordProvider()) {\r\n\t\t\tif (confirm === '') return setError('You must enter a valid password')\r\n\r\n\t\t\tprojectAuth\r\n\t\t\t\t.signInWithEmailAndPassword(user.email, confirm)\r\n\t\t\t\t.then(userCredential => {\r\n\t\t\t\t\tsetStartCountdown(true)\r\n\t\t\t\t\tsetCredential(userCredential)\r\n\t\t\t\t})\r\n\t\t\t\t.catch(error => {\r\n\t\t\t\t\tconsole.log(error.message)\r\n\t\t\t\t\tsetError('The password you entered is invalid')\r\n\t\t\t\t})\r\n\t\t}\r\n\t\tsetStartCountdown(true)\r\n\t}\r\n\r\n\tconst finalCountdown = () => {\r\n\t\tlet redirectCountdown = setInterval(() => {\r\n\t\t\tif (timeToDelete < 0) {\r\n\t\t\t\tclearInterval(redirectCountdown)\r\n\t\t\t} else {\r\n\t\t\t\tsetTimeToDelete(prevTimeToRedirect => prevTimeToRedirect - 1)\r\n\t\t\t}\r\n\t\t}, 1000)\r\n\t\tsetTimeout(() => {\r\n\t\t\thandleDeleteUser()\r\n\t\t}, 10000)\r\n\t}\r\n\r\n\tconst handleDeleteUser = () => {\r\n\t\tsetError(null)\r\n\r\n\t\tdeleteUser(user)\r\n\t\t\t.then(() => {\r\n\t\t\t\tsetIsPending(false)\r\n\t\t\t\tsetError(null)\r\n\t\t\t\tsetShow(false)\r\n\t\t\t})\r\n\t\t\t.catch(error => {\r\n\t\t\t\tconsole.log(error.message)\r\n\t\t\t\tsetError(error.message)\r\n\t\t\t\tsetIsPending(false)\r\n\t\t\t})\r\n\t}\r\n\r\n\tconst isPasswordProvider = () => {\r\n\t\tlet res = false\r\n\r\n\t\tuser.providerData.forEach(provider => {\r\n\t\t\tif (provider.providerId === 'password') {\r\n\t\t\t\tres = true\r\n\t\t\t}\r\n\t\t})\r\n\r\n\t\treturn res\r\n\t}\r\n\r\n\treturn (\r\n\t\t<div className='account-details__details-delete-account'>\r\n\t\t\t<button className='btn' onClick={() => setShow(true)}>\r\n\t\t\t\tDelete Account\r\n\t\t\t</button>\r\n\r\n\t\t\t<Modal\r\n\t\t\t\tshow={show}\r\n\t\t\t\tsetShow={() => setShow(false)}\r\n\t\t\t\tonClose={() => {\r\n\t\t\t\t\tsetIsPending(false)\r\n\t\t\t\t\tsetError(null)\r\n\t\t\t\t\tsetShow(false)\r\n\t\t\t\t\tsetConfirm('')\r\n\t\t\t\t\tsetStartCountdown(false)\r\n\t\t\t\t\tsetTimeToDelete(10)\r\n\t\t\t\t}}>\r\n\t\t\t\t<div className='modal__content-padding flex-column align-center'>\r\n\t\t\t\t\t{startCountdown && (\r\n\t\t\t\t\t\t<div className='countdown'>\r\n\t\t\t\t\t\t\t<h3>Deleting account in</h3>\r\n\t\t\t\t\t\t\t<div>{timeToDelete}</div>\r\n\r\n\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\tclassName='btn'\r\n\t\t\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\t\t\tsetShow(false)\r\n\t\t\t\t\t\t\t\t}}>\r\n\t\t\t\t\t\t\t\tcancel\r\n\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t)}\r\n\t\t\t\t\t{!startCountdown && (\r\n\t\t\t\t\t\t<>\r\n\t\t\t\t\t\t\t<i className='fa-solid fa-trash-can'></i>\r\n\r\n\t\t\t\t\t\t\t<h3>Delete Account?</h3>\r\n\t\t\t\t\t\t\t<p className='mb0'>You'll permanently lose your:</p>\r\n\r\n\t\t\t\t\t\t\t<ul>\r\n\t\t\t\t\t\t\t\t<li>\r\n\t\t\t\t\t\t\t\t\t<i className='fa-solid fa-xmark'></i>\r\n\t\t\t\t\t\t\t\t\t<span>Profile</span>\r\n\t\t\t\t\t\t\t\t</li>\r\n\t\t\t\t\t\t\t\t<li>\r\n\t\t\t\t\t\t\t\t\t<i className='fa-solid fa-xmark'></i>\r\n\t\t\t\t\t\t\t\t\t<span>Messages</span>\r\n\t\t\t\t\t\t\t\t</li>\r\n\t\t\t\t\t\t\t\t<li>\r\n\t\t\t\t\t\t\t\t\t<i className='fa-solid fa-xmark'></i>\r\n\t\t\t\t\t\t\t\t\t<span>Personal data</span>\r\n\t\t\t\t\t\t\t\t</li>\r\n\t\t\t\t\t\t\t</ul>\r\n\r\n\t\t\t\t\t\t\t{isPasswordProvider() && (\r\n\t\t\t\t\t\t\t\t<label>\r\n\t\t\t\t\t\t\t\t\t<p>Enter your password to confirm</p>\r\n\t\t\t\t\t\t\t\t\t<input\r\n\t\t\t\t\t\t\t\t\t\ttype='password'\r\n\t\t\t\t\t\t\t\t\t\tvalue={confirm}\r\n\t\t\t\t\t\t\t\t\t\tonChange={e => setConfirm(e.target.value)}\r\n\t\t\t\t\t\t\t\t\t\tplaceholder='Aa...'\r\n\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t</label>\r\n\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t{isPending && <Loader />}\r\n\t\t\t\t\t\t\t{error && <div className='error'>{error}</div>}\r\n\t\t\t\t\t\t</>\r\n\t\t\t\t\t)}\r\n\t\t\t\t</div>\r\n\r\n\t\t\t\t{!startCountdown && (\r\n\t\t\t\t\t<div className='btn-group'>\r\n\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\tclassName='btn btn--secondary'\r\n\t\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\t\tsetShow(false)\r\n\t\t\t\t\t\t\t}}>\r\n\t\t\t\t\t\t\tcancel\r\n\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\tclassName='btn'\r\n\t\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\t\tcheckPassword()\r\n\t\t\t\t\t\t\t}}>\r\n\t\t\t\t\t\t\tconfirm\r\n\t\t\t\t\t\t</button>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t)}\r\n\t\t\t</Modal>\r\n\t\t</div>\r\n\t)\r\n}\r\n\r\nexport default DeleteAccount\r\n","import { useState } from 'react'\r\nimport { useAuthContext } from '../../../../hooks/useAuthContext'\r\nimport { useDocument } from '../../../../hooks/useDocument'\r\n\r\n// Styles && Assets\r\nimport './AccountDetails.scss'\r\n\r\n// Components\r\nimport Loader from '../../../../components/Loader/Loader'\r\nimport Username from './fields/Username'\r\nimport Email from './fields/Email'\r\nimport PhoneNumber from './fields/PhoneNumber'\r\nimport Password from './fields/Password'\r\nimport DeleteAccount from './fields/DeleteAccount'\r\n\r\nconst AccountDetails = () => {\r\n\tconst { user } = useAuthContext()\r\n\tconst { document: userDoc, error: docError } = useDocument('users', user.uid)\r\n\r\n\tconst [copyBtnText, setCopyBtnText] = useState('copy')\r\n\r\n\tconst isPasswordProvider = () => {\r\n\t\tlet res = false\r\n\r\n\t\tuser.providerData.forEach(provider => {\r\n\t\t\tif (provider.providerId === 'password') {\r\n\t\t\t\tres = true\r\n\t\t\t}\r\n\t\t})\r\n\r\n\t\treturn res\r\n\t}\r\n\r\n\tconst copyInviteCode = () => {\r\n\t\tnavigator.clipboard.writeText(user.uid)\r\n\t\tsetCopyBtnText('copied')\r\n\r\n\t\tsetTimeout(() => {\r\n\t\t\tsetCopyBtnText('copy')\r\n\t\t}, 1000)\r\n\t}\r\n\r\n\tif (docError) {\r\n\t\treturn <div className='error'>{docError}</div>\r\n\t}\r\n\tif (userDoc && user)\r\n\t\treturn (\r\n\t\t\t<div className='account-details'>\r\n\t\t\t\t<h2 className='setting-title'>account details</h2>\r\n\r\n\t\t\t\t<div className='account-details__details'>\r\n\t\t\t\t\t<div className='account-details__details-field'>\r\n\t\t\t\t\t\t<h3>invite code</h3>\r\n\t\t\t\t\t\t<p className='text-clip'>{user.uid}</p>\r\n\r\n\t\t\t\t\t\t<button className='btn btn--secondary' onClick={() => copyInviteCode()}>\r\n\t\t\t\t\t\t\t{copyBtnText}\r\n\t\t\t\t\t\t</button>\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t<div className='separator'></div>\r\n\r\n\t\t\t\t\t<Username />\r\n\t\t\t\t\t<div className='separator'></div>\r\n\r\n\t\t\t\t\t{isPasswordProvider() && (\r\n\t\t\t\t\t\t<>\r\n\t\t\t\t\t\t\t<Email />\r\n\t\t\t\t\t\t\t<div className='separator'></div>\r\n\t\t\t\t\t\t</>\r\n\t\t\t\t\t)}\r\n\r\n\t\t\t\t\t<PhoneNumber />\r\n\t\t\t\t\t<div className='separator'></div>\r\n\r\n\t\t\t\t\t{isPasswordProvider() && (\r\n\t\t\t\t\t\t<>\r\n\t\t\t\t\t\t\t<Password />\r\n\t\t\t\t\t\t\t<div className='separator'></div>\r\n\t\t\t\t\t\t</>\r\n\t\t\t\t\t)}\r\n\t\t\t\t</div>\r\n\t\t\t\t<DeleteAccount />\r\n\t\t\t</div>\r\n\t\t)\r\n\r\n\tif (!userDoc && user) return <Loader />\r\n}\r\n\r\nexport default AccountDetails\r\n","export const createImage = url =>\r\n\tnew Promise((resolve, reject) => {\r\n\t\tconst image = new Image()\r\n\t\timage.addEventListener('load', () => resolve(image))\r\n\t\timage.addEventListener('error', error => reject(error))\r\n\t\timage.setAttribute('crossOrigin', 'anonymous')\r\n\t\timage.src = url\r\n\t})\r\n\r\nexport function getRadianAngle(degreeValue) {\r\n\treturn (degreeValue * Math.PI) / 180\r\n}\r\n\r\nexport function rotateSize(width, height, rotation) {\r\n\tconst rotRad = getRadianAngle(rotation)\r\n\r\n\treturn {\r\n\t\twidth: Math.abs(Math.cos(rotRad) * width) + Math.abs(Math.sin(rotRad) * height),\r\n\t\theight: Math.abs(Math.sin(rotRad) * width) + Math.abs(Math.cos(rotRad) * height),\r\n\t}\r\n}\r\n\r\nexport default async function getCroppedImg(\r\n\timageSrc,\r\n\tpixelCrop,\r\n\trotation = 0,\r\n\tflip = { horizontal: false, vertical: false }\r\n) {\r\n\tconst image = await createImage(imageSrc)\r\n\tconst canvas = document.createElement('canvas')\r\n\tconst ctx = canvas.getContext('2d')\r\n\r\n\tif (!ctx) {\r\n\t\treturn null\r\n\t}\r\n\r\n\tconst rotRad = getRadianAngle(rotation)\r\n\r\n\tconst { width: bBoxWidth, height: bBoxHeight } = rotateSize(image.width, image.height, rotation)\r\n\r\n\t// set canvas size to match the bounding box\r\n\tcanvas.width = bBoxWidth\r\n\tcanvas.height = bBoxHeight\r\n\r\n\tctx.translate(bBoxWidth / 2, bBoxHeight / 2)\r\n\tctx.rotate(rotRad)\r\n\tctx.scale(flip.horizontal ? -1 : 1, flip.vertical ? -1 : 1)\r\n\tctx.translate(-image.width / 2, -image.height / 2)\r\n\r\n\tctx.drawImage(image, 0, 0)\r\n\r\n\tconst data = ctx.getImageData(pixelCrop.x, pixelCrop.y, pixelCrop.width, pixelCrop.height)\r\n\r\n\tcanvas.width = pixelCrop.width\r\n\tcanvas.height = pixelCrop.height\r\n\r\n\tctx.putImageData(data, 0, 0)\r\n\r\n\treturn new Promise((resolve, reject) => {\r\n\t\tcanvas.toBlob(file => {\r\n\t\t\tconsole.log('file-from-crop', file)\r\n\t\t\t// resolve(URL.createObjectURL(file))\r\n\t\t\tresolve(file)\r\n\t\t}, 'image/jpeg')\r\n\t})\r\n}\r\n","import { useDropzone } from 'react-dropzone'\r\nimport { useAuthContext } from '../../../../../hooks/useAuthContext'\r\nimport { useFirestore } from '../../../../../hooks/useFirestore'\r\nimport { useCallback, useEffect, useReducer, useState } from 'react'\r\nimport { deleteObject, getDownloadURL, getStorage, list, ref, uploadBytes } from 'firebase/storage'\r\nimport { toast } from 'react-toastify'\r\nimport { projectStorage } from '../../../../../firebase/config'\r\nimport { updateProfile } from 'firebase/auth'\r\nimport getCroppedImg from '../CropImg'\r\n\r\n// Components\r\nimport Modal from '../../../../../components/Modal/Modal'\r\nimport Cropper from 'react-easy-crop'\r\n\r\nconst AvatarField = ({ setAvatarState, userDoc, setShowAvatarModal, showAvatarModal }) => {\r\n\tconst { user } = useAuthContext()\r\n\r\n\tconst { updateDocument } = useFirestore('users')\r\n\tconst { acceptedFiles, getRootProps, getInputProps, isDragAccept, isDragReject, open } = useDropzone({\r\n\t\tnoClick: true,\r\n\t\tmultiple: false,\r\n\t\taccept: {\r\n\t\t\t'image/*': [],\r\n\t\t},\r\n\t\tonDrop: acceptedFiles => {\r\n\t\t\tsetFiles(\r\n\t\t\t\tObject.assign(acceptedFiles[0], {\r\n\t\t\t\t\tpreview: URL.createObjectURL(acceptedFiles[0]),\r\n\t\t\t\t})\r\n\t\t\t)\r\n\t\t},\r\n\t})\r\n\r\n\tconst [error, setError] = useState(null)\r\n\tconst [isPending, setIsPending] = useState(false)\r\n\r\n\tconst [files, setFiles] = useState(null)\r\n\r\n\tconst [crop, setCrop] = useState({ x: 0, y: 0 })\r\n\tconst [zoom, setZoom] = useState(1)\r\n\tconst [croppedAreaPixels, setCroppedAreaPixels] = useState(null)\r\n\tconst [croppedImage, setCroppedImage] = useState(null)\r\n\r\n\tconst onCropComplete = useCallback((croppedArea, croppedAreaPixels) => {\r\n\t\tsetCroppedAreaPixels(croppedAreaPixels)\r\n\t}, [])\r\n\r\n\tconst showCroppedImage = useCallback(async () => {\r\n\t\ttry {\r\n\t\t\tconst croppedImage = await getCroppedImg(files.preview, croppedAreaPixels, 0)\r\n\t\t\tsetCroppedImage(croppedImage)\r\n\t\t\tupdateAvatar(croppedImage, true)\r\n\t\t} catch (e) {\r\n\t\t\tconsole.error(e)\r\n\t\t}\r\n\t}, [croppedAreaPixels, files])\r\n\r\n\tconst Undo = ({ onUndo, closeToast }) => {\r\n\t\tconst handleClick = () => {\r\n\t\t\tonUndo()\r\n\t\t\tcloseToast()\r\n\t\t}\r\n\r\n\t\treturn (\r\n\t\t\t<div className='reset-toast'>\r\n\t\t\t\tAvatar Deleted <button onClick={handleClick}>UNDO</button>\r\n\t\t\t</div>\r\n\t\t)\r\n\t}\r\n\r\n\tconst deletePhotoURLFromStorage = () => {\r\n\t\tconst storageRef = ref(projectStorage, `thumbnails/${user.uid}/`)\r\n\r\n\t\tlist(storageRef)\r\n\t\t\t.then(res => {\r\n\t\t\t\tconst deleteRef = ref(projectStorage, res.items[0].fullPath)\r\n\t\t\t\tdeleteObject(deleteRef)\r\n\t\t\t})\r\n\t\t\t.catch(error => {\r\n\t\t\t\tsetError(error.message)\r\n\t\t\t\tconsole.log(error.message)\r\n\t\t\t})\r\n\t}\r\n\r\n\tconst removePhotoURLs = async () => {\r\n\t\tsetError(null)\r\n\t\tsetIsPending(true)\r\n\r\n\t\ttry {\r\n\t\t\tawait updateProfile(user, {\r\n\t\t\t\tphotoURL: '',\r\n\t\t\t})\r\n\t\t\tawait updateDocument(user.uid, {\r\n\t\t\t\tphotoURL: '',\r\n\t\t\t})\r\n\t\t\tdeletePhotoURLFromStorage()\r\n\t\t\tsetIsPending(false)\r\n\t\t\tsetError(null)\r\n\t\t} catch (error) {\r\n\t\t\tsetError(error.message)\r\n\t\t\tconsole.log(error.message)\r\n\t\t\tsetIsPending(false)\r\n\t\t}\r\n\t}\r\n\r\n\tfunction reducer(state, action) {\r\n\t\tswitch (action.type) {\r\n\t\t\tcase 'QUEUE_FOR_REMOVAL':\r\n\t\t\t\treturn {\r\n\t\t\t\t\turl: state.url,\r\n\t\t\t\t\tremove: true,\r\n\t\t\t\t}\r\n\t\t\tcase 'CLEAN_COLLECTION':\r\n\t\t\t\tif (state.remove) {\r\n\t\t\t\t\tremovePhotoURLs()\r\n\t\t\t\t}\r\n\t\t\t\treturn {\r\n\t\t\t\t\turl: state.remove ? '' : state.url,\r\n\t\t\t\t\tremove: false,\r\n\t\t\t\t}\r\n\t\t\tcase 'UNDO':\r\n\t\t\t\treturn {\r\n\t\t\t\t\turl: state.url,\r\n\t\t\t\t\tremove: false,\r\n\t\t\t\t}\r\n\t\t\tdefault:\r\n\t\t\t\treturn state\r\n\t\t}\r\n\t}\r\n\r\n\tconst [state, dispatch] = useReducer(reducer, {\r\n\t\turl: null,\r\n\t\tremove: false,\r\n\t})\r\n\r\n\tuseEffect(() => {\r\n\t\tsetAvatarState(state)\r\n\t}, [state])\r\n\r\n\tconst handleRemoveAvatar = () => {\r\n\t\tdispatch({\r\n\t\t\ttype: 'QUEUE_FOR_REMOVAL',\r\n\t\t})\r\n\t\ttoast.info(<Undo onUndo={() => dispatch({ type: 'UNDO' })} />, {\r\n\t\t\tposition: 'bottom-right',\r\n\t\t\tautoClose: 15000,\r\n\t\t\thideProgressBar: false,\r\n\t\t\t// closeButton: false,\r\n\t\t\tcloseOnClick: false,\r\n\t\t\tpauseOnHover: true,\r\n\t\t\tdraggable: true,\r\n\t\t\tprogress: undefined,\r\n\t\t\ttheme: 'dark',\r\n\t\t\tonClose: () => dispatch({ type: 'CLEAN_COLLECTION' }),\r\n\t\t})\r\n\t}\r\n\r\n\tconst updateAvatar = async image => {\r\n\t\tconst storage = getStorage()\r\n\t\tconst uploadPath = `thumbnails/${user.uid}/${image.name}`\r\n\t\tconst storageRef = ref(storage, uploadPath)\r\n\r\n\t\tawait uploadBytes(storageRef, image)\r\n\t\t\t.then(snapshot => {\r\n\t\t\t\tgetDownloadURL(snapshot.ref).then(async downloadURL => {\r\n\t\t\t\t\ttry {\r\n\t\t\t\t\t\tawait updateDocument(user.uid, {\r\n\t\t\t\t\t\t\tphotoURL: downloadURL,\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t\tawait user.updateProfile({ photoURL: downloadURL })\r\n\r\n\t\t\t\t\t\tsetShowAvatarModal(false)\r\n\t\t\t\t\t\tsetFiles(null)\r\n\t\t\t\t\t\tsetCrop({ x: 0, y: 0 })\r\n\t\t\t\t\t\tsetZoom(1)\r\n\t\t\t\t\t\tsetCroppedAreaPixels(null)\r\n\t\t\t\t\t\tsetCroppedImage(null)\r\n\t\t\t\t\t\ttoast.success('Succesfully updated your avatar', {\r\n\t\t\t\t\t\t\tposition: 'bottom-right',\r\n\t\t\t\t\t\t\tautoClose: 5000,\r\n\t\t\t\t\t\t\thideProgressBar: false,\r\n\t\t\t\t\t\t\tcloseOnClick: true,\r\n\t\t\t\t\t\t\tpauseOnHover: true,\r\n\t\t\t\t\t\t\tdraggable: true,\r\n\t\t\t\t\t\t\tprogress: undefined,\r\n\t\t\t\t\t\t\ttheme: 'dark',\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t} catch (error) {\r\n\t\t\t\t\t\tconsole.log(error.message)\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t})\r\n\t\t\t.catch(error => {\r\n\t\t\t\tconsole.log(error.message)\r\n\t\t\t})\r\n\t}\r\n\r\n\treturn (\r\n\t\tuserDoc && (\r\n\t\t\t<div className='profile-settings__fields-field'>\r\n\t\t\t\t<h3 className='field-title'>avatar</h3>\r\n\r\n\t\t\t\t<div className='btn-group'>\r\n\t\t\t\t\t<>\r\n\t\t\t\t\t\t<button className='btn' onClick={() => setShowAvatarModal(true)}>\r\n\t\t\t\t\t\t\tchange avatar\r\n\t\t\t\t\t\t</button>\r\n\r\n\t\t\t\t\t\t<Modal show={showAvatarModal} setShow={() => setShowAvatarModal(false)}>\r\n\t\t\t\t\t\t\t{!files && (\r\n\t\t\t\t\t\t\t\t<section\r\n\t\t\t\t\t\t\t\t\t{...getRootProps({\r\n\t\t\t\t\t\t\t\t\t\tclassName: `dropzone-container ${isDragAccept ? 'accepted' : ''} ${isDragReject ? 'rejected' : ''}`,\r\n\t\t\t\t\t\t\t\t\t})}>\r\n\t\t\t\t\t\t\t\t\t<input {...getInputProps()} />\r\n\t\t\t\t\t\t\t\t\t<button className='btn' onClick={open}>\r\n\t\t\t\t\t\t\t\t\t\tbrowse files\r\n\t\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t\t\t<p>...or drag and drop image</p>\r\n\t\t\t\t\t\t\t\t</section>\r\n\t\t\t\t\t\t\t)}\r\n\r\n\t\t\t\t\t\t\t{files && (\r\n\t\t\t\t\t\t\t\t<div className='crop-container'>\r\n\t\t\t\t\t\t\t\t\t<div className='modal__content-padding'>\r\n\t\t\t\t\t\t\t\t\t\t<section>\r\n\t\t\t\t\t\t\t\t\t\t\t<h3>Edit Image</h3>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t<Cropper\r\n\t\t\t\t\t\t\t\t\t\t\t\timage={files.preview}\r\n\t\t\t\t\t\t\t\t\t\t\t\tcrop={crop}\r\n\t\t\t\t\t\t\t\t\t\t\t\tzoom={zoom}\r\n\t\t\t\t\t\t\t\t\t\t\t\taspect={1 / 1}\r\n\t\t\t\t\t\t\t\t\t\t\t\tcropShape='round'\r\n\t\t\t\t\t\t\t\t\t\t\t\tonCropChange={setCrop}\r\n\t\t\t\t\t\t\t\t\t\t\t\tonCropComplete={onCropComplete}\r\n\t\t\t\t\t\t\t\t\t\t\t\tonZoomChange={setZoom}\r\n\t\t\t\t\t\t\t\t\t\t\t\tmaxZoom={3}\r\n\t\t\t\t\t\t\t\t\t\t\t/>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t<div className='controls'>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<input\r\n\t\t\t\t\t\t\t\t\t\t\t\t\ttype='range'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tvalue={zoom}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tmin={1}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tmax={3}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tstep={0.01}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\taria-labelledby='Zoom'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tonChange={e => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tsetZoom(e.target.value)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tclassName='zoom-range'\r\n\t\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t</section>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t<div className='btn-group'>\r\n\t\t\t\t\t\t\t\t\t\t<button className='btn btn--secondary' onClick={() => updateAvatar(files)}>\r\n\t\t\t\t\t\t\t\t\t\t\tSkip\r\n\t\t\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t\t\t\t<div className='flex-row gap1'>\r\n\t\t\t\t\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\t\t\t\t\tclassName='btn btn--secondary'\r\n\t\t\t\t\t\t\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tsetFiles(null)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tsetCrop({ x: 0, y: 0 })\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tsetZoom(1)\r\n\t\t\t\t\t\t\t\t\t\t\t\t}}>\r\n\t\t\t\t\t\t\t\t\t\t\t\tCancel\r\n\t\t\t\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t\t\t\t\t<button className='btn' onClick={showCroppedImage}>\r\n\t\t\t\t\t\t\t\t\t\t\t\tApply\r\n\t\t\t\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t</Modal>\r\n\t\t\t\t\t</>\r\n\r\n\t\t\t\t\t{userDoc.photoURL && !state.remove && (\r\n\t\t\t\t\t\t<button className='btn btn--secondary' onClick={handleRemoveAvatar}>\r\n\t\t\t\t\t\t\tremove avatar\r\n\t\t\t\t\t\t</button>\r\n\r\n\t\t\t\t\t\t// notifyAvatar(() => (\r\n\t\t\t\t\t\t// \t<div className='reset-toast'>\r\n\t\t\t\t\t\t// \t\tRemoved avatar <span>reset</span>\r\n\t\t\t\t\t\t// \t</div>\r\n\t\t\t\t\t\t// ))\r\n\t\t\t\t\t)}\r\n\t\t\t\t</div>\r\n\t\t\t\t{error && <div className='error'>{error}</div>}\r\n\t\t\t</div>\r\n\t\t)\r\n\t)\r\n}\r\n\r\nexport default AvatarField\r\n","import { useFirestore } from '../../../../../hooks/useFirestore'\r\nimport { useState } from 'react'\r\nimport { useAuthContext } from '../../../../../hooks/useAuthContext'\r\nimport { toast } from 'react-toastify'\r\n\r\n// Components\r\nimport ColorPicker from '../../../../../components/ColorPicker/ColorPicker'\r\n\r\nexport default function BannerField({ setBannerColor, bannerColor }) {\r\n\tconst { user } = useAuthContext()\r\n\tconst { updateDocument } = useFirestore('users')\r\n\r\n\tconst [error, setError] = useState(null)\r\n\tconst [isPending, setIsPending] = useState(false)\r\n\r\n\tconst notify = message =>\r\n\t\ttoast.success(message, {\r\n\t\t\tposition: 'bottom-right',\r\n\t\t\tautoClose: 5000,\r\n\t\t\thideProgressBar: false,\r\n\t\t\tcloseOnClick: true,\r\n\t\t\tpauseOnHover: true,\r\n\t\t\tdraggable: true,\r\n\t\t\tprogress: undefined,\r\n\t\t\ttheme: 'dark',\r\n\t\t})\r\n\r\n\tconst updateBanner = async () => {\r\n\t\tsetError(null)\r\n\t\tsetIsPending(true)\r\n\r\n\t\ttry {\r\n\t\t\tawait updateDocument(user.uid, {\r\n\t\t\t\tbanner: `${bannerColor}`,\r\n\t\t\t})\r\n\r\n\t\t\tsetIsPending(false)\r\n\t\t\tsetError(null)\r\n\t\t\tnotify('Updated banner')\r\n\t\t} catch (error) {\r\n\t\t\tsetError(error.message)\r\n\t\t\tconsole.log(error.message)\r\n\t\t\tsetIsPending(false)\r\n\t\t}\r\n\t}\r\n\r\n\treturn (\r\n\t\t<div className='profile-settings__fields-field flex-row align-end gap1'>\r\n\t\t\t<div className='flex-column'>\r\n\t\t\t\t<h3 className='field-title'>banner color</h3>\r\n\r\n\t\t\t\t<ColorPicker\r\n\t\t\t\t\tvalue={bannerColor}\r\n\t\t\t\t\tsetValue={e => {\r\n\t\t\t\t\t\tsetBannerColor(e.target.value)\r\n\t\t\t\t\t}}\r\n\t\t\t\t\tclassName='mb0'\r\n\t\t\t\t/>\r\n\t\t\t</div>\r\n\r\n\t\t\t<button className='btn btn--secondary' onClick={() => updateBanner()}>\r\n\t\t\t\tUpdate Banner\r\n\t\t\t</button>\r\n\r\n\t\t\t{error && <div className='error'>{error}</div>}\r\n\t\t</div>\r\n\t)\r\n}\r\n","import { useState } from 'react'\r\nimport { toast } from 'react-toastify'\r\nimport { useAuthContext } from '../../../../../hooks/useAuthContext'\r\nimport { useFirestore } from '../../../../../hooks/useFirestore'\r\n\r\nexport default function AboutField({ about, setAbout }) {\r\n\tconst { user } = useAuthContext()\r\n\tconst { updateDocument } = useFirestore('users')\r\n\r\n\tconst [error, setError] = useState(null)\r\n\tconst [isPending, setIsPending] = useState(false)\r\n\r\n\tconst notify = message =>\r\n\t\ttoast.success(message, {\r\n\t\t\tposition: 'bottom-right',\r\n\t\t\tautoClose: 5000,\r\n\t\t\thideProgressBar: false,\r\n\t\t\tcloseOnClick: true,\r\n\t\t\tpauseOnHover: true,\r\n\t\t\tdraggable: true,\r\n\t\t\tprogress: undefined,\r\n\t\t\ttheme: 'dark',\r\n\t\t})\r\n\r\n\tconst updateBio = async () => {\r\n\t\tsetError(null)\r\n\r\n\t\tif (about.length < 71) {\r\n\t\t\ttry {\r\n\t\t\t\tawait updateDocument(user.uid, {\r\n\t\t\t\t\tbio: about,\r\n\t\t\t\t})\r\n\r\n\t\t\t\tsetIsPending(false)\r\n\t\t\t\tsetError(null)\r\n\t\t\t\tnotify('Updated about me')\r\n\t\t\t} catch (error) {\r\n\t\t\t\tsetError(error.message)\r\n\t\t\t\tconsole.log(error.message)\r\n\t\t\t\tsetIsPending(false)\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tsetError('About me must be less than 169 character long')\r\n\t\t}\r\n\t}\r\n\r\n\treturn (\r\n\t\t<div className='profile-settings__fields-field'>\r\n\t\t\t<h3 className='field-title'>about me</h3>\r\n\r\n\t\t\t<div className='textarea-container'>\r\n\t\t\t\t<textarea value={about} onChange={e => setAbout(e.target.value)}></textarea>\r\n\r\n\t\t\t\t<div className={`textarea-container__char-counter ${about.length > 70 ? 'limit' : ''}`}>\r\n\t\t\t\t\t{70 - about.length}\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t\t{error && <div className='error'>{error}</div>}\r\n\t\t\t<button className='btn btn--secondary text-capitalize' onClick={() => updateBio()}>\r\n\t\t\t\tupdate about me\r\n\t\t\t</button>\r\n\t\t</div>\r\n\t)\r\n}\r\n","import AvatarWithStatus from '../../../../components/AvatarWithStatus/AvatarWithStatus'\r\n\r\nexport default function Preview({ userDoc, avatarState, about, bannerColor, setShowAvatarModal }) {\r\n\treturn (\r\n\t\t<div className='profile-preview'>\r\n\t\t\t<div className='profile-preview__banner' style={{ backgroundColor: bannerColor }}></div>\r\n\t\t\t<div className='profile-preview__header'>\r\n\t\t\t\t<div\r\n\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\tsetShowAvatarModal(true)\r\n\t\t\t\t\t}}>\r\n\t\t\t\t\t<AvatarWithStatus userId={userDoc.id} src={avatarState && !avatarState.remove ? avatarState.url : ''} />\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\r\n\t\t\t<div className='profile-preview__info'>\r\n\t\t\t\t<h3 className='name'>{userDoc.displayName}</h3>\r\n\r\n\t\t\t\t<div className='cards'>\r\n\t\t\t\t\t<div className='cards__card'>\r\n\t\t\t\t\t\t{about && (\r\n\t\t\t\t\t\t\t<>\r\n\t\t\t\t\t\t\t\t<h4>About me</h4>\r\n\t\t\t\t\t\t\t\t<p className='bio'>{about}</p>\r\n\t\t\t\t\t\t\t</>\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t<div className='cards__card'>\r\n\t\t\t\t\t\t<h4>Member since</h4>\r\n\t\t\t\t\t\t<p>{userDoc.createdAt}</p>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t)\r\n}\r\n","import { useState } from 'react'\r\nimport { useAuthContext } from '../../../../hooks/useAuthContext'\r\nimport { useDocument } from '../../../../hooks/useDocument'\r\nimport { useEffect } from 'react'\r\n\r\n// Styles && Assets\r\nimport './Profile.scss'\r\n\r\n// Components\r\nimport { ToastContainer } from 'react-toastify'\r\nimport AvatarField from './fields/AvatarField'\r\nimport BannerField from './fields/BannerField'\r\nimport AboutField from './fields/AboutField'\r\nimport Loader from '../../../../components/Loader/Loader'\r\nimport Preview from './Preview'\r\n\r\nconst Profile = () => {\r\n\tconst { user } = useAuthContext()\r\n\tconst { document: userDoc } = useDocument('users', user.uid)\r\n\r\n\tconst [bannerColor, setBannerColor] = useState('#354167')\r\n\r\n\tconst [avatarState, setAvatarState] = useState({})\r\n\tconst [showAvatarModal, setShowAvatarModal] = useState(false)\r\n\r\n\tconst [about, setAbout] = useState('')\r\n\r\n\tuseEffect(() => {\r\n\t\tif (userDoc) {\r\n\t\t\tif (userDoc.banner) setBannerColor(userDoc.banner)\r\n\r\n\t\t\tif (userDoc.bio) setAbout(userDoc.bio)\r\n\t\t}\r\n\t}, [userDoc])\r\n\r\n\tif (!userDoc) return <Loader />\r\n\r\n\tif (userDoc)\r\n\t\treturn (\r\n\t\t\t<div className='profile-settings'>\r\n\t\t\t\t<ToastContainer />\r\n\t\t\t\t<h2 className='setting-title'>customize profile</h2>\r\n\r\n\t\t\t\t<div className='profile-settings__container'>\r\n\t\t\t\t\t<Preview\r\n\t\t\t\t\t\tuserDoc={userDoc}\r\n\t\t\t\t\t\tavatarState={avatarState}\r\n\t\t\t\t\t\tbannerColor={bannerColor}\r\n\t\t\t\t\t\tabout={about}\r\n\t\t\t\t\t\tsetShowAvatarModal={setShowAvatarModal}\r\n\t\t\t\t\t/>\r\n\r\n\t\t\t\t\t<div className='profile-settings__fields'>\r\n\t\t\t\t\t\t<BannerField setBannerColor={setBannerColor} bannerColor={bannerColor} />\r\n\r\n\t\t\t\t\t\t<AvatarField\r\n\t\t\t\t\t\t\tsetAvatarState={e => setAvatarState(e)}\r\n\t\t\t\t\t\t\tuserDoc={userDoc}\r\n\t\t\t\t\t\t\tsetShowAvatarModal={setShowAvatarModal}\r\n\t\t\t\t\t\t\tshowAvatarModal={showAvatarModal}\r\n\t\t\t\t\t\t/>\r\n\r\n\t\t\t\t\t\t<AboutField about={about} setAbout={setAbout} />\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t)\r\n}\r\n\r\nexport default Profile\r\n","const Theme = () => {\r\n\treturn <div className='mt3'>Do I even want to spend time on that?</div>\r\n}\r\n\r\nexport default Theme\r\n","const Premium = () => {\r\n\treturn (\r\n\t\t<div className='mt3'>\r\n\t\t\t<a href='https://buycoffee.to/mhada' target='_blank' rel='noreferrer'>\r\n\t\t\t\t<img\r\n\t\t\t\t\tsrc='https://buycoffee.to/btn/buycoffeeto-btn-primary.svg'\r\n\t\t\t\t\tstyle={{ width: '170px' }}\r\n\t\t\t\t\talt='Postaw mi kaw na buycoffee.to'\r\n\t\t\t\t/>\r\n\t\t\t</a>\r\n\t\t</div>\r\n\t)\r\n}\r\n\r\nexport default Premium\r\n","const PrivacyAndSecurity = () => {\r\n\treturn <div className='mt3'>I guarantee that it's safe</div>\r\n}\r\n\r\nexport default PrivacyAndSecurity\r\n","import { Link, NavLink, Route, Routes } from 'react-router-dom'\r\nimport { useAuthContext } from '../../hooks/useAuthContext'\r\nimport { useLogout } from '../../hooks/useLogout'\r\nimport { useState } from 'react'\r\nimport { useMediaQuery } from 'react-responsive'\r\n\r\n// Styles && Assets\r\nimport './Settings.scss'\r\nimport premiumIcon from '../../assets/premium-account.png'\r\n\r\n// Components\r\nimport AvatarWithStatus from '../../components/AvatarWithStatus/AvatarWithStatus'\r\nimport AccountDetails from './subpages/AccountDetails/AccountDetails'\r\nimport Profile from './subpages/Profile/Profile'\r\nimport Theme from './subpages/Theme/Theme'\r\nimport Premium from './subpages/Premium/Premium'\r\nimport PrivacyAndSecurity from './subpages/PrivacyAndSecurity/PrivacyAndSecurity'\r\n// import Modal from '../../components/Modal/Modal'\r\n// import Loader from '../../components/Loader/Loader'\r\n\r\nexport default function Settings() {\r\n\tconst { user } = useAuthContext()\r\n\tconst { logout, error, isPending } = useLogout()\r\n\r\n\tconst [showPage, setShowPage] = useState(false)\r\n\tconst mediaQueryXL = useMediaQuery({ query: '(min-width: 992px)' })\r\n\t// const [confirmLogout, setConfirmLogout] = useState(false)\r\n\treturn (\r\n\t\t<div className='settings'>\r\n\t\t\t<div className='wrapper'>\r\n\t\t\t\t<aside className='settings__sidebar'>\r\n\t\t\t\t\t<Link to={`/profile/${user.uid}`} className='settings__sidebar-user'>\r\n\t\t\t\t\t\t<AvatarWithStatus userId={user.uid} />\r\n\t\t\t\t\t\t<div className='flex-column'>\r\n\t\t\t\t\t\t\t<h3>{user.displayName}</h3>\r\n\t\t\t\t\t\t\t<p>{user.email && user.email}</p>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</Link>\r\n\r\n\t\t\t\t\t<div className='custom-scrollbar flex-column'>\r\n\t\t\t\t\t\t<NavLink\r\n\t\t\t\t\t\t\tto='/settings/account-details'\r\n\t\t\t\t\t\t\tclassName='settings__sidebar-link'\r\n\t\t\t\t\t\t\tonClick={() => setShowPage(true)}>\r\n\t\t\t\t\t\t\t<i className='fa-solid fa-circle-user'></i>\r\n\t\t\t\t\t\t\t<span>account details</span>\r\n\t\t\t\t\t\t</NavLink>\r\n\t\t\t\t\t\t<NavLink to='/settings/profile' className='settings__sidebar-link' onClick={() => setShowPage(true)}>\r\n\t\t\t\t\t\t\t<i className='fa-solid fa-address-card'></i>\r\n\t\t\t\t\t\t\t<span>profile</span>\r\n\t\t\t\t\t\t</NavLink>\r\n\t\t\t\t\t\t<NavLink to='/settings/theme' className='settings__sidebar-link' onClick={() => setShowPage(true)}>\r\n\t\t\t\t\t\t\t<i className='fa-solid fa-paintbrush'></i>\r\n\t\t\t\t\t\t\t<span>theme</span>\r\n\t\t\t\t\t\t</NavLink>\r\n\t\t\t\t\t\t<NavLink to='/settings/become-cool' className='settings__sidebar-link' onClick={() => setShowPage(true)}>\r\n\t\t\t\t\t\t\t<img src={premiumIcon} alt='Icon for premium account' />\r\n\t\t\t\t\t\t\t<span>premium</span>\r\n\t\t\t\t\t\t</NavLink>\r\n\t\t\t\t\t\t<NavLink\r\n\t\t\t\t\t\t\tto='/settings/privacy-and-security'\r\n\t\t\t\t\t\t\tclassName='settings__sidebar-link'\r\n\t\t\t\t\t\t\tonClick={() => setShowPage(true)}>\r\n\t\t\t\t\t\t\t<i className='fa-solid fa-shield-halved'></i>\r\n\t\t\t\t\t\t\t<span>privacy & security</span>\r\n\t\t\t\t\t\t</NavLink>\r\n\r\n\t\t\t\t\t\t<div className='settings__sidebar-link logout' onClick={() => logout()}>\r\n\t\t\t\t\t\t\t<span>log out</span>\r\n\t\t\t\t\t\t\t<i className='fa-solid fa-arrow-right-from-bracket'></i>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t{/* <Modal show={confirmLogout} setShow={() => setConfirmLogout(false)}>\r\n\t\t\t\t\t\t{!isPending && <i className='fa-regular fa-hand mb05'></i>}\r\n\r\n\t\t\t\t\t\t{isPending && <Loader />}\r\n\r\n\t\t\t\t\t\t<h3 className='mb05'>Come back soon!</h3>\r\n\t\t\t\t\t\t<p>Are you sure you want to Log Out?</p>\r\n\r\n\t\t\t\t\t\t<div className='btn-group'>\r\n\t\t\t\t\t\t\t<button className='btn btn--secondary' onClick={() => setConfirmLogout(false)}>\r\n\t\t\t\t\t\t\t\tcancel\r\n\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t<button className='btn' onClick={() => logout()}>\r\n\t\t\t\t\t\t\t\tlogout\r\n\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t{error && <div className='error'>{error}</div>}\r\n\t\t\t\t\t</Modal> */}\r\n\t\t\t\t</aside>\r\n\r\n\t\t\t\t{(showPage || mediaQueryXL) && (\r\n\t\t\t\t\t<div className='settings__content custom-scrollbar'>\r\n\t\t\t\t\t\t{!mediaQueryXL && <i className='fa-solid fa-arrow-left close-btn' onClick={() => setShowPage(false)}></i>}\r\n\r\n\t\t\t\t\t\t<Routes>\r\n\t\t\t\t\t\t\t<Route path='account-details' element={<AccountDetails />} />\r\n\t\t\t\t\t\t\t<Route path='profile' element={<Profile />} />\r\n\t\t\t\t\t\t\t<Route path='theme' element={<Theme />} />\r\n\t\t\t\t\t\t\t<Route path='become-cool' element={<Premium />} />\r\n\t\t\t\t\t\t\t<Route path='privacy-and-security' element={<PrivacyAndSecurity />} />\r\n\t\t\t\t\t\t</Routes>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t)}\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t)\r\n}\r\n","import { useState } from 'react'\r\nimport { useAuthContext } from '../../hooks/useAuthContext'\r\nimport { Link } from 'react-router-dom'\r\nimport { useDocument } from '../../hooks/useDocument'\r\nimport { useCollection } from '../../hooks/useCollection'\r\n\r\n// Components\r\nimport AvatarWithStatus from '../../components/AvatarWithStatus/AvatarWithStatus'\r\nimport Field from '../../components/Inputs/Field/Field'\r\nimport { useMediaQuery } from 'react-responsive'\r\n\r\nconst FriendsList = () => {\r\n\tconst { user } = useAuthContext()\r\n\tconst { document: currentUserDoc } = useDocument('users', user.uid)\r\n\tconst { documents: users } = useCollection('users')\r\n\r\n\tconst [search, setSearch] = useState('')\r\n\tconst [filter, setFilter] = useState('all')\r\n\r\n\tconst getDoc = id => {\r\n\t\tlet res = null\r\n\r\n\t\tif (users) {\r\n\t\t\tres = users.filter(doc => {\r\n\t\t\t\tif (doc.id === id) {\r\n\t\t\t\t\treturn true\r\n\t\t\t\t}\r\n\t\t\t\treturn false\r\n\t\t\t})[0]\r\n\t\t}\r\n\r\n\t\treturn res\r\n\t}\r\n\r\n\tconst filterUsers = f => {\r\n\t\tif (getDoc(f.id)) {\r\n\t\t\tlet flt\r\n\r\n\t\t\tswitch (filter) {\r\n\t\t\t\tcase 'offline':\r\n\t\t\t\t\tflt = 'invisible'\r\n\t\t\t\t\tbreak\r\n\t\t\t\tcase 'do not disturb':\r\n\t\t\t\t\tflt = 'do-not-disturb'\r\n\t\t\t\t\tbreak\r\n\t\t\t\tcase 'all':\r\n\t\t\t\t\tflt = getDoc(f.id).status\r\n\t\t\t\t\tbreak\r\n\t\t\t\tdefault:\r\n\t\t\t\t\tflt = filter\r\n\t\t\t\t\tbreak\r\n\t\t\t}\r\n\r\n\t\t\tif (getDoc(f.id).status === flt && f.accepted) {\r\n\t\t\t\tif (\r\n\t\t\t\t\tgetDoc(f.id).displayName.toLowerCase().trim().replace(/\\s+/g, '').includes(search.toLowerCase()) ||\r\n\t\t\t\t\tsearch === ''\r\n\t\t\t\t) {\r\n\t\t\t\t\treturn true\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn false\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn false\r\n\t}\r\n\r\n\tconst styleStatus = status => {\r\n\t\tlet styled\r\n\r\n\t\tswitch (status) {\r\n\t\t\tcase 'invisible':\r\n\t\t\t\tstyled = 'Offline'\r\n\t\t\t\tbreak\r\n\t\t\tcase 'do-not-disturb':\r\n\t\t\t\tstyled = 'Do Not Disturb'\r\n\t\t\t\tbreak\r\n\t\t\tdefault:\r\n\t\t\t\tstyled = status\r\n\t\t\t\tbreak\r\n\t\t}\r\n\r\n\t\treturn styled\r\n\t}\r\n\r\n\tconst queryMd = useMediaQuery({ query: '(min-width: 768px)' })\r\n\r\n\treturn (\r\n\t\t<>\r\n\t\t\t<div className={`friends__filter`}>\r\n\t\t\t\t<div className={`friends__filter-item ${filter === 'all' ? 'active' : ''}`} onClick={() => setFilter('all')}>\r\n\t\t\t\t\t<span>all</span>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div\r\n\t\t\t\t\tclassName={`friends__filter-item ${filter === 'online' ? 'active' : ''}`}\r\n\t\t\t\t\tonClick={() => setFilter('online')}>\r\n\t\t\t\t\t<div className='status status--online'></div>\r\n\t\t\t\t\t{queryMd && <span>online</span>}\r\n\t\t\t\t</div>\r\n\t\t\t\t<div className={`friends__filter-item ${filter === 'idle' ? 'active' : ''}`} onClick={() => setFilter('idle')}>\r\n\t\t\t\t\t<div className='status status--idle'></div>\r\n\t\t\t\t\t{queryMd && <span>idle</span>}\r\n\t\t\t\t</div>\r\n\t\t\t\t<div\r\n\t\t\t\t\tclassName={`friends__filter-item ${filter === 'do not disturb' ? 'active' : ''}`}\r\n\t\t\t\t\tonClick={() => setFilter('do not disturb')}>\r\n\t\t\t\t\t<div className='status status--do-not-disturb'></div>\r\n\t\t\t\t\t{queryMd && <span>do not disturb</span>}\r\n\t\t\t\t</div>\r\n\t\t\t\t<div\r\n\t\t\t\t\tclassName={`friends__filter-item ${filter === 'offline' ? 'active' : ''}`}\r\n\t\t\t\t\tonClick={() => setFilter('offline')}>\r\n\t\t\t\t\t<div className='status status--offline'></div>\r\n\t\t\t\t\t{queryMd && <span>offline</span>}\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\r\n\t\t\t<Field\r\n\t\t\t\tvalue={search}\r\n\t\t\t\tsetValue={setSearch}\r\n\t\t\t\tlabel='Search'\r\n\t\t\t\tafter={<i className='fa-solid fa-magnifying-glass'></i>}\r\n\t\t\t\tbefore={<i className='fa-solid fa-magnifying-glass'></i>}\r\n\t\t\t/>\r\n\r\n\t\t\t{currentUserDoc && currentUserDoc.friends && currentUserDoc.friends.filter(f => filterUsers(f)).length > 0 ? (\r\n\t\t\t\t<div className='friends__list'>\r\n\t\t\t\t\t<div className='friends__list-title'>\r\n\t\t\t\t\t\t{filter} - {currentUserDoc.friends.filter(f => filterUsers(f)).length}\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t<div className='friends__list-users'>\r\n\t\t\t\t\t\t{currentUserDoc.friends.map(\r\n\t\t\t\t\t\t\tf =>\r\n\t\t\t\t\t\t\t\tfilterUsers(f) && (\r\n\t\t\t\t\t\t\t\t\t<Link to={`/profile/${f.id}`} className='user' key={f.id}>\r\n\t\t\t\t\t\t\t\t\t\t<div className='flex-row gap05 w100'>\r\n\t\t\t\t\t\t\t\t\t\t\t<AvatarWithStatus userId={f.id} />\r\n\t\t\t\t\t\t\t\t\t\t\t<div className='flex-column w100 overflow-hidden'>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<p>{getDoc(f.id) && getDoc(f.id).displayName}</p>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<p>{getDoc(f.id) && styleStatus(getDoc(f.id).status)}</p>\r\n\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t</Link>\r\n\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t) : (\r\n\t\t\t\t<div className='absolute-center'>No user to be found</div>\r\n\t\t\t)}\r\n\t\t</>\r\n\t)\r\n}\r\n\r\nexport default FriendsList\r\n","import { useState } from 'react'\r\nimport { Link } from 'react-router-dom'\r\nimport { toast, ToastContainer } from 'react-toastify'\r\nimport { useAuthContext } from '../../hooks/useAuthContext'\r\nimport { useCollection } from '../../hooks/useCollection'\r\nimport { useDocument } from '../../hooks/useDocument'\r\nimport { useFirestore } from '../../hooks/useFirestore'\r\n\r\n// Components\r\nimport Field from '../../components/Inputs/Field/Field'\r\n\r\nconst AddFriend = () => {\r\n\tconst { user } = useAuthContext()\r\n\tconst { document: currentUserDoc } = useDocument('users', user.uid)\r\n\tconst { documents: users } = useCollection('users')\r\n\tconst { updateDocument } = useFirestore('users')\r\n\r\n\tconst [inputError, setInputError] = useState(null)\r\n\tconst [userCode, setUserCode] = useState('')\r\n\r\n\tconst notify = message =>\r\n\t\ttoast.success(message, {\r\n\t\t\tposition: 'bottom-right',\r\n\t\t\tautoClose: 5000,\r\n\t\t\thideProgressBar: false,\r\n\t\t\tcloseOnClick: true,\r\n\t\t\tpauseOnHover: true,\r\n\t\t\tdraggable: true,\r\n\t\t\tprogress: undefined,\r\n\t\t\ttheme: 'dark',\r\n\t\t})\r\n\r\n\tconst addFriend = async () => {\r\n\t\tsetInputError(null)\r\n\r\n\t\tlet userDoc = null\r\n\r\n\t\tusers.forEach(u => {\r\n\t\t\tif (u.id === userCode.trim()) {\r\n\t\t\t\tuserDoc = u\r\n\t\t\t}\r\n\t\t})\r\n\r\n\t\tif (userCode === '') {\r\n\t\t\tsetInputError('Please enter code')\r\n\t\t\treturn\r\n\t\t}\r\n\t\tif (userDoc === null) {\r\n\t\t\tsetInputError('Could not find user with this id')\r\n\t\t\treturn\r\n\t\t}\r\n\t\tif (currentUserDoc.friends && currentUserDoc.friends.some(f => f.id === userCode.trim())) {\r\n\t\t\tsetInputError(\"You've already invited this user or this user has invited you\")\r\n\t\t\treturn\r\n\t\t}\r\n\r\n\t\ttry {\r\n\t\t\tawait updateDocument(user.uid, {\r\n\t\t\t\tfriends: [\r\n\t\t\t\t\t...(currentUserDoc.friends ? currentUserDoc.friends : []),\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tid: userDoc.id,\r\n\t\t\t\t\t\tisPending: false,\r\n\t\t\t\t\t\taccepted: false,\r\n\t\t\t\t\t},\r\n\t\t\t\t],\r\n\t\t\t})\r\n\r\n\t\t\tawait updateDocument(userDoc.id, {\r\n\t\t\t\tfriends: [\r\n\t\t\t\t\t...(userDoc.friends ? userDoc.friends : []),\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tid: currentUserDoc.id,\r\n\t\t\t\t\t\tisPending: true,\r\n\t\t\t\t\t\taccepted: false,\r\n\t\t\t\t\t},\r\n\t\t\t\t],\r\n\t\t\t})\r\n\r\n\t\t\tnotify('Successfully sent invite')\r\n\t\t\tsetUserCode('')\r\n\t\t} catch (error) {\r\n\t\t\tsetInputError(error.message)\r\n\t\t\tconsole.log(error.message)\r\n\t\t}\r\n\t}\r\n\r\n\treturn (\r\n\t\t<div className='friends__add'>\r\n\t\t\t<ToastContainer />\r\n\t\t\t<h3 className='friends__add-title'>add friend</h3>\r\n\t\t\t<div className='friends__add-description'>\r\n\t\t\t\t<span>Enter invite code of user you want to add. </span>\r\n\t\t\t\t<span>\r\n\t\t\t\t\tYou can find the code in <Link to='/settings/account-details'>account settings.</Link>\r\n\t\t\t\t</span>\r\n\t\t\t</div>\r\n\r\n\t\t\t<Field\r\n\t\t\t\tvalue={userCode}\r\n\t\t\t\tsetValue={setUserCode}\r\n\t\t\t\tplaceholder='Enter Code'\r\n\t\t\t\terror={inputError}\r\n\t\t\t\tresetError={() => setInputError(null)}\r\n\t\t\t\tafter={\r\n\t\t\t\t\t<button className='btn btn--secondary text-capitalize' onClick={() => addFriend()}>\r\n\t\t\t\t\t\tinvite\r\n\t\t\t\t\t</button>\r\n\t\t\t\t}\r\n\t\t\t/>\r\n\t\t</div>\r\n\t)\r\n}\r\n\r\nexport default AddFriend\r\n","import { useState } from 'react'\r\nimport { toast, ToastContainer } from 'react-toastify'\r\nimport Avatar from '../../components/Avatar/Avatar'\r\nimport Tooltip from '../../components/Tooltip/Tooltip'\r\nimport { projectFirestore, timestamp } from '../../firebase/config'\r\nimport { useAuthContext } from '../../hooks/useAuthContext'\r\nimport { useCollection } from '../../hooks/useCollection'\r\nimport { useDocument } from '../../hooks/useDocument'\r\nimport { useFirestore } from '../../hooks/useFirestore'\r\nimport { doc, setDoc } from 'firebase/firestore'\r\n\r\nconst PendingInvites = () => {\r\n\tconst { user } = useAuthContext()\r\n\tconst { documents: users } = useCollection('users')\r\n\tconst { documents: chats } = useCollection('projects')\r\n\tconst { document: currentUserDoc } = useDocument('users', user.uid)\r\n\tconst { updateDocument } = useFirestore('users')\r\n\r\n\tconst [error, setError] = useState(null)\r\n\r\n\tconst notify = message =>\r\n\t\ttoast.success(message, {\r\n\t\t\tposition: 'bottom-right',\r\n\t\t\tautoClose: 5000,\r\n\t\t\thideProgressBar: false,\r\n\t\t\tcloseOnClick: true,\r\n\t\t\tpauseOnHover: true,\r\n\t\t\tdraggable: true,\r\n\t\t\tprogress: undefined,\r\n\t\t\ttheme: 'dark',\r\n\t\t})\r\n\r\n\tconst getDoc = id => {\r\n\t\tlet res = null\r\n\r\n\t\tif (users) {\r\n\t\t\tres = users.filter(doc => {\r\n\t\t\t\tif (doc.id === id) {\r\n\t\t\t\t\treturn true\r\n\t\t\t\t}\r\n\t\t\t\treturn false\r\n\t\t\t})[0]\r\n\t\t}\r\n\r\n\t\treturn res\r\n\t}\r\n\r\n\tconst handleSelect = async addUser => {\r\n\t\tconst combinedId = user.uid > addUser.id ? user.uid + addUser.id : addUser.id + user.uid\r\n\r\n\t\tconst docToAdd = {\r\n\t\t\tid: combinedId,\r\n\t\t\tassignedUsers: [\r\n\t\t\t\t{\r\n\t\t\t\t\tid: user.uid,\r\n\t\t\t\t\tnickname: user.displayName,\r\n\t\t\t\t},\r\n\t\t\t\t{\r\n\t\t\t\t\tid: addUser.id,\r\n\t\t\t\t\tnickname: addUser.displayName,\r\n\t\t\t\t},\r\n\t\t\t],\r\n\t\t\tassignedUsersId: [user.uid, addUser.id],\r\n\t\t\tchatEmoji: '1f44d',\r\n\t\t\tmessages: [],\r\n\t\t\tupdatedAt: timestamp.fromDate(new Date()),\r\n\t\t\tcreatedAt: timestamp.fromDate(new Date()),\r\n\t\t\tcustomThemes: [],\r\n\t\t}\r\n\r\n\t\ttry {\r\n\t\t\tconst exists = chats.some(c => c.id === combinedId)\r\n\r\n\t\t\tif (!exists && user.uid !== addUser.id) {\r\n\t\t\t\t// Create a chat in chats collection\r\n\r\n\t\t\t\t// await addDocument(docToAdd)\r\n\t\t\t\tawait setDoc(doc(projectFirestore, 'projects', combinedId), docToAdd)\r\n\t\t\t}\r\n\t\t} catch (err) {\r\n\t\t\tconsole.log(err.message)\r\n\t\t\tsetError(err.message)\r\n\t\t}\r\n\t}\r\n\r\n\tconst acceptInvite = async (u, index) => {\r\n\t\tsetError(null)\r\n\r\n\t\tconst arrCopy = currentUserDoc.friends\r\n\r\n\t\tarrCopy[index] = {\r\n\t\t\tid: u.id,\r\n\t\t\tisPending: false,\r\n\t\t\taccepted: true,\r\n\t\t}\r\n\r\n\t\tconst arrCopy2 = getDoc(u.id).friends\r\n\t\tlet index2\r\n\r\n\t\tarrCopy2.some((f, i) => {\r\n\t\t\tif (f.id === currentUserDoc.id) {\r\n\t\t\t\tindex2 = i\r\n\t\t\t\treturn true\r\n\t\t\t}\r\n\t\t\treturn false\r\n\t\t})\r\n\r\n\t\tarrCopy2[index2] = {\r\n\t\t\tid: currentUserDoc.id,\r\n\t\t\tisPending: false,\r\n\t\t\taccepted: true,\r\n\t\t}\r\n\r\n\t\ttry {\r\n\t\t\tawait updateDocument(user.uid, {\r\n\t\t\t\tfriends: arrCopy,\r\n\t\t\t})\r\n\r\n\t\t\tawait updateDocument(u.id, {\r\n\t\t\t\tfriends: arrCopy2,\r\n\t\t\t})\r\n\r\n\t\t\tawait handleSelect(getDoc(u.id))\r\n\r\n\t\t\tnotify('Successfully added user to your friends')\r\n\t\t} catch (error) {\r\n\t\t\tsetError(error.message)\r\n\t\t\tconsole.log(error.message)\r\n\t\t}\r\n\t}\r\n\r\n\tconst declineInvite = async (u, index) => {\r\n\t\tsetError(null)\r\n\r\n\t\tconst arrCopy = currentUserDoc.friends\r\n\t\tarrCopy.splice(index, 1)\r\n\r\n\t\tconst arrCopy2 = getDoc(u.id).friends\r\n\r\n\t\tlet index2\r\n\t\tarrCopy2.some((f, i) => {\r\n\t\t\tif (f.id === currentUserDoc.id) {\r\n\t\t\t\tindex2 = i\r\n\t\t\t\treturn true\r\n\t\t\t}\r\n\t\t\treturn false\r\n\t\t})\r\n\t\tarrCopy2.splice(index2, 1)\r\n\r\n\t\ttry {\r\n\t\t\tawait updateDocument(user.uid, {\r\n\t\t\t\tfriends: arrCopy,\r\n\t\t\t})\r\n\r\n\t\t\tawait updateDocument(u.id, {\r\n\t\t\t\tfriends: arrCopy2,\r\n\t\t\t})\r\n\r\n\t\t\tnotify('Successfully declined/canceled invitation')\r\n\t\t} catch (error) {\r\n\t\t\tsetError(error.message)\r\n\t\t\tconsole.log(error.message)\r\n\t\t}\r\n\t}\r\n\r\n\treturn (\r\n\t\t<div className='friends__invites mt2'>\r\n\t\t\t<ToastContainer />\r\n\t\t\t{currentUserDoc && currentUserDoc.friends && (\r\n\t\t\t\t<>\r\n\t\t\t\t\t{currentUserDoc.friends.map(\r\n\t\t\t\t\t\t(f, index) =>\r\n\t\t\t\t\t\t\t!f.isPending &&\r\n\t\t\t\t\t\t\t!f.accepted && (\r\n\t\t\t\t\t\t\t\t<div className='friends__invites-user' key={f.id}>\r\n\t\t\t\t\t\t\t\t\t<div className='flex-row gap1 w100'>\r\n\t\t\t\t\t\t\t\t\t\t<Avatar src={getDoc(f.id) && getDoc(f.id).photoURL} />\r\n\r\n\t\t\t\t\t\t\t\t\t\t<div className='flex-column flex-grow-1'>\r\n\t\t\t\t\t\t\t\t\t\t\t<p>{getDoc(f.id) && getDoc(f.id).displayName}</p>\r\n\t\t\t\t\t\t\t\t\t\t\t<p>You invited this user</p>\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t\t\t<div className='flex-row gap1 options'>\r\n\t\t\t\t\t\t\t\t\t\t<div className='options__decline' onClick={() => declineInvite(f, index)}>\r\n\t\t\t\t\t\t\t\t\t\t\t<Tooltip>Cancel invite</Tooltip>\r\n\t\t\t\t\t\t\t\t\t\t\t<i className='fa-solid fa-xmark'></i>\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t)\r\n\t\t\t\t\t)}\r\n\r\n\t\t\t\t\t{currentUserDoc.friends.filter(f => !f.accepted && !f.isPending).length > 0 ? (\r\n\t\t\t\t\t\t<div className='separator mb1 mt1'></div>\r\n\t\t\t\t\t) : (\r\n\t\t\t\t\t\t''\r\n\t\t\t\t\t)}\r\n\t\t\t\t\t{currentUserDoc.friends.filter(f => !f.accepted).length === 0 ? (\r\n\t\t\t\t\t\t<div className='absolute-center'>There are no pending invites</div>\r\n\t\t\t\t\t) : (\r\n\t\t\t\t\t\t''\r\n\t\t\t\t\t)}\r\n\r\n\t\t\t\t\t{currentUserDoc.friends.map(\r\n\t\t\t\t\t\t(f, index) =>\r\n\t\t\t\t\t\t\tf.isPending &&\r\n\t\t\t\t\t\t\t!f.accepted && (\r\n\t\t\t\t\t\t\t\t<div className='friends__invites-user' key={f.id}>\r\n\t\t\t\t\t\t\t\t\t<div className='flex-row gap1'>\r\n\t\t\t\t\t\t\t\t\t\t<Avatar src={getDoc(f.id) && getDoc(f.id).photoURL} />\r\n\r\n\t\t\t\t\t\t\t\t\t\t<div className='flex-column'>\r\n\t\t\t\t\t\t\t\t\t\t\t<p>{getDoc(f.id) && getDoc(f.id).displayName}</p>\r\n\t\t\t\t\t\t\t\t\t\t\t<p>Sent you an invite</p>\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t\t\t<div className='flex-row gap1 options'>\r\n\t\t\t\t\t\t\t\t\t\t<div className='options__decline' onClick={() => declineInvite(f, index)}>\r\n\t\t\t\t\t\t\t\t\t\t\t<Tooltip>Decline</Tooltip>\r\n\t\t\t\t\t\t\t\t\t\t\t<i className='fa-solid fa-xmark'></i>\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t\t\t\t<div className='options__accept' onClick={() => acceptInvite(f, index)}>\r\n\t\t\t\t\t\t\t\t\t\t\t<Tooltip>Accept</Tooltip>\r\n\t\t\t\t\t\t\t\t\t\t\t<i className='fa-solid fa-check'></i>\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t)\r\n\t\t\t\t\t)}\r\n\t\t\t\t</>\r\n\t\t\t)}\r\n\r\n\t\t\t{error && <div className='error'>{error}</div>}\r\n\t\t</div>\r\n\t)\r\n}\r\nexport default PendingInvites\r\n","import { useEffect, useState } from 'react'\r\nimport { useAuthContext } from '../../hooks/useAuthContext'\r\nimport { useDocument } from '../../hooks/useDocument'\r\nimport { useMediaQuery } from 'react-responsive'\r\n\r\n// Styles\r\nimport './Friends.scss'\r\n\r\n// Components\r\nimport FriendsList from './FriendsList'\r\nimport AddFriend from './AddFriend'\r\nimport PendingInvites from './PendingInvites'\r\n\r\nconst Friends = () => {\r\n\tconst { user } = useAuthContext()\r\n\tconst { document: currentUserDoc } = useDocument('users', user.uid)\r\n\r\n\tconst [view, setView] = useState('list') // list, pending, add\r\n\tconst [invitesAmount, setInvitesAmount] = useState(0)\r\n\r\n\tuseEffect(() => {\r\n\t\tif (currentUserDoc && currentUserDoc.friends) {\r\n\t\t\tsetInvitesAmount(\r\n\t\t\t\tcurrentUserDoc.friends.filter(f => {\r\n\t\t\t\t\tif (f.isPending) return true\r\n\t\t\t\t\treturn false\r\n\t\t\t\t}).length\r\n\t\t\t)\r\n\t\t}\r\n\t}, [currentUserDoc])\r\n\r\n\tconst queryMd = useMediaQuery({ query: '(max-width: 768px)' })\r\n\r\n\treturn (\r\n\t\tcurrentUserDoc && (\r\n\t\t\t<div className='friends wrapper'>\r\n\t\t\t\t<div className='friends__title-bar'>\r\n\t\t\t\t\t<div className='friends__title-bar-title' onClick={() => setView('list')}>\r\n\t\t\t\t\t\t<h2>Friends</h2>\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t<div className='flex-row gap1'>\r\n\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\tclassName={`friends__title-bar-pending ${view === 'pending' ? 'active' : ''}`}\r\n\t\t\t\t\t\t\tonClick={() => setView('pending')}>\r\n\t\t\t\t\t\t\t{!queryMd && <span>pending</span>}\r\n\t\t\t\t\t\t\t{queryMd && invitesAmount === 0 && <i className='fa-solid fa-envelope'></i>}\r\n\t\t\t\t\t\t\t{invitesAmount > 0 && (\r\n\t\t\t\t\t\t\t\t<>\r\n\t\t\t\t\t\t\t\t\t<i className='fa-solid fa-envelope'></i>\r\n\t\t\t\t\t\t\t\t\t<div className='pending-indicator'>\r\n\t\t\t\t\t\t\t\t\t\t<p>{invitesAmount}</p>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t</>\r\n\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\tclassName={`friends__title-bar-add ${view === 'add' ? 'active' : ''} ${queryMd ? 'mobile' : ''}`}\r\n\t\t\t\t\t\t\tonClick={() => setView('add')}>\r\n\t\t\t\t\t\t\t{!queryMd && (\r\n\t\t\t\t\t\t\t\t<>\r\n\t\t\t\t\t\t\t\t\t<span>add friend</span>\r\n\t\t\t\t\t\t\t\t\t<i className='fa-solid fa-user-plus'></i>\r\n\t\t\t\t\t\t\t\t</>\r\n\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t{queryMd && <i className='fa-solid fa-user-plus mobile'></i>}\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\r\n\t\t\t\t{view === 'list' && <FriendsList />}\r\n\t\t\t\t{view === 'add' && <AddFriend />}\r\n\t\t\t\t{view === 'pending' && <PendingInvites />}\r\n\t\t\t</div>\r\n\t\t)\r\n\t)\r\n}\r\n\r\nexport default Friends\r\n","import React, { useEffect, useState } from 'react'\r\nimport { NavLink, useLocation } from 'react-router-dom'\r\nimport { useAuthContext } from '../../../hooks/useAuthContext'\r\nimport { useCollection } from '../../../hooks/useCollection'\r\nimport { useDocument } from '../../../hooks/useDocument'\r\n\r\n// Styles\r\nimport './TabBar.scss'\r\n\r\nexport default function TabBar() {\r\n\tconst location = useLocation()\r\n\r\n\tconst { user } = useAuthContext()\r\n\tconst { documents: chats } = useCollection(\r\n\t\t'projects',\r\n\t\t['assignedUsersId', 'array-contains', user.uid],\r\n\t\t['updatedAt', 'desc']\r\n\t)\r\n\r\n\tconst { document: userDoc } = useDocument('users', user.uid)\r\n\r\n\tconst [currentPath, setCurrentPath] = useState('')\r\n\tconst [latestChat, setLatestChat] = useState()\r\n\tconst [invitesAmount, setInvitesAmount] = useState(0)\r\n\r\n\tuseEffect(() => {\r\n\t\tif (chats && chats !== null && chats.length !== 0) {\r\n\t\t\tsetLatestChat(chats[0])\r\n\t\t} else {\r\n\t\t\tsetLatestChat('')\r\n\t\t}\r\n\t}, [chats, userDoc])\r\n\r\n\tuseEffect(() => {\r\n\t\tif (userDoc && userDoc.friends) {\r\n\t\t\tsetInvitesAmount(\r\n\t\t\t\tuserDoc.friends.filter(f => {\r\n\t\t\t\t\tif (f.isPending) return true\r\n\t\t\t\t\treturn false\r\n\t\t\t\t}).length\r\n\t\t\t)\r\n\t\t}\r\n\t}, [userDoc])\r\n\r\n\tuseEffect(() => {\r\n\t\tsetCurrentPath(location.pathname)\r\n\t}, [location])\r\n\r\n\treturn (\r\n\t\t<nav className='tab-bar'>\r\n\t\t\t<NavLink\r\n\t\t\t\tto={`/u/${latestChat && latestChat.id}`}\r\n\t\t\t\tclassName={`tab-bar__link  ${currentPath.includes('/u/') ? 'active' : ''}`}>\r\n\t\t\t\t<i className='fa-solid fa-comment'></i>\r\n\t\t\t\t<div className='tab-bar__link-description'>Chat</div>\r\n\t\t\t</NavLink>\r\n\r\n\t\t\t<NavLink to='/' className='tab-bar__link'>\r\n\t\t\t\t<i className='fa-solid fa-house'></i>\r\n\t\t\t\t<div className='tab-bar__link-description'>Home</div>\r\n\t\t\t</NavLink>\r\n\r\n\t\t\t<NavLink to='/friends' className='tab-bar__link tab-bar__link--friends'>\r\n\t\t\t\t<i className='fa-solid fa-address-book'></i>\r\n\t\t\t\t{invitesAmount > 0 && (\r\n\t\t\t\t\t<div className='pending-indicator'>\r\n\t\t\t\t\t\t<p>{invitesAmount}</p>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t)}\r\n\t\t\t\t<div className='tab-bar__link-description'>Friends</div>\r\n\t\t\t</NavLink>\r\n\r\n\t\t\t<NavLink\r\n\t\t\t\tto='/settings/account-details'\r\n\t\t\t\tclassName={`tab-bar__link ${\r\n\t\t\t\t\t[\r\n\t\t\t\t\t\t'/settings/account-details',\r\n\t\t\t\t\t\t'/settings/profile',\r\n\t\t\t\t\t\t'/settings/theme',\r\n\t\t\t\t\t\t'/settings',\r\n\t\t\t\t\t\t'/settings/',\r\n\t\t\t\t\t\t'/settings/become-cool',\r\n\t\t\t\t\t\t'/settings/privacy-and-security',\r\n\t\t\t\t\t].includes(location.pathname)\r\n\t\t\t\t\t\t? 'active'\r\n\t\t\t\t\t\t: ''\r\n\t\t\t\t}`}>\r\n\t\t\t\t<i className='fa-solid fa-gear'></i>\r\n\t\t\t\t<div className='tab-bar__link-description'>Settings</div>\r\n\t\t\t</NavLink>\r\n\t\t</nav>\r\n\t)\r\n}\r\n","import { useEffect, useRef, useState } from 'react'\r\nimport { BrowserRouter, Route, Routes, Navigate, Link } from 'react-router-dom'\r\nimport { useAuthContext } from './hooks/useAuthContext'\r\nimport { GlobalStyles } from './theme/GlobalStyles'\r\nimport { useCollection } from './hooks/useCollection'\r\nimport { ThemeProvider } from 'styled-components'\r\n\r\n// Styles\r\nimport './App.scss'\r\nimport 'react-toastify/dist/ReactToastify.css'\r\n\r\n// Components && Pages\r\nimport Dashboard from './pages/dashboard/Dashboard'\r\nimport Chat from './pages/chat/Chat'\r\nimport Login from './pages/auth/login/Login'\r\nimport Signup from './pages/auth/signup/Signup'\r\nimport PrivacyPolicy from './pages/privacyPolicy/privacyPolicy'\r\nimport ResetPassword from './pages/auth/resetPassword/ResetPassword'\r\nimport SetNewPassword from './pages/auth/resetPassword/SetNewPassword'\r\nimport Chats from './components/Chats/Chats'\r\nimport ToolBar from './components/ToolBar/ToolBar'\r\nimport Profile from './pages/profile/Profile'\r\nimport Settings from './pages/settings/Settings'\r\nimport Friends from './pages/friends/Friends'\r\n\r\nimport MediaQuery from 'react-responsive'\r\nimport TabBar from './components/Mobile/TabBar/TabBar'\r\n\r\nfunction App() {\r\n\tconst inputRef = useRef(null)\r\n\r\n\tconst { user, authIsReady } = useAuthContext()\r\n\tconst { documents: themes } = useCollection('themes')\r\n\r\n\tconst [currentChat, setCurrentChat] = useState(null)\r\n\tconst [theme, setTheme] = useState(themes)\r\n\r\n\tconst filterTheme = themeToSet => {\r\n\t\tlet filteredTheme\r\n\r\n\t\tif (themeToSet.isCustom === true) {\r\n\t\t\tif (currentChat.customThemes) {\r\n\t\t\t\tcurrentChat.customThemes.forEach(theme => {\r\n\t\t\t\t\tif (theme.id === themeToSet.name) filteredTheme = theme\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tif (themes) {\r\n\t\t\t\tthemes.forEach(theme => {\r\n\t\t\t\t\tif (theme.id === themeToSet.name) filteredTheme = theme\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn filteredTheme\r\n\t}\r\n\r\n\tuseEffect(() => {\r\n\t\tif (currentChat) {\r\n\t\t\tcurrentChat.theme\r\n\t\t\t\t? setTheme(filterTheme(currentChat.theme))\r\n\t\t\t\t: setTheme(filterTheme({ name: 'frosty', isCustom: false }))\r\n\t\t} else if (themes) {\r\n\t\t\tsetTheme(filterTheme({ name: 'frosty', isCustom: false }))\r\n\t\t}\r\n\t}, [themes, currentChat])\r\n\r\n\tconst [showChat, setShowChat] = useState(false)\r\n\r\n\treturn (\r\n\t\tauthIsReady &&\r\n\t\ttheme && (\r\n\t\t\t<ThemeProvider theme={theme}>\r\n\t\t\t\t<GlobalStyles />\r\n\t\t\t\t<div className='App'>\r\n\t\t\t\t\t<BrowserRouter>\r\n\t\t\t\t\t\t<MediaQuery minWidth={769}>{user && <ToolBar />}</MediaQuery>\r\n\t\t\t\t\t\t<Routes>\r\n\t\t\t\t\t\t\t<Route path='/' element={user ? <Dashboard /> : <Navigate to='/login' />} />\r\n\t\t\t\t\t\t\t<Route\r\n\t\t\t\t\t\t\t\tpath='/u/:id'\r\n\t\t\t\t\t\t\t\telement={\r\n\t\t\t\t\t\t\t\t\tuser ? (\r\n\t\t\t\t\t\t\t\t\t\t[\r\n\t\t\t\t\t\t\t\t\t\t\t<Chats currentChat={currentChat} inputRef={inputRef} key='chats' setShowChat={setShowChat} />,\r\n\t\t\t\t\t\t\t\t\t\t\t<Chat\r\n\t\t\t\t\t\t\t\t\t\t\t\tsetCurrentChat={setCurrentChat}\r\n\t\t\t\t\t\t\t\t\t\t\t\tinputRef={inputRef}\r\n\t\t\t\t\t\t\t\t\t\t\t\tcurrentTheme={theme}\r\n\t\t\t\t\t\t\t\t\t\t\t\tkey='chat'\r\n\t\t\t\t\t\t\t\t\t\t\t\tshowChat={showChat}\r\n\t\t\t\t\t\t\t\t\t\t\t\tsetShowChat={setShowChat}\r\n\t\t\t\t\t\t\t\t\t\t\t/>,\r\n\t\t\t\t\t\t\t\t\t\t]\r\n\t\t\t\t\t\t\t\t\t) : (\r\n\t\t\t\t\t\t\t\t\t\t<Navigate to='/' />\r\n\t\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t<Route\r\n\t\t\t\t\t\t\t\tpath='/u/'\r\n\t\t\t\t\t\t\t\telement={\r\n\t\t\t\t\t\t\t\t\t<div className='no-chats absolute-center '>\r\n\t\t\t\t\t\t\t\t\t\t<h2>no chats yet</h2>\r\n\t\t\t\t\t\t\t\t\t\t<Link to='/friends/'>\r\n\t\t\t\t\t\t\t\t\t\t\t<button className='btn btn--secondary'>add friends</button>\r\n\t\t\t\t\t\t\t\t\t\t</Link>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t<Route path='/profile/:id' element={user ? <Profile /> : <Navigate to='/' />} />\r\n\t\t\t\t\t\t\t<Route path='/friends' element={user ? <Friends /> : <Navigate to='/' />} />\r\n\t\t\t\t\t\t\t<Route path='/settings/*' element={user ? <Settings /> : <Navigate to='/' />} />\r\n\t\t\t\t\t\t\t<Route path='/privacy-policy' element={<PrivacyPolicy />} />\r\n\t\t\t\t\t\t\t<Route path='/recover-password' element={<ResetPassword />} />\r\n\t\t\t\t\t\t\t<Route path='/login' element={user ? <Navigate to='/' /> : <Login />} />\r\n\t\t\t\t\t\t\t<Route path='/signup' element={user ? <Navigate to='/' /> : <Signup />} />\r\n\t\t\t\t\t\t\t<Route path='/set-new-password' element={<SetNewPassword />} />\r\n\t\t\t\t\t\t</Routes>\r\n\r\n\t\t\t\t\t\t<MediaQuery maxWidth={768}>{user && <TabBar />}</MediaQuery>\r\n\t\t\t\t\t</BrowserRouter>\r\n\t\t\t\t</div>\r\n\t\t\t</ThemeProvider>\r\n\t\t)\r\n\t)\r\n}\r\n\r\nexport default App\r\n","import React from 'react'\nimport ReactDOM from 'react-dom'\nimport './index.scss'\nimport App from './App'\nimport { AuthContextProvider } from './context/AuthContext'\n\nReactDOM.render(\n\t<React.StrictMode>\n\t\t<AuthContextProvider>\n\t\t\t<App />\n\t\t</AuthContextProvider>\n\t</React.StrictMode>,\n\tdocument.getElementById('root')\n)\n\t"],"sourceRoot":""}