{"version":3,"sources":["firebase/config.js","context/AuthContext.js","hooks/useAuthContext.js","pages/dashboard/Dashboard.js","hooks/useDocument.js","hooks/useDates.js","hooks/useFirestore.js","components/Avatar.js","components/Comments.js","assets/send-icon.svg","assets/image.svg","assets/x.svg","assets/smile.svg","components/ChatInput.js","pages/chat/Chat.js","hooks/useLogin.js","assets/btn_google_dark_normal_ios.svg","assets/GitHub-Mark-Light-32px.png","pages/login/Login.js","pages/signup/Signup.js","hooks/useSignup.js","pages/privacyPolicy/privacyPolicy.js","assets/shrek-gif.gif","pages/login/ResetPassword.js","hooks/useCollection.js","components/ChatsList.js","components/Chats.js","hooks/useLogout.js","App.js","index.js"],"names":["firebase","initializeApp","apiKey","authDomain","projectId","storageBucket","messagingSenderId","appId","projectFirestore","firestore","projectAuth","auth","projectStorage","storage","projectGoogle","GoogleAuthProvider","projectGitHub","GithubAuthProvider","setCustomParameters","prompt","timestamp","Timestamp","AuthContext","createContext","authReducer","state","action","type","user","payload","authIsReady","AuthContextProvider","children","useReducer","dispatch","useEffect","unsub","onAuthStateChanged","Provider","value","useAuthContext","context","useContext","Error","Dashboard","className","useDates","dayOfMonth","dayOfWeek","month","year","hour","curDate","fullDate","today","Date","toLocaleDateString","weekday","formatDate","comment","date","createdAt","toDate","getDay","getFullYear","getMonth","getDate","toString","toLocaleTimeString","minute","dateToFormat","lastMonday","setDate","setHours","getTime","isCurrentWeek","dates","initialState","document","isPending","error","success","firestoreReducer","useFirestore","collection","response","useState","isCancelled","setIsCancelled","ref","dispatchIfNotCancelled","addDocument","doc","a","fromDate","add","addedDocument","message","deleteDocument","id","delete","updateDocument","updates","update","updatedDocument","Avatar","src","alt","_defs","_path","Comments","chat","onQuery","showImage","setShowImage","messageToDelete","setMessageToDelete","history","useHistory","listen","handleMessageStyle","i","elements","createdBy","uid","showSendDate","value1","value2","date1","date2","Math","abs","deleteMessage","messages","splice","indexOf","console","log","onClick","FileSaver","saveAs","class","length","map","Fragment","displayName","content","photoURL","style","image","padding","backgroundColor","fileType","e","target","showFullImage","controls","playsInline","handleReply","_excluded","_extends","Object","assign","bind","arguments","source","key","prototype","hasOwnProperty","call","apply","this","_objectWithoutProperties","excluded","sourceKeys","keys","_objectWithoutPropertiesLoose","getOwnPropertySymbols","sourceSymbolKeys","propertyIsEnumerable","SvgSendIcon","_ref","svgRef","title","titleId","props","xmlns","viewBox","undefined","fill","d","_line","_line2","ForwardRef","SvgX","width","height","stroke","strokeWidth","strokeLinecap","strokeLinejoin","x1","y1","x2","y2","_circle","SvgSmile","cx","cy","r","ChatInput","query","uniqueId","uuid","newComment","setNewComment","imgUpload","setImgUpload","isAssignedUser","setIsAssignedUser","fastEmoji","sendFastEmoji","setSendFastEmoji","inputRef","useRef","sendMessage","assignedUsersId","forEach","commentToAdd","trim","updatedAt","handleImageUpload","imageFile","files","options","maxSizeMB","maxWidthOrHeight","useWebWorker","imageCompression","compressedFile","sendImage","includes","split","storageRef","name","uploadBytes","then","snapshot","getDownloadURL","downloadURL","handleSubmit","preventDefault","fileThumbnail","setFileThumbnail","showEmojis","setShowEmojis","onSubmit","substring","accept","onChange","URL","createObjectURL","handleFileChange","ImageIcon","current","resetFileInput","maxLength","placeholder","onKeyDown","code","handleKey","onOutsideClick","onEmojiClick","emojiData","event","emoji","theme","Theme","DARK","previewConfig","defaultCaption","defaultEmoji","emojiStyle","EmojiStyle","NATIVE","Chat","setQuery","setDocument","setError","onSnapshot","data","err","useDocument","useParams","rightUrl","rightDisplayName","assignedUsersPhotoURL","url","assignedUsersName","useLogin","setIsPending","isFinished","setIsFinished","login","email","password","signInWithEmailAndPassword","res","online","loginWithGoogle","signInWithPopup","loginWithGithub","resetPassword","sendPasswordResetEmail","setTimeout","push","Login","setEmail","setPassword","required","to","disabled","googleLogo","githubLogo","Signup","setDisplayName","thumbnail","setThumbnail","thumbnailError","setThumbnailError","signup","createUserWithEmailAndPassword","uploadPath","put","img","imgUrl","updateProfile","set","signInWithGoogle","signInWithGithub","additionalUserInfo","username","useSignup","selected","size","PrivacyPolicy","timeToRedirect","setTimeToRedirect","handlePasswordReset","countdown","redirectCountdown","setInterval","clearInterval","prevTimeToRedirect","ShrekGif","useCollection","_query","_orderBy","documents","setDocuments","orderBy","where","unsubscribe","results","docs","ChatsList","projects","users","onlineUsers","rightId","replaceDistanceToNow","about","minutes","onMouseMove","getElementsByClassName","card","rect","getBoundingClientRect","x","clientX","left","y","clientY","top","setProperty","project","formatDistanceToNowStrict","addSuffix","replace","matched","Chats","logout","signOut","useLogout","chats","handleSelect","addUser","combinedId","getDoc","exists","setDoc","filter","toLowerCase","App","exact","path","ReactDOM","render","StrictMode","getElementById"],"mappings":"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","file":"static/js/main.c49f6fa5.chunk.js","sourcesContent":["import firebase from 'firebase/compat/app'\r\nimport 'firebase/compat/firestore'\r\nimport 'firebase/compat/auth'\r\nimport 'firebase/compat/storage'\r\n\r\nconst firebaseConfig = {\r\n\tapiKey: 'AIzaSyBMB6C-_B61S1wd1RYAr34jomKZpvq16eA',\r\n\tauthDomain: 'better-react-messenger.firebaseapp.com',\r\n\tprojectId: 'better-react-messenger',\r\n\tstorageBucket: 'better-react-messenger.appspot.com',\r\n\tmessagingSenderId: '381225253186',\r\n\tappId: '1:381225253186:web:43a9fb8cce6b202f31f0db',\r\n}\r\n\r\n// Firebase init\r\nfirebase.initializeApp(firebaseConfig)\r\n\r\n// Services init\r\nconst projectFirestore = firebase.firestore()\r\nconst projectAuth = firebase.auth()\r\nconst projectStorage = firebase.storage()\r\n\r\nconst projectGoogle = new firebase.auth.GoogleAuthProvider()\r\nconst projectGitHub = new firebase.auth.GithubAuthProvider()\r\n\r\nprojectGoogle.setCustomParameters({ prompt: 'select_account' })\r\n// Timestamp\r\nconst timestamp = firebase.firestore.Timestamp\r\n\r\nexport { projectFirestore, projectAuth, timestamp, projectStorage, projectGoogle, projectGitHub }\r\n","import { createContext, useReducer, useEffect } from 'react'\nimport { projectAuth } from '../firebase/config'\n\nexport const AuthContext = createContext()\n\nexport const authReducer = (state, action) => {\n\tswitch (action.type) {\n\t\tcase 'LOGIN':\n\t\t\treturn { ...state, user: action.payload }\n\t\tcase 'LOGOUT':\n\t\t\treturn { ...state, user: null }\n\t\tcase 'AUTH_IS_READY':\n\t\t\treturn { user: action.payload, authIsReady: true }\n\t\tdefault:\n\t\t\treturn state\n\t}\n}\n\nexport const AuthContextProvider = ({ children }) => {\n\tconst [state, dispatch] = useReducer(authReducer, {\n\t\tuser: null,\n\t\tauthIsReady: false,\n\t})\n\n\tuseEffect(() => {\n\t\tconst unsub = projectAuth.onAuthStateChanged(user => {\n\t\t\tdispatch({ type: 'AUTH_IS_READY', payload: user })\n\t\t\tunsub()\n\t\t})\n\t}, [])\n\n\treturn <AuthContext.Provider value={{ ...state, dispatch }}>{children}</AuthContext.Provider>\n}\n","import { AuthContext } from \"../context/AuthContext\"\nimport { useContext } from \"react\"\n\nexport const useAuthContext = () => {\n  const context = useContext(AuthContext)\n\n  if(!context) {\n    throw Error('useAuthContext must be used inside an AuthContextProvider')\n  }\n\n  return context\n}","// Styles\r\nimport './Dashboard.scss'\r\n\r\nexport default function Dashboard() {\r\n\treturn (\r\n\t\t<div className='dashboard'>\r\n\t\t\t<div className='wise-mystical-tree'></div>\r\n\t\t</div>\r\n\t)\r\n}\r\n","import { useEffect, useState } from 'react'\r\nimport { projectFirestore } from '../firebase/config'\r\n\r\nexport const useDocument = (collection, id) => {\r\n\tconst [document, setDocument] = useState(null)\r\n\tconst [error, setError] = useState(null)\r\n\r\n\t// Realtime data for document\r\n\tuseEffect(() => {\r\n\t\tconst ref = projectFirestore.collection(collection).doc(id)\r\n\r\n\t\tconst unsub = ref.onSnapshot(\r\n\t\t\tsnapshot => {\r\n\t\t\t\tif (snapshot.data()) {\r\n\t\t\t\t\tsetDocument({ ...snapshot.data(), id: snapshot.id })\r\n\t\t\t\t\tsetError(null)\r\n\t\t\t\t} else {\r\n\t\t\t\t\tsetError('No such document exists')\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\terr => {\r\n\t\t\t\tconsole.log(err.message)\r\n\t\t\t\tsetError('Failed to get document')\r\n\t\t\t}\r\n\t\t)\r\n\r\n\t\treturn () => unsub()\r\n\t}, [collection, id])\r\n\r\n\treturn { document, error }\r\n}\r\n","export const useDates = () => {\r\n\tlet today = new Date().toLocaleDateString()\r\n\tlet weekday = []\r\n\tlet dayOfMonth, dayOfWeek, month, year, hour, curDate, fullDate\r\n\r\n\tconst dates = dateToFormat => {\r\n\t\tconst date = dateToFormat.toDate()\r\n\t\tweekday = ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun']\r\n\t\tdayOfWeek = weekday[date.getDay()]\r\n\r\n\t\tyear = date.getFullYear()\r\n\r\n\t\tmonth = date.getMonth() + 1 < 10 ? '0' + date.getMonth() + 1 : date.getMonth() + 1\r\n\r\n\t\tdayOfMonth = date.getDate() < 10 ? '0' + date.getDate().toString() : date.getDate().toString()\r\n\r\n\t\tcurDate = `${dayOfMonth}/${month}/${year}`\r\n\t\thour = date.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })\r\n\r\n\t\tfullDate = `${dayOfMonth}.${month}.${year}, ${hour}`\r\n\r\n\t\treturn { weekday, dayOfWeek, year, month, dayOfMonth, curDate, hour, fullDate }\r\n\t}\r\n\r\n\tconst isCurrentWeek = dateToFormat => {\r\n\t\tlet lastMonday = new Date() // Creating new date object for today\r\n\t\tlastMonday.setDate(lastMonday.getDate() - (lastMonday.getDay() - 1)) // Setting date to last monday\r\n\t\tlastMonday.setHours(0, 0, 0, 0) // Setting Hour to 00:00:00:00\r\n\r\n\t\tconst res =\r\n\t\t\tlastMonday.getTime() <= dateToFormat.getTime() && dateToFormat.getTime() < lastMonday.getTime() + 604800000\r\n\r\n\t\treturn res\r\n\t}\r\n\r\n\tconst formatDate = comment => {\r\n\t\tconst date = comment.createdAt.toDate()\r\n\r\n\t\tweekday = ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun']\r\n\t\tdayOfWeek = weekday[date.getDay()]\r\n\r\n\t\tyear = date.getFullYear()\r\n\r\n\t\tmonth = date.getMonth() + 1 < 10 ? '0' + date.getMonth() + 1 : date.getMonth() + 1\r\n\r\n\t\tdayOfMonth = date.getDate() < 10 ? '0' + date.getDate().toString() : date.getDate().toString()\r\n\r\n\t\tcurDate = `${dayOfMonth}/${month}/${year}`\r\n\t\thour = date.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })\r\n\r\n\t\tif (curDate === today) {\r\n\t\t\treturn hour\r\n\t\t} else if (isCurrentWeek(date)) {\r\n\t\t\treturn `${dayOfWeek}. ${hour}`\r\n\t\t} else {\r\n\t\t\treturn `${dayOfMonth}.${month}.${year}, ${hour}`\r\n\t\t}\r\n\t}\r\n\r\n\treturn { formatDate, dates, dayOfMonth, dayOfWeek, month, year, hour, curDate }\r\n}\r\n","import { useReducer, useEffect, useState } from 'react'\nimport { projectFirestore, timestamp } from '../firebase/config'\n\nlet initialState = {\n\tdocument: null,\n\tisPending: false,\n\terror: null,\n\tsuccess: null,\n}\n\nconst firestoreReducer = (state, action) => {\n\tswitch (action.type) {\n\t\tcase 'IS_PENDING':\n\t\t\treturn { isPending: true, document: null, success: false, error: null }\n\t\tcase 'ADDED_DOCUMENT':\n\t\t\treturn { isPending: false, document: action.payload, success: true, error: null }\n\t\tcase 'DELETED_DOCUMENT':\n\t\t\treturn { isPending: false, document: null, success: true, error: null }\n\t\tcase 'UPDATED_DOCUMENT':\n\t\t\treturn { isPending: false, document: action.payload, success: true, error: null }\n\t\tcase 'ERROR':\n\t\t\treturn { isPending: false, document: null, success: false, error: action.payload }\n\t\tdefault:\n\t\t\treturn state\n\t}\n}\n\nexport const useFirestore = collection => {\n\tconst [response, dispatch] = useReducer(firestoreReducer, initialState)\n\tconst [isCancelled, setIsCancelled] = useState(false)\n\n\t// Collection ref\n\tconst ref = projectFirestore.collection(collection)\n\n\t// Only dispatch is not cancelled\n\tconst dispatchIfNotCancelled = action => {\n\t\tif (!isCancelled) {\n\t\t\tdispatch(action)\n\t\t}\n\t}\n\n\t// Add a document\n\tconst addDocument = async doc => {\n\t\tdispatch({ type: 'IS_PENDING' })\n\n\t\ttry {\n\t\t\tconst createdAt = timestamp.fromDate(new Date())\n\n\t\t\tconst addedDocument = await ref.add({ ...doc, createdAt })\n\t\t\tdispatchIfNotCancelled({ type: 'ADDED_DOCUMENT', payload: addedDocument })\n\t\t} catch (err) {\n\t\t\tdispatchIfNotCancelled({ type: 'ERROR', payload: err.message })\n\t\t}\n\t}\n\n\t// Delete a document\n\tconst deleteDocument = async id => {\n\t\tdispatch({ type: 'IS_PENDING' })\n\n\t\ttry {\n\t\t\tawait ref.doc(id).delete()\n\t\t\tdispatchIfNotCancelled({ type: 'DELETED_DOCUMENT' })\n\t\t} catch (err) {\n\t\t\tdispatchIfNotCancelled({ type: 'ERROR', payload: 'could not delete' })\n\t\t}\n\t}\n\n\t// Update documents\n\n\tconst updateDocument = async (id, updates) => {\n\t\tdispatch({ type: 'IS_PENDING' })\n\n\t\ttry {\n\t\t\tconst updatedDocument = await ref.doc(id).update(updates)\n\n\t\t\tdispatchIfNotCancelled({ type: 'UPDATED_DOCUMENT', payload: updatedDocument })\n\t\t\treturn updatedDocument\n\t\t} catch (err) {\n\t\t\tdispatchIfNotCancelled({ type: 'ERROR', payload: err.message })\n\t\t\treturn null\n\t\t}\n\t}\n\n\tuseEffect(() => {\n\t\treturn () => setIsCancelled(true)\n\t}, [])\n\n\treturn { addDocument, deleteDocument, updateDocument, response }\n}\n","// Styles\r\nimport './Avatar.scss'\r\n\r\nexport default function Avatar({ src }) {\r\n\treturn (\r\n\t\t<div className='avatar'>\r\n\t\t\t<img src={src} alt='User avatar' />\r\n\t\t</div>\r\n\t)\r\n}\r\n","import React, { useState, useEffect } from 'react'\r\nimport { useAuthContext } from '../hooks/useAuthContext'\r\nimport { useDates } from '../hooks/useDates'\r\nimport { useFirestore } from '../hooks/useFirestore'\r\nimport { useHistory } from 'react-router-dom'\r\nimport FileSaver from 'file-saver'\r\n\r\n// Styles && Assets\r\nimport './Comments.scss'\r\nimport Avatar from './Avatar'\r\n\r\nconst Comments = ({ chat, onQuery }) => {\r\n\tconst { formatDate, dates } = useDates()\r\n\tconst { user } = useAuthContext()\r\n\tconst { updateDocument } = useFirestore('projects')\r\n\r\n\tconst [showImage, setShowImage] = useState('')\r\n\tconst [messageToDelete, setMessageToDelete] = useState(null)\r\n\r\n\tconst history = useHistory()\r\n\r\n\tuseEffect(() => {\r\n\t\treturn history.listen(() => {\r\n\t\t\tonQuery(null)\r\n\t\t})\r\n\t}, [history])\r\n\r\n\tconst handleMessageStyle = (comment, i, elements) => {\r\n\t\tif (elements[i + 1] && comment.response && elements[i + 1].response) {\r\n\t\t\tif (comment.createdBy === user.uid) {\r\n\t\t\t\treturn 'owner'\r\n\t\t\t} else {\r\n\t\t\t\treturn ''\r\n\t\t\t}\r\n\t\t} else if (elements[i - 1] && comment.response && (!elements[i - 1].response || elements[i - 1].response)) {\r\n\t\t\tif (comment.createdBy === user.uid) {\r\n\t\t\t\treturn 'owner group-top'\r\n\t\t\t} else {\r\n\t\t\t\treturn 'group-top'\r\n\t\t\t}\r\n\t\t} else if (\r\n\t\t\t!elements[i - 1] ||\r\n\t\t\t(elements[i + 1] &&\r\n\t\t\t\telements[i - 1] &&\r\n\t\t\t\tcomment.createdBy !== elements[i - 1].createdBy &&\r\n\t\t\t\tcomment.createdBy === elements[i + 1].createdBy)\r\n\t\t) {\r\n\t\t\tif (comment.createdBy === user.uid) {\r\n\t\t\t\treturn 'owner group-top'\r\n\t\t\t} else {\r\n\t\t\t\treturn 'group-top'\r\n\t\t\t}\r\n\t\t} else if (elements[i + 1] && elements[i + 1].response) {\r\n\t\t\tif (comment.createdBy === user.uid) {\r\n\t\t\t\treturn 'owner group-down'\r\n\t\t\t} else {\r\n\t\t\t\treturn 'group-down'\r\n\t\t\t}\r\n\t\t} else if (\r\n\t\t\telements[i + 1] &&\r\n\t\t\telements[i - 1] &&\r\n\t\t\tcomment.createdBy === elements[i - 1].createdBy &&\r\n\t\t\tcomment.createdBy === elements[i + 1].createdBy\r\n\t\t) {\r\n\t\t\tif (comment.createdBy === user.uid) {\r\n\t\t\t\treturn 'owner group-middle'\r\n\t\t\t} else {\r\n\t\t\t\treturn 'group-middle'\r\n\t\t\t}\r\n\t\t} else if (\r\n\t\t\telements[i - 1] &&\r\n\t\t\tcomment.createdBy === elements[i - 1].createdBy &&\r\n\t\t\t(!elements[i + 1] || comment.createdBy !== elements[i + 1].createdBy)\r\n\t\t) {\r\n\t\t\tif (comment.createdBy === user.uid) {\r\n\t\t\t\treturn 'owner group-down'\r\n\t\t\t} else {\r\n\t\t\t\treturn 'group-down'\r\n\t\t\t}\r\n\t\t} else if (comment.createdBy === user.uid) {\r\n\t\t\treturn 'owner'\r\n\t\t} else {\r\n\t\t\treturn ''\r\n\t\t}\r\n\t}\r\n\r\n\tconst showSendDate = (comment, elements, i) => {\r\n\t\tif (comment && elements[i - 1]) {\r\n\t\t\tconst value1 = comment.createdAt.toDate().toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })\r\n\t\t\tconst value2 = elements[i - 1].createdAt.toDate().toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })\r\n\r\n\t\t\t// Get miliseconds of each comment.createdAt\r\n\t\t\tconst date1 = new Date('01/01/2022 ' + value1 + ':00').getTime()\r\n\t\t\tconst date2 = new Date('01/01/2022 ' + value2 + ':00').getTime()\r\n\r\n\t\t\tconst minuteDiff = Math.abs(date1 - date2)\r\n\r\n\t\t\t// Check if difference between when comment was created is greater than 15 minutes\r\n\t\t\tif (minuteDiff >= 900000) {\r\n\t\t\t\treturn true\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tconst deleteMessage = async comment => {\r\n\t\tif (user.uid === comment.createdBy) {\r\n\t\t\tchat.messages.splice(chat.messages.indexOf(comment), 1)\r\n\r\n\t\t\ttry {\r\n\t\t\t\tawait updateDocument(chat.id, {\r\n\t\t\t\t\tmessages: [...chat.messages],\r\n\t\t\t\t})\r\n\t\t\t\tsetMessageToDelete(null)\r\n\t\t\t} catch (error) {\r\n\t\t\t\tconsole.log(error)\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tconst handleReply = comment => {\r\n\t\tonQuery(comment)\r\n\t}\r\n\r\n\tconst showFullImage = e => {\r\n\t\tif (showImage !== e.target.src) {\r\n\t\t\tsetShowImage(e.target.src)\r\n\t\t}\r\n\t}\r\n\r\n\tconst hideFullImage = () => {\r\n\t\tsetShowImage('')\r\n\t}\r\n\r\n\tconst downloadImage = () => {\r\n\t\tFileSaver.saveAs(showImage)\r\n\t}\r\n\r\n\treturn (\r\n\t\t<ul className='comments custom-scrollbar'>\r\n\t\t\t{showImage && (\r\n\t\t\t\t<div className='full-img'>\r\n\t\t\t\t\t<div className='full-img__background'>\r\n\t\t\t\t\t\t<div className='backdrop-blur'></div>\r\n\t\t\t\t\t\t<img src={showImage} alt='' className='' />\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div className='wrapper'>\r\n\t\t\t\t\t\t<img src={showImage} alt='' className='full-img__img' />\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t<div className='full-img__tools'>\r\n\t\t\t\t\t\t<div className='tool' onClick={() => downloadImage()}>\r\n\t\t\t\t\t\t\t<i class='fa-solid fa-download'></i>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<div className='tool' onClick={() => hideFullImage()}>\r\n\t\t\t\t\t\t\t<i class='fa-solid fa-xmark'></i>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t)}\r\n\t\t\t<div className='comments-wrapper'>\r\n\t\t\t\t<div className='comments__conversation-start'>\r\n\t\t\t\t\t<p>This is the start of your conversation with this user</p>\r\n\t\t\t\t\t{/* <p>{dates(chat.createdAt).fullDate}</p> */}\r\n\t\t\t\t</div>\r\n\r\n\t\t\t\t{chat.messages.length > 0 &&\r\n\t\t\t\t\tchat.messages.map((comment, i, elements) => (\r\n\t\t\t\t\t\t<React.Fragment key={comment.id}>\r\n\t\t\t\t\t\t\t{showSendDate(comment, elements, i) && <div className='comments__time-passed'>{formatDate(comment)}</div>}\r\n\r\n\t\t\t\t\t\t\t<li className={`${handleMessageStyle(comment, i, elements)}`}>\r\n\t\t\t\t\t\t\t\t{comment.createdBy !== user.uid &&\r\n\t\t\t\t\t\t\t\t\t(!elements[i - 1] || comment.createdBy !== elements[i - 1].createdBy) && (\r\n\t\t\t\t\t\t\t\t\t\t<p className='comment-author'>{comment.displayName}</p>\r\n\t\t\t\t\t\t\t\t\t)}\r\n\r\n\t\t\t\t\t\t\t\t{comment.response && <div className='response-message'>{comment.response.content}</div>}\r\n\r\n\t\t\t\t\t\t\t\t<div className='comment-content'>\r\n\t\t\t\t\t\t\t\t\t{comment.createdBy !== user.uid && (\r\n\t\t\t\t\t\t\t\t\t\t<div className='left-margin'>\r\n\t\t\t\t\t\t\t\t\t\t\t{(!elements[i + 1] || comment.createdBy !== elements[i + 1].createdBy) && (\r\n\t\t\t\t\t\t\t\t\t\t\t\t<Avatar src={comment.photoURL} />\r\n\t\t\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\t\t\t\tclassName='comment-content__text'\r\n\t\t\t\t\t\t\t\t\t\tstyle={comment.image ? { padding: 0, backgroundColor: 'transparent' } : null}>\r\n\t\t\t\t\t\t\t\t\t\t{comment.content && <p>{comment.content}</p>}\r\n\t\t\t\t\t\t\t\t\t\t{comment.image && comment.fileType === 'image' && (\r\n\t\t\t\t\t\t\t\t\t\t\t<div className='file-message' onClick={e => showFullImage(e)}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<img src={comment.image} alt='' />\r\n\t\t\t\t\t\t\t\t\t\t\t\t<div className='file-message__preview'>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<i className='fa-solid fa-up-right-and-down-left-from-center'></i>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t)}\r\n\r\n\t\t\t\t\t\t\t\t\t\t{comment.image && comment.fileType === 'video' && (\r\n\t\t\t\t\t\t\t\t\t\t\t<div className='file-message'>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<video src={comment.image} controls playsInline />\r\n\t\t\t\t\t\t\t\t\t\t\t\t<div className='file-message__preview'>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<i className='fa-solid fa-up-right-and-down-left-from-center'></i>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t{/* On click show options (deleting message and replying to it) */}\r\n\r\n\t\t\t\t\t\t\t\t\t<div className='comment-tools'>\r\n\t\t\t\t\t\t\t\t\t\t{user.uid === comment.createdBy && (\r\n\t\t\t\t\t\t\t\t\t\t\t<i className='fa-solid fa-trash-can' onClick={() => setMessageToDelete(comment)}></i>\r\n\t\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t\t\t<i className='fa-solid fa-reply' onClick={() => handleReply(comment)}></i>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t\t\t<div className='comment-createdAt'>{formatDate(comment)}</div>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t</li>\r\n\t\t\t\t\t\t</React.Fragment>\r\n\t\t\t\t\t))}\r\n\t\t\t</div>\r\n\t\t\t{messageToDelete && (\r\n\t\t\t\t<div className='confirm-message-delete'>\r\n\t\t\t\t\t<div className='hero-shadow'></div>\r\n\r\n\t\t\t\t\t<div className='confirm-message-delete__content'>\r\n\t\t\t\t\t\t<h2>Delete message</h2>\r\n\t\t\t\t\t\t<p>Do you really want to delete this message?</p>\r\n\r\n\t\t\t\t\t\t<p>Message to delete: </p>\r\n\t\t\t\t\t\t<div className='message-to-delete custom-scrollbar'>\r\n\t\t\t\t\t\t\t{messageToDelete.content && <span>\"{messageToDelete.content}\"</span>}\r\n\t\t\t\t\t\t\t{messageToDelete.image && <img src={messageToDelete.image} alt='' />}\r\n\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t<div className='vertical-btns'>\r\n\t\t\t\t\t\t\t<button className='btn btn--secondary' onClick={() => setMessageToDelete(null)}>\r\n\t\t\t\t\t\t\t\tCancel\r\n\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t<button className='btn' onClick={() => deleteMessage(messageToDelete)}>\r\n\t\t\t\t\t\t\t\tDelete\r\n\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t)}\r\n\t\t</ul>\r\n\t)\r\n}\r\n\r\nexport default Comments\r\n","var _defs, _path;\n\nvar _excluded = [\"title\", \"titleId\"];\n\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport * as React from \"react\";\n\nfunction SvgSendIcon(_ref, svgRef) {\n  var title = _ref.title,\n      titleId = _ref.titleId,\n      props = _objectWithoutProperties(_ref, _excluded);\n\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    id: \"Layer_1\",\n    \"data-name\": \"Layer 1\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    viewBox: \"0 0 122.56 122.88\",\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), _defs || (_defs = /*#__PURE__*/React.createElement(\"defs\", null, /*#__PURE__*/React.createElement(\"style\", null, \".cls-1{fill-rule:evenodd;}\"))), title === undefined ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, \"send\") : title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _path || (_path = /*#__PURE__*/React.createElement(\"path\", {\n    className: \"cls-1\",\n    fill: \"#3e2a49\",\n    d: \"M2.33,44.58,117.33.37a3.63,3.63,0,0,1,5,4.56l-44,115.61h0a3.63,3.63,0,0,1-6.67.28L53.93,84.14,89.12,33.77,38.85,68.86,2.06,51.24a3.63,3.63,0,0,1,.27-6.66Z\"\n  })));\n}\n\nvar ForwardRef = /*#__PURE__*/React.forwardRef(SvgSendIcon);\nexport default __webpack_public_path__ + \"static/media/send-icon.a8d72b5b.svg\";\nexport { ForwardRef as ReactComponent };","export default __webpack_public_path__ + \"static/media/image.47145ce5.svg\";","var _line, _line2;\n\nvar _excluded = [\"title\", \"titleId\"];\n\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport * as React from \"react\";\n\nfunction SvgX(_ref, svgRef) {\n  var title = _ref.title,\n      titleId = _ref.titleId,\n      props = _objectWithoutProperties(_ref, _excluded);\n\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    xmlns: \"http://www.w3.org/2000/svg\",\n    width: 12,\n    height: 12,\n    viewBox: \"0 0 24 24\",\n    fill: \"none\",\n    stroke: \"currentColor\",\n    strokeWidth: 2.5,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\",\n    className: \"feather feather-x\",\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _line || (_line = /*#__PURE__*/React.createElement(\"line\", {\n    x1: 18,\n    y1: 6,\n    x2: 6,\n    y2: 18\n  })), _line2 || (_line2 = /*#__PURE__*/React.createElement(\"line\", {\n    x1: 6,\n    y1: 6,\n    x2: 18,\n    y2: 18\n  })));\n}\n\nvar ForwardRef = /*#__PURE__*/React.forwardRef(SvgX);\nexport default __webpack_public_path__ + \"static/media/x.f399543c.svg\";\nexport { ForwardRef as ReactComponent };","var _circle, _path, _line, _line2;\n\nvar _excluded = [\"title\", \"titleId\"];\n\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport * as React from \"react\";\n\nfunction SvgSmile(_ref, svgRef) {\n  var title = _ref.title,\n      titleId = _ref.titleId,\n      props = _objectWithoutProperties(_ref, _excluded);\n\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    xmlns: \"http://www.w3.org/2000/svg\",\n    width: 24,\n    height: 24,\n    viewBox: \"0 0 24 24\",\n    fill: \"none\",\n    stroke: \"currentColor\",\n    strokeWidth: 2,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\",\n    className: \"feather feather-smile\",\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _circle || (_circle = /*#__PURE__*/React.createElement(\"circle\", {\n    cx: 12,\n    cy: 12,\n    r: 10\n  })), _path || (_path = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M8 14s1.5 2 4 2 4-2 4-2\"\n  })), _line || (_line = /*#__PURE__*/React.createElement(\"line\", {\n    x1: 9,\n    y1: 9,\n    x2: 9.01,\n    y2: 9\n  })), _line2 || (_line2 = /*#__PURE__*/React.createElement(\"line\", {\n    x1: 15,\n    y1: 9,\n    x2: 15.01,\n    y2: 9\n  })));\n}\n\nvar ForwardRef = /*#__PURE__*/React.forwardRef(SvgSmile);\nexport default __webpack_public_path__ + \"static/media/smile.27f2efd8.svg\";\nexport { ForwardRef as ReactComponent };","import React, { useEffect, useRef, useState } from 'react'\r\nimport { timestamp, projectStorage } from '../firebase/config'\r\nimport { useAuthContext } from '../hooks/useAuthContext'\r\nimport { useFirestore } from '../hooks/useFirestore'\r\nimport { v4 as uuid } from 'uuid'\r\nimport { getDownloadURL, ref, uploadBytes } from 'firebase/storage'\r\nimport EmojiPicker, { EmojiStyle, Theme } from 'emoji-picker-react'\r\nimport OutsideClickHandler from 'react-outside-click-handler'\r\nimport imageCompression from 'browser-image-compression'\r\n\r\n// Styles && Assets\r\nimport './ChatInput.scss'\r\nimport ImageIcon from '../assets/image.svg'\r\nimport { ReactComponent as SendIcon } from '../assets/send-icon.svg'\r\nimport { ReactComponent as CloseBtn } from '../assets/x.svg'\r\nimport { ReactComponent as SmileIcon } from '../assets/smile.svg'\r\n\r\nconst ChatInput = ({ chat, query, onQuery }) => {\r\n\tconst uniqueId = uuid()\r\n\r\n\tconst { updateDocument, response } = useFirestore('projects')\r\n\tconst { user } = useAuthContext()\r\n\r\n\tconst [newComment, setNewComment] = useState('')\r\n\tconst [imgUpload, setImgUpload] = useState(null)\r\n\tconst [isAssignedUser, setIsAssignedUser] = useState(false)\r\n\t// setFastEmoji is left for changing fastEmoji later\r\n\tconst [fastEmoji, setFastEmoji] = useState('')\r\n\tconst [sendFastEmoji, setSendFastEmoji] = useState(false)\r\n\r\n\tconst inputRef = useRef(null)\r\n\r\n\tuseEffect(() => {\r\n\t\tif (sendFastEmoji === true) {\r\n\t\t\tsendMessage()\r\n\t\t}\r\n\t}, [sendFastEmoji])\r\n\r\n\tuseEffect(() => {\r\n\t\tchat.assignedUsersId.forEach(id => {\r\n\t\t\tif (id === user.uid) setIsAssignedUser(true)\r\n\t\t})\r\n\t}, [setIsAssignedUser, chat.assignedUsersId, user.uid])\r\n\r\n\tconst sendMessage = async () => {\r\n\t\tconst commentToAdd = {\r\n\t\t\tdisplayName: user.displayName,\r\n\t\t\tphotoURL: user.photoURL,\r\n\t\t\tcontent: sendFastEmoji ? fastEmoji : newComment,\r\n\t\t\tcreatedAt: timestamp.fromDate(new Date()),\r\n\t\t\tcreatedBy: user.uid,\r\n\t\t\tid: uniqueId,\r\n\t\t\tresponse: query ? query : null,\r\n\t\t}\r\n\r\n\t\tif (commentToAdd.content.trim() !== '' && newComment.length < 900 && isAssignedUser) {\r\n\t\t\tawait updateDocument(chat.id, {\r\n\t\t\t\tmessages: [...chat.messages, commentToAdd],\r\n\t\t\t\tupdatedAt: timestamp.fromDate(new Date()),\r\n\t\t\t})\r\n\t\t\tif (!response.error) {\r\n\t\t\t\tsetNewComment('')\r\n\t\t\t\tsetSendFastEmoji(false)\r\n\t\t\t\tonQuery(null)\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\tconst handleImageUpload = async e => {\r\n\t\tconst imageFile = e.target.files[0]\r\n\r\n\t\tconst options = {\r\n\t\t\tmaxSizeMB: 1,\r\n\t\t\tmaxWidthOrHeight: 1920,\r\n\t\t\tuseWebWorker: true,\r\n\t\t}\r\n\t\ttry {\r\n\t\t\tconst compressedFile = await imageCompression(imageFile, options)\r\n\t\t\tawait setImgUpload(compressedFile)\r\n\t\t} catch (error) {\r\n\t\t\tconsole.log(error)\r\n\t\t}\r\n\t}\r\n\r\n\tconst sendImage = async () => {\r\n\t\tconst acceptedFileTypes = ['image', 'video']\r\n\r\n\t\tif (acceptedFileTypes.includes(imgUpload.type.split('/')[0])) {\r\n\t\t\tconst storageRef = ref(\r\n\t\t\t\tprojectStorage,\r\n\t\t\t\t`imgs/${chat.assignedUsersId[0] + chat.assignedUsersId[1]}/${uuid() + imgUpload.name}`\r\n\t\t\t)\r\n\t\t\tconst uploadTask = uploadBytes(storageRef, imgUpload)\r\n\r\n\t\t\tuploadTask.then(snapshot => {\r\n\t\t\t\tgetDownloadURL(snapshot.ref).then(async downloadURL => {\r\n\t\t\t\t\tconst commentToAdd = {\r\n\t\t\t\t\t\tdisplayName: user.displayName,\r\n\t\t\t\t\t\tphotoURL: user.photoURL,\r\n\t\t\t\t\t\t// content: newComment,\r\n\t\t\t\t\t\tfileType: imgUpload.type.includes('image/') ? 'image' : 'video',\r\n\t\t\t\t\t\timage: downloadURL,\r\n\t\t\t\t\t\tcreatedAt: timestamp.fromDate(new Date()),\r\n\t\t\t\t\t\tcreatedBy: user.uid,\r\n\t\t\t\t\t\tid: uniqueId,\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif (isAssignedUser) {\r\n\t\t\t\t\t\tawait updateDocument(chat.id, {\r\n\t\t\t\t\t\t\tmessages: [...chat.messages, commentToAdd],\r\n\t\t\t\t\t\t\tupdatedAt: timestamp.fromDate(new Date()),\r\n\t\t\t\t\t\t})\r\n\r\n\t\t\t\t\t\tif (!response.error) {\r\n\t\t\t\t\t\t\tsetImgUpload(null)\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t})\r\n\t\t}\r\n\t}\r\n\r\n\tconst handleSubmit = e => {\r\n\t\te.preventDefault()\r\n\r\n\t\tif (imgUpload) {\r\n\t\t\tsendImage()\r\n\t\t} else {\r\n\t\t\tsendMessage()\r\n\t\t}\r\n\t}\r\n\r\n\tconst handleKey = e => {\r\n\t\te.code === 'Enter' && handleSubmit(e)\r\n\t}\r\n\r\n\tconst [fileThumbnail, setFileThumbnail] = useState('')\r\n\r\n\tconst handleFileChange = e => {\r\n\t\thandleImageUpload(e)\r\n\t\t// setImgUpload(e.target.files[0])\r\n\t\tsetFileThumbnail(URL.createObjectURL(e.target.files[0]))\r\n\t}\r\n\r\n\tconst resetFileInput = e => {\r\n\t\te.preventDefault()\r\n\t\tinputRef.current.value = ''\r\n\t\tsetImgUpload(null)\r\n\t}\r\n\r\n\tconst handleEmojis = (emojiData, event) => {\r\n\t\tsetNewComment(newComment => newComment + emojiData.emoji)\r\n\t}\r\n\r\n\tconst [showEmojis, setShowEmojis] = useState(false)\r\n\r\n\treturn (\r\n\t\t<form onSubmit={handleSubmit}>\r\n\t\t\t{query && (\r\n\t\t\t\t<div className='response'>\r\n\t\t\t\t\t<div>\r\n\t\t\t\t\t\t<p className='response__to'>\r\n\t\t\t\t\t\t\tResponding to{' '}\r\n\t\t\t\t\t\t\t<span>{query.displayName === user.displayName ? 'yourself' : <b>{query.displayName}</b>}</span>\r\n\t\t\t\t\t\t</p>\r\n\t\t\t\t\t\t<p className='response__content'>\r\n\t\t\t\t\t\t\t{query.content && (\r\n\t\t\t\t\t\t\t\t<>\r\n\t\t\t\t\t\t\t\t\t{query.content.substring(0, 70)}\r\n\t\t\t\t\t\t\t\t\t{query.content.length > 70 ? <span>...</span> : ''}\r\n\t\t\t\t\t\t\t\t</>\r\n\t\t\t\t\t\t\t)}\r\n\r\n\t\t\t\t\t\t\t{query.image && 'Image'}\r\n\t\t\t\t\t\t</p>\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t<div className='response__close-btn' onClick={() => onQuery(null)}>\r\n\t\t\t\t\t\t<i className='fa-solid fa-xmark'></i>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t)}\r\n\r\n\t\t\t<div className='add-comment'>\r\n\t\t\t\t<label className='attach-image'>\r\n\t\t\t\t\t<input ref={inputRef} type='file' accept='video/*, image/*' onChange={e => handleFileChange(e)} />\r\n\t\t\t\t\t<img src={ImageIcon} alt='' />\r\n\t\t\t\t</label>\r\n\r\n\t\t\t\t<div className='message-field'>\r\n\t\t\t\t\t<div className='column'>\r\n\t\t\t\t\t\t{imgUpload && (\r\n\t\t\t\t\t\t\t<div className='thumbnails'>\r\n\t\t\t\t\t\t\t\t<div className='file-thumbnail'>\r\n\t\t\t\t\t\t\t\t\t<img src={fileThumbnail} alt='' />\r\n\t\t\t\t\t\t\t\t\t<button className='remove-img' onClick={e => resetFileInput(e)}>\r\n\t\t\t\t\t\t\t\t\t\t<CloseBtn className='close-btn' />\r\n\t\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t<label>\r\n\t\t\t\t\t\t\t<input\r\n\t\t\t\t\t\t\t\tmaxLength='900'\r\n\t\t\t\t\t\t\t\tplaceholder='Aa'\r\n\t\t\t\t\t\t\t\tonChange={e => setNewComment(e.target.value)}\r\n\t\t\t\t\t\t\t\tvalue={newComment}\r\n\t\t\t\t\t\t\t\tonKeyDown={e => handleKey(e)}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t</label>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<button className='toggle-emoji-picker' onClick={() => setShowEmojis(!showEmojis)}>\r\n\t\t\t\t\t\t<SmileIcon />\r\n\t\t\t\t\t</button>\r\n\r\n\t\t\t\t\t{showEmojis && (\r\n\t\t\t\t\t\t<OutsideClickHandler\r\n\t\t\t\t\t\t\tonOutsideClick={() => {\r\n\t\t\t\t\t\t\t\tsetShowEmojis(false)\r\n\t\t\t\t\t\t\t}}>\r\n\t\t\t\t\t\t\t<EmojiPicker\r\n\t\t\t\t\t\t\t\tclassName='emoji-picker'\r\n\t\t\t\t\t\t\t\tonEmojiClick={handleEmojis}\r\n\t\t\t\t\t\t\t\ttheme={Theme.DARK}\r\n\t\t\t\t\t\t\t\tpreviewConfig={{\r\n\t\t\t\t\t\t\t\t\tdefaultCaption: '',\r\n\t\t\t\t\t\t\t\t\tdefaultEmoji: null,\r\n\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t// lazyLoadEmojis={true}\r\n\t\t\t\t\t\t\t\temojiStyle={EmojiStyle.NATIVE}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t</OutsideClickHandler>\r\n\t\t\t\t\t)}\r\n\t\t\t\t</div>\r\n\r\n\t\t\t\t{!imgUpload && newComment.trim() === '' && (\r\n\t\t\t\t\t<button\r\n\t\t\t\t\t\tclassName='input-tool'\r\n\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\tsetSendFastEmoji(true)\r\n\t\t\t\t\t\t}}>\r\n\t\t\t\t\t\t<span></span>\r\n\t\t\t\t\t</button>\r\n\t\t\t\t)}\r\n\r\n\t\t\t\t{(newComment.trim() !== '' || imgUpload) && (\r\n\t\t\t\t\t<button type='submit' className='input-tool'>\r\n\t\t\t\t\t\t<SendIcon />\r\n\t\t\t\t\t</button>\r\n\t\t\t\t)}\r\n\t\t\t</div>\r\n\t\t\t{newComment.length >= 900 && <p className='error'>Message can't be longer than 900 characters</p>}\r\n\t\t</form>\r\n\t)\r\n}\r\n\r\nexport default ChatInput\r\n","import { useEffect, useState } from 'react'\r\nimport { useParams } from 'react-router-dom'\r\nimport { useDocument } from '../../hooks/useDocument'\r\nimport { useAuthContext } from '../../hooks/useAuthContext'\r\n\r\n// Components\r\nimport Comments from '../../components/Comments'\r\nimport ChatInput from '../../components/ChatInput'\r\n\r\n// Styles && Assets\r\nimport './Chat.scss'\r\nimport Avatar from '../../components/Avatar'\r\n\r\nexport default function Chat() {\r\n\tconst [isAssignedUser, setIsAssignedUser] = useState(false)\r\n\tconst [query, setQuery] = useState(null)\r\n\r\n\tconst { user } = useAuthContext()\r\n\tconst { id } = useParams()\r\n\r\n\tconst { error, document } = useDocument('projects', id)\r\n\tlet rightUrl = ''\r\n\tlet rightDisplayName = ''\r\n\r\n\tuseEffect(() => {\r\n\t\tif (document) {\r\n\t\t\tdocument.assignedUsersId.forEach(id => {\r\n\t\t\t\tif (id === user.uid) setIsAssignedUser(true)\r\n\t\t\t})\r\n\t\t}\r\n\t}, [document, user.uid])\r\n\r\n\tif (error) {\r\n\t\treturn <div className='error'>{error}</div>\r\n\t}\r\n\r\n\tif (!document) {\r\n\t\treturn <div className='loading'>Loading...</div>\r\n\t}\r\n\r\n\tdocument.assignedUsersPhotoURL.forEach(url => {\r\n\t\tif (url !== user.photoURL) {\r\n\t\t\trightUrl = url\r\n\t\t}\r\n\t})\r\n\r\n\tdocument.assignedUsersName.forEach(name => {\r\n\t\tif (name !== user.displayName) {\r\n\t\t\trightDisplayName = name\r\n\t\t}\r\n\t})\r\n\r\n\treturn (\r\n\t\t<>\r\n\t\t\t{isAssignedUser && (\r\n\t\t\t\t<div className='chat'>\r\n\t\t\t\t\t{user && (\r\n\t\t\t\t\t\t<div className='chat__top-bar'>\r\n\t\t\t\t\t\t\t<Avatar src={rightUrl} />\r\n\t\t\t\t\t\t\t<h3>{rightDisplayName}</h3>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t)}\r\n\r\n\t\t\t\t\t<div className='vertical-container'>\r\n\t\t\t\t\t\t<div className='chat__comments'>\r\n\t\t\t\t\t\t\t<Comments chat={document} onQuery={setQuery} />\r\n\t\t\t\t\t\t\t<ChatInput chat={document} query={query} onQuery={setQuery} />\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t)}\r\n\t\t</>\r\n\t)\r\n}\r\n","import { useState, useEffect } from 'react'\r\nimport { useHistory } from 'react-router-dom'\r\nimport { projectAuth, projectFirestore, projectGitHub, projectGoogle } from '../firebase/config'\r\nimport { useAuthContext } from './useAuthContext'\r\n\r\nexport const useLogin = () => {\r\n\tconst [isCancelled, setIsCancelled] = useState(false)\r\n\tconst [error, setError] = useState(null)\r\n\tconst [isPending, setIsPending] = useState(false)\r\n\tconst { dispatch } = useAuthContext()\r\n\tconst [isFinished, setIsFinished] = useState(false)\r\n\r\n\tlet history = useHistory()\r\n\r\n\tconst login = async (email, password) => {\r\n\t\tsetError(null)\r\n\t\tsetIsPending(true)\r\n\r\n\t\ttry {\r\n\t\t\t// Login\r\n\t\t\tconst res = await projectAuth.signInWithEmailAndPassword(email, password)\r\n\r\n\t\t\t// Update online status\r\n\r\n\t\t\tawait projectFirestore.collection('users').doc(res.user.uid).update({\r\n\t\t\t\tonline: true,\r\n\t\t\t})\r\n\r\n\t\t\t// Dispatch login action\r\n\t\t\tdispatch({ type: 'LOGIN', payload: res.user })\r\n\r\n\t\t\t// Update state\r\n\t\t\tif (!isCancelled) {\r\n\t\t\t\tsetIsPending(false)\r\n\t\t\t\tsetError(null)\r\n\t\t\t}\r\n\t\t} catch (err) {\r\n\t\t\tif (!isCancelled) {\r\n\t\t\t\tsetError(err.message)\r\n\t\t\t\tsetIsPending(false)\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tconst loginWithGoogle = async () => {\r\n\t\tsetError(null)\r\n\t\tsetIsPending(true)\r\n\r\n\t\ttry {\r\n\t\t\t// Login\r\n\t\t\tconst res = await projectAuth.signInWithPopup(projectGoogle)\r\n\r\n\t\t\t// Update online status\r\n\r\n\t\t\tawait projectFirestore.collection('users').doc(res.user.uid).update({\r\n\t\t\t\tonline: true,\r\n\t\t\t})\r\n\r\n\t\t\t// Dispatch login action\r\n\t\t\tdispatch({ type: 'LOGIN', payload: res.user })\r\n\r\n\t\t\t// Update state\r\n\t\t\tif (!isCancelled) {\r\n\t\t\t\tsetIsPending(false)\r\n\t\t\t\tsetError(null)\r\n\t\t\t}\r\n\t\t} catch (err) {\r\n\t\t\tif (!isCancelled) {\r\n\t\t\t\tsetError(err.message)\r\n\t\t\t\tsetIsPending(false)\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tconst loginWithGithub = async () => {\r\n\t\tsetError(null)\r\n\t\tsetIsPending(true)\r\n\r\n\t\ttry {\r\n\t\t\t// Login\r\n\t\t\tconst res = await projectAuth.signInWithPopup(projectGitHub)\r\n\t\t\t// Update online status\r\n\r\n\t\t\tawait projectFirestore.collection('users').doc(res.user.uid).update({\r\n\t\t\t\tonline: true,\r\n\t\t\t})\r\n\r\n\t\t\t// Dispatch login action\r\n\t\t\tdispatch({ type: 'LOGIN', payload: res.user })\r\n\r\n\t\t\t// Update state\r\n\t\t\tif (!isCancelled) {\r\n\t\t\t\tsetIsPending(false)\r\n\t\t\t\tsetError(null)\r\n\t\t\t}\r\n\t\t} catch (err) {\r\n\t\t\tif (!isCancelled) {\r\n\t\t\t\tsetError(err.message)\r\n\t\t\t\tsetIsPending(false)\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tconst resetPassword = async email => {\r\n\t\tsetError(null)\r\n\t\tsetIsPending(true)\r\n\t\tsetIsFinished(false)\r\n\r\n\t\ttry {\r\n\t\t\tawait projectAuth.sendPasswordResetEmail(email)\r\n\t\t\tif (!isCancelled) {\r\n\t\t\t\tsetIsPending(false)\r\n\t\t\t\tsetError(null)\r\n\t\t\t\tsetIsFinished(true)\r\n\r\n\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\thistory.push('/login')\r\n\t\t\t\t}, 15000)\r\n\t\t\t}\r\n\t\t} catch (err) {\r\n\t\t\tif (!isCancelled) {\r\n\t\t\t\tsetError(err.message)\r\n\t\t\t\tsetIsPending(false)\r\n\t\t\t\tsetIsFinished(false)\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tuseEffect(() => {\r\n\t\treturn () => setIsCancelled(true)\r\n\t}, [])\r\n\r\n\treturn { login, loginWithGoogle, loginWithGithub, resetPassword, isPending, error, isFinished }\r\n}\r\n","export default __webpack_public_path__ + \"static/media/btn_google_dark_normal_ios.9fe90a17.svg\";","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyRpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNS1jMDIxIDc5LjE1NDkxMSwgMjAxMy8xMC8yOS0xMTo0NzoxNiAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6RERCMUIwOUY4NkNFMTFFM0FBNTJFRTMzNTJEMUJDNDYiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6RERCMUIwOUU4NkNFMTFFM0FBNTJFRTMzNTJEMUJDNDYiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNiAoTWFjaW50b3NoKSI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkU1MTc4QTJBOTlBMDExRTI5QTE1QkMxMDQ2QTg5MDREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOkU1MTc4QTJCOTlBMDExRTI5QTE1QkMxMDQ2QTg5MDREIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+jUqS1wAAApVJREFUeNq0l89rE1EQx3e3gVJoSPzZeNEWPKgHoa0HBak0iHiy/4C3WvDmoZ56qJ7txVsPQu8qlqqHIhRKJZceesmhioQEfxTEtsoSpdJg1u/ABJ7Pmc1m8zLwgWTmzcw3L+/te+tHUeQltONgCkyCi2AEDHLsJ6iBMlgHL8FeoqokoA2j4CloRMmtwTmj7erHBXPgCWhG6a3JNXKdCiDl1cidVbXZkJoXQRi5t5BrxwoY71FzU8S4JuAIqFkJ2+BFSlEh525b/hr3+k/AklDkNsf6wTT4yv46KIMNpsy+iMdMc47HNWxbsgVcUn7FmLAzzoFAWDsBx+wVP6bUpp5ewI+DOeUx0Wd9D8F70BTGNjkWtqnhmT1JQAHcUgZd8Lo3rQb1LAT8eJVUfgGvHQigGp+V2Z0iAUUl8QH47kAA1XioxIo+bRN8OG8F/oBjwv+Z1nJgX5jpdzQDw0LCjsPmrcW7I/iHScCAEDj03FtD8A0EyuChHgg4KTlJQF3wZ7WELppnBX+dBFSVpJsOBWi1qiRgSwnOgoyD5hmuJdkWCVhTgnTvW3AgYIFrSbZGh0UW/Io5Vp+DQoK7o80pztWMemZbgxeNwCNwDbw1fIfgGZjhU6xPaJgBV8BdsMw5cbZoHsenwYFxkZzl83xTSKTiviCAfCsJLysH3POfC8m8NegyGAGfLP/VmGmfSChgXroR0RSWjEFv2J/nG84cuKFMf4sTCZqXuJd4KaXFVjEG3+tw4eXbNK/YC9oXXs3O8NY8y99L4BXY5cvLY/Bb2VZ58EOJVcB18DHJq9lRsKr8inyKGVjlmh29mtHs3AHfuhCwy1vXT/Nu2GKQt+UHsGdctyX6eQyNvc+5sfX9Dl7Pe2J/BRgAl2CpwmrsHR0AAAAASUVORK5CYII=\"","import { useState } from 'react'\r\nimport { useLogin } from '../../hooks/useLogin'\r\nimport { Link } from 'react-router-dom'\r\n\r\n// Styles & assets\r\nimport './Login.scss'\r\nimport googleLogo from '../../assets/btn_google_dark_normal_ios.svg'\r\nimport githubLogo from '../../assets/GitHub-Mark-Light-32px.png'\r\n\r\nexport default function Login() {\r\n\tconst [email, setEmail] = useState('')\r\n\tconst [password, setPassword] = useState('')\r\n\tconst { login, loginWithGoogle, loginWithGithub, isPending, error } = useLogin()\r\n\r\n\tconst handleSubmit = e => {\r\n\t\te.preventDefault()\r\n\t\tlogin(email, password)\r\n\t}\r\n\tconst handleSubmitWithGoogle = e => {\r\n\t\te.preventDefault()\r\n\t\tloginWithGoogle()\r\n\t}\r\n\tconst handleSubmitWithGithub = e => {\r\n\t\te.preventDefault()\r\n\t\tloginWithGithub()\r\n\t}\r\n\r\n\treturn (\r\n\t\t<div className='login'>\r\n\t\t\t<div className='auth-decoration'>\r\n\t\t\t\t<div className='circle'></div>\r\n\t\t\t\t<div className='blur'></div>\r\n\t\t\t</div>\r\n\r\n\t\t\t<form className='auth-form' onSubmit={handleSubmit}>\r\n\t\t\t\t<div className='auth-form__title'>\r\n\t\t\t\t\t<h2>Welcome back</h2>\r\n\t\t\t\t</div>\r\n\r\n\t\t\t\t<label>\r\n\t\t\t\t\t<span>Email</span>\r\n\t\t\t\t\t<input\r\n\t\t\t\t\t\ttype='email'\r\n\t\t\t\t\t\trequired\r\n\t\t\t\t\t\tonChange={e => setEmail(e.target.value)}\r\n\t\t\t\t\t\tvalue={email}\r\n\t\t\t\t\t\tplaceholder='Enter your email'\r\n\t\t\t\t\t/>\r\n\t\t\t\t</label>\r\n\r\n\t\t\t\t<label>\r\n\t\t\t\t\t<span>Password</span>\r\n\t\t\t\t\t<input\r\n\t\t\t\t\t\ttype='password'\r\n\t\t\t\t\t\trequired\r\n\t\t\t\t\t\tonChange={e => setPassword(e.target.value)}\r\n\t\t\t\t\t\tvalue={password}\r\n\t\t\t\t\t\tplaceholder='Enter your password'\r\n\t\t\t\t\t/>\r\n\t\t\t\t</label>\r\n\t\t\t\t<Link to={'/recover-password'} className='reset-password'>\r\n\t\t\t\t\tForgot password?\r\n\t\t\t\t</Link>\r\n\r\n\t\t\t\t{!isPending && <button className='btn'>Login</button>}\r\n\t\t\t\t{isPending && (\r\n\t\t\t\t\t<button className='btn' disabled>\r\n\t\t\t\t\t\tLoading\r\n\t\t\t\t\t</button>\r\n\t\t\t\t)}\r\n\r\n\t\t\t\t<div className='others-separator'>\r\n\t\t\t\t\t<span>or</span>\r\n\t\t\t\t</div>\r\n\r\n\t\t\t\t<button className='google-btn' onClick={handleSubmitWithGoogle}>\r\n\t\t\t\t\t<img src={googleLogo} alt='google logo' />\r\n\t\t\t\t\t<span>Sign in with google</span>\r\n\t\t\t\t</button>\r\n\r\n\t\t\t\t<button className='github-btn' onClick={handleSubmitWithGithub}>\r\n\t\t\t\t\t<img src={githubLogo} alt='github logo' />\r\n\t\t\t\t\t<span>Sign in with GitHub</span>\r\n\t\t\t\t</button>\r\n\r\n\t\t\t\t<p className='change-page'>\r\n\t\t\t\t\tDon't have an account? <Link to='/signup'>Sign up</Link>\r\n\t\t\t\t</p>\r\n\r\n\t\t\t\t{error && <div className='error'>{error}</div>}\r\n\t\t\t</form>\r\n\t\t</div>\r\n\t)\r\n}\r\n","import { useState } from 'react'\r\nimport { useSignup } from '../../hooks/useSignup'\r\nimport { Link } from 'react-router-dom'\r\n\r\n// Styles\r\nimport './Signup.scss'\r\nimport googleLogo from '../../assets/btn_google_dark_normal_ios.svg'\r\nimport githubLogo from '../../assets/GitHub-Mark-Light-32px.png'\r\n\r\nexport default function Signup() {\r\n\tconst [email, setEmail] = useState('')\r\n\tconst [password, setPassword] = useState('')\r\n\tconst [displayName, setDisplayName] = useState('')\r\n\tconst [thumbnail, setThumbnail] = useState(null)\r\n\tconst [thumbnailError, setThumbnailError] = useState(null)\r\n\tconst { signup, signInWithGoogle, signInWithGithub, isPending, error } = useSignup()\r\n\r\n\tconst handleSubmit = e => {\r\n\t\te.preventDefault()\r\n\t\tsignup(email, password, displayName, thumbnail)\r\n\t}\r\n\r\n\tconst handleSubmitWithGoogle = e => {\r\n\t\te.preventDefault()\r\n\t\tsignInWithGoogle()\r\n\t}\r\n\r\n\tconst handleSubmitWithGithub = e => {\r\n\t\te.preventDefault()\r\n\t\tsignInWithGithub()\r\n\t}\r\n\r\n\tconst handleFileChange = e => {\r\n\t\tsetThumbnail(null)\r\n\t\tlet selected = e.target.files[0]\r\n\r\n\t\tif (!selected) {\r\n\t\t\tsetThumbnailError('Please select a file')\r\n\t\t\treturn\r\n\t\t}\r\n\t\tif (!selected.type.includes('image')) {\r\n\t\t\tsetThumbnailError('Selected file must be an image')\r\n\t\t\treturn\r\n\t\t}\r\n\t\tif (!selected.size > 100000) {\r\n\t\t\tsetThumbnailError('Image file size must be less than 100kb')\r\n\t\t\treturn\r\n\t\t}\r\n\r\n\t\tsetThumbnailError(null)\r\n\t\tsetThumbnail(selected)\r\n\t}\r\n\r\n\treturn (\r\n\t\t<div className='signup'>\r\n\t\t\t<div className='auth-decoration'>\r\n\t\t\t\t<div className='circle'></div>\r\n\t\t\t\t<div className='blur'></div>\r\n\t\t\t</div>\r\n\t\t\t<form className='auth-form' onSubmit={handleSubmit}>\r\n\t\t\t\t<div className='auth-form__title'>\r\n\t\t\t\t\t<h2>Join us</h2>\r\n\t\t\t\t</div>\r\n\r\n\t\t\t\t<label>\r\n\t\t\t\t\t<span>Email:</span>\r\n\t\t\t\t\t<input type='email' required onChange={e => setEmail(e.target.value)} value={email} placeholder='Aa' />\r\n\t\t\t\t</label>\r\n\t\t\t\t<label>\r\n\t\t\t\t\t<span>Password:</span>\r\n\t\t\t\t\t<input\r\n\t\t\t\t\t\ttype='password'\r\n\t\t\t\t\t\trequired\r\n\t\t\t\t\t\tonChange={e => setPassword(e.target.value)}\r\n\t\t\t\t\t\tvalue={password}\r\n\t\t\t\t\t\tplaceholder='Aa'\r\n\t\t\t\t\t/>\r\n\t\t\t\t</label>\r\n\t\t\t\t<label>\r\n\t\t\t\t\t<span>Display name:</span>\r\n\t\t\t\t\t<input\r\n\t\t\t\t\t\ttype='text'\r\n\t\t\t\t\t\trequired\r\n\t\t\t\t\t\tonChange={e => setDisplayName(e.target.value)}\r\n\t\t\t\t\t\tvalue={displayName}\r\n\t\t\t\t\t\tplaceholder='Aa'\r\n\t\t\t\t\t/>\r\n\t\t\t\t</label>\r\n\t\t\t\t<label>\r\n\t\t\t\t\t<span>Profile thumbnail:</span>\r\n\t\t\t\t\t<input type='file' required onChange={handleFileChange} />\r\n\r\n\t\t\t\t\t{thumbnailError && <div className='error'>{thumbnailError}</div>}\r\n\t\t\t\t</label>\r\n\r\n\t\t\t\t{!isPending && <button className='btn'>Sign up</button>}\r\n\t\t\t\t{isPending && (\r\n\t\t\t\t\t<button className='btn' disabled>\r\n\t\t\t\t\t\tLoading\r\n\t\t\t\t\t</button>\r\n\t\t\t\t)}\r\n\r\n\t\t\t\t<div className='others-separator'>\r\n\t\t\t\t\t<span>or</span>\r\n\t\t\t\t</div>\r\n\r\n\t\t\t\t<button className='google-btn' onClick={handleSubmitWithGoogle}>\r\n\t\t\t\t\t<img src={googleLogo} alt='google logo' />\r\n\t\t\t\t\t<span>Sign in with google</span>\r\n\t\t\t\t</button>\r\n\r\n\t\t\t\t<button className='github-btn' onClick={handleSubmitWithGithub}>\r\n\t\t\t\t\t<img src={githubLogo} alt='github logo' />\r\n\t\t\t\t\t<span>Sign in with GitHub</span>\r\n\t\t\t\t</button>\r\n\r\n\t\t\t\t<p className='change-page'>\r\n\t\t\t\t\tAlready have an account? <Link to='/login'>Login</Link>\r\n\t\t\t\t</p>\r\n\r\n\t\t\t\t{error && <div className='error'>{error}</div>}\r\n\t\t\t</form>\r\n\t\t</div>\r\n\t)\r\n}\r\n","import { useState, useEffect } from 'react'\r\nimport { projectAuth, projectFirestore, projectStorage, projectGoogle, projectGitHub } from '../firebase/config'\r\nimport { useAuthContext } from './useAuthContext'\r\n\r\nexport const useSignup = () => {\r\n\tconst [isCancelled, setIsCancelled] = useState(false)\r\n\tconst [error, setError] = useState(null)\r\n\tconst [isPending, setIsPending] = useState(false)\r\n\tconst { dispatch } = useAuthContext()\r\n\r\n\tconst signup = async (email, password, displayName, thumbnail) => {\r\n\t\tsetError(null)\r\n\t\tsetIsPending(true)\r\n\r\n\t\ttry {\r\n\t\t\t// Signup\r\n\t\t\tconst res = await projectAuth.createUserWithEmailAndPassword(email, password)\r\n\r\n\t\t\tif (!res) {\r\n\t\t\t\tthrow new Error('Could not complete signup')\r\n\t\t\t}\r\n\r\n\t\t\t// Upload thumbnail\r\n\r\n\t\t\tconst uploadPath = `thumbnails/${res.user.uid}/${thumbnail.name}`\r\n\t\t\tconst img = await projectStorage.ref(uploadPath).put(thumbnail)\r\n\t\t\tconst imgUrl = await img.ref.getDownloadURL()\r\n\r\n\t\t\t// Add display name to user\r\n\t\t\tawait res.user.updateProfile({ displayName, photoURL: imgUrl })\r\n\r\n\t\t\t// Create a user document\r\n\t\t\tawait projectFirestore.collection('users').doc(res.user.uid).set({\r\n\t\t\t\tonline: true,\r\n\t\t\t\tdisplayName: displayName,\r\n\t\t\t\tphotoURL: imgUrl,\r\n\t\t\t})\r\n\r\n\t\t\t// Dispatch login action\r\n\t\t\tdispatch({ type: 'LOGIN', payload: res.user })\r\n\r\n\t\t\tif (!isCancelled) {\r\n\t\t\t\tsetIsPending(false)\r\n\t\t\t\tsetError(null)\r\n\t\t\t}\r\n\t\t} catch (err) {\r\n\t\t\tif (!isCancelled) {\r\n\t\t\t\tsetError(err.message)\r\n\t\t\t\tsetIsPending(false)\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tconst signInWithGoogle = async () => {\r\n\t\tsetError(null)\r\n\t\tsetIsPending(true)\r\n\r\n\t\ttry {\r\n\t\t\t// Signup\r\n\t\t\tconst res = await projectAuth.signInWithPopup(projectGoogle)\r\n\r\n\t\t\tif (!res) {\r\n\t\t\t\tthrow new Error('Could not complete signup')\r\n\t\t\t}\r\n\r\n\t\t\t// Add display name to user\r\n\t\t\tawait res.user.updateProfile({ displayName: res.user.displayName, photoURL: res.user.photoURL })\r\n\r\n\t\t\t// Create a user document\r\n\t\t\tawait projectFirestore.collection('users').doc(res.user.uid).set({\r\n\t\t\t\tonline: true,\r\n\t\t\t\tdisplayName: res.user.displayName,\r\n\t\t\t\tphotoURL: res.user.photoURL,\r\n\t\t\t})\r\n\r\n\t\t\t// Dispatch login action\r\n\t\t\tdispatch({ type: 'LOGIN', payload: res.user })\r\n\r\n\t\t\tif (!isCancelled) {\r\n\t\t\t\tsetIsPending(false)\r\n\t\t\t\tsetError(null)\r\n\t\t\t}\r\n\t\t} catch (err) {\r\n\t\t\tif (!isCancelled) {\r\n\t\t\t\tsetError(err.message)\r\n\t\t\t\tsetIsPending(false)\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tconst signInWithGithub = async () => {\r\n\t\tsetError(null)\r\n\t\tsetIsPending(true)\r\n\r\n\t\ttry {\r\n\t\t\t// Signup\r\n\t\t\tconst res = await projectAuth.signInWithPopup(projectGitHub)\r\n\r\n\t\t\tif (!res) {\r\n\t\t\t\tthrow new Error('Could not complete signup')\r\n\t\t\t}\r\n\r\n\t\t\t// Add display name to user\r\n\t\t\tawait res.user.updateProfile({ displayName: res.additionalUserInfo.username, photoURL: res.user.photoURL })\r\n\r\n\t\t\t// Create a user document\r\n\t\t\tawait projectFirestore.collection('users').doc(res.user.uid).set({\r\n\t\t\t\tonline: true,\r\n\t\t\t\tdisplayName: res.user.displayName,\r\n\t\t\t\tphotoURL: res.user.photoURL,\r\n\t\t\t})\r\n\r\n\t\t\t// Dispatch login action\r\n\t\t\tdispatch({ type: 'LOGIN', payload: res.user })\r\n\r\n\t\t\tif (!isCancelled) {\r\n\t\t\t\tsetIsPending(false)\r\n\t\t\t\tsetError(null)\r\n\t\t\t}\r\n\t\t} catch (err) {\r\n\t\t\tif (!isCancelled) {\r\n\t\t\t\tsetError(err.message)\r\n\t\t\t\tsetIsPending(false)\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tuseEffect(() => {\r\n\t\treturn () => setIsCancelled(true)\r\n\t}, [])\r\n\r\n\treturn { signup, signInWithGoogle, signInWithGithub, error, isPending }\r\n}\r\n","import React from 'react'\r\n\r\nexport default function PrivacyPolicy() {\r\n\treturn (\r\n\t\t<>\r\n\t\t\t<div class='privacy-section'>\r\n\t\t\t\t<h3>Zbieranie danych</h3>\r\n\t\t\t\t<p>Kiedy zbieramy Twoje dane? Twj email oraz haso zapisywane s podczas rejestracji na naszej stronie.</p>\r\n\t\t\t</div>\r\n\r\n\t\t\t<div class='privacy-section'>\r\n\t\t\t\t<h3>Cele przetwarzania danych</h3>\r\n\r\n\t\t\t\t<p>\r\n\t\t\t\t\tTwoje dane zebrane podczas rejestracji przetwarzane s jedynie w celu umoliwienia korzystania ze strony. Nie\r\n\t\t\t\t\tudostpniamy ich nikomu, nie sprzedajemy ich. Rejestracja jest dobrowolna.\r\n\t\t\t\t</p>\r\n\t\t\t</div>\r\n\t\t\t<div class='privacy-section'>\r\n\t\t\t\t<h3>Bezpieczestwo danych</h3>\r\n\r\n\t\t\t\t<p>\r\n\t\t\t\t\tTwoje dane s automatycznie szyfrowane przez usug firebase od google. Nikt nieautoryzowany nie ma dostpu do\r\n\t\t\t\t\ttwoich danych.\r\n\t\t\t\t</p>\r\n\t\t\t</div>\r\n\t\t\t<div class='privacy-section'>\r\n\t\t\t\t<h3>Usuwanie danych</h3>\r\n\r\n\t\t\t\t<p>\r\n\t\t\t\t\tJeli zrezygnujesz z uywania naszej aplikacji w kadym momencie moesz do nas napisa na maila \"matkowsky808@gmail\" lub wykorzysta funkcj w ustawieniach, aby usun konto oraz swoje dane.\r\n\t\t\t\t</p>\r\n\t\t\t</div>\r\n\r\n\t\t\t<div class='privacy-section'>\r\n\t\t\t\t<h3>Pozostae informacje</h3>\r\n\r\n\t\t\t\t<p>\r\n\t\t\t\t\t<span>W razie jakichkolwiek pyta, prosimy o kontakt na adresie mailowym: matkowsky808@gmail.com</span>\r\n\t\t\t\t</p>\r\n\t\t\t</div>\r\n\t\t</>\r\n\t)\r\n}\r\n","export default __webpack_public_path__ + \"static/media/shrek-gif.df094210.gif\";","import { useEffect, useState } from 'react'\r\nimport { useLogin } from '../../hooks/useLogin'\r\nimport { Link } from 'react-router-dom'\r\n\r\n// Styles & assets\r\nimport './Login.scss'\r\nimport ShrekGif from '../../assets/shrek-gif.gif'\r\n\r\nexport default function Login() {\r\n\tconst [email, setEmail] = useState('')\r\n\tconst { resetPassword, isPending, error, isFinished } = useLogin()\r\n\tconst [timeToRedirect, setTimeToRedirect] = useState(15)\r\n\r\n\tconst handlePasswordReset = e => {\r\n\t\te.preventDefault()\r\n\t\tresetPassword(email)\r\n\t}\r\n\r\n\tuseEffect(() => {\r\n\t\tif (isFinished === true) {\r\n\t\t\tcountdown()\r\n\t\t}\r\n\t}, [isFinished])\r\n\r\n\tconst countdown = () => {\r\n\t\tlet redirectCountdown = setInterval(() => {\r\n\t\t\tif (timeToRedirect <= 0) {\r\n\t\t\t\tclearInterval(redirectCountdown)\r\n\t\t\t} else {\r\n\t\t\t\tsetTimeToRedirect(prevTimeToRedirect => prevTimeToRedirect - 1)\r\n\t\t\t}\r\n\t\t}, 1000)\r\n\t}\r\n\r\n\tconst handleKey = e => {\r\n\t\te.code === 'Enter' && handlePasswordReset(e)\r\n\t}\r\n\r\n\treturn (\r\n\t\t<div className='login'>\r\n\t\t\t<div className='auth-decoration'>\r\n\t\t\t\t<div className='circle'></div>\r\n\t\t\t\t<div className='blur'></div>\r\n\t\t\t</div>\r\n\r\n\t\t\t<div className='auth-form'>\r\n\t\t\t\t{isFinished && (\r\n\t\t\t\t\t<div className='text-center email-sent'>\r\n\t\t\t\t\t\t<img src={ShrekGif} alt='' className='email-sent__img' />\r\n\t\t\t\t\t\t<h2>Check your email</h2>\r\n\t\t\t\t\t\t<p>A password reset email has been sent to your email address</p>\r\n\r\n\t\t\t\t\t\t<Link to='/login'>\r\n\t\t\t\t\t\t\t<button className='btn'>Back to Login</button>\r\n\t\t\t\t\t\t</Link>\r\n\r\n\t\t\t\t\t\t<p className='redirect'>Redirecting in {timeToRedirect} s</p>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t)}\r\n\r\n\t\t\t\t{!isFinished && (\r\n\t\t\t\t\t<>\r\n\t\t\t\t\t\t<div className='auth-form__title'>\r\n\t\t\t\t\t\t\t<h2>Forgot password?</h2>\r\n\t\t\t\t\t\t\t<p>Enter your email below to recieve password reset instructions</p>\r\n\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t<label>\r\n\t\t\t\t\t\t\t<span>Email</span>\r\n\t\t\t\t\t\t\t<input\r\n\t\t\t\t\t\t\t\ttype='email'\r\n\t\t\t\t\t\t\t\trequired\r\n\t\t\t\t\t\t\t\tonChange={e => setEmail(e.target.value)}\r\n\t\t\t\t\t\t\t\tvalue={email}\r\n\t\t\t\t\t\t\t\tplaceholder='Enter your email'\r\n\t\t\t\t\t\t\t\tonKeyDown={e => handleKey(e)}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t</label>\r\n\r\n\t\t\t\t\t\t{!isPending && (\r\n\t\t\t\t\t\t\t<button className='btn' onClick={handlePasswordReset}>\r\n\t\t\t\t\t\t\t\tReset password\r\n\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t{isPending && (\r\n\t\t\t\t\t\t\t<button className='btn' disabled>\r\n\t\t\t\t\t\t\t\tSending email...\r\n\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t)}\r\n\r\n\t\t\t\t\t\t<p className='change-page'>\r\n\t\t\t\t\t\t\tNo longer have Alzheimer? <Link to='/login'>Login</Link>\r\n\t\t\t\t\t\t</p>\r\n\r\n\t\t\t\t\t\t{error && <div className='error'>{error}</div>}\r\n\t\t\t\t\t</>\r\n\t\t\t\t)}\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t)\r\n}\r\n","import { useEffect, useState, useRef } from \"react\"\nimport { projectFirestore } from \"../firebase/config\"\n\nexport const useCollection = (collection, _query, _orderBy) => {\n  const [documents, setDocuments] = useState(null)\n  const [error, setError] = useState(null)\n\n  // if we don't use a ref --> infinite loop in useEffect\n  // _query is an array and is \"different\" on every function call\n  const query = useRef(_query).current\n  const orderBy = useRef(_orderBy).current\n\n  useEffect(() => {\n    let ref = projectFirestore.collection(collection)\n\n    if (query) {\n      ref = ref.where(...query)\n    }\n    if (orderBy) {\n      ref = ref.orderBy(...orderBy)\n    }\n\n    const unsubscribe = ref.onSnapshot(snapshot => {\n      let results = []\n      snapshot.docs.forEach(doc => {\n        results.push({...doc.data(), id: doc.id})\n      });\n      \n      // update state\n      setDocuments(results)\n      setError(null)\n    }, error => {\n      console.log(error)\n      setError('could not fetch the data')\n    })\n\n    // unsubscribe on unmount\n    return () => unsubscribe()\n\n  }, [collection, query, orderBy])\n\n  return { documents, error }\n}","import { Link } from 'react-router-dom'\r\nimport { useAuthContext } from '../hooks/useAuthContext'\r\nimport { useCollection } from '../hooks/useCollection'\r\nimport formatDistanceToNowStrict from 'date-fns/formatDistanceToNow'\r\nimport Avatar from './Avatar'\r\n\r\n// Styles\r\nimport './ChatsList.scss'\r\n\r\nexport default function ChatsList({ projects }) {\r\n\tconst { user } = useAuthContext()\r\n\tconst { documents: users } = useCollection('users')\r\n\r\n\tlet onlineUsers = []\r\n\tlet rightUrl = ''\r\n\tlet rightDisplayName = ''\r\n\tlet rightId = ''\r\n\tconst replaceDistanceToNow = {\r\n\t\tabout: '',\r\n\t\tminute: 'min',\r\n\t\tminutes: 'min',\r\n\t\t'less than a minute': '1 min',\r\n\t}\r\n\r\n\t// const handleOnMouseMove = e => {\r\n\t// \tconsole.log(e)\r\n\t// \tconst rect = e.target.getBoundingClientRect(),\r\n\t// \t\tx = e.clientX - rect.left,\r\n\t// \t\ty = e.clientY - rect.top\r\n\t// \te.target.firstChild.style.setProperty('left', `${x}px`)\r\n\t// \te.target.firstChild.style.setProperty('top', `${y}px`)\r\n\t// }\r\n\r\n\tconst handleOnMouseMove = e => {\r\n\t\tfor (const card of document.getElementsByClassName('card')) {\r\n\t\t\tconst rect = card.getBoundingClientRect(),\r\n\t\t\t\tx = e.clientX - rect.left,\r\n\t\t\t\ty = e.clientY - rect.top\r\n\r\n\t\t\tcard.style.setProperty('--mouse-x', `${x}px`)\r\n\t\t\tcard.style.setProperty('--mouse-y', `${y}px`)\r\n\t\t}\r\n\t}\r\n\r\n\treturn (\r\n\t\t<div className='chat-list custom-scrollbar' onMouseMove={handleOnMouseMove}>\r\n\t\t\t{projects.length === 0 && <p>No chats yet!</p>}\r\n\t\t\t{projects.map(project => (\r\n\t\t\t\t<Link to={`/u/${project.id}`} key={project.id} className='card'>\r\n\t\t\t\t\t<div className='card-content'>\r\n\t\t\t\t\t\t{project.assignedUsersPhotoURL.forEach(url => {\r\n\t\t\t\t\t\t\tif (url !== user.photoURL) {\r\n\t\t\t\t\t\t\t\trightUrl = url\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t})}\r\n\r\n\t\t\t\t\t\t{project.assignedUsersName.forEach(name => {\r\n\t\t\t\t\t\t\tif (name !== user.displayName) {\r\n\t\t\t\t\t\t\t\trightDisplayName = name\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t})}\r\n\r\n\t\t\t\t\t\t{project.assignedUsersId.forEach(id => {\r\n\t\t\t\t\t\t\tif (id !== user.uid) {\r\n\t\t\t\t\t\t\t\trightId = id\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t})}\r\n\r\n\t\t\t\t\t\t{users &&\r\n\t\t\t\t\t\t\tusers.forEach(user => {\r\n\t\t\t\t\t\t\t\tif (user.online && !onlineUsers.includes(user.id)) {\r\n\t\t\t\t\t\t\t\t\tonlineUsers.push(user.id)\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t})}\r\n\r\n\t\t\t\t\t\t<div className='avatar-container'>\r\n\t\t\t\t\t\t\t<Avatar src={rightUrl} />\r\n\r\n\t\t\t\t\t\t\t{onlineUsers.includes(rightId) && (\r\n\t\t\t\t\t\t\t\t<span className='online-user'>\r\n\t\t\t\t\t\t\t\t\t<div className='status-circle'></div>\r\n\t\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t{/* {console.log(project.messages[project.messages.length - 1].createdAt.toDate().getTime())}\r\n\t\t\t\t\t{console.log(project)} */}\r\n\t\t\t\t\t\t<div className='chat-info'>\r\n\t\t\t\t\t\t\t<p className='display-name'>\r\n\t\t\t\t\t\t\t\t{rightDisplayName.substring(0, 18)}\r\n\t\t\t\t\t\t\t\t<span>{rightDisplayName.length >= 18 && '...'}</span>\r\n\t\t\t\t\t\t\t</p>\r\n\r\n\t\t\t\t\t\t\t<div className='last-chat'>\r\n\t\t\t\t\t\t\t\t<span className='last-message'>\r\n\t\t\t\t\t\t\t\t\t{project &&\r\n\t\t\t\t\t\t\t\t\t\tproject.messages[project.messages.length - 1] &&\r\n\t\t\t\t\t\t\t\t\t\tproject.messages[project.messages.length - 1].createdBy === user.uid &&\r\n\t\t\t\t\t\t\t\t\t\t'You: '}\r\n\r\n\t\t\t\t\t\t\t\t\t{project.messages.length !== 0 &&\r\n\t\t\t\t\t\t\t\t\t\tproject.messages[project.messages.length - 1].content &&\r\n\t\t\t\t\t\t\t\t\t\tproject.messages[project.messages.length - 1].fileType === undefined &&\r\n\t\t\t\t\t\t\t\t\t\tproject.messages[project.messages.length - 1].content.substring(0, 15)}\r\n\r\n\t\t\t\t\t\t\t\t\t{project.messages.length !== 0 &&\r\n\t\t\t\t\t\t\t\t\t\t!project.messages[project.messages.length - 1].content &&\r\n\t\t\t\t\t\t\t\t\t\tproject.messages[project.messages.length - 1].fileType === 'image' &&\r\n\t\t\t\t\t\t\t\t\t\t`sent a photo`}\r\n\r\n\t\t\t\t\t\t\t\t\t{project.messages.length !== 0 &&\r\n\t\t\t\t\t\t\t\t\t\t!project.messages[project.messages.length - 1].content &&\r\n\t\t\t\t\t\t\t\t\t\tproject.messages[project.messages.length - 1].fileType === 'video' &&\r\n\t\t\t\t\t\t\t\t\t\t`sent a video`}\r\n\r\n\t\t\t\t\t\t\t\t\t{project.messages.length !== 0 &&\r\n\t\t\t\t\t\t\t\t\t\tproject.messages[project.messages.length - 1].content &&\r\n\t\t\t\t\t\t\t\t\t\tproject.messages[project.messages.length - 1].content.length >= 15 &&\r\n\t\t\t\t\t\t\t\t\t\t'...'}\r\n\t\t\t\t\t\t\t\t\t{/* {console.log(project.messages[project.messages.length - 1].fileType !== undefined)} */}\r\n\t\t\t\t\t\t\t\t\t{project.messages.length === 0 && 'No messages yet'}\r\n\t\t\t\t\t\t\t\t</span>\r\n\r\n\t\t\t\t\t\t\t\t{project.messages.length !== 0 && <div className='dot'></div>}\r\n\t\t\t\t\t\t\t\t<span className='comment-date'>\r\n\t\t\t\t\t\t\t\t\t{project.messages.length !== 0 &&\r\n\t\t\t\t\t\t\t\t\t\tformatDistanceToNowStrict(project.messages[project.messages.length - 1].createdAt.toDate(), {\r\n\t\t\t\t\t\t\t\t\t\t\taddSuffix: false,\r\n\t\t\t\t\t\t\t\t\t\t}).replace(/\\b(?:about|less than a minute)\\b/gi, matched => replaceDistanceToNow[matched])}\r\n\t\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</Link>\r\n\t\t\t))}\r\n\t\t</div>\r\n\t)\r\n}\r\n","import { useState } from 'react'\r\nimport { setDoc, doc, getDoc } from 'firebase/firestore'\r\nimport { projectFirestore, timestamp } from '../firebase/config'\r\nimport { useCollection } from '../hooks/useCollection'\r\nimport { useAuthContext } from '../hooks/useAuthContext'\r\nimport { useLogout } from '../hooks/useLogout'\r\n\r\n// Compontents\r\nimport ChatsList from './ChatsList'\r\n\r\n// Styles\r\nimport './Chats.scss'\r\nimport Avatar from './Avatar'\r\n\r\nexport default function Chats() {\r\n\tconst { user } = useAuthContext()\r\n\tconst { logout, isPending } = useLogout()\r\n\tconst { documents: users } = useCollection('users')\r\n\tconst { documents: chats } = useCollection(\r\n\t\t'projects',\r\n\t\t['assignedUsersId', 'array-contains', user.uid],\r\n\t\t['updatedAt', 'desc']\r\n\t)\r\n\r\n\tconst [query, setQuery] = useState('')\r\n\r\n\tconst handleSelect = async addUser => {\r\n\t\t// Check whether the group(chats in firestore) exists, if not create\r\n\t\tconst combinedId = user.uid > addUser.id ? user.uid + addUser.id : addUser.id + user.uid\r\n\r\n\t\ttry {\r\n\t\t\tconst res = await getDoc(doc(projectFirestore, 'projects', combinedId))\r\n\r\n\t\t\tif (!res.exists() && user.uid !== addUser.id) {\r\n\t\t\t\t// Create a chat in chats collection\r\n\r\n\t\t\t\tawait setDoc(doc(projectFirestore, 'projects', combinedId), {\r\n\t\t\t\t\tid: combinedId,\r\n\t\t\t\t\tassignedUsersId: [user.uid, addUser.id],\r\n\t\t\t\t\tassignedUsersName: [user.displayName, addUser.displayName],\r\n\t\t\t\t\tassignedUsersPhotoURL: [user.photoURL, addUser.photoURL],\r\n\t\t\t\t\tmessages: [],\r\n\t\t\t\t\tupdatedAt: timestamp.fromDate(new Date()),\r\n\t\t\t\t\tcreatedAt: timestamp.fromDate(new Date()),\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t} catch (err) {}\r\n\r\n\t\tsetQuery('')\r\n\t}\r\n\r\n\treturn (\r\n\t\t<div className='user-list'>\r\n\t\t\t<div className='search'>\r\n\t\t\t\t<div>\r\n\t\t\t\t\t<div className='search-form'>\r\n\t\t\t\t\t\t<label>\r\n\t\t\t\t\t\t\t<i className='fa-solid fa-magnifying-glass'></i>\r\n\t\t\t\t\t\t\t<input\r\n\t\t\t\t\t\t\t\ttype='text'\r\n\t\t\t\t\t\t\t\tplaceholder='Find a user'\r\n\t\t\t\t\t\t\t\t// onKeyUp={handleSearch}\r\n\t\t\t\t\t\t\t\tonChange={e => setQuery(e.target.value)}\r\n\t\t\t\t\t\t\t\tvalue={query}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t</label>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t{query !== '' && (\r\n\t\t\t\t\t\t<>\r\n\t\t\t\t\t\t\t<div className='add-users'>\r\n\t\t\t\t\t\t\t\t{users &&\r\n\t\t\t\t\t\t\t\t\tusers\r\n\t\t\t\t\t\t\t\t\t\t.filter(user => user.displayName.toLowerCase().trim().replace(/\\s+/g, '').includes(query))\r\n\t\t\t\t\t\t\t\t\t\t.map(user => (\r\n\t\t\t\t\t\t\t\t\t\t\t<div key={user.id} className='user-chat' onClick={() => handleSelect(user)}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<img src={user.photoURL} alt='' />\r\n\t\t\t\t\t\t\t\t\t\t\t\t<div className='user-chat-info'>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<span>{user.displayName}</span>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t))}\r\n\r\n\t\t\t\t\t\t\t\t{query.trim() === '' && <span>User not found!</span>}\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</>\r\n\t\t\t\t\t)}\r\n\t\t\t\t\t<div className='chats'>{query === '' && chats && <ChatsList projects={chats} />}</div>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t\t<div className='user'>\r\n\t\t\t\t<div>\r\n\t\t\t\t\t<Avatar src={user.photoURL} />\r\n\t\t\t\t\t<span>{user.displayName}</span>\r\n\t\t\t\t</div>\r\n\r\n\t\t\t\t{!isPending && user && (\r\n\t\t\t\t\t<button className='btn' onClick={logout}>\r\n\t\t\t\t\t\tLogout\r\n\t\t\t\t\t</button>\r\n\t\t\t\t)}\r\n\r\n\t\t\t\t{isPending && (\r\n\t\t\t\t\t<button className='btn' disabled>\r\n\t\t\t\t\t\tLogging out...\r\n\t\t\t\t\t</button>\r\n\t\t\t\t)}\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t)\r\n}\r\n","import { useEffect, useState } from 'react'\nimport { projectAuth, projectFirestore } from '../firebase/config'\nimport { useAuthContext } from './useAuthContext'\n\nexport const useLogout = () => {\n\tconst [isCancelled, setIsCancelled] = useState(false)\n\tconst [error, setError] = useState(null)\n\tconst [isPending, setIsPending] = useState(false)\n\tconst { dispatch, user } = useAuthContext()\n\n\tconst logout = async () => {\n\t\tsetError(null)\n\t\tsetIsPending(true)\n\n\t\ttry {\n\t\t\t// Update online status\n\t\t\tconst { uid } = user\n\t\t\tawait projectFirestore.collection('users').doc(uid).update({\n\t\t\t\tonline: false,\n\t\t\t})\n\n\t\t\t// Sign the user out\n\t\t\tawait projectAuth.signOut()\n\n\t\t\t// Dispatch logout action\n\t\t\tdispatch({ type: 'LOGOUT' })\n\n\t\t\t// Update state\n\t\t\tif (!isCancelled) {\n\t\t\t\tsetIsPending(false)\n\t\t\t\tsetError(null)\n\t\t\t}\n\t\t} catch (err) {\n\t\t\tif (!isCancelled) {\n\t\t\t\tsetError(err.message)\n\t\t\t\tsetIsPending(false)\n\t\t\t}\n\t\t}\n\t}\n\n\tuseEffect(() => {\n\t\treturn () => setIsCancelled(true)\n\t}, [])\n\n\treturn { logout, error, isPending }\n}\n","import { BrowserRouter, Route, Switch, Redirect } from 'react-router-dom'\r\nimport { useAuthContext } from './hooks/useAuthContext'\r\n\r\n// Styles\r\nimport './App.scss'\r\n\r\n// Components && Pages\r\nimport Dashboard from './pages/dashboard/Dashboard'\r\nimport Chat from './pages/chat/Chat'\r\nimport Login from './pages/login/Login'\r\nimport Signup from './pages/signup/Signup'\r\nimport PrivacyPolicy from './pages/privacyPolicy/privacyPolicy'\r\nimport ResetPassword from './pages/login/ResetPassword'\r\nimport Chats from './components/Chats'\r\n\r\nfunction App() {\r\n\tconst { user, authIsReady } = useAuthContext()\r\n\r\n\treturn (\r\n\t\t<div className='App'>\r\n\t\t\t{authIsReady && (\r\n\t\t\t\t<BrowserRouter>\r\n\t\t\t\t\t{user && <Chats />}\r\n\r\n\t\t\t\t\t<Switch>\r\n\t\t\t\t\t\t<Route exact path='/'>\r\n\t\t\t\t\t\t\t{!user && <Redirect to='/login' />}\r\n\t\t\t\t\t\t\t{user && <Dashboard />}\r\n\t\t\t\t\t\t</Route>\r\n\r\n\t\t\t\t\t\t<Route path='/u/:id'>\r\n\t\t\t\t\t\t\t{!user && <Redirect to='/login' />}\r\n\t\t\t\t\t\t\t{user && <Chat />}\r\n\t\t\t\t\t\t</Route>\r\n\r\n\t\t\t\t\t\t<Route path='/privacy-policy'>\r\n\t\t\t\t\t\t\t<PrivacyPolicy />\r\n\t\t\t\t\t\t</Route>\r\n\r\n\t\t\t\t\t\t<Route path='/recover-password'>\r\n\t\t\t\t\t\t\t<ResetPassword />\r\n\t\t\t\t\t\t</Route>\r\n\r\n\t\t\t\t\t\t<Route path='/login'>\r\n\t\t\t\t\t\t\t{user && <Redirect to='/' />}\r\n\t\t\t\t\t\t\t{!user && <Login />}\r\n\t\t\t\t\t\t</Route>\r\n\r\n\t\t\t\t\t\t<Route path='/signup'>\r\n\t\t\t\t\t\t\t{user && <Redirect to='/' />}\r\n\t\t\t\t\t\t\t{!user && <Signup />}\r\n\t\t\t\t\t\t</Route>\r\n\t\t\t\t\t</Switch>\r\n\t\t\t\t</BrowserRouter>\r\n\t\t\t)}\r\n\t\t</div>\r\n\t)\r\n}\r\n\r\nexport default App\r\n","import React from 'react'\nimport ReactDOM from 'react-dom'\nimport './index.scss'\nimport App from './App'\nimport { AuthContextProvider } from './context/AuthContext'\n\nReactDOM.render(\n\t<React.StrictMode>\n\t\t<AuthContextProvider>\n\t\t\t<App />\n\t\t</AuthContextProvider>\n\t</React.StrictMode>,\n\tdocument.getElementById('root')\n)\n\t"],"sourceRoot":""}